define(["backbone","Breadcrumbs","Forms","Fuse","Handlebars","moment","purify","rxjs","QuickBase","css!./css/app.css"],function(Backbone,Breadcrumbs,BBForm,Fuse,Handlebars,moment,DOMPurify,rxjs,QuickBase){var __extends=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a,__spreadArrays=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var i=Array(e),o=0,t=0;t<n;t++)for(var a=arguments[t],s=0,l=a.length;s<l;s++,o++)i[o]=a[s];return i},__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},T=(A.Accordion=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="section">\n    <div class="heading"><i class="fa fa-caret-right"></i> <input type="checkbox"/>'+e.escapeExpression("function"==typeof(n=null!=(n=a(n,"heading")||(null!=t?a(t,"heading"):t))?n:e.hooks.helperMissing)?n.call(null!=t?t:e.nullContext||{},{name:"heading",hash:{},data:o,loc:{start:{line:2,column:83},end:{line:2,column:94}}}):n)+'</div>\n    <div class="content"></div>\n</div>\n'},useData:!0}),A.AnalyticParamItem=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r=e.escapeExpression,c="function",e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="buttonsContainer">\n\t<button class="generate-view-state">'+r((e(n,"t")||t&&e(t,"t")||l).call(s,"Generate Viewstate Path",{name:"t",hash:{},data:o,loc:{start:{line:2,column:37},end:{line:2,column:68}}}))+'</button>\n\t<div id="'+r(typeof(a=null!=(a=e(n,"radioId")||(null!=t?e(t,"radioId"):t))?a:l)==c?a.call(s,{name:"radioId",hash:{},data:o,loc:{start:{line:3,column:10},end:{line:3,column:21}}}):a)+'">\n\t\t<input type="radio" id="'+r(typeof(a=null!=(a=e(n,"radio1Id")||(null!=t?e(t,"radio1Id"):t))?a:l)==c?a.call(s,{name:"radio1Id",hash:{},data:o,loc:{start:{line:4,column:26},end:{line:4,column:38}}}):a)+'" name="'+r(typeof(a=null!=(a=e(n,"radioId")||(null!=t?e(t,"radioId"):t))?a:l)==c?a.call(s,{name:"radioId",hash:{},data:o,loc:{start:{line:4,column:46},end:{line:4,column:57}}}):a)+'" value="viewState"><label for="'+r(typeof(a=null!=(a=e(n,"radio1Id")||(null!=t?e(t,"radio1Id"):t))?a:l)==c?a.call(s,{name:"radio1Id",hash:{},data:o,loc:{start:{line:4,column:89},end:{line:4,column:101}}}):a)+'" class="firstLabel">'+r((e(n,"t")||t&&e(t,"t")||l).call(s,"Existing Viewstate Path",{name:"t",hash:{},data:o,loc:{start:{line:4,column:122},end:{line:4,column:153}}}))+'</label>\n\t\t<input type="radio" id="'+r(typeof(a=null!=(a=e(n,"radio2Id")||(null!=t?e(t,"radio2Id"):t))?a:l)==c?a.call(s,{name:"radio2Id",hash:{},data:o,loc:{start:{line:5,column:26},end:{line:5,column:38}}}):a)+'" name="'+r(typeof(a=null!=(a=e(n,"radioId")||(null!=t?e(t,"radioId"):t))?a:l)==c?a.call(s,{name:"radioId",hash:{},data:o,loc:{start:{line:5,column:46},end:{line:5,column:57}}}):a)+'" value="text"><label for="'+r(typeof(a=null!=(a=e(n,"radio2Id")||(null!=t?e(t,"radio2Id"):t))?a:l)==c?a.call(s,{name:"radio2Id",hash:{},data:o,loc:{start:{line:5,column:84},end:{line:5,column:96}}}):a)+'">'+r((e(n,"t")||t&&e(t,"t")||l).call(s,"Text",{name:"t",hash:{},data:o,loc:{start:{line:5,column:98},end:{line:5,column:110}}}))+'</label>\n\t</div>\n</div>\n\n<div class="analyticParamErrorDialog" style="display: none;">View state parameter type does not match analytic parameter type.</div>'},useData:!0}),A.AnalyticParamsView=Handlebars.template({1:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <div class="parameterItem">\n            <div class="label">'+c(typeof(a=null!=(a=e(n,"Name")||(null!=t?e(t,"Name"):t))?a:l)==r?a.call(s,{name:"Name",hash:{},data:o,loc:{start:{line:6,column:31},end:{line:6,column:39}}}):a)+" ("+c(typeof(a=null!=(a=e(n,"Type")||(null!=t?e(t,"Type"):t))?a:l)==r?a.call(s,{name:"Type",hash:{},data:o,loc:{start:{line:6,column:41},end:{line:6,column:49}}}):a)+')</div>\n            <input class="value" value="'+c(typeof(a=null!=(a=e(n,"DefaultValue")||(null!=t?e(t,"DefaultValue"):t))?a:l)==r?a.call(s,{name:"DefaultValue",hash:{},data:o,loc:{start:{line:7,column:40},end:{line:7,column:56}}}):a)+'" />\n        </div>\n'},compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]},r="<fieldset>\n    <legend>"+e.escapeExpression((l(n,"t")||t&&l(t,"t")||s).call(a,"Parameters",{name:"t",hash:{},data:o,loc:{start:{line:2,column:12},end:{line:2,column:30}}}))+'</legend>\n    <div class="parameterList">\n',c=null!=(c=l(n,"Parameters")||(null!=t?l(t,"Parameters"):t))?c:s,s={name:"Parameters",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:4,column:8},end:{line:9,column:23}}},o="function"==typeof c?c.call(a,s):c;return null!=(o=l(n,"Parameters")?o:e.hooks.blockHelperMissing.call(t,o,s))&&(r+=o),r+"    </div>\n</fieldset>\n"},useData:!0}),A.BreadcrumbsWrapper=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){return""},useData:!0}),A.BulkColumnEditorDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){return'<div class="pnlInfo">\n</div>\n\n\n<div class="pnlLeft">\n    <ul class="lstColumns">\n    </ul>    \n</div>\n\n\n\n<div class="properties-panel">\n    <div class="pnlPropertyEditor"></div>\n</div>'},useData:!0}),A.CleanUpDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){return'<div class="tree"></div>'},useData:!0}),A.ColorPickerDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<ul>\n    <li><a href="#colorPickerSolid">Solid</a></li>\n    <li><a href="#colorPickerGradient">Gradient</a></li>\n\n</ul>\n<div id="colorPickerSolid">\n    <div class="solid_color"></div>\n</div>\n<div id="colorPickerGradient">\n    <table>\n        <tr>\n            <td style="width: 185px;">'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"Type",{name:"t",hash:{},data:o,loc:{start:{line:12,column:38},end:{line:12,column:50}}}))+'</td>\n            <td>\n                <select class="colorPickerType">\n                    <option>'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"linear",{name:"t",hash:{},data:o,loc:{start:{line:15,column:28},end:{line:15,column:42}}}))+"</option>\n                    <option>"+l((e(n,"t")||t&&e(t,"t")||s).call(a,"radial",{name:"t",hash:{},data:o,loc:{start:{line:16,column:28},end:{line:16,column:42}}}))+'</option>\n                </select>\n            </td>\n            <td>\n                <select class="colorPickerDirection">\n                    <option>'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"left",{name:"t",hash:{},data:o,loc:{start:{line:21,column:28},end:{line:21,column:40}}}))+"</option>\n                    <option>"+l((e(n,"t")||t&&e(t,"t")||s).call(a,"right",{name:"t",hash:{},data:o,loc:{start:{line:22,column:28},end:{line:22,column:41}}}))+"</option>\n                    <option>"+l((e(n,"t")||t&&e(t,"t")||s).call(a,"top",{name:"t",hash:{},data:o,loc:{start:{line:23,column:28},end:{line:23,column:39}}}))+"</option>\n                    <option>"+l((e(n,"t")||t&&e(t,"t")||s).call(a,"bottom",{name:"t",hash:{},data:o,loc:{start:{line:24,column:28},end:{line:24,column:42}}}))+"</option>\n                    <option>"+l((e(n,"t")||t&&e(t,"t")||s).call(a,"45deg",{name:"t",hash:{},data:o,loc:{start:{line:25,column:28},end:{line:25,column:41}}}))+'</option>\n                </select>\n            </td>\n        </tr>\n        <tr>\n            <td></td>\n            <td colspan="3">\n                <div class="grad_ex" id="ex1"></div>\n            </td>\n        </tr>\n        \x3c!--<tr><td>'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"Selected Css",{name:"t",hash:{},data:o,loc:{start:{line:35,column:20},end:{line:35,column:40}}}))+'</td><td><input id="cssGradient" class="cssGradient" type="text" placeholder="css" readonly></td></tr>--\x3e\n        <tr>\n            <td>'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"Preview",{name:"t",hash:{},data:o,loc:{start:{line:37,column:16},end:{line:37,column:31}}}))+'</td>\n            <td colspan="3">\n                <div class="left"></div>\n            </td>\n        </tr>\n\n    </table>\n\n</div>\n'},useData:!0}),A.ColumnsDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="addNewColumn">'+e.escapeExpression((a(n,"t")||t&&a(t,"t")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},"Add Column",{name:"t",hash:{},data:o,loc:{start:{line:1,column:26},end:{line:1,column:44}}}))+"</div>"},useData:!0}),A.ComponentDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="thumb">\n    <img src="'+e.escapeExpression("function"==typeof(n=null!=(n=a(n,"listViewThumb")||(null!=t?a(t,"listViewThumb"):t))?n:e.hooks.helperMissing)?n.call(null!=t?t:e.nullContext||{},{name:"listViewThumb",hash:{},data:o,loc:{start:{line:2,column:14},end:{line:2,column:31}}}):n)+'" />\n    <div class="file-btn-wrapper">\n        <input class="file-input" type="file" />\n    </div>\n    <button class="upload-btn">\n        Upload Icon\n    </button>\n</div>\n<div class="form"></div>'},useData:!0}),A.ComponentListView=Handlebars.template({1:function(e,t,n,i,o){return'        <span class="ui-widget-content">'+e.escapeExpression(e.lambda(t,t))+"</span>\n"},compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a,s,l=null!=t?t:e.nullContext||{},r=e.hooks.helperMissing,c="function",d=e.escapeExpression,u=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="icon">'+(null!=(a=typeof(s=null!=(s=u(n,"listViewThumb")||(null!=t?u(t,"listViewThumb"):t))?s:r)==c?s.call(l,{name:"listViewThumb",hash:{},data:o,loc:{start:{line:1,column:18},end:{line:1,column:37}}}):s)?a:"")+'</div>\n<div class="name">'+d(typeof(s=null!=(s=u(n,"componentName")||(null!=t?u(t,"componentName"):t))?s:r)==c?s.call(l,{name:"componentName",hash:{},data:o,loc:{start:{line:2,column:18},end:{line:2,column:35}}}):s)+'</div>\n<div class="description">'+d((u(n,"t")||t&&u(t,"t")||r).call(l,null!=t?u(t,"componentDescription"):t,{name:"t",hash:{},data:o,loc:{start:{line:3,column:25},end:{line:3,column:51}}}))+'</div>\n<div class="tags">\n'+(null!=(a=u(n,"each").call(l,null!=t?u(t,"tags"):t,{name:"each",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:5,column:4},end:{line:7,column:13}}}))?a:"")+"</div>"},useData:!0}),A.ComponentsPanel=Handlebars.template({1:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <a class="add" title="'+e.escapeExpression((a(n,"t")||t&&a(t,"t")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},"Add a new Widget",{name:"t",hash:{},data:o,loc:{start:{line:12,column:26},end:{line:12,column:50}}}))+'"><i class="fa fa-plus fa-fw"></i></a>\n'},compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="panel-header">\n    <div class="pin-button">\n        <i class="fa fa-caret-right"></i><i class="fa fa-caret-right"></i>\n    </div>\n    <div class="search-box">  \n        <input type="text" placeholder="search components..."/>\n        <div class="fa fa-fw fa-search" />\n        <div class="fa fa-times">\n        </div>\n    </div>\n'+(null!=(n=a(n,"unless").call(null!=t?t:e.nullContext||{},null!=t?a(t,"isLite"):t,{name:"unless",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:11,column:4},end:{line:13,column:15}}}))?n:"")+'</div>\n\n<div class="components-list">\n</div>\n<div class="scroll-up">\n    <i class="fa fa-fw fa-caret-up"></i>\n</div>\n<div class="scroll-down">\n    <i class="fa fa-fw fa-caret-down"></i>\n</div>\n'},useData:!0}),A.ConnectionManagement=Handlebars.template({1:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\t\t\t\t\t\t<option value="q">'+e.escapeExpression((a(n,"t")||t&&a(t,"t")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},"kdb",{name:"t",hash:{},data:o,loc:{start:{line:27,column:24},end:{line:27,column:35}}}))+"</option>\n"},3:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\t\t\t\t\t\t<option value="q">'+e.escapeExpression((a(n,"t")||t&&a(t,"t")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},"kdb",{name:"t",hash:{},data:o,loc:{start:{line:29,column:24},end:{line:29,column:35}}}))+'</option>\n\t\t\t\t\t\t<option value="jdbc:com.mysql.jdbc.Driver">mysql</option>\n\t\t\t\t\t\t<option value="jdbc:oracle.jdbc.OracleDriver">oracle</option>\n\t\t\t\t\t\t<option value="jdbc:com.microsoft.sqlserver.jdbc.SQLServerDriver">mssql</option>\n\t\t\t\t\t\t<option value="daemon">daemon</option>\n'},compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="connectionsTabs" tabindex="0">\n\t<ul>\n\t\t<li><a href="#'+c(typeof(a=null!=(a=d(n,"singleConnectionsId")||(null!=t?d(t,"singleConnectionsId"):t))?a:l)==r?a.call(s,{name:"singleConnectionsId",hash:{},data:o,loc:{start:{line:3,column:16},end:{line:3,column:39}}}):a)+'">Individual</a></li>\n\t\t<li><a href="#'+c(typeof(a=null!=(a=d(n,"groupConnectionsId")||(null!=t?d(t,"groupConnectionsId"):t))?a:l)==r?a.call(s,{name:"groupConnectionsId",hash:{},data:o,loc:{start:{line:4,column:16},end:{line:4,column:38}}}):a)+'">Groups</a></li>\n\t\t<li><a href="#'+c(typeof(a=null!=(a=d(n,"serivcesTabId")||(null!=t?d(t,"serivcesTabId"):t))?a:l)==r?a.call(s,{name:"serivcesTabId",hash:{},data:o,loc:{start:{line:5,column:16},end:{line:5,column:33}}}):a)+'">Services</a></li>\n\t</ul>\n\t<div id="'+c(typeof(a=null!=(a=d(n,"singleConnectionsId")||(null!=t?d(t,"singleConnectionsId"):t))?a:l)==r?a.call(s,{name:"singleConnectionsId",hash:{},data:o,loc:{start:{line:7,column:10},end:{line:7,column:33}}}):a)+'">\n\t\t<div class="connectionsList singleConnectionsList">\n\t\t\t\x3c!--<div class="row">\n\t\t\t\t<div class="newConnectionButton btn">'+c((d(n,"t")||t&&d(t,"t")||l).call(s,"New Connection",{name:"t",hash:{},data:o,loc:{start:{line:10,column:41},end:{line:10,column:63}}}))+'</div>\n\t\t\t</div>\n\t\t\t<input class="filterBox singleFilter" placeholder="type to filter"/>\n\t\t\t<i class="fa fa-search filterIcon"></i>--\x3e\n\t\t\t<div class="singleConnectionsListGrid"></div>\n\t\t\t\x3c!--<ul></ul>--\x3e\n\t\t</div>\n\t\t<div class="connectionDetailsPanel">\n\t\t\t<div class="title"></div>\n\t\t\t<div class="row">\n\t\t\t\t<label>'+c((d(n,"t")||t&&d(t,"t")||l).call(s,"Name:",{name:"t",hash:{},data:o,loc:{start:{line:20,column:11},end:{line:20,column:24}}}))+'</label>\n\t\t\t\t<input class="name" type="text" value="" />\n\t\t\t</div>\n\t\t\t<div class="row">\n\t\t\t\t<label>'+c((d(n,"t")||t&&d(t,"t")||l).call(s,"Type:",{name:"t",hash:{},data:o,loc:{start:{line:24,column:11},end:{line:24,column:24}}}))+'</label>\n\t\t\t\t<select class="type" disabled>\n'+(null!=(e=d(n,"if").call(s,null!=t?d(t,"isLite"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.program(3,o,0),data:o,loc:{start:{line:26,column:5},end:{line:34,column:12}}}))?e:"")+'\t\t\t\t</select>\n\t\t\t</div>\n\t\t\t<div class="row">\n\t\t\t\t<label>'+c((d(n,"t")||t&&d(t,"t")||l).call(s,"Host:",{name:"t",hash:{},data:o,loc:{start:{line:38,column:11},end:{line:38,column:24}}}))+'</label>\n\t\t\t\t<input class="host" type="text" value=""/>\n\t\t\t</div>\n\t\t\t<div class="row">\n\t\t\t\t<label>'+c((d(n,"t")||t&&d(t,"t")||l).call(s,"Port:",{name:"t",hash:{},data:o,loc:{start:{line:42,column:11},end:{line:42,column:24}}}))+'</label>\n\t\t\t\t<input class="port" type="text" value="" />\n\t\t\t</div>\n\t\t\t<div class="row databaseRow" style="display: none">\n\t\t\t\t<label>'+c((d(n,"t")||t&&d(t,"t")||l).call(s,"Database:",{name:"t",hash:{},data:o,loc:{start:{line:46,column:11},end:{line:46,column:28}}}))+'</label>\n\t\t\t\t<input class="database" type="text" value="" />\n\t\t\t</div>\n\t\t\t<div class="row integratedSecurityRow" style="display: none;">\n\t\t\t\t<label>'+c((d(n,"t")||t&&d(t,"t")||l).call(s,"Integrated Security:",{name:"t",hash:{},data:o,loc:{start:{line:50,column:11},end:{line:50,column:39}}}))+'</label>\n\t\t\t\t<input class="integratedSecurity" type="checkbox" value="" style="width: auto; margin-top: 5px;" />\n\t\t\t</div>\n\t\t\t<div class="row">\n\t\t\t\t<label>'+c((d(n,"t")||t&&d(t,"t")||l).call(s,"User:",{name:"t",hash:{},data:o,loc:{start:{line:54,column:11},end:{line:54,column:24}}}))+'</label>\n\t\t\t\t<input class="user" type="text" value="" />\n\t\t\t</div>\n\t\t\t<div class="row">\n\t\t\t\t<label>'+c((d(n,"t")||t&&d(t,"t")||l).call(s,"Password:",{name:"t",hash:{},data:o,loc:{start:{line:58,column:11},end:{line:58,column:28}}}))+'</label>\n\t\t\t\t<input class="password" type="password" value="" />\n\t\t\t</div>\n\t\t\t<div class="row">\n\t\t\t\t<label>'+c((d(n,"t")||t&&d(t,"t")||l).call(s,"Confirm Password:",{name:"t",hash:{},data:o,loc:{start:{line:62,column:11},end:{line:62,column:36}}}))+'</label>\n\t\t\t\t<input class="confirmPassword" type="password" value="" />\n\t\t\t</div>\n\t\t\t<div class="row">\n\t\t\t\t<label>'+c((d(n,"t")||t&&d(t,"t")||l).call(s,"TLS:",{name:"t",hash:{},data:o,loc:{start:{line:66,column:11},end:{line:66,column:23}}}))+'</label>\n\t\t\t\t<input class="tls" type="checkbox" value="" />\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div id="'+c(typeof(a=null!=(a=d(n,"groupConnectionsId")||(null!=t?d(t,"groupConnectionsId"):t))?a:l)==r?a.call(s,{name:"groupConnectionsId",hash:{},data:o,loc:{start:{line:71,column:10},end:{line:71,column:32}}}):a)+'">\n\t\t<div class="connectionsList groupConnectionsList">\n\t\t\t\x3c!--<input class="filterBox groupFilter" placeholder="type to filter"/>\n\t\t\t<i class="fa fa-search filterIcon"></i>--\x3e\n\t\t\t<div class="groupConnectionListGrid"></div>\n\t\t\t\x3c!--<ul></ul>\n\t\t\t<div class="row">\n\t\t\t\t<div class="newGroupButton btn">'+c((d(n,"t")||t&&d(t,"t")||l).call(s,"New Group",{name:"t",hash:{},data:o,loc:{start:{line:78,column:36},end:{line:78,column:53}}}))+'</div>\n\t\t\t</div>\n\t\t\t--\x3e\n\t\t</div>\n\t\t<div class="groupDetailsPanel">\n\t\t\t<div class="title"></div>\n\t\t\t<div class="row">\n\t\t\t\t<label>'+c((d(n,"t")||t&&d(t,"t")||l).call(s,"Group Name:",{name:"t",hash:{},data:o,loc:{start:{line:85,column:11},end:{line:85,column:30}}}))+'</label>\n\t\t\t\t<input class="groupName" type="text" value="" disabled/>\n\t\t\t</div>\n\t\t\t<div class="row">\n\t\t\t\t<label>'+c((d(n,"t")||t&&d(t,"t")||l).call(s,"Group Type:",{name:"t",hash:{},data:o,loc:{start:{line:89,column:11},end:{line:89,column:30}}}))+'</label>\n\t\t\t\t<select class="groupType">\n\t\t\t\t\t<option value="DEFAULT">'+c((d(n,"t")||t&&d(t,"t")||l).call(s,"Default",{name:"t",hash:{},data:o,loc:{start:{line:91,column:29},end:{line:91,column:44}}}))+'</option>\n\t\t\t\t\t<option value="LEADER_CLUSTER">'+c((d(n,"t")||t&&d(t,"t")||l).call(s,"Leader",{name:"t",hash:{},data:o,loc:{start:{line:92,column:36},end:{line:92,column:50}}}))+'</option>\n\t\t\t\t\t<option value="COMBINED">'+c((d(n,"t")||t&&d(t,"t")||l).call(s,"Combined",{name:"t",hash:{},data:o,loc:{start:{line:93,column:30},end:{line:93,column:46}}}))+'</option>\n\t\t\t\t\t<option value="ROUND_ROBIN">'+c((d(n,"t")||t&&d(t,"t")||l).call(s,"Round Robin",{name:"t",hash:{},data:o,loc:{start:{line:94,column:33},end:{line:94,column:52}}}))+'</option>\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t\t<div class="multipleSelect">\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div id='+c(typeof(a=null!=(a=d(n,"serivcesTabId")||(null!=t?d(t,"serivcesTabId"):t))?a:l)==r?a.call(s,{name:"serivcesTabId",hash:{},data:o,loc:{start:{line:101,column:9},end:{line:101,column:26}}}):a)+'>\n\t\t<div class="connectionsList servisesList">\n\t\t\t<div class="servicesListGrid"></div>\n\t\t</div>\n</div>\n\n<div class="statusBar"></div>'},useData:!0}),A.ContentPanel=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){return'<div class="content-panel">\n\n    <div class="panel-header">\n\n    </div>\n\n    <div class="document-view-div">\n\n    </div>\n\n</div>\n'},useData:!0}),A.CssDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){return'<div class="query-editor" spellcheck="false"></div>'},useData:!0}),A.DashboardListView=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="tile-content">\n    <span class="dash-name">\n        '+c(typeof(a=null!=(a=e(n,"name")||(null!=t?e(t,"name"):t))?a:l)==r?a.call(s,{name:"name",hash:{},data:o,loc:{start:{line:3,column:8},end:{line:3,column:16}}}):a)+'\n    </span>\n\n    <span class="name-error-info"></span>\n    \n\t<span class="right-side-span">\n\t\t<i class="dash-wip-icon fa'+c(typeof(a=null!=(a=e(n,"draftStateIcon")||(null!=t?e(t,"draftStateIcon"):t))?a:l)==r?a.call(s,{name:"draftStateIcon",hash:{},data:o,loc:{start:{line:9,column:28},end:{line:9,column:46}}}):a)+'" style="margin-right: 7px; cursor: pointer;" title="'+c(typeof(a=null!=(a=e(n,"title")||(null!=t?e(t,"title"):t))?a:l)==r?a.call(s,{name:"title",hash:{},data:o,loc:{start:{line:9,column:99},end:{line:9,column:108}}}):a)+'"></i>\n\t\t<i class="fa fa-home" style="margin-right: 7px; cursor: pointer;" title="Select as default dashboard for all users"></i>\n\t\t<i class="fa fa-star" style="margin-right: 7px; cursor: pointer;"></i>\n\t\t<i class="fa fa-star-o" style="margin-right: 7px; cursor: pointer;"></i>\n\t\t<span class="dash-date">\n\t\t\t'+c(typeof(a=null!=(a=e(n,"documentLocalDate")||(null!=t?e(t,"documentLocalDate"):t))?a:l)==r?a.call(s,{name:"documentLocalDate",hash:{},data:o,loc:{start:{line:14,column:3},end:{line:14,column:24}}}):a)+"\n\t\t</span>\n\t</span>\n</div>"},useData:!0}),A.DashboardNamePrompt=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div style="display: table; width: 100%; height: 100%; max-height: 100%; overflow: hidden;">\n    <div style="display: table-cell; width: 100%; height: 100%; max-height: 100%; vertical-align: middle; text-align: center;">\n        <span style="margin-right: 3px;">\n            Name:\n        </span>\n        <input class="name-input" value="'+e.escapeExpression("function"==typeof(n=null!=(n=a(n,"name")||(null!=t?a(t,"name"):t))?n:e.hooks.helperMissing)?n.call(null!=t?t:e.nullContext||{},{name:"name",hash:{},data:o,loc:{start:{line:6,column:41},end:{line:6,column:49}}}):n)+'" />\n        <span class="wip-icon">\n            <input type="checkbox" id="work-in-progress" class="work-in-progress"/>\n            <label for="work-in-progress"></label>\n        </span>\n        <div class = "wip-tooltip"></div>\n        <div class="dash-exist-info">\n            Dashboard with this name already exists.\n        </div>\n    </div>\n\n</div>\n'},useData:!0}),A.DashboardPermission=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<td class="permissionName" title="'+c(typeof(a=null!=(a=e(n,"name")||(null!=t?e(t,"name"):t))?a:l)==r?a.call(s,{name:"name",hash:{},data:o,loc:{start:{line:1,column:34},end:{line:1,column:42}}}):a)+'" colspan="3">'+c(typeof(a=null!=(a=e(n,"name")||(null!=t?e(t,"name"):t))?a:l)==r?a.call(s,{name:"name",hash:{},data:o,loc:{start:{line:1,column:56},end:{line:1,column:64}}}):a)+'</td>\n<td class="permissionRead" style="text-align: center;">\n\t<input type="checkbox" />\n</td>\n<td class="permissionWrite" style="text-align: center;">\n\t<input type="checkbox" />\n</td>'},useData:!0}),A.DashboardPermissions=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="permissions-panel" style="padding:10px;">\n\t\t<table>\n\t\t\t<thead>\n\t\t\t\t<tr><th  colspan="3">'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"User Group",{name:"t",hash:{},data:o,loc:{start:{line:4,column:25},end:{line:4,column:43}}}))+'</th><th class="permissionRead">'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"Read Access",{name:"t",hash:{},data:o,loc:{start:{line:4,column:75},end:{line:4,column:94}}}))+"</th><th permissionWrite>"+l((e(n,"t")||t&&e(t,"t")||s).call(a,"Write Access",{name:"t",hash:{},data:o,loc:{start:{line:4,column:119},end:{line:4,column:139}}}))+"</th></tr>\n\t\t\t</thead>\n\t\t\t<tbody></tbody>\n\t\t</table>\n</div>"},useData:!0}),A.DashboardStyles=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r=e.escapeExpression,c="function",e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<table>\n    <tr>\n        <td>\n            <span>"+r((e(n,"t")||t&&e(t,"t")||l).call(s,"Dashboard Theme",{name:"t",hash:{},data:o,loc:{start:{line:4,column:18},end:{line:4,column:41}}}))+'</span>\n        </td>\n        <td>\n            <select class="dashboardTheme">\n                <option>'+r((e(n,"t")||t&&e(t,"t")||l).call(s,"Dark",{name:"t",hash:{},data:o,loc:{start:{line:8,column:24},end:{line:8,column:36}}}))+"</option>\n                <option>"+r((e(n,"t")||t&&e(t,"t")||l).call(s,"Light",{name:"t",hash:{},data:o,loc:{start:{line:9,column:24},end:{line:9,column:37}}}))+"</option>\n            </select>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <span>"+r((e(n,"t")||t&&e(t,"t")||l).call(s,"Widgets Spacing",{name:"t",hash:{},data:o,loc:{start:{line:15,column:18},end:{line:15,column:41}}}))+'</span>\n        </td>\n        <td>\n            <input class="widgets-spacing" value="'+r(typeof(a=null!=(a=e(n,"widgetsSpacing")||(null!=t?e(t,"widgetsSpacing"):t))?a:l)==c?a.call(s,{name:"widgetsSpacing",hash:{},data:o,loc:{start:{line:18,column:50},end:{line:18,column:68}}}):a)+'" />\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <span>'+r((e(n,"t")||t&&e(t,"t")||l).call(s,"Border Color",{name:"t",hash:{},data:o,loc:{start:{line:23,column:18},end:{line:23,column:38}}}))+'</span>\n        </td>\n        <td>\n            <input class="border-color" value="'+r(typeof(a=null!=(a=e(n,"borderColor")||(null!=t?e(t,"borderColor"):t))?a:l)==c?a.call(s,{name:"borderColor",hash:{},data:o,loc:{start:{line:26,column:47},end:{line:26,column:62}}}):a)+'" />\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <span>'+r((e(n,"t")||t&&e(t,"t")||l).call(s,"Border Background",{name:"t",hash:{},data:o,loc:{start:{line:31,column:18},end:{line:31,column:43}}}))+'</span>\n        </td>\n        <td>\n            <input class="border-background" value="'+r(typeof(a=null!=(a=e(n,"borderBackground")||(null!=t?e(t,"borderBackground"):t))?a:l)==c?a.call(s,{name:"borderBackground",hash:{},data:o,loc:{start:{line:34,column:52},end:{line:34,column:72}}}):a)+'" />\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <span>'+r((e(n,"t")||t&&e(t,"t")||l).call(s,"Transparent Background",{name:"t",hash:{},data:o,loc:{start:{line:39,column:18},end:{line:39,column:48}}}))+'</span>\n        </td>\n        <td>\n            <input type="checkbox" class="border-background-transparent" checked="'+r(typeof(a=null!=(a=e(n,"transparentBackground")||(null!=t?e(t,"transparentBackground"):t))?a:l)==c?a.call(s,{name:"transparentBackground",hash:{},data:o,loc:{start:{line:42,column:82},end:{line:42,column:107}}}):a)+'" />\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <span>'+r((e(n,"t")||t&&e(t,"t")||l).call(s,"Border Width",{name:"t",hash:{},data:o,loc:{start:{line:47,column:18},end:{line:47,column:38}}}))+'</span>\n        </td>\n        <td>\n            <input class="border-width" value="'+r(typeof(a=null!=(a=e(n,"borderWidth")||(null!=t?e(t,"borderWidth"):t))?a:l)==c?a.call(s,{name:"borderWidth",hash:{},data:o,loc:{start:{line:50,column:47},end:{line:50,column:62}}}):a)+'" />\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <span>'+r((e(n,"t")||t&&e(t,"t")||l).call(s,"Border Rounding",{name:"t",hash:{},data:o,loc:{start:{line:55,column:18},end:{line:55,column:41}}}))+'</span>\n        </td>\n        <td>\n            <input class="border-rounding" value="'+r(typeof(a=null!=(a=e(n,"borderRounding")||(null!=t?e(t,"borderRounding"):t))?a:l)==c?a.call(s,{name:"borderRounding",hash:{},data:o,loc:{start:{line:58,column:50},end:{line:58,column:68}}}):a)+'" />\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <span>'+r((e(n,"t")||t&&e(t,"t")||l).call(s,"Border Spacing",{name:"t",hash:{},data:o,loc:{start:{line:63,column:18},end:{line:63,column:40}}}))+'</span>\n        </td>\n        <td>\n            <input class="border-spacing" value="'+r(typeof(a=null!=(a=e(n,"borderSpacing")||(null!=t?e(t,"borderSpacing"):t))?a:l)==c?a.call(s,{name:"borderSpacing",hash:{},data:o,loc:{start:{line:66,column:49},end:{line:66,column:66}}}):a)+'" />\n        </td>\n    </tr>\n    <tr>\n    <td>\n            <span>'+r((e(n,"t")||t&&e(t,"t")||l).call(s,"Worksheet Padding",{name:"t",hash:{},data:o,loc:{start:{line:71,column:18},end:{line:71,column:43}}}))+'</span>\n        </td>\n        <td>\n            <input class="worksheet-padding" value="'+r(typeof(a=null!=(a=e(n,"worksheetPadding")||(null!=t?e(t,"worksheetPadding"):t))?a:l)==c?a.call(s,{name:"worksheetPadding",hash:{},data:o,loc:{start:{line:74,column:52},end:{line:74,column:72}}}):a)+'" />\n        </td>\n    </tr>\n</table>'},useData:!0}),A.DataConfigAggregateRow=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<input class="aggregateFnItm" value="'+c(typeof(a=null!=(a=e(n,"aggFn")||(null!=t?e(t,"aggFn"):t))?a:l)==r?a.call(s,{name:"aggFn",hash:{},data:o,loc:{start:{line:1,column:37},end:{line:1,column:46}}}):a)+'" placeholder="Function"/>\n<input class="aggregateColItm" value="'+c(typeof(a=null!=(a=e(n,"aggCol")||(null!=t?e(t,"aggCol"):t))?a:l)==r?a.call(s,{name:"aggCol",hash:{},data:o,loc:{start:{line:2,column:38},end:{line:2,column:48}}}):a)+'" placeholder="Column"/>\n<input class="aggregateLabelItm" value="'+c(typeof(a=null!=(a=e(n,"aggLabel")||(null!=t?e(t,"aggLabel"):t))?a:l)==r?a.call(s,{name:"aggLabel",hash:{},data:o,loc:{start:{line:3,column:40},end:{line:3,column:52}}}):a)+'" placeholder="Label" />\n<div class="deleteRow"></div>\n<div class="moveRow rowIcon fa fa-bars"></div>'},useData:!0}),A.DataConfigAnalytic=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){return'<div class="pnlAnalyticsGridWrapper">\n    <div class=\'search\'>\n        <i class=\'fa fa-search\'></i>\n        <input type=\'text\' class=\'searchBox\' />\n        <span class="clearSearch fa fa-times" style="display: none"></span>\n    </div>\n    <div class="pnlAnalyticsTree"></div>\n</div>\n\n<div class="propertiesPanel paramsView"></div>\n\n<div class="subscription-select"></div>\n     '},useData:!0}),A.DataConfigForm=Handlebars.template({1:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                <label class="sql-editor_label">\n                    <input type="radio" name="_dataType" class="sql" value="sql" checked />'+e.escapeExpression((a(n,"t")||t&&a(t,"t")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},"SQL",{name:"t",hash:{},data:o,loc:{start:{line:20,column:91},end:{line:20,column:102}}}))+"\n                </label>\n"},3:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                <label class="sql-editor_label hidden">\n                    <input type="radio" name="_dataType" class="sql" value="sql" checked />'+e.escapeExpression((a(n,"t")||t&&a(t,"t")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},"SQL",{name:"t",hash:{},data:o,loc:{start:{line:24,column:91},end:{line:24,column:102}}}))+"\n                </label>\n"},5:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                <label>\n                    <input type="radio" name="_dataType" class="builder" value="builder" />'+e.escapeExpression((a(n,"t")||t&&a(t,"t")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},"Builder",{name:"t",hash:{},data:o,loc:{start:{line:32,column:91},end:{line:32,column:106}}}))+"\n                </label>\n"},compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r=e.escapeExpression,c="function",d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="toolbar ui-widget-header ui-corner-all">\n\n    <button class="newConnectionGroup">'+r((d(n,"t")||t&&d(t,"t")||l).call(s,"Connection Management",{name:"t",hash:{},data:o,loc:{start:{line:3,column:39},end:{line:3,column:68}}}))+'</button>\n\n    <div class="connection-select">\n        <select style="width: 192px;"></select>\n    </div>\n\n    <button id="datasource-execute-query" class="run-btn"\n        title="'+r((d(n,"t")||t&&d(t,"t")||l).call(s,"Execute (Ctrl + Enter)",{name:"t",hash:{},data:o,loc:{start:{line:10,column:15},end:{line:10,column:45}}}))+'">'+r((d(n,"t")||t&&d(t,"t")||l).call(s,"Execute",{name:"t",hash:{},data:o,loc:{start:{line:10,column:47},end:{line:10,column:62}}}))+'</button>\n    <button class="add-parameter-btn" title="'+r((d(n,"t")||t&&d(t,"t")||l).call(s,"Add a parameter to query string",{name:"t",hash:{},data:o,loc:{start:{line:11,column:45},end:{line:11,column:84}}}))+'">'+r((d(n,"t")||t&&d(t,"t")||l).call(s,"Add Parameter",{name:"t",hash:{},data:o,loc:{start:{line:11,column:86},end:{line:11,column:107}}}))+'</button>\n</div>\n\n<div class="data-div">\n    <div class="function">\n        <fieldset>\n            <span>\n'+(null!=(a=d(n,"if").call(s,null!=t?d(t,"sql_editor"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.program(3,o,0),data:o,loc:{start:{line:18,column:16},end:{line:26,column:23}}}))?a:"")+'                <label>\n                    <input type="radio" name="_dataType" class="query" value="query"  />'+r((d(n,"t")||t&&d(t,"t")||l).call(s,"kdb+/q",{name:"t",hash:{},data:o,loc:{start:{line:28,column:88},end:{line:28,column:102}}}))+"\n                </label>\n"+(null!=(a=d(n,"if").call(s,null!=t?d(t,"query_graph"):t,{name:"if",hash:{},fn:e.program(5,o,0),inverse:e.noop,data:o,loc:{start:{line:30,column:16},end:{line:34,column:23}}}))?a:"")+'                <label class="analyticFieldsetLabel">\n                    <input type="radio" name="_dataType" class="analytic" value="analytic" />'+r((d(n,"t")||t&&d(t,"t")||l).call(s,"Analytic",{name:"t",hash:{},data:o,loc:{start:{line:36,column:93},end:{line:36,column:109}}}))+'\n                </label>\n                <label>\n                    <input type="radio" name="_dataType" class="streaming" value="streaming" />'+r((d(n,"t")||t&&d(t,"t")||l).call(s,"Streaming",{name:"t",hash:{},data:o,loc:{start:{line:39,column:95},end:{line:39,column:112}}}))+'\n                </label>\n                <label>\n                    <input type="radio" name="_dataType" class="virtual" value="virtual" />'+r((d(n,"t")||t&&d(t,"t")||l).call(s,"Virtual",{name:"t",hash:{},data:o,loc:{start:{line:42,column:91},end:{line:42,column:106}}}))+'\n                </label>\n            </span>\n\n            <div class="legend-right">\n                <label class="pivot-label">\n                    <input class="pivot-checkbox" type="checkbox" />'+r((d(n,"t")||t&&d(t,"t")||l).call(s,"Pivot",{name:"t",hash:{},data:o,loc:{start:{line:48,column:68},end:{line:48,column:81}}}))+'\n                </label>\n                <label class="update-label">\n                    <input class="update-checkbox" type="checkbox" />'+r((d(n,"t")||t&&d(t,"t")||l).call(s,"Update",{name:"t",hash:{},data:o,loc:{start:{line:51,column:69},end:{line:51,column:83}}}))+'\n                </label>\n            </div>\n            <div class="analytic-form"></div>\n            <div class="streaming-form" style="display: none"></div>\n            <div class="builder-query-form" style="display: none"></div>\n            <div class="query-form" style="display: none"></div>\n            <div class="virtual-query-form" style="display: none"></div>\n            <div class="sql-query-form" style="display: none"></div>\n        </fieldset>\n    </div>\n    <div class="pivot">\n        <fieldset>\n            <legend>\n                <label>'+r((d(n,"t")||t&&d(t,"t")||l).call(s,"Pivot Query",{name:"t",hash:{},data:o,loc:{start:{line:65,column:23},end:{line:65,column:42}}}))+'</label>\n            </legend>\n            <div class="legend-right">\n                <label class="pivot-type-label-server">\n                    <input type="radio" name="_pivotType" class="server" value="server" checked />'+r((d(n,"t")||t&&d(t,"t")||l).call(s,"Server",{name:"t",hash:{},data:o,loc:{start:{line:69,column:98},end:{line:69,column:112}}}))+'\n                </label>\n                <label class="pivot-type-label-client">\n                    <input type="radio" name="_pivotType" class="client" value="client" />'+r((d(n,"t")||t&&d(t,"t")||l).call(s,"Client",{name:"t",hash:{},data:o,loc:{start:{line:72,column:90},end:{line:72,column:104}}}))+'\n                </label>\n            </div>\n            <div class="pivot-form"></div>\n        </fieldset>\n    </div>\n    <div class="update">\n        <fieldset>\n            <legend>\n                <label>'+r((d(n,"t")||t&&d(t,"t")||l).call(s,"Update",{name:"t",hash:{},data:o,loc:{start:{line:81,column:23},end:{line:81,column:37}}}))+'</label>\n            </legend>\n            <div class="legend-right">\n                <label class="pivot-type-label-query">\n                    <input type="radio" name="_updateType" class="query" value="query" checked />'+r((d(n,"t")||t&&d(t,"t")||l).call(s,"Query",{name:"t",hash:{},data:o,loc:{start:{line:85,column:97},end:{line:85,column:110}}}))+'\n                </label>\n                <label class="pivot-type-label-analytic">\n                    <input type="radio" name="_updateType" class="analytic" value="analytic" />'+r((d(n,"t")||t&&d(t,"t")||l).call(s,"Analytic",{name:"t",hash:{},data:o,loc:{start:{line:88,column:95},end:{line:88,column:111}}}))+'\n                </label>\n            </div>\n            <div class="update-form"></div>\n        </fieldset>\n    </div>\n    <div class="subscription">\n    </div>\n    <div class="results">\n        <div class="stacked-bar-graph"></div>\n        <fieldset class="results-div">\n            <legend>\n                <label>Results:</label>\n            </legend>\n\n            <div class="queryStatus ui-state-header">\n                <div class="statusPanel Error ui-state-error">\n                    <div class="statusTitle"><i class="fa fa-exclamation-triangle"></i><span>'+r((d(n,"t")||t&&d(t,"t")||l).call(s,"Error",{name:"t",hash:{},data:o,loc:{start:{line:105,column:93},end:{line:105,column:106}}}))+'</span></div>\n                    <span class="statusText"></span>\n                </div>\n                <div class="statusPanel Warning ui-state-warning">\n                    <div class="statusTitle"><i class="fa fa-exclamation-circle"></i><span>'+r((d(n,"t")||t&&d(t,"t")||l).call(s,"Warning",{name:"t",hash:{},data:o,loc:{start:{line:109,column:91},end:{line:109,column:106}}}))+'</span></div>\n                    <span class="statusText"></span>\n                </div>\n                <div class="statusPanel Info ui-state-highlight">\n                    <div class="statusTitle"><i class="fa fa-info-circle"></i><span>'+r((d(n,"t")||t&&d(t,"t")||l).call(s,"Info",{name:"t",hash:{},data:o,loc:{start:{line:113,column:84},end:{line:113,column:96}}}))+'</span></div>\n                    <span class="statusText"></span>\n                </div>\n                <div class="statusPanel Loading ui-state-highlight">\n                    <div class="statusTitle"><i class="fa fa-spinner fa-pulse"></i><span>'+r((d(n,"t")||t&&d(t,"t")||l).call(s,"Loading",{name:"t",hash:{},data:o,loc:{start:{line:117,column:89},end:{line:117,column:104}}}))+'</span></div>\n                    <span class="statusText"></span>\n                </div>\n                <div class="statusPanel NoResults ui-state-highlight">\n                    <div class="statusTitle"><i class="fa fa-info-circle"></i><span>'+r((d(n,"t")||t&&d(t,"t")||l).call(s,"No Results",{name:"t",hash:{},data:o,loc:{start:{line:121,column:84},end:{line:121,column:102}}}))+'</span></div>\n                    <span class="statusText"></span>\n                </div>\n            </div>\n\n            <div class="tabs">\n                <ul>\n                    <li><a href="#'+r(typeof(e=null!=(e=d(n,"tableId")||(null!=t?d(t,"tableId"):t))?e:l)==c?e.call(s,{name:"tableId",hash:{},data:o,loc:{start:{line:128,column:34},end:{line:128,column:45}}}):e)+'"><i class="fa fa-fw fa-table"></i>&nbsp;Results</a></li>\n                    <li><a href="#'+r(typeof(e=null!=(e=d(n,"mappingId")||(null!=t?d(t,"mappingId"):t))?e:l)==c?e.call(s,{name:"mappingId",hash:{},data:o,loc:{start:{line:129,column:34},end:{line:129,column:47}}}):e)+'"><i class="fa fa-fw fa-code-fork fa-rotate-90"></i>&nbsp;Mapping</a>\n                    </li>\n                    <li><a href="#'+r(typeof(e=null!=(e=d(n,"rawId")||(null!=t?d(t,"rawId"):t))?e:l)==c?e.call(s,{name:"rawId",hash:{},data:o,loc:{start:{line:131,column:34},end:{line:131,column:43}}}):e)+'"><i class="fa fa-fw fa-file-text-o"></i>&nbsp;Raw Output</a></li>\n                </ul>\n                <div id="'+r(typeof(e=null!=(e=d(n,"tableId")||(null!=t?d(t,"tableId"):t))?e:l)==c?e.call(s,{name:"tableId",hash:{},data:o,loc:{start:{line:133,column:25},end:{line:133,column:36}}}):e)+'" class="dataTableTab"></div>\n                <div id="'+r(typeof(e=null!=(e=d(n,"mappingId")||(null!=t?d(t,"mappingId"):t))?e:l)==c?e.call(s,{name:"mappingId",hash:{},data:o,loc:{start:{line:134,column:25},end:{line:134,column:38}}}):e)+'"></div>\n                <div id="'+r(typeof(e=null!=(e=d(n,"rawId")||(null!=t?d(t,"rawId"):t))?e:l)==c?e.call(s,{name:"rawId",hash:{},data:o,loc:{start:{line:135,column:25},end:{line:135,column:34}}}):e)+'"></div>\n            </div>\n    </div>\n\n\n    </fieldset>\n</div>\n</div>\n<div class="addParameterDialog" style="display: none;">\n    <span style="display: inline-block; width: 150px;">'+r((d(n,"t")||t&&d(t,"t")||l).call(s,"Parameter name",{name:"t",hash:{},data:o,loc:{start:{line:144,column:55},end:{line:144,column:77}}}))+'</span>\n    <input class="parameterName" type="text" style="display: inline-block; width: 200px;" />\n</div>'},useData:!0}),A.DataConfigForm_Perf=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="stacked-bar-graph-details">\n    <table class="tooltiptext">\n        <tr>\n            <td><i class="fa fa-square iconbar-1"></i></td>\n            <td>Dispatch:</td>\n            <td class="rightTextAlign">'+c(typeof(a=null!=(a=e(n,"subscriptionTime")||(null!=t?e(t,"subscriptionTime"):t))?a:l)==r?a.call(s,{name:"subscriptionTime",hash:{},data:o,loc:{start:{line:6,column:39},end:{line:6,column:59}}}):a)+' ms</td>\n            <td class="rightTextAlign"> '+c((e(n,"toFixed")||t&&e(t,"toFixed")||l).call(s,null!=t?e(t,"subscriptionPercent"):t,2,{name:"toFixed",hash:{},data:o,loc:{start:{line:7,column:40},end:{line:7,column:73}}}))+'%</td>\n        </tr>\n        <tr>\n            <td><i class="fa fa-square iconbar-2"></i></td>\n            <td>Server Duration:</td>\n            <td class="rightTextAlign">'+c(typeof(a=null!=(a=e(n,"executionTime")||(null!=t?e(t,"executionTime"):t))?a:l)==r?a.call(s,{name:"executionTime",hash:{},data:o,loc:{start:{line:12,column:39},end:{line:12,column:56}}}):a)+' ms</td>\n            <td class="rightTextAlign"> '+c((e(n,"toFixed")||t&&e(t,"toFixed")||l).call(s,null!=t?e(t,"executionPercent"):t,2,{name:"toFixed",hash:{},data:o,loc:{start:{line:13,column:40},end:{line:13,column:70}}}))+'%</td>\n        </tr>\n        <tr>\n            <td><i class="fa fa-square iconbar-3"></i></td>\n            <td>IPC & Deserialize:</td>\n            <td class="rightTextAlign">'+c(typeof(a=null!=(a=e(n,"dataModelTime")||(null!=t?e(t,"dataModelTime"):t))?a:l)==r?a.call(s,{name:"dataModelTime",hash:{},data:o,loc:{start:{line:18,column:39},end:{line:18,column:56}}}):a)+' ms</td>\n            <td class="rightTextAlign"> '+c((e(n,"toFixed")||t&&e(t,"toFixed")||l).call(s,null!=t?e(t,"dataModelPercent"):t,2,{name:"toFixed",hash:{},data:o,loc:{start:{line:19,column:40},end:{line:19,column:70}}}))+'%</td>\n        </tr>\n    </table> <span style="width:'+c(typeof(a=null!=(a=e(n,"subscriptionPercent")||(null!=t?e(t,"subscriptionPercent"):t))?a:l)==r?a.call(s,{name:"subscriptionPercent",hash:{},data:o,loc:{start:{line:21,column:32},end:{line:21,column:55}}}):a)+'%" class="bar-1"></span>\n    <span style="width:'+c(typeof(a=null!=(a=e(n,"executionPercent")||(null!=t?e(t,"executionPercent"):t))?a:l)==r?a.call(s,{name:"executionPercent",hash:{},data:o,loc:{start:{line:22,column:23},end:{line:22,column:43}}}):a)+'%" class="bar-2"></span>\n    <span style="width:'+c(typeof(a=null!=(a=e(n,"dataModelPercent")||(null!=t?e(t,"dataModelPercent"):t))?a:l)==r?a.call(s,{name:"dataModelPercent",hash:{},data:o,loc:{start:{line:23,column:23},end:{line:23,column:43}}}):a)+'%" class="bar-3"></span>\n</div>\n<div class="stacked-bar-graph-summary"> Roundtrip: '+c(typeof(a=null!=(a=e(n,"totalTime")||(null!=t?e(t,"totalTime"):t))?a:l)==r?a.call(s,{name:"totalTime",hash:{},data:o,loc:{start:{line:25,column:51},end:{line:25,column:64}}}):a)+" ms</div>"},useData:!0}),A.DataConfigMapping=Handlebars.template({1:function(e,t,n,i,o){return" single-value"},3:function(e,t,n,i,o){return'            <div class="value slick-header-column ui-state-default">Value</div>\n            <div class="view-state bbf-editor slick-header-column ui-state-default">View State</div>\n            <div class="remove"></div>\n'},5:function(e,t,n,i,o){return'            <div class="key slick-header-column ui-state-default">\n                <label>Key<select class="key-select"></select></label>\n            </div>\n            <div class="value slick-header-column ui-state-default">\n                <label>Value<select class="value-select"></select></label>\n            </div>\n            <div class="view-state bbf-editor slick-header-column ui-state-default">View State</div>\n            <div class="remove slick-header-column ui-state-default"></div>\n'},7:function(e,t,n,i,o){return" disabled"},compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="mapping-table Datagrid '+e.escapeExpression("function"==typeof(a=null!=(a=l(n,"theme")||(null!=t?l(t,"theme"):t))?a:e.hooks.helperMissing)?a.call(s,{name:"theme",hash:{},data:o,loc:{start:{line:1,column:35},end:{line:1,column:44}}}):a)+(null!=(a=l(n,"if").call(s,null!=t?l(t,"singleValue"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:1,column:44},end:{line:1,column:83}}}))?a:"")+'">\n    <div class="table-header">\n        <div class="row slick-header-columns ui-state-default">\n'+(null!=(a=l(n,"if").call(s,null!=t?l(t,"singleValue"):t,{name:"if",hash:{},fn:e.program(3,o,0),inverse:e.program(5,o,0),data:o,loc:{start:{line:4,column:12},end:{line:17,column:19}}}))?a:"")+'        </div>\n    </div>\n    <div class="table-body"></div>\n</div>\n<div class="toolbar">\n    <button class="reset-mapping" '+(null!=(a=l(n,"if").call(s,null!=t?l(t,"singleValue"):t,{name:"if",hash:{},fn:e.program(7,o,0),inverse:e.noop,data:o,loc:{start:{line:23,column:34},end:{line:23,column:69}}}))?a:"")+'>Reset</button>\n    <button class="add-mapping" '+(null!=(a=l(n,"if").call(s,null!=t?l(t,"singleValue"):t,{name:"if",hash:{},fn:e.program(7,o,0),inverse:e.noop,data:o,loc:{start:{line:24,column:32},end:{line:24,column:67}}}))?a:"")+">Add</button>\n</div>\n"},useData:!0}),A.DataConfigMappingItem=Handlebars.template({1:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="slick-cell value">'+e.escapeExpression("function"==typeof(n=null!=(n=a(n,"value")||(null!=t?a(t,"value"):t))?n:e.hooks.helperMissing)?n.call(null!=t?t:e.nullContext||{},{name:"value",hash:{},data:o,loc:{start:{line:2,column:30},end:{line:2,column:39}}}):n)+'</div>\n<div class="slick-cell view-state bbf-editor"></div>\n'},3:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="slick-cell key"><select class="key-select"></select></div>\n<div class="slick-cell value">'+e.escapeExpression("function"==typeof(n=null!=(n=a(n,"value")||(null!=t?a(t,"value"):t))?n:e.hooks.helperMissing)?n.call(null!=t?t:e.nullContext||{},{name:"value",hash:{},data:o,loc:{start:{line:6,column:30},end:{line:6,column:39}}}):n)+'</div>\n<div class="slick-cell view-state bbf-editor"></div>\n<div class="slick-cell remove"><button class="remove-mapping">Remove</button></div>\n'},compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(n=a(n,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"singleValue"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.program(3,o,0),data:o,loc:{start:{line:1,column:0},end:{line:9,column:7}}}))?n:""},useData:!0}),A.DataConfigPivot=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r=e.escapeExpression,c="function",e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="row tableNameRow">\n\t<label>'+r((e(n,"t")||t&&e(t,"t")||l).call(s,"Table name:",{name:"t",hash:{},data:o,loc:{start:{line:2,column:8},end:{line:2,column:27}}}))+'</label>\n\t<input class="_table" value="'+r(typeof(a=null!=(a=e(n,"_table")||(null!=t?e(t,"_table"):t))?a:l)==c?a.call(s,{name:"_table",hash:{},data:o,loc:{start:{line:3,column:30},end:{line:3,column:40}}}):a)+'" />\n\t<div class="_pivotQuery"><textarea>'+r(typeof(a=null!=(a=e(n,"_pivotQuery")||(null!=t?e(t,"_pivotQuery"):t))?a:l)==c?a.call(s,{name:"_pivotQuery",hash:{},data:o,loc:{start:{line:4,column:36},end:{line:4,column:51}}}):a)+'</textarea></div>\n\t<div id="'+r(typeof(a=null!=(a=e(n,"radioId")||(null!=t?e(t,"radioId"):t))?a:l)==c?a.call(s,{name:"radioId",hash:{},data:o,loc:{start:{line:5,column:10},end:{line:5,column:21}}}):a)+'" class="pivotSourceToggle">\n        <input type="radio" id="'+r(typeof(a=null!=(a=e(n,"radio1Id")||(null!=t?e(t,"radio1Id"):t))?a:l)==c?a.call(s,{name:"radio1Id",hash:{},data:o,loc:{start:{line:6,column:32},end:{line:6,column:44}}}):a)+'" name="'+r(typeof(a=null!=(a=e(n,"radioId")||(null!=t?e(t,"radioId"):t))?a:l)==c?a.call(s,{name:"radioId",hash:{},data:o,loc:{start:{line:6,column:52},end:{line:6,column:63}}}):a)+'" value="tableName" checked="checked"><label for="'+r(typeof(a=null!=(a=e(n,"radio1Id")||(null!=t?e(t,"radio1Id"):t))?a:l)==c?a.call(s,{name:"radio1Id",hash:{},data:o,loc:{start:{line:6,column:113},end:{line:6,column:125}}}):a)+'">Table name</label>\n        <input type="radio" id="'+r(typeof(a=null!=(a=e(n,"radio2Id")||(null!=t?e(t,"radio2Id"):t))?a:l)==c?a.call(s,{name:"radio2Id",hash:{},data:o,loc:{start:{line:7,column:32},end:{line:7,column:44}}}):a)+'" name="'+r(typeof(a=null!=(a=e(n,"radioId")||(null!=t?e(t,"radioId"):t))?a:l)==c?a.call(s,{name:"radioId",hash:{},data:o,loc:{start:{line:7,column:52},end:{line:7,column:63}}}):a)+'" value="pivotQuery"><label for="'+r(typeof(a=null!=(a=e(n,"radio2Id")||(null!=t?e(t,"radio2Id"):t))?a:l)==c?a.call(s,{name:"radio2Id",hash:{},data:o,loc:{start:{line:7,column:96},end:{line:7,column:108}}}):a)+'">Query string</label>\n    </div>\n</div>\n<div class="_breakdownCols row">\n    <label>'+r((e(n,"t")||t&&e(t,"t")||l).call(s,"Breakdown Cols:",{name:"t",hash:{},data:o,loc:{start:{line:11,column:11},end:{line:11,column:34}}}))+'</label>\n    <textarea></textarea>\n</div>\n<div class="_aggregateCols row">\n\t<label>'+r((e(n,"t")||t&&e(t,"t")||l).call(s,"Aggregate Cols:",{name:"t",hash:{},data:o,loc:{start:{line:15,column:8},end:{line:15,column:31}}}))+'</label>\n\t<textarea></textarea>\n</div>\n<div class="_aggregateFns row">\n\t<label>'+r((e(n,"t")||t&&e(t,"t")||l).call(s,"Aggregate Fns:",{name:"t",hash:{},data:o,loc:{start:{line:19,column:8},end:{line:19,column:30}}}))+'</label>\n\t<textarea></textarea>\n</div>\n<div class="subscription-select"></div>\n\x3c!--<div class="row">\n    <label>'+r((e(n,"t")||t&&e(t,"t")||l).call(s,"From Date:",{name:"t",hash:{},data:o,loc:{start:{line:24,column:11},end:{line:24,column:29}}}))+'</label>\n    <input class="_from" value="'+r(typeof(a=null!=(a=e(n,"_from")||(null!=t?e(t,"_from"):t))?a:l)==c?a.call(s,{name:"_from",hash:{},data:o,loc:{start:{line:25,column:32},end:{line:25,column:41}}}):a)+'" data-datadesc="from"/>\n</div>\n<div class="row">\n    <label>'+r((e(n,"t")||t&&e(t,"t")||l).call(s,"To Date:",{name:"t",hash:{},data:o,loc:{start:{line:28,column:11},end:{line:28,column:27}}}))+'</label>\n    <input class="_to" value="'+r(typeof(a=null!=(a=e(n,"_to")||(null!=t?e(t,"_to"):t))?a:l)==c?a.call(s,{name:"_to",hash:{},data:o,loc:{start:{line:29,column:30},end:{line:29,column:37}}}):a)+'" data-datadesc="to" />\n</div>\n<div class="errorDialog" style="display: none;">Please select either "From Date" or "To Date" to populate.</div>--\x3e\n'},useData:!0}),A.DataConfigQuery_Builder=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="graph-container">\n    <div class="graph-content">\n        <div class="accordion">\n            <div class="side-dialog" style="display:none;">\n                <div class="side-dialog-menu">\n                    <span class="menu-item menu-icon"></span>\n                    <span class="menu-item description"></span>\n                    <span class="menu-item close-button"><i class="fa fa-times"></i></span>\n                </div>\n                <div class="side-dialog-content"></div>\n                <div class="side-dialog-buttons">\n                    <span class="save-button">Save</span>\n                </div>\n            </div>\n            <div class="graph"></div>\n        </div>\n    </div>\n    <ul class=\'custom-menu\'></ul>\n\n    <div class="nodeErrorMessage" style="display:none">\n        <div class="errors-title"><i class="fa fa-exclamation-triangle"></i><span>'+e.escapeExpression((a(n,"t")||t&&a(t,"t")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},"Error:",{name:"t",hash:{},data:o,loc:{start:{line:21,column:82},end:{line:21,column:96}}}))+'</span></div>\n        <span class="errors-text"></span>\n    </div>\n\n    <div class="loading">\n        <div class="loadingInner">\n            <i class="fa fa-spinner fa-spin"></i>\n        </div>\n    </div>\n</div>'},useData:!0}),A.DataConfigQuery_Pivot=Handlebars.template({1:function(e,t,n,i,o){return"isViewState"},3:function(e,t,n,i,o){return"checked"},compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a,s,l=null!=t?t:e.nullContext||{},r=e.hooks.helperMissing,c=e.escapeExpression,d="function",u=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\n<div class="overlay"></div>\n<div class="_breakdownCols row"></div>\n<div class="_columnLabels row">\n    <label>'+c((u(n,"t")||t&&u(t,"t")||r).call(l,"Column Label:",{name:"t",hash:{},data:o,loc:{start:{line:5,column:11},end:{line:5,column:32}}}))+'</label>\n    <span class="columnLabelInputHolder">\n        \x3c!--<input type="text" class="_columnLabel"/>--\x3e\n        <input class="_columnLabel" type="text" />\n    </span>\n    \x3c!--<textarea></textarea>--\x3e\n</div>\n<div class="aggregateContainer '+(null!=(a=u(n,"if").call(l,null!=t?u(t,"hasAggregateViewState"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:12,column:31},end:{line:12,column:78}}}))?a:"")+'">\n    <div class="label">\n        Aggregates:<br />\n        <label for="'+c(typeof(s=null!=(s=u(n,"guid")||(null!=t?u(t,"guid"):t))?s:r)==d?s.call(l,{name:"guid",hash:{},data:o,loc:{start:{line:15,column:20},end:{line:15,column:28}}}):s)+'_viewStateCheckbox">'+c((u(n,"t")||t&&u(t,"t")||r).call(l,"Assign View State",{name:"t",hash:{},data:o,loc:{start:{line:15,column:48},end:{line:15,column:73}}}))+'</label>\n        <input id="'+c(typeof(s=null!=(s=u(n,"guid")||(null!=t?u(t,"guid"):t))?s:r)==d?s.call(l,{name:"guid",hash:{},data:o,loc:{start:{line:16,column:19},end:{line:16,column:27}}}):s)+'_viewStateCheckbox" type="checkbox" class="viewStateCheckbox" '+(null!=(a=u(n,"if").call(l,null!=t?u(t,"hasAggregateViewState"):t,{name:"if",hash:{},fn:e.program(3,o,0),inverse:e.noop,data:o,loc:{start:{line:16,column:89},end:{line:16,column:132}}}))?a:"")+' />\n        <span class="resetBtn">Reset</span>\n    </div>\n    <div>\n        <div class="aggregateList">\n            <ul style="list-style: none;"></ul>\n            <div class="pivotRow newAggregate">\n                <input class="aggregateFnItm new" placeholder="Function" />\n                <input class="aggregateColItm new" placeholder="Column" />\n                <input class="aggregateLabelItm new" placeholder="Label" />\n                <div class="addBtn">Add</div>\n            </div>\n        </div>\n        <div class="aggregateViewState"></div>\n    </div>\n</div>\n'},useData:!0}),A.DataConfigQuery_Query=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){return'<div class="query-editor">\n\n</div>\n<div class="params-box" spellcheck="false" resize="false"></div> '},useData:!0}),A.DataConfigQuery_SQL=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){return'<div class="query-editor"></div>\n<div class="params-box" spellcheck="false" resize="false"></div> '},useData:!0}),A.DataConfigQuery_Subscription=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){return'<div style="height: 100%;">\n<div class="subscription-select"></div>\n</div>'},useData:!0}),A.DataConfigQuery_Update=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="overlay"></div>\n<div class="update-editor"></div>\n<div class="update-analytic-picker">\n    <div class="picker"></div>\n    <div class="info">\n        <p>Update Analytic is Called with Three Parameters</p>\n        <ol>\n            <li>dgAdd {Dict} - Added Columns</li>\n            <li>dgUpd {Dict} - Updated Columns</li>\n            <li>dgDel {Dict} - Removed Columns</li>\n        </ol>\n    </div>\n</div>\n<a\n    class="fa fa-fw fa-info-circle"\n    title="'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"Example shows add, upd and del parameters are passed to the update query as dictionaries",{name:"t",hash:{},data:o,loc:{start:{line:16,column:11},end:{line:16,column:107}}}))+"&#13;"+l((e(n,"t")||t&&e(t,"t")||s).call(a,"Containing all column entries of any rows added, updated or deleted.",{name:"t",hash:{},data:o,loc:{start:{line:16,column:112},end:{line:16,column:188}}}))+'"\n/>\n<div class="update-params-box" spellcheck="false" resize="false"></div>\n'},useData:!0}),A.DataConfigQuery_Virtual=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){return'<div class="query-editor"></div>\n<div class="params-box" spellcheck="false" resize="false"></div> '},useData:!0}),A.DataDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){return'<div class="tree" />\n<div class="form" />\n'},useData:!0}),A.DataModelProperties=Handlebars.template({1:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"        <tr><td>"+c(typeof(a=null!=(a=e(n,"key")||(null!=t?e(t,"key"):t))?a:l)==r?a.call(s,{name:"key",hash:{},data:o,loc:{start:{line:4,column:16},end:{line:4,column:23}}}):a)+"</td><td>"+c(typeof(a=null!=(a=e(n,"val")||(null!=t?e(t,"val"):t))?a:l)==r?a.call(s,{name:"val",hash:{},data:o,loc:{start:{line:4,column:32},end:{line:4,column:39}}}):a)+"</td></tr>\n"},compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<form>\n    <table>\n"+(null!=(a=l(n,"each").call(s,t,{name:"each",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:3,column:8},end:{line:5,column:17}}}))?a:"")+'    </table>\n    <div>\n        <div class="config-btn">'+e.escapeExpression((l(n,"t")||t&&l(t,"t")||e.hooks.helperMissing).call(s,"Configure",{name:"t",hash:{},data:o,loc:{start:{line:8,column:32},end:{line:8,column:49}}}))+"</div>\n    </div>\n</form>\n"},useData:!0}),A.DataParameter=Handlebars.template({1:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <input class="name-input col1" value="'+e.escapeExpression("function"==typeof(n=null!=(n=a(n,"name")||(null!=t?a(t,"name"):t))?n:e.hooks.helperMissing)?n.call(null!=t?t:e.nullContext||{},{name:"name",hash:{},data:o,loc:{start:{line:3,column:42},end:{line:3,column:50}}}):n)+'" />\n'},3:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <label class="col1">'+e.escapeExpression("function"==typeof(n=null!=(n=a(n,"name")||(null!=t?a(t,"name"):t))?n:e.hooks.helperMissing)?n.call(null!=t?t:e.nullContext||{},{name:"name",hash:{},data:o,loc:{start:{line:5,column:24},end:{line:5,column:32}}}):n)+"</label>\n"},5:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div class="remove-item-btn col4" data-id="'+e.escapeExpression("function"==typeof(n=null!=(n=a(n,"id")||(null!=t?a(t,"id"):t))?n:e.hooks.helperMissing)?n.call(null!=t?t:e.nullContext||{},{name:"id",hash:{},data:o,loc:{start:{line:64,column:47},end:{line:64,column:53}}}):n)+'">\n        Remove Item\n    </div>\n'},compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r=e.escapeExpression,c=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="form-control viewstate-control">\n'+(null!=(a=c(n,"if").call(s,null!=t?c(t,"editable"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.program(3,o,0),data:o,loc:{start:{line:2,column:4},end:{line:6,column:11}}}))?a:"")+'\n    <div class="type-dropdown col2">\n        <select class="type-select">\n            <option>boolean</option>\n            <option>byte</option>\n            <option>char</option>\n            <option>date</option>\n            <option>datetime</option>\n            <option>dict</option>\n            <option>double</option>\n            <option>float</option>\n            <option>guid</option>\n            <option>int</option>\n            <option>list</option>\n            <option>long</option>\n            <option>minute</option>\n            <option>month</option>\n            <option>second</option>\n            <option>short</option>\n            <option>string</option>\n            <option>symbol</option>\n            <option>time</option>\n            <option>timespan</option>\n            <option>timestamp</option>\n        </select>\n    </div>\n\n    <div class="input-div col3">\n        \x3c!-- <input class="value-input" type="text" data-schemaformat="number" /> --\x3e\n        <span class="value-input bbf-editor"></span>\n\n        <i class="fa fa-fw watermark fa-eye binding-apply viewstate-apply"></i>\n\n        <div class="generate-value" title="'+r((c(n,"t")||t&&c(t,"t")||l).call(s,"Generate View State",{name:"t",hash:{},data:o,loc:{start:{line:40,column:43},end:{line:40,column:70}}}))+'">\n            <i class="fa fa-fw watermark fa-eye generate-viewstate-icon"></i>\n            <i class="fa fa-fw watermark fa-cog generate-viewstate-icon"></i>\n        </div>\n\n        <div class="binding-container">\n            <i\n                class="fa fa-fw watermark fa-eraser binding-clear"\n                title="'+r((c(n,"t")||t&&c(t,"t")||l).call(s,"Clear View State",{name:"t",hash:{},data:o,loc:{start:{line:48,column:23},end:{line:48,column:47}}}))+'"\n            ></i>\n            <i\n                class="fa fa-fw watermark fa-eye binding-icon viewstate-icon"\n                title="'+r((c(n,"t")||t&&c(t,"t")||l).call(s,"Select View State",{name:"t",hash:{},data:o,loc:{start:{line:52,column:23},end:{line:52,column:48}}}))+'"\n            ></i>\n            <input\n                class="value-display data-parameter-editor"\n                type="text"\n                tabindex="-1"\n                readonly\n            />\n        </div>\n    </div>\n\n'+(null!=(a=c(n,"if").call(s,null!=t?c(t,"editable"):t,{name:"if",hash:{},fn:e.program(5,o,0),inverse:e.noop,data:o,loc:{start:{line:63,column:4},end:{line:67,column:11}}}))?a:"")+'</div>\n\n<div class="form-control viewstate-control button-row">\n    <div class="add-item-btn">\n        Add Item\n    </div>\n</div>\n\n<div class="list-items" style="margin-bottom: 22px; padding-left: 1em;"></div>\n'},useData:!0}),A.DocumentGraph=Handlebars.template({1:function(e,t,n,i,o){return" checked "},compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="overlay"></div>\n<div class="graph-toolbar">\n    <div class="options ui-widget">\n        <div class="radio-button">    \n            <label><input type="radio" name="hierarchical" value="default" '+(null!=(a=l(n,"unless").call(s,null!=t?l(t,"hierarchical"):t,{name:"unless",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:5,column:75},end:{line:5,column:119}}}))?a:"")+'>Default</label>\n        </div>\n        <div class="radio-button">\n            <label><input type="radio" name="hierarchical" value="hierarchical" '+(null!=(a=l(n,"if").call(s,null!=t?l(t,"hierarchical"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:8,column:80},end:{line:8,column:116}}}))?a:"")+'>Hierarchical</label>\n        </div>\n        <div class="graph-buttons">\n            <button class="clean-up" title="Clean Up Isolated Objects"></button>\n        </div>\n    </div>\n    <div class="search-box">\n        <form autocomplete="off">\n            <i class="fa fa-search"></i>\n            <input type="text" class="searchInput" placeholder="Components, Data Sources, or View States">\n            <span class="clearSearch fa fa-times" style="visibility: hidden"></span>\n        </form>\n    </div>\n    <div class="close-box">\n        <a class="close"><i class="fa fa-close"></i></a>\n    </div>\n    \n</div>\n<div class="loading">\n    <div class="loadingInner">\n        <i class="fa fa-spinner fa-spin"></i>\n    </div>\n</div>'},useData:!0}),A.DocumentGraphTooltip=Handlebars.template({1:function(e,t,n,i,o){return"<li>"+e.escapeExpression(e.lambda(t,t))+"</li>\n"},3:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<table class="tooltiptext">\n    <tr>\n        <td><i class="fa fa-square iconbar-1"></i></td>\n        <td>Dispatch:</td>\n        <td class="rightTextAlign">'+c(typeof(a=null!=(a=e(n,"subscriptionTime")||(null!=t?e(t,"subscriptionTime"):t))?a:l)==r?a.call(s,{name:"subscriptionTime",hash:{},data:o,loc:{start:{line:14,column:35},end:{line:14,column:55}}}):a)+' ms</td>\n        <td class="rightTextAlign"> '+c((e(n,"toFixed")||t&&e(t,"toFixed")||l).call(s,null!=t?e(t,"subscriptionPercent"):t,2,{name:"toFixed",hash:{},data:o,loc:{start:{line:15,column:36},end:{line:15,column:69}}}))+'%</td>\n    </tr>\n    <tr>\n        <td><i class="fa fa-square iconbar-2"></i></td>\n        <td>Server Duration:</td>\n        <td class="rightTextAlign">'+c(typeof(a=null!=(a=e(n,"executionTime")||(null!=t?e(t,"executionTime"):t))?a:l)==r?a.call(s,{name:"executionTime",hash:{},data:o,loc:{start:{line:20,column:35},end:{line:20,column:52}}}):a)+' ms</td>\n        <td class="rightTextAlign"> '+c((e(n,"toFixed")||t&&e(t,"toFixed")||l).call(s,null!=t?e(t,"executionPercent"):t,2,{name:"toFixed",hash:{},data:o,loc:{start:{line:21,column:36},end:{line:21,column:66}}}))+'%</td>\n    </tr>\n    <tr>\n        <td><i class="fa fa-square iconbar-3"></i></td>\n        <td>IPC & Deserialize:</td>\n        <td class="rightTextAlign">'+c(typeof(a=null!=(a=e(n,"dataModelTime")||(null!=t?e(t,"dataModelTime"):t))?a:l)==r?a.call(s,{name:"dataModelTime",hash:{},data:o,loc:{start:{line:26,column:35},end:{line:26,column:52}}}):a)+' ms</td>\n        <td class="rightTextAlign"> '+c((e(n,"toFixed")||t&&e(t,"toFixed")||l).call(s,null!=t?e(t,"dataModelPercent"):t,2,{name:"toFixed",hash:{},data:o,loc:{start:{line:27,column:36},end:{line:27,column:66}}}))+"%</td>\n    </tr>\n</table>\n"},compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class = "document-graph-tooltip">\n'+c(typeof(a=null!=(a=d(n,"executions")||(null!=t?d(t,"executions"):t))?a:l)==r?a.call(s,{name:"executions",hash:{},data:o,loc:{start:{line:2,column:0},end:{line:2,column:14}}}):a)+" <br>\n"+c(typeof(a=null!=(a=d(n,"label")||(null!=t?d(t,"label"):t))?a:l)==r?a.call(s,{name:"label",hash:{},data:o,loc:{start:{line:3,column:0},end:{line:3,column:9}}}):a)+"\n<ul>\n"+(null!=(c=d(n,"each").call(s,null!=t?d(t,"subscribers"):t,{name:"each",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:5,column:0},end:{line:7,column:9}}}))?c:"")+"</ul>\n"+(null!=(c=d(n,"if").call(s,null!=t?d(t,"bool"):t,{name:"if",hash:{},fn:e.program(3,o,0),inverse:e.noop,data:o,loc:{start:{line:9,column:0},end:{line:30,column:7}}}))?c:"")+"</div>"},useData:!0}),A.DropDownDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\n<ol class="tp-radio">\n</ol>\n\n<div class="pnlCustom"> \n    <p>To create a "wild" column please use * <br /> \n        <span>e.g. use <b>bid*</b> for <b>[bid]</b> and <b>[bid_change]</b></span></p>\n    <input class="customDropwdownInput" type="text" />\n    <button class="customDropwdownSelect">'+e.escapeExpression((a(n,"t")||t&&a(t,"t")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},"Add Custom Column",{name:"t",hash:{},data:o,loc:{start:{line:9,column:42},end:{line:9,column:67}}}))+"</button>\n</div>\n"},useData:!0}),A.DropDownSelectableDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\n<ol class="tp-selectable">\n</ol>\n\n<div class="pnlCustom"> \n    <p>To create a "wild" column please use * <br /> \n        <span>e.g. use <b>bid*</b> for <b>[bid]</b> and <b>[bid_change]</b></span></p>\n    <input class="customDropwdownInput" type="text" />\n    <button class="customDropwdownSelect">'+e.escapeExpression((a(n,"t")||t&&a(t,"t")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},"Add Custom Column",{name:"t",hash:{},data:o,loc:{start:{line:9,column:42},end:{line:9,column:67}}}))+"</button>\n</div>\n"},useData:!0}),A.DropDownWithEnumSelectableDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\n<ol class="tp-selectable">\n</ol>\n\n<div class="pnlCustom"> \n    <p>Add custom geoJson url <br /> \n        \n    <input class="customDropwdownInput" type="text" />\n    <button class="customDropwdownSelect">'+e.escapeExpression((a(n,"t")||t&&a(t,"t")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},"Use Custom Url",{name:"t",hash:{},data:o,loc:{start:{line:9,column:42},end:{line:9,column:64}}}))+"</button>\n</div>\n"},useData:!0}),A.EditorDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="toolbar ui-widget-header ui-corner-all">\n\t<span class="fa-stack fa-lg element-picker" title="'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"Choose an element",{name:"t",hash:{},data:o,loc:{start:{line:2,column:52},end:{line:2,column:77}}}))+'">\n\t\t<i class="fa fa-square-o fa-stack-2x"></i>\n\t\t<i class="fa fa-mouse-pointer fa-stack-1x"></i>\n\t</span>\n\t<div class="highlighted-element">'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"Click the icon to choose an element",{name:"t",hash:{},data:o,loc:{start:{line:6,column:34},end:{line:6,column:77}}}))+"</div>\n</div>"},useData:!0}),A.ErrorDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="dialog-error" title="'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"Error",{name:"t",hash:{},data:o,loc:{start:{line:1,column:33},end:{line:1,column:46}}}))+'">\n    <p>'+l("function"==typeof(l=null!=(l=e(n,"body")||(null!=t?e(t,"body"):t))?l:s)?l.call(a,{name:"body",hash:{},data:o,loc:{start:{line:2,column:7},end:{line:2,column:15}}}):l)+"\n    </p>\n</div>\n"},useData:!0}),A.FailedLoginsNotification=Handlebars.template({1:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div class="status-'+c(typeof(a=null!=(a=d(n,"status")||(null!=t?d(t,"status"):t))?a:l)==r?a.call(s,{name:"status",hash:{},data:o,loc:{start:{line:2,column:23},end:{line:2,column:33}}}):a)+'">\n        <span>'+c(typeof(a=null!=(a=d(n,"time")||(null!=t?d(t,"time"):t))?a:l)==r?a.call(s,{name:"time",hash:{},data:o,loc:{start:{line:3,column:14},end:{line:3,column:22}}}):a)+'</span>\n        <span class="info">from:</span>\n        <span>'+c(typeof(a=null!=(a=d(n,"machineID")||(null!=t?d(t,"machineID"):t))?a:l)==r?a.call(s,{name:"machineID",hash:{},data:o,loc:{start:{line:5,column:14},end:{line:5,column:27}}}):a)+"</span>\n"+(null!=(e=d(n,"if").call(s,null!=t?d(t,"status"):t,{name:"if",hash:{},fn:e.program(2,o,0),inverse:e.noop,data:o,loc:{start:{line:6,column:8},end:{line:9,column:15}}}))?e:"")+'        <span class="info">url:</span>\n        <span>'+c(typeof(a=null!=(a=d(n,"url")||(null!=t?d(t,"url"):t))?a:l)==r?a.call(s,{name:"url",hash:{},data:o,loc:{start:{line:11,column:14},end:{line:11,column:21}}}):a)+"</span>\n    </div>\n"},2:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <span class="info">status:</span>\n        <span>'+e.escapeExpression("function"==typeof(n=null!=(n=a(n,"status")||(null!=t?a(t,"status"):t))?n:e.hooks.helperMissing)?n.call(null!=t?t:e.nullContext||{},{name:"status",hash:{},data:o,loc:{start:{line:8,column:14},end:{line:8,column:24}}}):n)+"</span>\n"},compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(n=a(n,"each").call(null!=t?t:e.nullContext||{},null!=t?a(t,"rows"):t,{name:"each",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:1,column:0},end:{line:13,column:9}}}))?n:""},useData:!0}),A.HandlebarHelp=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){return'<div class="handlebars-help">\n    <h2 id="getting-started">Getting Started\n    </h2>\n    <div class="contents">\n        <div class="description">\n            Creating a template looks like regular HTML, with embedded expressions.\n        </div>\n         <pre class="sunburst"><span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>My symbol is: <span class="EmbeddedSourceBright">&#123;&#123;sym&#125;&#125;</span><span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>&#x000A;</pre>\n        <div class="notes">\n            An expression is a <code>&#123;&#123;</code>, some contents, followed by a <code>&#125;&#125;</code>\n        </div>\n        <div class="notes">\n            You can iterate over your data using the each helper. Inside the block, you can use this to reference the element being iterated over.\n        </div>\n        <pre class="sunburst"><span class="MetaTagAll">&lt;div&gt;</span>My symbols are:&#x000A;<span class="MetaTagAll">&lt;ol&gt;</span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;#each this&#125;&#125;</span>&#x000A;    <span class="MetaTagAll">&lt;li&gt;</span><span class="EmbeddedSourceBright">&#123;&#123;sym&#125;&#125;</span><span class="MetaTagAll">&lt;/li&gt;</span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;/each&#125;&#125;</span>&#x000A;  <span class="MetaTagAll">&lt;/ol&gt;</span>&#x000A;<span class="MetaTagAll">&lt;/div&gt;</span></pre>\n    </div>\n    <h2 id="basic-blocks">Basic Usage\n    </h2>\n    <div class="contents">\n        <div class="bullet">\n            <div class="description">\n                The simplest Handlebars expression is a simple identifier:\n            </div>\n            <pre class="sunburst"><span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span><span class="EmbeddedSourceBright">&#123;&#123;title&#125;&#125;</span><span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span>&#x000A;</pre>\n            <div class="notes">\n                This expression means "look up the <code>title</code> property in\n            the current context". Block helpers may manipulate the current\n            context, but they do not change the basic meaning of an expression.\n            </div>\n        </div>\n        <div class="bullet">\n            <div class="description">\n                Handlebars expressions can also be dot-separated paths.\n            </div>\n            <pre class="sunburst"><span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span><span class="EmbeddedSourceBright">&#123;&#123;article.title&#125;&#125;</span><span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span>&#x000A;</pre>\n            <div class="notes">\n                This expression means "look up the <code>article</code> property in\n            the current context. Then look up the <code>title</code>\n                property in the result".\n            </div>\n        </div>\n        <div class="bullet">\n            <div class="description">\n                Identifiers may be any unicode character except for the following:\n            </div>\n            <div class="notes">\n                Whitespace\n            <code>!</code>\n                <code>"</code>\n                <code>#</code>\n                <code>%</code>\n                <code>&</code>\n                <code>\'</code>\n                <code>(</code>\n                <code>)</code>\n                <code>*</code>\n                <code>+</code>\n                <code>,</code>\n                <code>.</code>\n                <code>/</code>\n                <code>;</code>\n                <code><</code>\n                <code>=</code>\n                <code>></code>\n                <code>@</code>\n                <code>[</code>\n                <code>\\</code>\n                <code>]</code>\n                <code>^</code>\n                <code>`</code>\n                <code>{</code>\n                <code>|\x3c!-- Comment to prevent multiline parsing --\x3e</code>\n                <code>}</code>\n                <code>~</code>\n            </div>\n        </div>\n        <div class="bullet">\n            <div class="description">\n                To reference a property that is not a valid identifier, you can\n            use segment-literal notation, <code>[</code>:\n            </div>\n            <pre class="sunburst"><span class="EmbeddedSourceBright">&#123;&#123;#each articles.[10].[#comments]&#125;&#125;</span>&#x000A;  <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span><span class="EmbeddedSourceBright">&#123;&#123;subject&#125;&#125;</span><span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>&#x000A;    <span class="EmbeddedSourceBright">&#123;&#123;body&#125;&#125;</span>&#x000A;  <span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>&#x000A;<span class="EmbeddedSourceBright">&#123;&#123;/each&#125;&#125;</span>&#x000A;</pre>\n            <div class="notes">\n                In the example above, the template will treat the <code>each</code>\n                parameter roughly equivalent to this javascript:\n            <code>articles[10][\'#comments\']</code>\n            </div>\n            <div class="notes">\n                You may not include a closing <code>]</code> in a path-literal,\n            but all other characters are fair game.\n            </div>\n            <div class="description">\n                JavaScript-style strings, <code>"</code> and <code>\'</code>, may also be used vs. <code>[</code>\n                pairs.\n            </div>\n        </div>\n        <div class="bullet">\n            <div class="description">\n                Handlebars HTML-escapes values returned by a <code>&#123;&#123;expression&#125;&#125;</code>.\n            If you don\'t want Handlebars to escape a value, use the "triple-stash", <code>&#123;&#123;{</code>\n            </div>\n            <pre class="sunburst"><span class="EmbeddedSourceBright">&#123;&#123;{foo&#125;&#125;</span>}&#x000A;</pre>\n        </div>\n    </div>\n    <h2 id="conditionals">The <code>if</code> block helper\n    </h2>\n    <div class="content">\n        <div class="bullet">\n            <div class="description">\n                You can use the <code>if</code> helper to conditionally render a block. If\n              its argument returns <code>false</code>, <code>undefined</code>, <code>null</code>,\n              <code>""</code>, <code>0</code>, or <code>[]</code>, Handlebars will not\n              render the block.\n            </div>\n            <pre class="sunburst"><span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">div</span> <span class="MetaTagAll">class</span>=<span class="String"><span class="String">&quot;</span>entry<span class="String">&quot;</span></span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;#if author&#125;&#125;</span>&#x000A;    <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span><span class="EmbeddedSourceBright">&#123;&#123;firstName&#125;&#125;</span> <span class="EmbeddedSourceBright">&#123;&#123;lastName&#125;&#125;</span><span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;/if&#125;&#125;</span>&#x000A;<span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>&#x000A;</pre>\n            <div class="notes">\n                when used with an empty (<code>{}</code>) context, <code>author</code> will be\n              <code>undefined</code>, resulting in:\n            </div>\n            <pre class="sunburst"><span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">div</span> <span class="MetaTagAll">class</span>=<span class="String"><span class="String">&quot;</span>entry<span class="String">&quot;</span></span><span class="MetaTagAll">&gt;</span></span>&#x000A;<span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>&#x000A;</pre>\n        </div>\n        <div class="bullet">\n            <div class="description">\n                When using a block expression, you can specify a template section to\n              run if the expression returns a falsy value. The section, marked by\n              <code>&#123;&#123;else&#125;&#125;</code> is called an "else section".\n            </div>\n            <pre class="sunburst"><span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">div</span> <span class="MetaTagAll">class</span>=<span class="String"><span class="String">&quot;</span>entry<span class="String">&quot;</span></span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;#if author&#125;&#125;</span>&#x000A;    <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span><span class="EmbeddedSourceBright">&#123;&#123;firstName&#125;&#125;</span> <span class="EmbeddedSourceBright">&#123;&#123;lastName&#125;&#125;</span><span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;else&#125;&#125;</span>&#x000A;    <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span>Unknown Author<span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;/if&#125;&#125;</span>&#x000A;<span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>&#x000A;</pre>\n        </div>\n    </div>\n    <h2 id="unless">The <code>unless</code> block helper\n    </h2>\n    <div class="content">\n        <div class="bullet">\n            <div class="description">\n                You can use the <code>unless</code> helper as the inverse of the\n              <code>if</code> helper. Its block will be rendered if the expression\n              returns a falsy value.\n            </div>\n            <pre class="sunburst"><span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">div</span> <span class="MetaTagAll">class</span>=<span class="String"><span class="String">&quot;</span>entry<span class="String">&quot;</span></span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;#unless license&#125;&#125;</span>&#x000A;  <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">h3</span> <span class="MetaTagAll">class</span>=<span class="String"><span class="String">&quot;</span>warning<span class="String">&quot;</span></span><span class="MetaTagAll">&gt;</span></span>WARNING: This entry does not have a license!<span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">h3</span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;/unless&#125;&#125;</span>&#x000A;<span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>&#x000A;</pre>\n            <div class="notes">\n                If looking up <code>license</code> under the current context returns a\n              falsy value, Handlebars will render the warning. Otherwise, it will render\n              nothing.\n            </div>\n        </div>\n    </div>\n    <h2 id="iteration">The <code>each</code> block helper\n    </h2>\n    <div class="content">\n        <div class="bullet">\n            <div class="description">\n                You can iterate over a list using the built-in <code>each</code>\n                helper. Inside the block, you can use <code>this</code> to reference\n              the element being iterated over.\n            </div>\n            <pre class="sunburst"><span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">ul</span> <span class="MetaTagAll">class</span>=<span class="String"><span class="String">&quot;</span>people_list<span class="String">&quot;</span></span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;#each people&#125;&#125;</span>&#x000A;    <span class="MetaTagInline"><span class="MetaTagInline">&lt;</span><span class="MetaTagInline">li</span><span class="MetaTagInline">&gt;</span></span><span class="EmbeddedSourceBright">&#123;&#123;this&#125;&#125;</span><span class="MetaTagInline"><span class="MetaTagInline">&lt;/</span><span class="MetaTagInline">li</span><span class="MetaTagInline">&gt;</span></span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;/each&#125;&#125;</span>&#x000A;<span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">ul</span><span class="MetaTagAll">&gt;</span></span>&#x000A;</pre>\n            <div class="notes">\n                when used with this context:\n            </div>\n            <pre class="sunburst">{&#x000A;  people: [&#x000A;    <span class="String"><span class="String">&quot;</span>Yehuda Katz<span class="String">&quot;</span></span>,&#x000A;    <span class="String"><span class="String">&quot;</span>Alan Johnson<span class="String">&quot;</span></span>,&#x000A;    <span class="String"><span class="String">&quot;</span>Charles Jolley<span class="String">&quot;</span></span>&#x000A;  ]&#x000A;}&#x000A;</pre>\n            <div class="notes">\n                will result in:\n            </div>\n            <pre class="sunburst"><span class="Keyword">&lt;</span>ul <span class="Storage">class</span><span class="Keyword">=</span><span class="String"><span class="String">&quot;</span>people_list<span class="String">&quot;</span></span><span class="Keyword">&gt;</span>&#x000A;  <span class="Keyword">&lt;</span>li<span class="Keyword">&gt;</span>Yehuda Katz<span class="Keyword">&lt;</span>/li<span class="Keyword">&gt;</span>&#x000A;  <span class="Keyword">&lt;</span>li<span class="Keyword">&gt;</span>Alan Johnson<span class="Keyword">&lt;</span>/li<span class="Keyword">&gt;</span>&#x000A;  <span class="Keyword">&lt;</span>li<span class="Keyword">&gt;</span>Charles Jolley<span class="Keyword">&lt;</span>/li<span class="Keyword">&gt;</span>&#x000A;<span class="Keyword">&lt;</span>/ul<span class="Keyword">&gt;</span>&#x000A;</pre>\n            <div class="notes">\n                You can use the <code>this</code> expression in any context to reference\n              the current context.\n            </div>\n        </div>\n        <div class="bullet">\n            <div class="description">\n                You can optionally provide an <code>&#123;&#123;else&#125;&#125;</code> section which will display only when the list is empty.\n            </div>\n            <pre class="sunburst"><span class="EmbeddedSourceBright">&#123;&#123;#each paragraphs&#125;&#125;</span>&#x000A;  <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">p</span><span class="MetaTagAll">&gt;</span></span><span class="EmbeddedSourceBright">&#123;&#123;this&#125;&#125;</span><span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">p</span><span class="MetaTagAll">&gt;</span></span>&#x000A;<span class="EmbeddedSourceBright">&#123;&#123;else&#125;&#125;</span>&#x000A;  <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">p</span> <span class="MetaTagAll">class</span>=<span class="String"><span class="String">&quot;</span>empty<span class="String">&quot;</span></span><span class="MetaTagAll">&gt;</span></span>No content<span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">p</span><span class="MetaTagAll">&gt;</span></span>&#x000A;<span class="EmbeddedSourceBright">&#123;&#123;/each&#125;&#125;</span>&#x000A;</pre>\n        </div>\n        <div class="bullet">\n            <div class="description">\n                When looping through items in <code>each</code>, you can optionally reference the current loop index via <code>&#123;&#123;@index&#125;&#125;</code>\n            </div>\n            <pre class="sunburst"><span class="EmbeddedSourceBright">&#123;&#123;#each array&#125;&#125;</span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;@index&#125;&#125;</span>: <span class="EmbeddedSourceBright">&#123;&#123;this&#125;&#125;</span>&#x000A;<span class="EmbeddedSourceBright">&#123;&#123;/each&#125;&#125;</span>&#x000A;</pre>\n            <div class="notes">\n                Additionally for object iteration, <code>&#123;&#123;@key&#125;&#125;</code> references the current key name:\n            </div>\n            <pre class="sunburst"><span class="EmbeddedSourceBright">&#123;&#123;#each object&#125;&#125;</span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;@key&#125;&#125;</span>: <span class="EmbeddedSourceBright">&#123;&#123;this&#125;&#125;</span>&#x000A;<span class="EmbeddedSourceBright">&#123;&#123;/each&#125;&#125;</span>&#x000A;</pre>\n            <div class="notes">\n                The first and last steps of iteration are noted via the <code>@first</code> and <code>@last</code>\n                variables when iterating over an array. When iterating over an object only the <code>@first</code>\n                is available.\n            </div>\n            <div class="notes">\n                Nested <code>each</code> blocks may access the interation variables via depth based paths.\n              To access the parent index, for example, <code>&#123;&#123;@../index&#125;&#125;</code> can be used.\n            </div>\n        </div>\n        <div class="bullet">\n            <div class="description">\n                The <code>each</code> helper also supports <a href="block_helpers.html#block-params">block parameters</a>, allowing for named references anywhere in the block.\n            </div>\n            <pre class="sunburst"><span class="EmbeddedSourceBright">&#123;&#123;#each array as |value key|&#125;&#125;</span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;#each child as |childValue childKey|&#125;&#125;</span>&#x000A;    <span class="EmbeddedSourceBright">&#123;&#123;key&#125;&#125;</span> - <span class="EmbeddedSourceBright">&#123;&#123;childKey&#125;&#125;</span>. <span class="EmbeddedSourceBright">&#123;&#123;childValue&#125;&#125;</span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;/each&#125;&#125;</span>&#x000A;<span class="EmbeddedSourceBright">&#123;&#123;/each&#125;&#125;</span>&#x000A;</pre>\n            <div class="notes">\n                Will create a <code>key</code> and <code>value</code> variable that children may access without the need for depthed variable references. In the example above, <code>&#123;&#123;key&#125;&#125;</code> is identical to <code>&#123;&#123;@../key&#125;&#125;</code> but in many cases is more readable.\n            </div>\n        </div>\n    </div>\n    <h2 id="lookup">The <code>lookup</code> helper\n    </h2>\n    <div class="contents">\n        <div class="bullet">\n            <div class="description">\n                The <code>lookup</code> helper allows for dynamic parameter resolution using Handlebars\n              variables. This is useful for resolving values for array indexes.\n            </div>\n            <pre class="sunburst"><span class="EmbeddedSourceBright">&#123;&#123;#each bar&#125;&#125;</span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;lookup ../foo @index&#125;&#125;</span>&#x000A;<span class="EmbeddedSourceBright">&#123;&#123;/each&#125;&#125;</span>&#x000A;</pre>\n        </div>\n    </div>\n    <h2 id="log">The <code>log</code> block helper\n    </h2>\n    <div class="contents">\n        <div class="bullet">\n            <div class="description">\n                The <code>log</code> helper allows for logging of context state while executing\n              a template.\n            </div>\n            <pre class="sunburst"><span class="EmbeddedSourceBright">&#123;&#123;log &quot;Look at me!&quot;&#125;&#125;</span>&#x000A;</pre>\n            <div class="notes">\n                Delegates to <code>Handlebars.logger.log</code> which may\n              be overriden to perform custom logging.\n            </div>\n            <div class="notes">\n                Any number of arguments may be passed to this method and all will be forwarded to the logger.\n            </div>\n            <pre class="sunburst"><span class="EmbeddedSourceBright">&#123;&#123;log &quot;This is logged&quot; foo &quot;And so is this&quot;&#125;&#125;</span>&#x000A;</pre>\n            <div class="notes">\n                The log level may be set using the <code>level</code> hash parameter. Supported values are <code>debug</code>, <code>info</code>, <code>warn</code>, and <code>error</code>. When omitted, <code>info</code> is the default value,\n            </div>\n            <pre class="sunburst"><span class="EmbeddedSourceBright">&#123;&#123;log &quot;Log!&quot; level=&quot;error&quot;&#125;&#125;</span>&#x000A;</pre>\n            <div class="notes">\n                Logging is conditional based on the level and to value set in <code>Handlebars.logger.level</code>, which defaults to <code>info</code>. All log statements at or above the current level will be output.\n            </div>\n        </div>\n    </div>\n    \n    <h2 id="escaping">Escaping\n    </h2>\n    <div class="contents">\n        <div class="bullet">\n            <div class="description">\n                Handlebars content may be escaped in one of two ways, inline escapes or raw block helpers.\n                Inline escapes created by prefixing a mustache block with <code>\\</code>. Raw blocks are\n                created using <code>&#123;&#123;&#123;&#123;</code> mustache braces.\n            </div>\n            <pre class="sunburst">\\<span class="EmbeddedSourceBright">&#123;&#123;escaped&#125;&#125;</span>&#x000A;<span class="EmbeddedSourceBright">&#123;&#123;&#123;&#123;raw&#125;&#125;</span>&#125;&#125;&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;escaped&#125;&#125;</span>&#x000A;<span class="EmbeddedSourceBright">&#123;&#123;&#123;&#123;/raw&#125;&#125;</span>&#125;&#125;&#x000A;</pre>\n            <div class="notes">\n                Raw blocks operate in the same manner as other <a href="/block_helpers.html">block helpers</a>\n                with the distinction of the child content is treated as a literal string.\n            </div>\n        </div>\n    </div>\n    <h2>More...\n    </h2>\n    <div class="contents">\n        More information can be found on the Handlerbars website <a href="http://http://handlebarsjs.com">here</a>.\n    </div>\n</div>\n'},useData:!0}),A.IconDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){return'<div class="search">\n    <input name="q" type="text" size="40" placeholder="Search Icons..." />\n    <i class="fa fa-fw fa-search"></i>\n</div>\n<div class="grid"></div>\n'},useData:!0}),A.IconDialogItem=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<a title="'+c(typeof(a=null!=(a=e(n,"icon")||(null!=t?e(t,"icon"):t))?a:l)==r?a.call(s,{name:"icon",hash:{},data:o,loc:{start:{line:1,column:10},end:{line:1,column:18}}}):a)+'"><i class="gridItem '+c(typeof(a=null!=(a=e(n,"type")||(null!=t?e(t,"type"):t))?a:l)==r?a.call(s,{name:"type",hash:{},data:o,loc:{start:{line:1,column:39},end:{line:1,column:47}}}):a)+" "+c(typeof(a=null!=(a=e(n,"subtype")||(null!=t?e(t,"subtype"):t))?a:l)==r?a.call(s,{name:"subtype",hash:{},data:o,loc:{start:{line:1,column:48},end:{line:1,column:59}}}):a)+" "+c(typeof(a=null!=(a=e(n,"type")||(null!=t?e(t,"type"):t))?a:l)==r?a.call(s,{name:"type",hash:{},data:o,loc:{start:{line:1,column:60},end:{line:1,column:68}}}):a)+"-"+c(typeof(a=null!=(a=e(n,"icon")||(null!=t?e(t,"icon"):t))?a:l)==r?a.call(s,{name:"icon",hash:{},data:o,loc:{start:{line:1,column:69},end:{line:1,column:77}}}):a)+'"></i><div class="gridItemName">'+c(typeof(a=null!=(a=e(n,"icon")||(null!=t?e(t,"icon"):t))?a:l)==r?a.call(s,{name:"icon",hash:{},data:o,loc:{start:{line:1,column:109},end:{line:1,column:117}}}):a)+"</div></a>"},useData:!0}),A.IconDialogItemMD=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<a title="'+c(typeof(a=null!=(a=e(n,"icon")||(null!=t?e(t,"icon"):t))?a:l)==r?a.call(s,{name:"icon",hash:{},data:o,loc:{start:{line:1,column:10},end:{line:1,column:18}}}):a)+'"><i class="gridItem fa fa-fw '+c(typeof(a=null!=(a=e(n,"type")||(null!=t?e(t,"type"):t))?a:l)==r?a.call(s,{name:"type",hash:{},data:o,loc:{start:{line:1,column:48},end:{line:1,column:56}}}):a)+"-"+c(typeof(a=null!=(a=e(n,"icon")||(null!=t?e(t,"icon"):t))?a:l)==r?a.call(s,{name:"icon",hash:{},data:o,loc:{start:{line:1,column:57},end:{line:1,column:65}}}):a)+' \'"></i><div class="gridItemName">'+c(typeof(a=null!=(a=e(n,"icon")||(null!=t?e(t,"icon"):t))?a:l)==r?a.call(s,{name:"icon",hash:{},data:o,loc:{start:{line:1,column:99},end:{line:1,column:107}}}):a)+"</div></a>"},useData:!0}),A.JsonDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){return'<div class="json-editor" spellcheck="false"></div>\n'},useData:!0}),A.LoadingScreen=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="loading" style="display: table; width: 100%; height: 100%; opacity: 0.9; pointer-events: none;">\n    <div style="display: table-cell; width: 100%; height: 100%; vertical-align: middle; text-align: center;">\n        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="64" height="64" fill="#D2D2D2">\n            <circle cx="16" cy="3" r="0">\n                <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />\n            </circle>\n            <circle transform="rotate(45 16 16)" cx="16" cy="3" r="0">\n                <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.125s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />\n            </circle>\n            <circle transform="rotate(90 16 16)" cx="16" cy="3" r="0">\n                <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.25s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />\n            </circle>\n            <circle transform="rotate(135 16 16)" cx="16" cy="3" r="0.567031">\n                <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.375s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />\n            </circle>\n            <circle transform="rotate(180 16 16)" cx="16" cy="3" r="1.82452">\n                <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.5s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />\n            </circle>\n            <circle transform="rotate(225 16 16)" cx="16" cy="3" r="2.88475">\n                <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.625s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />\n            </circle>\n            <circle transform="rotate(270 16 16)" cx="16" cy="3" r="2.1029">\n                <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.75s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />\n            </circle>\n            <circle transform="rotate(315 16 16)" cx="16" cy="3" r="0.60761">\n                <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.875s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />\n            </circle>\n            <circle transform="rotate(180 16 16)" cx="16" cy="3" r="1.82452">\n                <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.5s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />\n            </circle>\n        </svg>\n        <div style="color: #D2D2D2; font-weight: bold; margin-top: 7px; font-size: 11px; letter-spacing: 1px;">\n            '+e.escapeExpression("function"==typeof(n=null!=(n=a(n,"text")||(null!=t?a(t,"text"):t))?n:e.hooks.helperMissing)?n.call(null!=t?t:e.nullContext||{},{name:"text",hash:{},data:o,loc:{start:{line:33,column:12},end:{line:33,column:20}}}):n)+"\n        </div>\n    </div>\n</div>"},useData:!0}),A.LoginHistoryDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){return'<div class="grid-div">\n</div>'},useData:!0}),A.MainToolbar=Handlebars.template({1:function(e,t,n,i,o){return'<a class="toolbar-toggler"></a>\r\n'},compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.escapeExpression,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="logo"></div>\r\n\r\n<div class="document-selector" style="display: inline-block;"></div>\r\n\r\n<div class="main">\r\n    <a class="new-dash">'+l((r(n,"t")||t&&r(t,"t")||s).call(a,"New Dashboard",{name:"t",hash:{},data:o,loc:{start:{line:6,column:24},end:{line:6,column:45}}}))+'</a><a class="save-dash">'+l((r(n,"t")||t&&r(t,"t")||s).call(a,"Save Dashboard",{name:"t",hash:{},data:o,loc:{start:{line:7,column:25},end:{line:7,column:47}}}))+'</a><a class="undo-action" title="Undo Action">'+l((r(n,"t")||t&&r(t,"t")||s).call(a,"Undo Action",{name:"t",hash:{},data:o,loc:{start:{line:8,column:47},end:{line:8,column:66}}}))+'</a><a class="redo-action" title="Redo Action">'+l((r(n,"t")||t&&r(t,"t")||s).call(a,"Redo Action",{name:"t",hash:{},data:o,loc:{start:{line:9,column:47},end:{line:9,column:66}}}))+'</a>\r\n</div>\r\n\r\n<div class="content-toggle">\r\n    <input type="checkbox" id="checkbtn"><label for="checkbtn" title="'+l((r(n,"t")||t&&r(t,"t")||s).call(a,"Toggle Design/Preview View",{name:"t",hash:{},data:o,loc:{start:{line:13,column:70},end:{line:13,column:104}}}))+'">\r\n        <span class="design"><i class="fa fa-fw fa-pencil-square-o"></i>'+l((r(n,"t")||t&&r(t,"t")||s).call(a,"Design",{name:"t",hash:{},data:o,loc:{start:{line:14,column:72},end:{line:14,column:86}}}))+'</span>\r\n        <span class="preview"><i class="fa fa-fw fa-desktop"></i>'+l((r(n,"t")||t&&r(t,"t")||s).call(a,"Preview",{name:"t",hash:{},data:o,loc:{start:{line:15,column:65},end:{line:15,column:80}}}))+'</span>\r\n    </label>\r\n</div>\r\n\r\n<div class="connectionStatus"></div>\r\n\r\n<div class="profile">\r\n    <button>\r\n        <i class="fa fa-fw fa-user"></i>\r\n        <span class="user-name-wrap">\r\n            <span class="user-name"></span>\r\n        </span>\r\n    </button>\r\n\r\n    <div class="profile-menu"></div>\r\n</div>\r\n'+(null!=(l=r(n,"if").call(a,null!=t?r(t,"hideToolbar"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:31,column:0},end:{line:33,column:7}}}))?l:"")+"\r\n"},useData:!0}),A.ManageDashWindow=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="manage-documents-toolbar">\n    <button class="open">'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"open",{name:"t",hash:{},data:o,loc:{start:{line:2,column:25},end:{line:2,column:37}}}))+'</button>\n    <button class="view"> '+l((e(n,"t")||t&&e(t,"t")||s).call(a,"view on web",{name:"t",hash:{},data:o,loc:{start:{line:3,column:26},end:{line:3,column:45}}}))+'</button>\n    <button class="delete">'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"delete",{name:"t",hash:{},data:o,loc:{start:{line:4,column:27},end:{line:4,column:41}}}))+'</button>\n    <button class="export" title="'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"Export",{name:"t",hash:{},data:o,loc:{start:{line:5,column:34},end:{line:5,column:48}}}))+'">'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"export",{name:"t",hash:{},data:o,loc:{start:{line:5,column:50},end:{line:5,column:64}}}))+'</button>\n    <input type="file" id="dashImportFile" name="files" accept=".json,application/xml" style="display: none;" multiple />\n    <button class="import">'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"Import",{name:"t",hash:{},data:o,loc:{start:{line:7,column:27},end:{line:7,column:41}}}))+'</button>\n    <div class="search-box">\n        <i class="fa fa-search"></i>\n        <input class="search-input">\n        <span class="clearSearch fa fa-times" style="display: none"></span>\n    </div>\n</div>\n\n<div class="dash-list-headers">\n\n    <span class="name-sort" style="margin-left: 11px;">\n        '+l((e(n,"t")||t&&e(t,"t")||s).call(a,"name",{name:"t",hash:{},data:o,loc:{start:{line:18,column:8},end:{line:18,column:20}}}))+'\n        <i class="fa fa-caret-down"></i>\n        <i class="fa fa-caret-up"></i>\n    </span>\n\n    <span class="last-modified-sort" style="float: right; margin-right: 31px;">\n        '+l((e(n,"t")||t&&e(t,"t")||s).call(a,"last modified",{name:"t",hash:{},data:o,loc:{start:{line:24,column:8},end:{line:24,column:29}}}))+'\n        <i class="fa fa-caret-down"></i>\n        <i class="fa fa-caret-up"></i>\n    </span>\n</div>\n\n<div class="content-container">\n    <div class="dashboards-list">\n\n    </div>\n</div>'},useData:!0}),A.MenuLayoutCheckbox=Handlebars.template({1:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <label><input type="checkbox" name="'+c(typeof(a=null!=(a=e(n,"title")||(null!=t?e(t,"title"):t))?a:l)==r?a.call(s,{name:"title",hash:{},data:o,loc:{start:{line:2,column:40},end:{line:2,column:49}}}):a)+'" class="GENERATED->'+c(typeof(a=null!=(a=e(n,"class")||(null!=t?e(t,"class"):t))?a:l)==r?a.call(s,{name:"class",hash:{},data:o,loc:{start:{line:2,column:69},end:{line:2,column:78}}}):a)+'" '+c(typeof(a=null!=(a=e(n,"checked")||(null!=t?e(t,"checked"):t))?a:l)==r?a.call(s,{name:"checked",hash:{},data:o,loc:{start:{line:2,column:80},end:{line:2,column:91}}}):a)+">"+c(typeof(a=null!=(a=e(n,"description")||(null!=t?e(t,"description"):t))?a:l)==r?a.call(s,{name:"description",hash:{},data:o,loc:{start:{line:2,column:92},end:{line:2,column:107}}}):a)+"</label>\n"},compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(n=a(n,"each").call(null!=t?t:e.nullContext||{},null!=t?a(t,"checkboxes"):t,{name:"each",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:1,column:0},end:{line:3,column:9}}}))?n:""},useData:!0}),A.MenuLayoutItem=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div id="'+c(typeof(a=null!=(a=e(n,"id")||(null!=t?e(t,"id"):t))?a:l)==r?a.call(s,{name:"id",hash:{},data:o,loc:{start:{line:1,column:9},end:{line:1,column:15}}}):a)+'" class="ui-widget-content">\n    <div class="label">'+c(typeof(a=null!=(a=e(n,"label")||(null!=t?e(t,"label"):t))?a:l)==r?a.call(s,{name:"label",hash:{},data:o,loc:{start:{line:2,column:23},end:{line:2,column:32}}}):a)+'</div>\n    <img src="'+c(typeof(a=null!=(a=e(n,"image")||(null!=t?e(t,"image"):t))?a:l)==r?a.call(s,{name:"image",hash:{},data:o,loc:{start:{line:3,column:14},end:{line:3,column:23}}}):a)+'" style="width: 100%">\n    <div class="description">'+c(typeof(a=null!=(a=e(n,"description")||(null!=t?e(t,"description"):t))?a:l)==r?a.call(s,{name:"description",hash:{},data:o,loc:{start:{line:4,column:29},end:{line:4,column:44}}}):a)+"</div>\n</div>"},useData:!0}),A.MenuLayoutList=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="ui-widget-header title">'+e.escapeExpression("function"==typeof(n=null!=(n=a(n,"text")||(null!=t?a(t,"text"):t))?n:e.hooks.helperMissing)?n.call(null!=t?t:e.nullContext||{},{name:"text",hash:{},data:o,loc:{start:{line:1,column:36},end:{line:1,column:44}}}):n)+'</div>\n<div class="ui-widget-content presets"></div>\n<div class="ui-widget-content checkboxes"></div>'},useData:!0}),A.MessageDialog=Handlebars.template({1:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<label><input type="checkbox" />'+e.escapeExpression("function"==typeof(n=null!=(n=a(n,"check")||(null!=t?a(t,"check"):t))?n:e.hooks.helperMissing)?n.call(null!=t?t:e.nullContext||{},{name:"check",hash:{},data:o,loc:{start:{line:3,column:32},end:{line:3,column:41}}}):n)+"</label>\n"},compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="msg">'+(null!=(a="function"==typeof(a=null!=(a=l(n,"message")||(null!=t?l(t,"message"):t))?a:e.hooks.helperMissing)?a.call(s,{name:"message",hash:{},data:o,loc:{start:{line:1,column:17},end:{line:1,column:30}}}):a)?a:"")+"</div>\n"+(null!=(a=l(n,"if").call(s,null!=t?l(t,"check"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:2,column:0},end:{line:4,column:7}}}))?a:"")},useData:!0}),A.Notificator=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){return'<div class="panel ui-widget-content">\n    <div class="title"></div>\n    <div class="items"></div>\n    <button class="close-button">\n        Close\n    </button>\n</div>'},useData:!0}),A.PropertiesPanel=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="panel-header">\n    <span class="propertySearch">\n        <i class="searchIcon fa fa-search"></i>\n        <input class="searchInput" placeholder="search properties...">\n    </span>\n    <i class="fa fa-question-circle dashboardHelp" aria-hidden="true" title="Component Help / Documentation"></i>\n    <div class="pin-button">\n        <i class="fa fa-caret-right"></i><i class="fa fa-caret-right"></i>\n    </div>\n    <span class="lblWidgetName">'+e.escapeExpression((a(n,"t")||t&&a(t,"t")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},"dashboard",{name:"t",hash:{},data:o,loc:{start:{line:10,column:32},end:{line:10,column:49}}}))+'</span>\n\n</div>\n<div class="panel-document">\n\n</div>\n<div class="panel-content">\n</div>\n\n<div class="expand-button">\n    <div class="header">\n        properties\n    </div>\n</div>'},useData:!0}),A.PropertiesPanelContent=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){return'<div class="tabs">\n  <ul>\n    <li><a href="#tabs-1">Nunc tincidunt</a></li>\n    <li><a href="#tabs-2">Proin dolor</a></li>\n    <li><a href="#tabs-3">Aenean lacinia</a></li>\n  </ul>\n  <div id="tabs-1">\n    <p>Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris. Nam elementum quam ullamcorper ante. Etiam aliquet massa et lorem. Mauris dapibus lacus auctor risus. Aenean tempor ullamcorper leo. Vivamus sed magna quis ligula eleifend adipiscing. Duis orci. Aliquam sodales tortor vitae ipsum. Aliquam nulla. Duis aliquam molestie erat. Ut et mauris vel pede varius sollicitudin. Sed ut dolor nec orci tincidunt interdum. Phasellus ipsum. Nunc tristique tempus lectus.</p>\n  </div>\n  <div id="tabs-2">\n    <p>Morbi tincidunt, dui sit amet facilisis feugiat, odio metus gravida ante, ut pharetra massa metus id nunc. Duis scelerisque molestie turpis. Sed fringilla, massa eget luctus malesuada, metus eros molestie lectus, ut tempus eros massa ut dolor. Aenean aliquet fringilla sem. Suspendisse sed ligula in ligula suscipit aliquam. Praesent in eros vestibulum mi adipiscing adipiscing. Morbi facilisis. Curabitur ornare consequat nunc. Aenean vel metus. Ut posuere viverra nulla. Aliquam erat volutpat. Pellentesque convallis. Maecenas feugiat, tellus pellentesque pretium posuere, felis lorem euismod felis, eu ornare leo nisi vel felis. Mauris consectetur tortor et purus.</p>\n  </div>\n  <div id="tabs-3">\n    <p>Mauris eleifend est et turpis. Duis id erat. Suspendisse potenti. Aliquam vulputate, pede vel vehicula accumsan, mi neque rutrum erat, eu congue orci lorem eget lorem. Vestibulum non ante. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Fusce sodales. Quisque eu urna vel enim commodo pellentesque. Praesent eu risus hendrerit ligula tempus pretium. Curabitur lorem enim, pretium nec, feugiat nec, luctus a, lacus.</p>\n    <p>Duis cursus. Maecenas ligula eros, blandit nec, pharetra at, semper at, magna. Nullam ac lacus. Nulla facilisi. Praesent viverra justo vitae neque. Praesent blandit adipiscing velit. Suspendisse potenti. Donec mattis, pede vel pharetra blandit, magna ligula faucibus eros, id euismod lacus dolor eget odio. Nam scelerisque. Donec non libero sed nulla mattis commodo. Ut sagittis. Donec nisi lectus, feugiat porttitor, tempor ac, tempor vitae, pede. Aenean vehicula velit eu tellus interdum rutrum. Maecenas commodo. Pellentesque nec elit. Fusce in lacus. Vivamus a libero vitae lectus hendrerit hendrerit.</p>\n  </div>\n</div>'},useData:!0}),A.PropertiesPanelDocument=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="document-properties">\n    <div class="property-editor"></div>\n</div>\n\n<span class="documentGraphBtn">'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"Document Graph",{name:"t",hash:{},data:o,loc:{start:{line:5,column:31},end:{line:5,column:53}}}))+'</span>\n<span class="connectionMgmtBtn">'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"Connections",{name:"t",hash:{},data:o,loc:{start:{line:6,column:32},end:{line:6,column:51}}}))+"</span>\n"},useData:!0}),A.RichTextEditorDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="toolbar ui-widget-header ui-corner-all" id="htmlxEdit">\n</div>\n<div class="editor" style="background:'+c(typeof(a=null!=(a=e(n,"background")||(null!=t?e(t,"background"):t))?a:l)==r?a.call(s,{name:"background",hash:{},data:o,loc:{start:{line:3,column:38},end:{line:3,column:52}}}):a)+'">\n    <textarea id="'+c(typeof(a=null!=(a=e(n,"uid")||(null!=t?e(t,"uid"):t))?a:l)==r?a.call(s,{name:"uid",hash:{},data:o,loc:{start:{line:4,column:18},end:{line:4,column:25}}}):a)+'"></textarea>\n</div>\n<div class="code" style="display: none">\n</div>\n'},useData:!0}),A.ScreenItem=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div style="display: table; width: 100%; height: 100%;">\n    <div style="display: table-cell; width: 100%; height: 100%; vertical-align: middle; text-align: center;">\n\n        <div class="screen-thumb-wrapper">\n            <img class="screen-thumb" src="'+c(typeof(a=null!=(a=e(n,"thumb")||(null!=t?e(t,"thumb"):t))?a:l)==r?a.call(s,{name:"thumb",hash:{},data:o,loc:{start:{line:5,column:43},end:{line:5,column:52}}}):a)+'" />\n            <div class="default-thumb">\n                <div style="display: table; width: 100%; height: 100%;">\n                    <div style="display: table-cell; width: 100%; height: 100%; vertical-align: middle; text-align: center;">\n                        <i class="fa fa-pencil-square-o"></i>\n                    </div>\n                </div>\n            </div>\n            <div class="remove-screen-btn" title="'+c((e(n,"t")||t&&e(t,"t")||l).call(s,"Remove Screen",{name:"t",hash:{},data:o,loc:{start:{line:13,column:50},end:{line:13,column:72}}}))+'">\n                <i class="fa fa-times"></i>\n            </div>\n\n            <div class="make-default-screen-btn">\n                <i class="fa fa-star"></i>\n            </div>\n            <div class="duplicate-screen-btn" title="'+c((e(n,"t")||t&&e(t,"t")||l).call(s,"Duplicate Screen",{name:"t",hash:{},data:o,loc:{start:{line:20,column:53},end:{line:20,column:78}}}))+'">\n                <i class="fa fa-copy"></i>\n            </div>\n\n            <a class="camera" title="'+c((e(n,"t")||t&&e(t,"t")||l).call(s,null!=t?e(t,"Take"):t,null!=t?e(t,"Screenshot"):t,{name:"t",hash:{},data:o,loc:{start:{line:24,column:37},end:{line:24,column:58}}}))+'">\n                <i class="fa fa-camera"></i>\n            </a>\n        </div>\n\n        <div class="screen-name">\n            '+c(typeof(a=null!=(a=e(n,"name")||(null!=t?e(t,"name"):t))?a:l)==r?a.call(s,{name:"name",hash:{},data:o,loc:{start:{line:30,column:12},end:{line:30,column:20}}}):a)+"\n        </div>\n\n    </div>\n</div>"},useData:!0}),A.ScreenList=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="screen-list">\n        \x3c!--<div class="screen-list-header">'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"Screens",{name:"t",hash:{},data:o,loc:{start:{line:2,column:44},end:{line:2,column:59}}}))+'</div>--\x3e\n\n    <div class="list-scroll-wrap">\n        <ul></ul>\n    </div>\n\n    <div style="text-align: right;">\n        <div class="add-screen-button">\n            '+l((e(n,"t")||t&&e(t,"t")||s).call(a,"Add Screen",{name:"t",hash:{},data:o,loc:{start:{line:10,column:12},end:{line:10,column:31}}}))+"\n        </div>\n    </div>\n</div>"},useData:!0}),A.SubscriptionSelect=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<fieldset>\n    <span>\n        <label>Subscription:</label> \n        <label class="staticRadio"><input type="radio" name="_subscriptionType" class="static" value="static" checked>'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"Static",{name:"t",hash:{},data:o,loc:{start:{line:4,column:118},end:{line:4,column:132}}}))+'</label>\n        <label class="subscriptionRadio"><input type="radio" name="_subscriptionType" class="subscription" value="subscription">'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"Managed",{name:"t",hash:{},data:o,loc:{start:{line:5,column:128},end:{line:5,column:143}}}))+'</label>\n        <label class="streamingRadio"><input type="radio" name="_subscriptionType" class="streaming" value="streaming">'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"Streaming",{name:"t",hash:{},data:o,loc:{start:{line:6,column:119},end:{line:6,column:136}}}))+'</label>\n        <label class="pollingRadio"><input type="radio" name="_subscriptionType" class="polling" value="polling">'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"Polling",{name:"t",hash:{},data:o,loc:{start:{line:7,column:113},end:{line:7,column:128}}}))+'</label>\n        <label class="auto-execute-label" title="Auto-execute on parameter changes. For query mappers, also execute when loading the dashboard."><input class="auto-execute" type="checkbox">Auto-execute</label>\n    </span>\n    <div>\n        <span class="subscriptionParamInput">Interval: <span class="subscriptionIntervalContainer bbf-editor"></span>s</span>\n        <span class="subscriptionParamInput">Key: <select name="_subscriptionKey" class="subscriptionKey"></select></span>\n        <span class="subscriptionParamInput">Force Reset: <input name="_forceReset" class="_forceReset" type="checkbox" /></span>\n    </div>\n    <div class="legend-right">\n        <label class="server-paging" title="'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"Page and sort results on the server",{name:"t",hash:{},data:o,loc:{start:{line:16,column:44},end:{line:16,column:87}}}))+'">\n            <input type="checkbox" name="_serverPaging" />'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"Paged",{name:"t",hash:{},data:o,loc:{start:{line:17,column:58},end:{line:17,column:71}}}))+'\n        </label>\n        <label class="max-rows" title="'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"Specify the maximum number of row returned",{name:"t",hash:{},data:o,loc:{start:{line:19,column:39},end:{line:19,column:89}}}))+'">\n            Max rows:\n            <input name="_maxRows" class="_maxRows" type="number" min="0" max="10000" step="1" value="2000" />\n        </label>\n        <label class="page-size" title="'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"Specify the number of rows per page",{name:"t",hash:{},data:o,loc:{start:{line:23,column:40},end:{line:23,column:83}}}))+'">\n            Page size:\n            <input name="_pageSize" class="_pageSize" type="number" min="0" max="10000" step="1" value="2000" />\n        </label>\n    </div>\n</fieldset>'},useData:!0}),A.TemplateDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="sidebar">\n    <div class="topnav">\n        <i class=\'fa fa-search\'></i>\n        <input type=\'text\' class=\'searchBox\' placeholder="Search ..." />\n        <span class="clearSearch fa fa-times" style="display: none"></span>\n    </div>\n    <div class="tree"></div>\n</div>\n<div class="template-editor">\n    <div class="toolbar ui-widget-header ui-corner-right" id="htmlxEdit">\n    </div>\n    <div class="toolbar ui-widget-header ui-corner-right" id="advanced-toolbar" style="display: none;">\n        <button class="basic-mode" title="Return to Basic editor">Basic mode</button>\n        <select class="gok-handlebarselect"></select>\n        <button class="add-helper" title="Add element">Add Helper</button>\n        <button class="beautify" title="Automatically format code with indents and line breaks">Auto-format</button>\n    </div>\n    <div class="editor" style="background:'+c(typeof(a=null!=(a=e(n,"background")||(null!=t?e(t,"background"):t))?a:l)==r?a.call(s,{name:"background",hash:{},data:o,loc:{start:{line:18,column:42},end:{line:18,column:56}}}):a)+'">\n        <textarea id="'+c(typeof(a=null!=(a=e(n,"uid")||(null!=t?e(t,"uid"):t))?a:l)==r?a.call(s,{name:"uid",hash:{},data:o,loc:{start:{line:19,column:22},end:{line:19,column:29}}}):a)+'"></textarea>\n    </div>\n    <div class="code" style="display: none"></div>\n    <div class="handlebar-errors" style="display:none">\n        <span><i class="fa fa-exclamation-triangle"></i> Template error:</span>\n        <div></div>\n    </div>\n</div>'},useData:!0}),A.TooltipTemplateDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){return'<div class="toolbar ui-widget-header ui-corner-all" >\n    <table>\n        <tr>\n            <td><i class="fa fa-question-circle"></i></td>\n            <td style="padding: 0px 5px 0 25px;">\n                Value:\n            </td>\n            <td> <select class="tp-selectable js-example-basic-single"></select></td>\n\n            <td style="padding: 0px 5px 0 25px;">\n                Type:\n            </td>\n            <td>  \n                <div class="typeOfHandle">\n                 <input type="radio" id="div" checked="checked"><label for="div"><i class="fa fa-align-justify"></i></label>\n                 <input type="radio" id="li"><label for="li"><i class="fa fa-list-ul"></i></label>\n                 <input type="radio" id="td"><label for="td"><i class="fa fa-th-list"></i></label>\n                 <input type="radio" id="img"><label for="img"><i class="fa fa-picture-o"></i></label>\n                </div>\n            </td>\n            <td style="padding: 0px 5px 0 25px;">\n                Colour:\n            </td>\n            <td>\n                <label class="handlebar-colorPicker-tooltip" title="Pick Colour">\n                 <div class="handlebar-colorPicker">\n                        <i class="fa fa-square" style="color:#000000"></i>\n                 </div>\n                </label>\n            </td>\n            <td>\n                <label class="tp-selectable-add-tooltip" title="Add element">\n                    <div class="tp-selectable-add">\n                        <i class="fa fa-plus"></i>\n                    </div>\n                </label>\n            </td>\n        </tr>\n    </table>\n</div>\n<div class="code">\n    <textarea />\n</div>\n'},useData:!0}),A.TreeView=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="toolbar ui-widget-header ui-corner-all">\n    <button class="new">'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"New",{name:"t",hash:{},data:o,loc:{start:{line:2,column:24},end:{line:2,column:35}}}))+'</button>\n    <button class="rename">'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"Rename",{name:"t",hash:{},data:o,loc:{start:{line:3,column:27},end:{line:3,column:41}}}))+'</button>\n    <button class="delete">'+l((e(n,"t")||t&&e(t,"t")||s).call(a,"Delete",{name:"t",hash:{},data:o,loc:{start:{line:4,column:27},end:{line:4,column:41}}}))+'</button>\n    <div>\n        <i class="fa fa-search"></i>\n        <input class="search" />\n        <span class="clearSearch fa fa-times" style="display: none"></span>\n    </div>\n</div>\n<div class="tree"></div>\n'},useData:!0}),A.ViewStateDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){return'<div class="accordian-container" >\n    <div class="treeview">\n        <div class="tree"/>\n    </div>\n    <div class="viewstate-editor collapsible" >\n        <h3 class="ui-widget-header"><i class="fa fa-fw fa-caret-down"></i>Properties</h3>\n        <div class="properties">\n        </div>\n    </div>\n</div>'},useData:!0}),A.VirtualParameter=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="form-control">\n    \n    <label class="col1">'+c(typeof(a=null!=(a=e(n,"name")||(null!=t?e(t,"name"):t))?a:l)==r?a.call(s,{name:"name",hash:{},data:o,loc:{start:{line:3,column:24},end:{line:3,column:32}}}):a)+'</label>\n\n\t<div class="type-radio col2">\n        <input id="'+c(typeof(a=null!=(a=e(n,"uniqueId")||(null!=t?e(t,"uniqueId"):t))?a:l)==r?a.call(s,{name:"uniqueId",hash:{},data:o,loc:{start:{line:6,column:19},end:{line:6,column:31}}}):a)+'_datasource" type="radio" name="'+c(typeof(a=null!=(a=e(n,"uniqueId")||(null!=t?e(t,"uniqueId"):t))?a:l)==r?a.call(s,{name:"uniqueId",hash:{},data:o,loc:{start:{line:6,column:63},end:{line:6,column:75}}}):a)+'_parameter-type" value="datasource">\n        <label for="'+c(typeof(a=null!=(a=e(n,"uniqueId")||(null!=t?e(t,"uniqueId"):t))?a:l)==r?a.call(s,{name:"uniqueId",hash:{},data:o,loc:{start:{line:7,column:20},end:{line:7,column:32}}}):a)+'_datasource">Data Source</label>\n        \n        <input id="'+c(typeof(a=null!=(a=e(n,"uniqueId")||(null!=t?e(t,"uniqueId"):t))?a:l)==r?a.call(s,{name:"uniqueId",hash:{},data:o,loc:{start:{line:9,column:19},end:{line:9,column:31}}}):a)+'_viewstate" type="radio" name="'+c(typeof(a=null!=(a=e(n,"uniqueId")||(null!=t?e(t,"uniqueId"):t))?a:l)==r?a.call(s,{name:"uniqueId",hash:{},data:o,loc:{start:{line:9,column:62},end:{line:9,column:74}}}):a)+'_parameter-type" value="viewstate">\n        <label for="'+c(typeof(a=null!=(a=e(n,"uniqueId")||(null!=t?e(t,"uniqueId"):t))?a:l)==r?a.call(s,{name:"uniqueId",hash:{},data:o,loc:{start:{line:10,column:20},end:{line:10,column:32}}}):a)+'_viewstate">View State</label>\n\n        <input id="'+c(typeof(a=null!=(a=e(n,"uniqueId")||(null!=t?e(t,"uniqueId"):t))?a:l)==r?a.call(s,{name:"uniqueId",hash:{},data:o,loc:{start:{line:12,column:19},end:{line:12,column:31}}}):a)+'_text" type="radio" name="'+c(typeof(a=null!=(a=e(n,"uniqueId")||(null!=t?e(t,"uniqueId"):t))?a:l)==r?a.call(s,{name:"uniqueId",hash:{},data:o,loc:{start:{line:12,column:57},end:{line:12,column:69}}}):a)+'_parameter-type" value="text">\n        <label for="'+c(typeof(a=null!=(a=e(n,"uniqueId")||(null!=t?e(t,"uniqueId"):t))?a:l)==r?a.call(s,{name:"uniqueId",hash:{},data:o,loc:{start:{line:13,column:20},end:{line:13,column:32}}}):a)+'_text">Text</label>\n\t</div>\n\n\t<div class="input-div col3">\n\n\t\t<input class="value-input" type="text" value="'+c(typeof(a=null!=(a=e(n,"value")||(null!=t?e(t,"value"):t))?a:l)==r?a.call(s,{name:"value",hash:{},data:o,loc:{start:{line:18,column:48},end:{line:18,column:57}}}):a)+'" />\n\n\t\t<div class="binding-container">\n\t\t\t<i class="fa fa-fw watermark fa-eraser clear-binding"></i>\n            <i class="fa fa-fw watermark fa-database binding-icon"></i>\n\t\t\t<input class="value-display" type="text" value="'+c(typeof(a=null!=(a=e(n,"value")||(null!=t?e(t,"value"):t))?a:l)==r?a.call(s,{name:"value",hash:{},data:o,loc:{start:{line:23,column:51},end:{line:23,column:60}}}):a)+'" tabindex="-1" readonly />\n\t\t</div>\n\n\t</div>\n\n</div>'},useData:!0}),A.VirtualQuerySample=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a,s,l=null!=t?t:e.nullContext||{},r=e.hooks.helperMissing,c="function",e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"function (source, callback) {\n\n    // source is an object representing a data source, with the following properties:\n    // columns: an array of column names, for example,\n    // "+(null!=(a=typeof(s=null!=(s=e(n,"columns")||(null!=t?e(t,"columns"):t))?s:r)==c?s.call(l,{name:"columns",hash:{},data:o,loc:{start:{line:5,column:7},end:{line:5,column:20}}}):s)?a:"")+"\n\n    // meta: an object mapping column names to their kdb types\n    // "+(null!=(a=typeof(s=null!=(s=e(n,"meta")||(null!=t?e(t,"meta"):t))?s:r)==c?s.call(l,{name:"meta",hash:{},data:o,loc:{start:{line:8,column:7},end:{line:8,column:17}}}):s)?a:"")+"\n\n    // rows: an array of row objects, each one maps columns to values\n    // "+(null!=(a=typeof(s=null!=(s=e(n,"rows")||(null!=t?e(t,"rows"):t))?s:r)==c?s.call(l,{name:"rows",hash:{},data:o,loc:{start:{line:11,column:7},end:{line:11,column:17}}}):s)?a:"")+"\n\n    // you can perform operations on the source, generate values or fetch remote data using javascript\n    // when your are done pass an object in the same format as source to the callback function to return your data\n    \n    callback(source);\n\n}"},useData:!0}),A.app=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){return'<div class="toolbar editor-ui" />\n<div class="breadcrumbs-div" />\n<div class="components-panel unpinned" />\n<div class="properties-panel doc" contenteditable="false" />\n<div class="content-panel Dark components-unpinned" tabindex="0" />\n<div class="dialog-panel">\n    <div class="document" />\n    <div class="environment" />\n</div>\n<div class="notifications-div">\n\n</div>'},useData:!0}),A.dashboardDDL=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="dashboardDLLForm">\n     <fieldset>\n         <legend>'+l((e(n,"t")||t&&e(t,"t")||s).call(a," Select a Dashboard",{name:"t",hash:{},data:o,loc:{start:{line:3,column:17},end:{line:3,column:44}}}))+'</legend>\n         <span class="fa fa-search"></span>\n         <select class="tags"/>\n    </fieldset>\n    <fieldset class="screenFieldSet">\n        <legend>'+l((e(n,"t")||t&&e(t,"t")||s).call(a," Select a Screen",{name:"t",hash:{},data:o,loc:{start:{line:8,column:16},end:{line:8,column:40}}}))+'</legend>\n         <select class="tags-screens"/>\n    </fieldset>\n    </div>'},useData:!0}),A.paramatersDialog=Handlebars.template({1:function(e,t,n,i,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l="function",r=e.escapeExpression,c=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]},d='<div class="paramItem ',u=null!=(u=c(n,"required")||(null!=t?c(t,"required"):t))?u:s,p={name:"required",hash:{},fn:e.program(2,o,0),inverse:e.noop,data:o,loc:{start:{line:2,column:22},end:{line:2,column:56}}},h=typeof u==l?u.call(a,p):u;return null!=(h=c(n,"required")?h:e.hooks.blockHelperMissing.call(t,h,p))&&(d+=h),d+'">\n    <span class="paramName" data-id="'+r(typeof(u=null!=(u=c(n,"id")||(null!=t?c(t,"id"):t))?u:s)==l?u.call(a,{name:"id",hash:{},data:o,loc:{start:{line:3,column:37},end:{line:3,column:43}}}):u)+'" style="display: inline-block;width: 150px;font-weight:bold; margin-right: 5px">'+r(typeof(u=null!=(u=c(n,"id")||(null!=t?c(t,"id"):t))?u:s)==l?u.call(a,{name:"id",hash:{},data:o,loc:{start:{line:3,column:124},end:{line:3,column:130}}}):u)+'</span>\n    <input type="text" class="value" style="display: inline-block;margin-bottom: 10px; width: 200px;"/>\n    <span>'+r(typeof(u=null!=(u=c(n,"type")||(null!=t?c(t,"type"):t))?u:s)==l?u.call(a,{name:"type",hash:{},data:o,loc:{start:{line:5,column:10},end:{line:5,column:18}}}):u)+'</span>\n    <div class="paramDesc" data-id="'+r(typeof(u=null!=(u=c(n,"description")||(null!=t?c(t,"description"):t))?u:s)==l?u.call(a,{name:"description",hash:{},data:o,loc:{start:{line:6,column:36},end:{line:6,column:51}}}):u)+'" style="display: none;">'+r(typeof(u=null!=(u=c(n,"description")||(null!=t?c(t,"description"):t))?u:s)==l?u.call(a,{name:"description",hash:{},data:o,loc:{start:{line:6,column:76},end:{line:6,column:91}}}):u)+"</div>\n</div>\n"},2:function(e,t,n,i,o){return"required"},compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]},s=null!=(s=a(n,"ParamList")||(null!=t?a(t,"ParamList"):t))?s:e.hooks.helperMissing,o={name:"ParamList",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:1,column:0},end:{line:8,column:14}}},s="function"==typeof s?s.call(null!=t?t:e.nullContext||{},o):s;return null!=(s=a(n,"ParamList")?s:e.hooks.blockHelperMissing.call(t,s,o))?s:""},useData:!0}),A);function A(){}var DropzoneView=Backbone.View.extend({initialize:function(e){var t=this;this.documentImporter=e.documentImporter,this.router=e.router,this.$text=$("<p></p>").text("Drop dashboards to import  "),this.$icon=$("<i></i>").addClass("fa fa-upload"),this.$icon.appendTo(this.$text),this.$text.appendTo(this.$el),this.$el.on("dragover",function(e){e.preventDefault(),e.stopPropagation()}),this.$el.on("dragleave",function(e){$(e.fromElement).is("p")||$(e.toElement).is("p")||(t.$el.parent().removeClass("dragging"),e.preventDefault(),e.stopPropagation())}),this.$el.on("drop",function(e){e.stopPropagation(),e.preventDefault();e=_.filter(e.originalEvent.dataTransfer.files,function(e){return _.includes(["application/json","text/xml"],e.type)||""===e.type&&_.endsWith(e.name,".json")});t.documentImporter.importFiles(e,function(e){t.router.navigate(e,{trigger:!0})},function(e){QuickBase.ErrorDialog.ShowError(e,_.noop)}),t.$el.parent().removeClass("dragging")})}}),DRAFT_STATE={iconDraft:{true:" fa-circle-o",false:" fa-check-circle"},textDraft:{true:"Unmark as Draft",false:"Mark as Draft"}},DashboardListView=Backbone.View.extend({$dashName:null,$delete:null,$input:null,$nameErrorInfo:null,$open:null,$preview:null,$starred:null,$starredNot:null,$draftIconButton:null,appModel:null,className:"dashboard-list-view",debouncedUpdateNameAndTags:null,viewModel:null,compareTags:function(e,t){if(!t)return!1;if(e.length!=t.length)return!1;for(var n=0,i=e.length;n<i;n++)if(e[n]instanceof Array&&t[n]instanceof Array){if(!compareTags(e[n],t[n]))return!1}else if(e[n]!=t[n])return!1;return!0},hideInput:function(){var e;this.$input&&(e=this.$input,this.$input=null,e.blur(),e.off(),e.remove())},initialize:function(e){Handlebars.registerHelper("documentLocalDate",function(){var e=this.lastUpdateDate?moment(this.lastUpdateDate):moment();return e.format("DD/MM/YYYY HH:mm:ss")}),this.appModel=e.appModel,this.viewModel=e.viewModel,this.eventBus=e.eventBus,this.debouncedUpdateNameAndTags=_.debounce($.proxy(this.updateNameAndTags,this),500),this.render(),this.initializeEvents(),this.$el.attr("data-id",this.model.id),this.$el.attr("tabindex","0")},initializeEvents:function(){var n=this;this.$open.on("click",$.proxy(this.onOpen,this)),this.$preview.on("click",$.proxy(this.onPreview,this)),this.$delete.on("click",$.proxy(this.onDelete,this)),this.$dashName.on("click",$.proxy(this.onName,this)),this.$draftIconButton.on("click",$.proxy(this.updateDraftStatus,this)),this.listenTo(this.model,"change:name",this.onNameChanged),this.listenTo(this.model,"change:tags",this.onTagsChanged),this.$starred.on("click",function(e){e.stopPropagation(),e.preventDefault(),e=n.model.get("tags"),e=_.without(e,"starred"),n.model.set("tags",e),n.onTagsChanged(),n.debouncedUpdateNameAndTags()}),this.$starredNot.on("click",function(e){e.stopPropagation(),e.preventDefault(),e=n.model.get("tags").concat(["starred"]),n.model.set("tags",e),n.onTagsChanged(),n.debouncedUpdateNameAndTags()}),this.$isDefault.on("click",function(e){var t=n.model.get("tags");e.stopPropagation(),e.preventDefault(),_.includes(n.model.get("tags"),"defaultdash")||(t=n.model.get("tags").concat(["defaultdash"])),n.removeAllDefaultDashTags(),n.model.set({tags:t}),n.debouncedUpdateNameAndTags()}),this.$el.on("dblclick",$.proxy(this.onOpen,this)),this.$el.on("keydown",$.proxy(this.onKeyDown,this)),this.eventBus.on("dialog-resized",this.hideInput.bind(this))},isDraft:function(){return 0===this.model.get("name").indexOf("Draft")},onDelete:function(e){var i=this,t=this.$el.attr("data-id"),t=this.appModel.get("documents").get(t);"FSBL"in window&&t.id===window.finApi.documentId&&(window.finApi.dashRemoving=!0),t.destroy({success:function(e,t,n){console.log("document deleted without any issues",e,t,n);t=i.appModel.get("router").viewModel.get("selectedDocumentId");"FSBL"in window?_.debounce(function(){window.finApi.closeWindow(e.id)},10)():i.appModel.get("router").navigate(t,{trigger:!0})},error:function(e,t,n){console.log("document destroy error!",e,t,n)}})},onExport:function(e){var t=this.$el.attr("data-id"),n=this.appModel.get("documents").get(t),i=e?n.id:n.get("name"),o=this.appModel.get("isLite")?"json":"xml";t===this.viewModel.get("selectedDocumentId")?DashboardListView.exportModel(n,i,o):n.fetch({success:function(e){DashboardListView.exportModel(e,i,o)}.bind(this)})},onKeyDown:function(e){var t;"INPUT"===e.target.nodeName?13===e.keyCode?(e.preventDefault(),e.stopPropagation(),t=this.$input.val(),this.appModel.get("documents").findWhere({name:t})?this.showError.call(this,"Dashboard with this name already exists."):(this.model.set("name",t),this.hideInput(),this.debouncedUpdateNameAndTags())):27===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.hideInput()):32===e.keyCode||13===e.keyCode?(e.stopPropagation(),e.preventDefault(),this.trigger("keyboard-selection",this.$el),13===e.keyCode&&this.onOpen()):46===e.keyCode&&this.onDelete()},onName:function(e){e.preventDefault(),e.stopPropagation(),this.showInput()},onNameChanged:function(){this.$dashName.text(this.model.get("name")),this.updateDraftIconState.call(this)},onOpen:function(e){var t;this.trigger("closeDialog"),t=this.$el.attr("data-id"),Backbone.history.fragment===t?Backbone.history.loadUrl(t):this.appModel.get("router").navigate(t,{trigger:!0})},onPreview:function(e){this.$el.attr("data-id");var t=(this.appModel.get("websiteUrl")||"").replace("edit","#")+this.model.id;window.open(t,"_blank")},onTagsChanged:function(){_.includes(this.model.get("tags"),"starred")?(this.$starredNot.hide(),this.$starred.show()):(this.$starred.hide(),this.$starredNot.show()),_.includes(this.model.get("tags"),"defaultdash")?(this.$isDefault.addClass("active"),0<this.$el.siblings().length&&this.$el.siblings().find(".fa-home").removeClass("active")):this.$isDefault.removeClass("active")},render:function(){var e=this.model.get("name"),t=this.isDraft(),n=DRAFT_STATE.iconDraft[t],t=DRAFT_STATE.textDraft[t],e=_.extend({name:e,draftStateIcon:n,title:t},this.model.pick("lastUpdateDate"));this.$el.html(T.DashboardListView(e)),this.$open=this.$el.find(".open-dash"),this.$preview=this.$el.find(".preview-dash"),this.$delete=this.$el.find(".delete-dash"),this.$dashName=this.$el.find(".dash-name"),this.$isDefault=this.$el.find(".fa-home"),this.$starred=this.$el.find(".fa-star"),this.$starredNot=this.$el.find(".fa-star-o"),this.$nameErrorInfo=this.$el.find(".name-error-info"),this.$nameErrorInfo.hide(),this.$draftIconButton=this.$el.find(".dash-wip-icon"),this.onTagsChanged()},updateDraftIconState:function(){var e=this.isDraft();this.$draftIconButton.attr("class","dash-wip-icon fa"+DRAFT_STATE.iconDraft[e]),this.$draftIconButton.attr("title",DRAFT_STATE.textDraft[e])},remove:function(){this.$open.off(),this.$preview.off(),this.$delete.off(),this.$draftIconButton.off(),this.hideInput(),this.$el.off(),this.$el.remove()},removeAllDefaultDashTags:function(){var e,n=this;0<(e=this.appModel.get("documents").filter(function(e){return _.includes(e.get("tags"),"defaultdash")})).length&&_.each(e,function(e){var t;e!==n.model&&(t=_.without(e.get("tags"),"defaultdash"),e.fetch({success:function(e){e.set({tags:t},{silent:!0}),e.saveNow()}}))})},updateDraftStatus:function(){var e=this.model.get("name");e&&(e=this.isDraft()?e.substring(6).trim():"Draft: "+e,this.appModel.get("documents").findWhere({name:e})?this.showError.call(this,"Dashboard with this name already exists."):(this.model.set("name",e),this.debouncedUpdateNameAndTags()))},showError:function(e){this.$nameErrorInfo.text(t(e)),this.$nameErrorInfo.fadeIn(function(){$(this).delay(3e3).fadeOut("slow")})},showInput:function(){var t=this,e=this.$dashName.position(),n=this.$el.width()-this.$el.find(".right-side-span").width()-50,i=this.$dashName.height()+4;this.$input=$(document.createElement("input")),this.$input.addClass("name-input"),this.$input.css({left:e.left,top:e.top-4,width:n,height:i}),this.$input.val(this.model.get("name")),this.$input.appendTo(this.$el.find(".tile-content")),this.$input.focus(),this.$input.select(),this.$input.on("keydown",$.proxy(this.onKeyDown,this)),this.$input.on("focusout",function(e){t.hideInput()})},updateNameAndTags:function(){var s=this;new QuickBase.Document({id:this.model.id}).fetch({success:function(t){var e=t.get("name"),n=s.model.get("name"),i=t.get("tags"),o=$.extend(!0,[],s.model.get("tags")),a=!1;s.viewModel.get("selectedDocumentId")===s.model.id?(a=!0,t=s.model):(e!==n&&(t.set("name",n),a=!0),s.compareTags(i,o)||(t.set("tags",o),a=!0)),a&&t.saveNow(function(e){t.set("name",oldname),s.showError.call(s,e)},function(){var e;"FSBL"in window&&(window.finApi.dashRenamed=oldname,e=_.map(t.collection.models,function(e){return _.pick(e.toJSON(),["name","id"])}),window.finApi.applyUserConfig(window.finApi.generateConfig(e,!0)))})},error:function(e,t){QuickBase.Log.Error("Error fetching dashboards model",t)}})}},{exportModel:function(e,t,n){function i(e){return e.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;")}var o,a,s=e.toJSONClone(),l=document.createElement("a"),r=(e="xml"===n?(a="data:application/xml;charset=utf-8","<ui>\r\n\t<name>"+e.id+"</name>\r\n\t<displayName>"+i(e.get("name"))+"</displayName>\r\n\t<description>"+i(JSON.stringify(_.pick(s,"creationDate","lastUpdateDate","tags"),null,2))+"</description>\r\n\t<data>"+i(JSON.stringify(s,null,2))+"</data>\r\n</ui>"):(a="data:application/json;charset=utf-8",JSON.stringify(s,null,2)),t+"."+n);window.Blob?(o=new Blob([e],{type:a}),window.navigator.msSaveOrOpenBlob?l.onclick=function(){window.navigator.msSaveOrOpenBlob(o,r)}:void 0!==l.download&&l.setAttribute("href",URL.createObjectURL(o))):l.setAttribute("href",encodeURI(a+","+e)),void 0!==l.download&&l.setAttribute("download",r),document.body.appendChild(l),l.click(),document.body.removeChild(l)}}),MessageDialog=Backbone.View.extend({className:"confirm-dialog",initialize:function(e){var n=this;n.options=e,n.$el.html(T.MessageDialog(e)),n.$dialog=n.$el.dialog(_.extend({appendTo:e.container,title:t("Confirm"),resizable:!0,height:190,width:360,minWidth:300,modal:!0,autoOpen:!0,buttons:[{text:t("OK"),click:$.proxy(n.onOKButtonClick,n),icons:{primary:"fa fa-check"}},{text:t("Cancel"),click:n.close.bind(n),icons:{primary:"fa fa-times"}}],close:function(){n.remove()},open:function(){$('<i class="fa fa-question-circle" />').insertBefore(n.$el.parent().find(".ui-dialog-title"))}},e)),LocalTools.moveDialogOnTop(n.$dialog.parent())},close:function(){this.$el.dialog("close")},onOKButtonClick:function(){this.$dialog.dialog("close")}}),ManageDashWindow=Backbone.View.extend({$closeButton:null,$dashboardsList:null,$dialog:null,$searchInput:null,$sortNameUp:null,$sortNameDown:null,$sortDateUp:null,$sortDateDown:null,searchClear:null,appModel:null,className:"quick-dash window manage-window",filterName:null,filterTags:null,selected:null,sortOrder:null,sortDirection:null,viewModel:null,views:null,initialize:function(e){this.views=[],this.options=e,this.appModel=e.appModel,this.container=e.container,this.viewModel=e.viewModel,this.filterTags=["all"],this.sortOrder="byLatest",this.sortDirection="descending",this.eventBus=_.extend({},Backbone.Events),this.render(),this.initializeEvents(),this.onSelected(null),this.filterNow()},initializeEvents:function(){var t=this;this.$el.on("click",$.proxy(this.onClose,this)),this.listenTo(this.appModel.get("documents"),"sort remove add",this.updateList.bind(this)),this.$searchInput.on("input",t.onSearchInput.bind(t)),this.$searchClear.on("click",t.onClearSearch.bind(t)),this.$searchInput.on("keydown",function(e){27===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.$searchInput.val(""),this.filterName=null,this.updateList())}.bind(this)),this.$el.find(".open").click(function(){t.selected.onOpen()}),this.$el.find(".view").click(function(){t.selected.onPreview()}),this.$el.find(".delete").click(function(){window.confirm("Do you want to delete this dashboard?")&&t.selected.onDelete()}),this.$el.find(".export").click(function(e){t.selected.onExport(e.altKey)}),this.$el.find(".import").click(function(e){t.$el.find("#dashImportFile").click()}),this.$el.find("#dashImportFile").change(t.onImportFileChange.bind(t))},addDocuments:function(){var t,n=this,e=this.filterNow();this.views.length&&(_.each(this.views,function(e){e.remove()}),this.views=[]),_.each(e,function(e){(t=new DashboardListView({model:e,appModel:n.appModel,viewModel:n.viewModel,eventBus:n.eventBus})).$el.appendTo(n.$dashboardsList),n.views.push(t),n.listenTo(t,"keyboard-selection",function(e){n.onBeforeSelected(e)}),n.listenTo(t,"closeDialog",n.remove),n.listenTo(t.model,"change:name",function(){n.selected&&n.selected.$el&&n.onBeforeSelected(n.selected.$el)})})},clearFileInput:function(e){try{e.value=null}catch(e){}e.value&&e.parentNode.replaceChild(e.cloneNode(!0),e)},filterNow:function(){var t,e=this.appModel.get("documents").models;return _.includes(this.filterTags,"recent")&&((e=_.sortBy(e,function(e){var t=e.get("lastUpdateDate");return t=t||e.get("creationDate"),new Date(t)})).reverse(),e=_.take(e,10)),_.includes(this.filterTags,"starred")&&(e=_.filter(e,function(e){return _.includes(e.get("tags"),"starred")})),this.filterName&&0<this.filterName.length&&(t=this.filterName.toLowerCase(),e=_.filter(e,function(e){return-1<e.get("name").toLowerCase().indexOf(t)})),"byLatest"===this.sortOrder?e=_.sortBy(e,function(e){var t=e.get("lastUpdateDate");return t=t||e.get("creationDate"),new Date(t)}):"byName"===this.sortOrder&&(e=_.sortBy(e,function(e){return e.get("name").toLowerCase()})),"descending"===this.sortDirection&&e.reverse(),e},onBeforeSelected:function(e){var t;e.addClass("ui-selected").siblings().removeClass("ui-selected"),e.focus(),(t=e.attr("data-id"))&&(e=_.find(this.views,function(e){return e.model.id===t}),this.onSelected(e))},onClearSearch:function(){this.$searchInput.val(""),this.onSearchInput()},onImportFileChange:function(e){var t=this;this.appModel.documentImporter.importFiles(_.filter(e.target.files,function(e){return _.includes(["application/json","text/xml"],e.type)||""===e.type&&_.endsWith(e.name,".json")}),function(){t.clearFileInput(t.$el.find("#dashImportFile")[0])},function(e){t.clearFileInput(t.$el.find("#dashImportFile")[0]),QuickBase.ErrorDialog.ShowError(e,_.noop)})},onSearchInput:function(){this.filterName=this.$searchInput.val(),this.updateList(),this.toggleHideSearch()},onSelected:function(e){this.selected=e,this.$el.find(".open").button("option","disabled",!e),this.$el.find(".view").button("option","disabled",!e||e.isDraft()),this.$el.find(".delete").button("option","disabled",!e),this.$el.find(".export").button("option","disabled",!e)},remove:function(){this.stopListening(),this.$searchClear.off(),this.$searchInput.off(),this.$el.off(),this.removeListElements(),this.trigger("close"),this.$dashboardsList&&this.$dashboardsList.data("uiSelectable")&&this.$dashboardsList.selectable("destroy"),this.$dialog&&this.$dialog.data("uiDialog")&&this.$dialog.dialog("destroy"),Backbone.View.prototype.remove.apply(this,arguments)},removeListElements:function(){this.onSelected(null),_.each(this.views,function(e){e.remove()})},render:function(){var n=this,e=Tools.calcDialogHeight(400,"dataDialog"),i=e<400?"top":"center";this.$el.html(T.ManageDashWindow({radio1:_.uniqueId("radio_"),radio2:_.uniqueId("radio_"),radio3:_.uniqueId("radio_")})),this.$contentContainer=this.$el.find(".content-container"),this.$dashboardsList=this.$el.find(".dashboards-list"),this.$searchInput=this.$el.find(".search-input"),this.$sortNameUp=this.$el.find(".name-sort .fa-caret-up"),this.$sortNameUp.hide(),this.$sortNameDown=this.$el.find(".name-sort .fa-caret-down"),this.$sortNameDown.hide(),this.$sortDateUp=this.$el.find(".last-modified-sort .fa-caret-up"),this.$sortDateUp.hide(),this.$sortDateDown=this.$el.find(".last-modified-sort .fa-caret-down"),this.$searchClear=this.$el.find(".clearSearch"),this.$el.find(".open").button({icons:{primary:"fa fa-play"}}).hide(),this.$el.find(".view").button({icons:{primary:"fa fa-globe"}}),this.$el.find(".delete").button({icons:{primary:"fa fa-trash"}}),this.$el.find(".import").button({icons:{primary:"fa fa-upload"},text:!1}),this.$el.find(".export").button({icons:{primary:"fa fa-download"},text:!1}),this.$dashboardsList.selectable({autoRefresh:!0,filter:">*",cancel:".dash-name,i,.ui-selected,.title-content",selected:function(e,t){n.onBeforeSelected($(t.selected))},unselected:function(){n.onSelected(null)}}),this.$dialog=this.$el.dialog(_.extend({appendTo:this.container,dialogClass:"quick-dash manage-dashboards",title:t("Dashboards"),resizable:!0,height:e,width:750,position:{my:"center",at:i,of:"#appdiv",collision:"fit"},modal:!0,autoOpen:!0,draggable:!0,buttons:[{text:t("Open"),click:function(){n.selected&&n.selected.onOpen()},icons:{primary:"fa fa-play"}},{text:t("Cancel"),click:function(){$(this).dialog("close")},icons:{primary:"fa fa-times"}}],open:function(){$('<i class="fa fa-list-alt" />').insertBefore(n.$el.parent().find(".ui-dialog-title")),n.updateList()},close:function(){n.remove(),Backbone.history.loadUrl()},resize:function(){n.eventBus.trigger("dialog-resized")}},n.options)),"FSBL"in window&&n.$el.parent().css("margin-top",window.finApi.DIALOGS_TOP_MARGIN),this.$el.find(".name-sort").on("click",$.proxy(this.nameSortClicked,this)),this.$el.find(".last-modified-sort").on("click",$.proxy(this.lastModifiedSortClicked,this))},nameSortClicked:function(){"byLatest"===this.sortOrder?(this.sortOrder="byName",this.$sortDateDown.hide(),this.$sortDateUp.hide(),("descending"===this.sortDirection?this.$sortNameDown:this.$sortNameUp).show()):"descending"===this.sortDirection?(this.sortDirection="ascending",this.$sortNameDown.hide(),this.$sortNameUp.show()):(this.sortDirection="descending",this.$sortNameUp.hide(),this.$sortNameDown.show()),this.updateList()},lastModifiedSortClicked:function(){"byName"===this.sortOrder?(this.sortOrder="byLatest",this.$sortNameDown.hide(),this.$sortNameUp.hide(),("descending"===this.sortDirection?this.$sortDateDown:this.$sortDateUp).show()):"descending"===this.sortDirection?(this.sortDirection="ascending",this.$sortDateDown.hide(),this.$sortDateUp.show()):(this.sortDirection="descending",this.$sortDateUp.hide(),this.$sortDateDown.show()),this.updateList()},toggleHideSearch:function(){this.$searchInput&&this.$searchInput.val()?this.$searchClear.show():this.$searchClear.hide()},updateList:function(){this.removeListElements(),this.addDocuments(),this.appModel.get("documents").length<=1?this.$el.find(".manage-documents-toolbar .delete").addClass("disabled"):this.$el.find(".manage-documents-toolbar .delete").removeClass("disabled")}}),LoadingScreen=Backbone.View.extend({className:"quick-dash loadingScreen",loadText:null,initialize:function(e){this.loadText=e.loadingText,this.render()},render:function(){return this.$el.html(T.LoadingScreen({text:this.loadText})),this.$el.hide(),this.$el.fadeIn(),this}}),DashboardNamePrompt=Backbone.View.extend({$closeButton:null,$dialog:null,$nameInput:null,$wip:null,$tooltip:null,$dashExistsInfo:null,appModel:null,create:!1,className:"quick-dash window dashboard-name-prompt",initialize:function(e){function n(e,t,n){return{text:e,click:t,icons:{primary:"fa fa-"+n}}}var i=this,o=[];this.appModel=e.appModel,this.container=e.container,this.$el.html(T.DashboardNamePrompt(this.model.toJSON())),this.$nameInput=this.$el.find(".name-input"),this.$wip=this.$el.find(".work-in-progress"),this.$tooltip=this.$el.find(".wip-tooltip"),this.$dashExistsInfo=this.$(".dash-exist-info"),this.$dashExistsInfo.hide();e.saveAs?o.push(n(t("Save As..."),function(){i.onOk()},"file-o")):(o.push(n(t("New"),function(){i.onOk()},"file-o")),o.push(n(t("Duplicate"),function(){i.onDuplicate()},"files-o"))),o.push(n(t("Cancel"),function(){$(this).dialog("close")},"times")),this.$dialog=this.$el.dialog(_.extend({appendTo:this.container,dialogClass:"quick-dash newdashboard-dialog",title:e.saveAs?t("Save As..."):t("New Dashboard"),resizable:!1,height:150,width:311,modal:!0,autoOpen:!0,draggable:!1,buttons:o,closeOnEscape:!this.forced,open:function(){i.forced&&$(this).parent().find(".ui-dialog-titlebar-close").hide(),$('<i class="fa fa-file-o" />').insertBefore(i.$el.parent().find(".ui-dialog-title")),i.$nameInput.select(),i.$nameInput.focus(),$.cookie("dashboard-work-in-progress")||$.cookie("dashboard-work-in-progress",!1,{expires:90,path:"/"}),String(i.$wip.prop("checked"))!=$.cookie("dashboard-work-in-progress")&&i.updateWIPState(),i.$nameInput.on("keyup",function(e){0===i.$nameInput.val().indexOf("Draft:")?$.cookie("dashboard-work-in-progress",!0,{expires:90,path:"/"}):$.cookie("dashboard-work-in-progress",!1,{expires:90,path:"/"}),i.updateWIPState(),13==e.keyCode&&(e.preventDefault(),e.stopPropagation(),i.onOk.call(i))}),i.$wip.change(function(e){$.cookie("dashboard-work-in-progress",e.target.checked,{expires:90,path:"/"}),i.$tooltip.hide(),i.updateWIPState()}),i.$el.find(".wip-icon").hover(function(){var e="true"===$.cookie("dashboard-work-in-progress")?"Unmark as Draft":"Mark as Draft";i.$tooltip.html(e),i.$tooltip.show()},function(){i.$tooltip.hide()})},close:function(){i.remove()}},e))},onDuplicate:function(){this.duplicate=!0,this.onOk()},onOk:function(){var t=DOMPurify.sanitize(this.$nameInput.val().trim());0<(t=0===t.indexOf("Draft:")?t.substring(6).trim():t).length&&(this.appModel.get("documents").find(function(e){e=e.attributes.name.trim();return e===t||e==="Draft:"+t||e==="Draft: "+t})?this.$dashExistsInfo.fadeIn(function(){$(this).delay(3e3).fadeOut("slow")}):(this.create=!0,this.$dialog.dialog("close")))},remove:function(){this.stopListening(),this.$nameInput.off(),this.$wip.off(),this.$dialog&&this.$dialog.dialog("destroy"),Backbone.View.prototype.remove.apply(this),this.trigger("close",{create:this.create,duplicate:this.duplicate,name:this.$nameInput.val()})},updateWIPState:function(){"true"===$.cookie("dashboard-work-in-progress")?(this.$wip.prop("checked",!0),0!==this.$nameInput.val().indexOf("Draft:")&&this.$nameInput.val("Draft: "+this.$nameInput.val())):(this.$wip.prop("checked",!1),0===this.$nameInput.val().indexOf("Draft:")&&this.$nameInput.val(this.$nameInput.val().substring(6).trim()))}}),Log=QuickBase.Log,LoginHistoryDialog=Backbone.View.extend({$dialog:null,close:function(){this.$dialog.dialog("close")},dataGridStuff:(bk=["pk","time","machineID","status","url"],ck=[11,15,11,11,11],dk=["pk","Time","Machine Id","Status","Url"],ek=["pk"],{generateDatagridConfig:function(e){return this.Datagrid=e,(e=new QuickBase.DocumentDataModel({_subscriptionKey:"pk",_dataType:"copy",_maxRows:1e6})).apply(),e.onExecuteSuccess(this.getResponse(),!0),new Backbone.Model({data:e,columnsConfig:this.getColumnsConfiguration(),datagridConfig:this.datagridConfiguration(),sortColumns:this.sortColumns})},datagridConfiguration:function(){return{Selection:{Mode:"Multi Row"}}},columnsConfiguration:function(){var n;return MAP={1:"Boolean",14:"Date",15:"DateTime",19:"Time"},n=function(e){return MAP[e]||"General"},_.map(bk,function(e,t){return{Field:e,DisplayName:dk[t],Sortable:!0,Hidden:_.includes(ek,bk[t]),Format:n(ck[t])}})},getResponse:function(e){return{rows:e||[],columns:bk,meta:_.zipObject(bk,ck)}},getColumnsConfiguration:function(){var e=this.columnsConfiguration(),t=this;return _.map(e,function(e){return _.extend({},t.Datagrid.getColumnSettingsModel(),{DisplayName:e.Field,TextAlign:"left",IsReadonly:!0,MinWidthAbsolute:100},e)})},sortColumns:[{sortCol:"time",sortAsc:!1}]}),getLoginHistory:function(){var t=this;QuickBase.DeltaClientLib.getAPIQueryData("kdb",void 0,".session.getLogins",[{IsKdbParam:!0,i:0,index:0,name:"user",type:"symbol",value:QuickBase.DeltaClientLib.deltaClient.user()},{IsKdbParam:!0,i:1,index:1,name:"clientType",type:"symbol"}],function(e){t.dgSourceModel.onExecuteSuccess(t.dataGridStuff.getResponse(_.map(e.rows,function(e){return _.extend({pk:_.uniqueId()},_.pick(e,"machineID","status","time","url"))})),!0),t.hideLoadingScreen(),t.onResize()},function(e){console.log("getLoginHistory session get logins error",e)},100,!1)},hideLoadingScreen:function(){this.$loadingScreen&&(this.$loadingScreen.fadeOut(function(){$(this).remove()}),this.$loadingScreen=null)},initialize:function(e){var n=this;n.$el.html(T.LoginHistoryDialog()),n.showLoadingScreen(),n.initializeDataGrid(),this.$dialog=this.$el.dialog(_.extend({dialogClass:"quick-base login-history-dialog",title:t("Login History"),resizable:!0,height:302,width:552,modal:!0,autoOpen:!0,draggable:!0,buttons:[{text:t("OK"),click:$.proxy(n.close,n),icons:{primary:"fa fa-check"}}],open:function(){$('<i class="fa fa-history" />').insertBefore(n.$el.parent().find(".ui-dialog-title"))},close:function(){_.isFunction(e.onClose)&&e.onClose(),n.remove()},resize:$.proxy(this.onResize,this)},e))},initializeDataGrid:function(e){var n=this;require(["Datagrid"],function(e){var t=n.dataGridStuff.generateDatagridConfig(e);n.dgSourceModel=t.get("data"),n.dgSource=new e.Master({el:n.$(".grid-div"),model:t}),n.getLoginHistory()})},onResize:function(){this.dgSource&&this.dgSource.onResize()},remove:function(){this.dgSource.off(),this.dgSource.remove(),Backbone.View.prototype.remove.apply(this)},showLoadingScreen:function(e){e=new LoadingScreen({loadingText:e});e.$el.appendTo(this.$el),this.$loadingScreen=e.$el}}),bk,ck,dk,ek,CustomEvents=(Dk.prototype.on=function(e,t,n){},Dk.prototype.off=function(e,t,n){},Dk.prototype.trigger=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]},Dk.prototype.bind=function(e,t,n){},Dk.prototype.unbind=function(e,t,n){},Dk.prototype.once=function(e,t,n){},Dk.prototype.listenTo=function(e,t,n){},Dk.prototype.listenToOnce=function(e,t,n){},Dk.prototype.stopListening=function(e,t,n){},Dk);function Dk(){_.extend(this,Backbone.Events)}var ButtonMenu=(dl.prototype.initCombo=function(e){var t=this;this.$cmbCommands=$("<select class='button-menu'></select>"),this.$btn.before(this.$cmbCommands),this.$cmbCommands.select2({minimumResultsForSearch:1e3,theme:"button-menu"}),this.$cmbCommands.on("select2:select",function(){t.isBusy||e(t.$cmbCommands.val())}),this.$cmbCommands.on("select2:open",function(){$("body > .select2-container--button-menu").addClass("select2--environment")})},dl.prototype.showMenu=function(e){var n="<option></option>";_.each(e,function(e,t){n+='<option value="'+t+'">'+e+"</option>"}),this.$cmbCommands.val("").trigger("change"),this.$cmbCommands[0].innerHTML=n,this.$cmbCommands.trigger("change").select2("open")},dl.prototype.initClickAndPress=function(e,t,n){var i=this;e.mousedown(function(){i.longPressTimerId=setTimeout(function(){i.longPressTimerId=null,e.button("option","disabled")||i.showMenu(n())},dl.LONG_PRESS_DURATION)}).on("mouseup mouseout",function(){null===i.longPressTimerId?(i.clickEnabled=!1,_.defer(function(){i.clickEnabled=!0})):(clearTimeout(i.longPressTimerId),i.longPressTimerId=null)}).click(function(){i.clickEnabled&&t.call(i)})},dl.LONG_PRESS_DURATION=500,dl);function dl(e,t,n,i){this.isBusy=!1,this.clickEnabled=!0,this.longPressTimerId=null,this.$btn=e,this.initClickAndPress(e,t,i),this.initCombo(n)}var EditorCommand=function(e){this.title=e=void 0===e?null:e},UndoRedoManager=(ul=CustomEvents,__extends(vl,ul),vl.prototype.initializeEvents=function(){this.listenTo(this.viewModel,"change:commandIndex",this.updateButtonStates)},vl.prototype.onSelect=function(e){e=parseInt(e.replace(/^\D+/g,""),10);this.viewModel.goToCommandIndex(e)},vl.prototype.clear=function(){this.updateButtonStates()},vl.prototype.getButtonMethod=function(e){return e?"enable":"disable"},vl.prototype.getOptions=function(e){var t=this.viewModel.get("commands"),n=this.viewModel.get("commandIndex"),i={};if(e)for(var o=n;0<=o;o--)i["_"+o]=t[o].title;else for(o=n+1;o<t.length;o++)i["_"+o]=t[o].title;return i},vl.prototype.onClickRedo=function(){this.redoCommand(),this.updateButtonStates()},vl.prototype.onClickUndo=function(){this.undoCommand(),this.updateButtonStates()},vl.prototype.redoCommand=function(){this.isBusy||this.$btnRedo.button("option","disabled")||(this.isBusy=!0,this.viewModel.redo(),this.isBusy=!1)},vl.prototype.undoCommand=function(){this.isBusy||this.$btnUndo.button("option","disabled")||(this.isBusy=!0,this.viewModel.undo(),this.isBusy=!1)},vl.prototype.updateButtonStates=function(){var e=this.viewModel.get("commands"),t=this.viewModel.get("commandIndex"),n=!1,i=!1;null!==t&&e.length&&(0<=t&&(i=!0),t!==e.length-1&&(n=!0)),this.$btnRedo.button(this.getButtonMethod(n)).toggle(n),this.$btnUndo.button(this.getButtonMethod(i))},vl),ul;function vl(e){function t(e){return{icons:{primary:"fa "+e},text:!1,disabled:!0}}var n=ul.call(this)||this;n.isBusy=!1,n.viewModel=e.viewModel,n.$btnRedo=e.$btnRedo,n.$btnUndo=e.$btnUndo;return n.$btnRedo.button(t("fa-repeat")).hide(),n.$btnUndo.button(t("fa-undo")),n.redoBtn=new ButtonMenu(n.$btnRedo,n.onClickRedo.bind(n),n.onSelect.bind(n),function(){return n.getOptions(!1)}),n.undoBtn=new ButtonMenu(n.$btnUndo,n.onClickUndo.bind(n),n.onSelect.bind(n),function(){return n.getOptions(!0)}),n.updateButtonStates(),n.initializeEvents(),n}var MainToolbar=Backbone.View.extend({$profileButton:null,$profileMenu:null,$loadingScreen:null,$newDash:null,$openDash:null,$saveDash:null,$saveDashAs:null,appModel:null,manageDashWindow:null,viewModel:null,documentSelector:null,undoRedoManager:null,initialize:function(e){var n=this,t=(this.options=e,this.appModel=e.appModel,this.dialogContainer=e.dialogContainer,this.viewModel=e.viewModel,this.appModel.set("hideToolbar","FSBL"in window),this.$el.html(T.MainToolbar(this.appModel.toJSON())),this.documentSelector=new QuickBase.DocumentSelector({el:this.$el.find(".document-selector"),appModel:this.appModel,viewModel:e.viewModel,showManage:!0}),this.$newDash=this.$el.find(".new-dash"),this.$newDash.button({icons:{primary:"fa fa-file-o"},text:!1}).click($.proxy(this.onNewDash,this)),this.$saveDash=this.$el.find(".save-dash"),this.$saveDash.button({icons:{primary:"fa fa-floppy-o"},text:!1}),new ButtonMenu(this.$saveDash,this.onSaveDash.bind(this),function(e){"sa"==e?this.onSaveDashAs():"ex"==e&&this.onExportDash()}.bind(this),function(){return{sa:"Save As...",ex:"Export"}}),$("<span />").addClass("save-pending fa fa-asterisk").appendTo(this.$saveDash),$("<span />").addClass("save-in-progress fa fa-spinner fa-pulse").appendTo(this.$saveDash),this.$connectionStatus=this.$el.find(".connectionStatus"),this.appModel.set("undoRedoManager",this.undoRedoManager=new UndoRedoManager({$btnUndo:this.$(".undo-action"),$btnRedo:this.$(".redo-action"),appModel:this.appModel,viewModel:this.viewModel})),this.$el.find(".content-toggle > input").button().click(function(){n.viewModel.set("buildMode",!n.viewModel.get("buildMode"))}),n.viewModel.get("buildMode")||(this.$el.find(".content-toggle > input").prop("checked",!0),this.$el.find(".content-toggle > label").toggleClass("ui-state-active",!0)),this.$profileButton=this.$el.find(".profile > button"),this.$profileMenu=this.$el.find(".profile > .profile-menu"),this.$profileButton=this.$el.find(".profile > button").button({text:!0,icons:{secondary:"ui-icon-triangle-1-s"}}).click(function(){return n.$profileMenu.toggle(),n.$profileMenu.css("position","absolute"),n.$profileMenu.position({my:"right top",at:"right bottom",of:this}),$(document).on("click",function(){n.$profileMenu.hide()}),!1}),this.$toolbarToggle=this.$el.find(".toolbar-toggler"),this.$toolbarToggle.on("click",function(e){n.appModel.set("hideToolbar",!n.appModel.get("hideToolbar"))}),this.appModel.get("isLite")?this.initProfileMenu():$(QuickBase.DeltaClientLib).one("DeltaClientLogin",$.proxy(this.initProfileMenu,this)),this.listenTo(this.appModel,"change:userName",function(e,t){n.$el.find(".user-name").text(t)}),this.listenTo(this.viewModel,"change:selectedDocumentId",this.onSelectedDocumentIdChanged),this.listenTo(this.documentSelector,"manage",this.openDashManagerWindow),function(){$(QuickBase.DeltaClientLib).one("DeltaClientDisconnect",function(){n.changeConnectionStatus(!1),$(QuickBase.DeltaClientLib).one("DeltaClientConnect",function(){n.changeConnectionStatus(!0),t()})})});t(),$(window).on("keydown",$.proxy(this.onKeyDown,this))},createDashboard:function(o,a){var s=this;return new Promise(function(t,n){var i=s,e=s.getNewDashModel({name:a});return o&&e.set("id",o),i.$saveDash.addClass("saving"),e.saveNow(function(e,t){Log.Error("error creating dashboard",e),i.$saveDash.removeClass("saving"),MainToolbar.ShowError_unableToCreateNewDashboard(t),i.hideLoadingScreen(),n(e)},function(e){i.$saveDash.removeClass("saving"),e.set("wasChanged",!1),i.appModel.get("documents").add(e,{at:0}),i.hideLoadingScreen(),t(e.id)}),e})},initProfileMenu:function(){this.profileMenu=new QuickBase.ProfileMenu({appModel:this.appModel,dialogContainer:this.dialogContainer,themes:this.options.themes,viewModel:this.viewModel}),this.$profileMenu.html(this.profileMenu.$el),this.listenTo(this.profileMenu,"themeChange",function(){this.trigger("themeChange")}.bind(this)),this.listenTo(this.profileMenu,"login-history",function(){this.onLoginHistory()}.bind(this)),this.$profileMenu.hide()},getNewDashModel:function(e){var t=!0,n="My New Dashboard",i=1,o=this.appModel.get("documents");e&&e.name&&(n=e.name);for(var a=n;o.some(function(e){e=e.get("name");return(e=0===e.indexOf("Draft:")?e.substring(6).trim():e)===n})?(n=a+" ("+i+")",i+=1):t=!1,t;);return(e=$.extend(e||{},{name:n,creationDate:(new Date).toUTCString(),id:null,lastUpdateDate:null}))&&e.screens&&e.screens.each(function(e){e.set("id",QuickBase.Helpers.getGUID())}),new QuickBase.Document(e)},changeConnectionStatus:function(e){var t=this;e?(t.$connectionStatus.html('<span class="fa fa-info-circle"></span>Delta Client has reconnected'),t.$connectionStatus.css({color:"#03B103",display:"inline-block"}),_.delay(function(){t.$connectionStatus.hide()},7e3)):(t.$connectionStatus.html('<span class="fa fa-warning"></span>Delta Client connection has been lost, reconnecting...'),t.$connectionStatus.css({color:"#FF6262",display:"inline-block"}))},getSelectedDoc:function(){var e=this.viewModel.get("selectedDocumentId");return this.appModel.get("documents").get(e)},getViewstate:function(){var e=this.getSelectedDoc().get("viewState").getViewStateList(!0),t={};return _.each(e,function(e){t[e.path]=e.model.get("value")}),t},hideLoadingScreen:function(){this.$loadingScreen&&(this.$loadingScreen.fadeOut(function(){$(this).remove()}),this.$loadingScreen=null)},onDocumentChanged:function(e){this.$saveDash.addClass("changed")},onDocumentSaved:function(){this.$saveDash.removeClass("changed")},onExportDash:function(){var e=this.getSelectedDoc();DashboardListView.exportModel(e,e.get("name"),this.appModel.get("isLite")?"json":"xml")},onKeyDown:function(e){var t=!0;if(!$(".ui-dialog-content:visible").length){if((e.ctrlKey||e.metaKey)&&(QuickBase.DeltaClientLib.clientLoggedIn||this.appModel.get("isLite")))switch(e.keyCode){case 78:this.onNewDash();break;case 79:this.onOpenDash();break;case 83:this.onSaveDash();break;case 89:this.undoRedoManager.redoCommand();break;case 90:this.undoRedoManager.undoCommand();break;default:t=!1}else t=!1;t&&(e.preventDefault(),e.stopPropagation())}},onLoginHistory:function(){new LoginHistoryDialog({appModel:this.appModel})},onNewDash:function(e){var e=e&&e.force,t=this.getNewDashModel();this.saveNewDash(t,e)},onOpenDash:function(){this.openDashManagerWindow()},onResize:function(){this.documentSelector.onResize()},onSaveDash:function(){var e=this.getSelectedDoc(),n=this;e&&(Log.Info("save dash now!",e),n.$saveDash.addClass("saving"),e.saveNow(function(e){var t;n.$saveDash.removeClass("saving"),t=arguments[1]||"No error information returned from the server.",Log.Error("ERROR DIALOG: ",e,arguments),QuickBase.ErrorDialog.ShowError(t)},function(){n.$saveDash.removeClass("saving")}))},onSaveDashAs:function(){var e,t=this.getSelectedDoc();t&&(e=this.getNewDashModel(t.toJSON()),t.set("wasChanged",!1),this.saveNewDash(e,!0))},onSelectedDocumentIdChanged:function(){var e=this.viewModel.previous("selectedDocumentId"),t=this.viewModel.get("selectedDocumentId");e&&(e=this.appModel.get("documents").get(e))&&(this.stopListening(e,"postCommand",this.onDocumentChanged),this.stopListening(e,"documentSaved",this.onDocumentSaved),this.onDocumentSaved()),t&&(e=this.appModel.get("documents").get(t))&&(this.listenTo(e,"postCommand",this.onDocumentChanged),this.listenTo(e,"documentSaved",this.onDocumentSaved))},openDashManagerWindow:function(){var e=this;this.manageDashWindow||(this.manageDashWindow=new ManageDashWindow({appModel:this.appModel,container:this.dialogContainer,viewModel:this.viewModel}),this.manageDashWindow.on("close",function(){e.manageDashWindow&&(e.manageDashWindow.off(),e.manageDashWindow=null)}))},saveNewDash:function(n,e){var i=this;new DashboardNamePrompt({saveAs:e,appModel:i.appModel,container:i.dialogContainer,model:n}).once("close",function(e){var t;e.create?(e.duplicate&&(t=i.getSelectedDoc(),n=i.getNewDashModel(t.toJSON()),t.set("wasChanged",!1)),n.set("name",e.name),i.$saveDash.addClass("saving"),n.saveNow(function(e,t){Log.Error("error creating dashboard",e),i.$saveDash.removeClass("saving"),MainToolbar.ShowError_unableToCreateNewDashboard(t),i.hideLoadingScreen()},function(e){i.$saveDash.removeClass("saving"),e.set("wasChanged",!1),i.appModel.get("documents").add(e,{at:0}),"FSBL"in window?window.open("#"+e.id):location.hash="#"+e.id,i.hideLoadingScreen()})):i.hideLoadingScreen()})},showLoadingScreen:function(e){var t="FSBL"in window?"#appContainer":"body",e=new LoadingScreen({loadingText:e});e.$el.appendTo($(t)),this.$loadingScreen=e.$el},toggleTitle:function(e){e=e?t("Show Tools panel"):t("Hide Tools panel");this.$el.prop("title",e)},updateStatus:function(e){}},{ShowError_unableToCreateNewDashboard:function(e){QuickBase.ErrorDialog.ShowError("Error: Unable to create new Dashboard")}}),LocalTools=(_m.applyViewStateMethods=function(t,n){Object.getOwnPropertyNames(ViewStateMethods.prototype).forEach(function(e){n.prototype.hasOwnProperty(e)||Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(ViewStateMethods.prototype,e))})},_m.diff=function(o,a){var s={};if(!Object.is(o,a))return a&&"object"==typeof a?(Object.keys(o||{}).concat(Object.keys(a||{})).forEach(function(i){var e;a[i]===o[i]||Object.is(o[i],a[i])||(s[i]=a[i]),Array.isArray(a[i])&&Array.isArray(o[i])?o[i].forEach(function(e,t){var n=_m.diff(o[i][t],a[i][t]);void 0!==n&&(s[i][t]=n)}):"object"==typeof a[i]&&"object"==typeof o[i]&&void 0!==(e=_m.diff(o[i],a[i]))&&(s[i]=e)}),s):a},_m.moveDialogOnTop=function(e){var t=100;_.each($(".dialog-panel").find(".ui-dialog"),function(e){e=$(e).zIndex();t=t<e?e:t}),e.zIndex&&e.zIndex(t+1)},_m.getValue=function(e,t){for(var n=(t=(t=t.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split("."),i=e;n.length;){var o=n.shift();if(!(o in i))return;i=i[o]}return i},_m.setValue=function(e,t,n){if(e&&t){for(var i=t.split("."),o=e;i.length-1;){var a=i.shift();_.isObject(o[a])||(o[a]={}),o=o[a]}o[i[0]]=n}},_m.typecast=function(e,t){return"boolean"===t?!!e:"number"===t?+e:"integer"===t?Math.floor(+e):""+e},_m);function _m(){}var BaseEditor=(Object.defineProperty(Dn.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e,this.rendered&&this.setInputValue()},enumerable:!1,configurable:!0}),Dn.prototype.postRender=function(){this.rendered=!0,this.setInputValue()},Dn.prototype.preRender=function(){},Dn.prototype.remove=function(){$(this.el).remove()},Dn.prototype.render=function(){return this.el},Dn.prototype.startRender=function(){return this.preRender(),this.render(),this.postRender(),this.el},Dn.prototype.hideError=function(){QuickBase.ErrorTooltip.clear(this.errorTooltip)},Dn.prototype.onInput=function(e){this.hideError();var t=this.validate(e);t?this.showError(t):this.onChange(this.processInput(e))},Dn.prototype.onWatchedFieldChange=function(e,t){},Dn.prototype.processInput=function(e){var t=this.schema&&this.schema.type,n=e;switch(t){case"number":case"integer":_.isNaN(Number(e))||(n=Number(e),"integer"===t&&(n=Math.round(n)))}return this.sanitize(n)},Dn.prototype.sanitize=function(e){return e},Dn.prototype.setInputValue=function(){this.input&&(this.input.value=this.value)},Dn.prototype.showError=function(e){this.errorTooltip=QuickBase.ErrorTooltip.show(e,this.el,null)},Dn.prototype.validate=function(e){return""},Dn.collapsible=!1,Dn.labelled=!0,Dn);function Dn(e,t,n,i){this.canPaste=!1,this.schemaOptions=e.options||{},this.api=n,this.onChange=t,this.options=i||{},this.schema=e,this.el=document.createElement("div")}var CheckBoxEditor=(Tn=BaseEditor,__extends(Un,Tn),Object.defineProperty(Un.prototype,"value",{get:function(){return this._value},set:function(e){this._value=_.isUndefined(e)?void 0:!!e,this.rendered&&this.setInputValue()},enumerable:!1,configurable:!0}),Un.prototype.render=function(){return this.input=document.createElement("input"),this.input.setAttribute("type","checkbox"),this.input.style.width="auto",this.el.append(this.input),this.el},Un.prototype.postRender=function(){Tn.prototype.postRender.call(this),this.input.setAttribute("draggable","true"),this.input.addEventListener("dragstart",function(e){e.preventDefault(),e.stopPropagation()}),rxjs.fromEvent(this.input,"change").pipe(rxjs.operators.map(function(e){return e.target.checked})).subscribe(this.onInput.bind(this))},Un.prototype.setInputValue=function(){this.input&&(this.input.checked=this.value)},Un),Tn;function Un(e,t,n,i){return Tn.call(this,e,t,n,i)||this}var ClickableStringEditor=(ao=BaseEditor,__extends(bo,ao),bo.prototype.applyBaseState=function(){this.editorClear&&(this.editorClear.onclick=null),this.value?(this.el.classList.add("input-hasvalue"),this.editorClear&&(this.editorClear.onclick=this.onEditorClear.bind(this))):this.el.classList.remove("input-hasvalue")},bo.prototype.render=function(){var e;return ao.prototype.render.call(this),this.input=document.createElement("input"),this.input.setAttribute("readonly","true"),this.input.setAttribute("type","text"),this.el.classList.add("dashboards-control"),this.options.watermark&&(e=document.createElement("i"),this.input.classList.add("wa"),e.className="fa fa-fw watermark fa-"+this.options.watermark,this.el.append(e)),this.options.eraser&&(this.el.classList.add("clickable-control"),this.editorClear=document.createElement("i"),this.editorClear.className="fa fa-fw watermark fa-eraser input-clear",this.el.append(this.editorClear)),this.schema.data&&this.input.setAttribute("data",this.schema.data),this.el.append(this.input),this.el},bo.prototype.postRender=function(){ao.prototype.postRender.call(this),this.input.setAttribute("draggable","true"),this.input.addEventListener("dragstart",function(e){e.preventDefault(),e.stopPropagation()}),this.options.click&&this.input.addEventListener("click",this.options.click.bind(this)),this.options.onFocusOrBlur&&(this.input.addEventListener("focus",this.options.onFocusOrBlur.bind(this)),this.input.addEventListener("blur",this.options.onFocusOrBlur.bind(this)))},bo.prototype.onEditorClear=function(){this.applyBaseState(),this.onInput("")},bo.prototype.sanitize=function(e){return e="string"==typeof e?DOMPurify.sanitize(e,{ADD_ATTR:["target"]}):e},bo.prototype.setInputValue=function(){this.options.eraser&&this.applyBaseState(),this.input.value=this.value},bo),ao;function bo(e,t,n,i){return ao.call(this,e,t,n,i)||this}var ViewStateMethods=(ko.prototype.applyControlState=function(){this.rendered?(this.viewStateApply.onclick=null,this.viewStateClear.onclick=null,this.viewStateIcon.onclick=null,this.viewStateInput.onclick=null,this.viewStateInput.onkeyup=null,this.isViewState?(this.el.classList.add("is-viewstate"),this.el.parentElement&&this.el.parentElement.classList.add("is-viewstate-active"),this.viewStateClear.onclick=this.onViewStateClear.bind(this),this.viewStateIcon.onclick=this.onViewStateClick.bind(this),this.viewStateInput.onclick=this.onViewStateClick.bind(this),this.viewStateInput.onkeyup=this.onViewStateKeyPress.bind(this),this.viewStateInput.removeAttribute("tabindex")):(this.el.classList.remove("is-viewstate"),this.el.parentElement&&this.el.parentElement.classList.remove("is-viewstate-active"),this.viewStateApply.onclick=this.onViewStateApply.bind(this),this.viewStateInput.setAttribute("tabindex","-1")),this.statePending=!1):this.statePending=!0},ko.prototype.determineType=function(e){return e instanceof Backbone.Model?e.get("_viewType")?"viewstate":e.get("_dataType")?"datasource":void 0:"none"},ko.prototype.formatValue=function(e){return e},ko.prototype.getModel=function(){return this.model},ko.prototype.getValue=function(){return this.isViewState?this.model||this.formatValue(""):this.formatValue(this._value)},ko.prototype.remove=function(){this.rendered&&(this.viewStateApply.onclick=null,this.viewStateClear.onclick=null,this.viewStateIcon.onclick=null,this.viewStateInput.onclick=null)},ko.prototype.render=function(){return this.cache={text:"",viewState:""},this.viewStateApply=document.createElement("i"),this.viewStateApply.className="fa fa-fw watermark fa-eye viewstate-apply",this.viewStateClear=document.createElement("i"),this.viewStateClear.className="fa fa-fw watermark fa-eraser viewstate-active viewstate-clear",this.viewStateIcon=document.createElement("i"),this.viewStateIcon.className="fa fa-fw watermark fa-eye viewstate-active viewstate-icon",this.viewStateInput=document.createElement("input"),this.viewStateInput.className="wa viewstate-input",this.viewStateInput.setAttribute("type","text"),this.viewStateInput.setAttribute("tabindex","-1"),this.viewStateInput.readOnly=!0,this.el.append(this.viewStateApply),this.el.append(this.viewStateClear),this.el.append(this.viewStateIcon),this.el.append(this.viewStateInput),this.el.classList.add("dashboards-control"),this.el.classList.add("viewstate-control"),this.isViewState=this.isViewState||!1,this.applyControlState(),this.el},ko.prototype.setInputValue=function(){this.statePending&&this.applyControlState(),this.isViewState?this.viewStateInput.value=this._value?this._value.path:"":this.viewStateInput.value=this.cache.text||""},ko.prototype.setModel=function(e){var t=e?e.path:"";this.model=e,this._value=null,this.isViewState||(this.isViewState=!0,this.applyControlState()),this.rendered&&t!==this.input.value&&this.setInputValue()},ko.prototype.setValue=function(e){var t;this.ignoreModelChanges||("viewstate"===this.determineType(e)?(this.ignoreModelChanges=!0,this.setModel(e),t=e,this.ignoreModelChanges=!1,this._value=t,t=!1===this.isViewState,this.isViewState=!0):(this._value=e,t=!(this.model=null)===this.isViewState,this.isViewState=!1),this.rendered&&this.setInputValue()),t&&this.applyControlState()},ko.prototype.onViewStateApply=function(){this.cache.text=this._value,this.onViewStateClick()},ko.prototype.onViewStateClear=function(){this.isViewState=!1,this.model=null,this.viewStateInput.value="",this.onInput(this.cache.text),this.applyControlState()},ko.prototype.onViewStateKeyPress=function(e){32!==e.keyCode&&13!==e.keyCode||this.onViewStateClick()},ko.prototype.onViewStateClick=function(){var t=this;this.api.showViewStateDialog(this.model?this.model.path:"",function(e){t.isViewState=!0,t.onInput(e),t.applyControlState()})},ko);function ko(){}var ColSelectorEditor=(vo=ClickableStringEditor,__extends(wo,vo),Object.defineProperty(wo.prototype,"value",{get:function(){return this._value},set:function(e){ViewStateMethods.prototype.setValue.apply(this,arguments)},enumerable:!1,configurable:!0}),wo.prototype.preRender=function(){var e=this;this.options.watermark="pencil",this.options.click=function(){e.api.showColSelectorDialog(e.watchedValues[e.columnProperty],e.value,e.el,e.isUserDefined,e.onInput.bind(e))}},wo.prototype.render=function(){return vo.prototype.render.call(this),ViewStateMethods.prototype.render.apply(this),this.el},wo.prototype.onWatchedFieldChange=function(e,t){this.watchedValues[t]=e},wo.prototype.setInputValue=function(){vo.prototype.setInputValue.call(this),ViewStateMethods.prototype.setInputValue.apply(this)},wo),vo;function wo(e,t,n,i){t=vo.call(this,e,t,n,i)||this;return t.watchedValues={},LocalTools.applyViewStateMethods(t,wo),t.columnProperty=e&&e.data?e.data:"possible_columns",t.isUserDefined=!i||!1!==i.isUserDefined,t}var CSSEditor=(Go=ClickableStringEditor,__extends(Ho,Go),Ho.prototype.preRender=function(){var e=this;this.schemaOptions.format="textarea",this.options.click=function(){e.api.showCssDialog(e.value,e.onInput.bind(e))}},Ho.prototype.sanitize=function(e){e=(e=e).replace(/>/g,",dash-ancestor");return DOMPurify.sanitize(e).replace(/,dash-ancestor/g,">")},Ho),Go;function Ho(){return null!==Go&&Go.apply(this,arguments)||this}var DataSourceEditor=(Mo=ClickableStringEditor,__extends(No,Mo),Object.defineProperty(No.prototype,"value",{get:function(){if(void 0!==this._value)return this.model||""},set:function(e){!e&&this._value?(this._value="",this.model=""):(this._value,this._value=e,this.setModel(e)),this.rendered&&this.setInputValue()},enumerable:!1,configurable:!0}),No.prototype.onClick=function(){this.api.showDataDialog(this.model instanceof QuickBase.DocumentDataModel?this.model.path:"",_.bind(function(e){this.onInput(e)},this))},No.prototype.getModel=function(){return this.model},No.prototype.preRender=function(){this.options.watermark="database",this.options.eraser=!0,this.options.onFocusOrBlur=this.onFocusOrBlur.bind(this),this.options.click=this.onClick.bind(this)},No.prototype.setModel=function(e){this.model=e},No.prototype.onFocusOrBlur=function(e){var t=this;this.input.onkeyup=null,"focus"===e.type&&(this.input.onkeyup=_.bind(function(e){32!==e.keyCode&&13!==e.keyCode||t.onClick()},this))},No.prototype.onEditorClear=function(){this.applyBaseState(),this.onInput(null)},No.prototype.setInputValue=function(){this.applyBaseState(),this.value instanceof QuickBase.DocumentDataModel?this.input.value=this.value.path||"":this.input.value=this.value||""},No),Mo;function No(e,t,n,i){return Mo.call(this,e,t,n,i)||this}var DataConnectionEditor=(Zo=ClickableStringEditor,__extends($o,Zo),$o.prototype.preRender=function(){var t=this;this.options.watermark="server",this.options.eraser=!0,this.options.click=function(){t.api.showDataConnectionDialog(t.value,function(e){t.onInput(e)})}},$o),Zo;function $o(){return null!==Zo&&Zo.apply(this,arguments)||this}var DefaultEditor=(bp=BaseEditor,__extends(cp,bp),cp),bp;function cp(){return null!==bp&&bp.apply(this,arguments)||this}var DropdownEditor=(dp=BaseEditor,__extends(ep,dp),ep.prototype.preRender=function(){dp.prototype.preRender.call(this),this.getOptions()},ep.prototype.render=function(){return this.input=document.createElement("select"),this.el.append(this.input),this.renderOptions(),this.el.classList.add("select2-wrapper"),this.select2=$(this.input).select2({minimumResultsForSearch:10,theme:"dashboards-properties"}),this.el},ep.prototype.postRender=function(){dp.prototype.postRender.call(this),rxjs.fromEvent(this.select2,"select2:select").pipe(rxjs.operators.map(function(e){return e.params.data.id})).subscribe(this.onInput.bind(this))},ep.prototype.onWatchedFieldChange=function(e,t){this.getOptions(e),this.rendered&&this.renderOptions(),this.defaultPending&&(this.defaultPending=!1,this.rendered&&-1!==this.enumValues.indexOf(this.getStringValue())?this.setInputValue():void 0!==this.enumValues[0]&&this.onChange(this.enumValues[0]))},ep.prototype.setInputValue=function(){this.input.value=this.value||"",this.select2.val(this.value).trigger("change")},ep.prototype.getOptions=function(e){var n,i=this,o=this.schema.options&&this.schema.options.enum_titles||[];this.enumDisplay=[],this.enumOptions=[],this.enumValues=[],e||this.schema.enum?(e=e||this.schema.enum,Array.isArray(e)||(e=[]),n=_.isObject(this.schema.enumSource),e.forEach(function(e,t){i.enumDisplay[t]=n&&_.isObject(e)?e[i.schema.enumSource.title]:""+(o[t]||e),i.enumOptions[t]=n&&_.isObject(e)?e[i.schema.enumSource.value]:""+e,i.enumValues[t]=LocalTools.typecast(n&&_.isObject(e)?e[i.schema.enumSource.value]:""+e,i.schema.type)})):this.schema.enumSource&&(this.enumSource=[],"string"==typeof this.schema.enumSource?this.enumSource=[{source:this.schema.enumSource}]:Array.isArray(this.schema.enumSource)&&this.schema.enumSource.forEach(function(e,t){i.enumSource[t]=e}))},ep.prototype.getStringValue=function(){return this.value?this.value.toString():""},ep.prototype.renderOptions=function(){var i=this;this.input.options.length=0,this.enumOptions.forEach(function(e,t){var n=document.createElement("option");n.value=e,n.text=i.enumDisplay[t],n.value.toString()===i.getStringValue()&&(n.selected=!0),i.input.appendChild(n)}),$(this.input).trigger("change")},ep),dp;function ep(e,t,n,i){e=dp.call(this,e,t,n,i)||this;return e.enumDisplay=[],e.enumOptions=[],e.enumValues=[],e.schema.enumSource&&(e.defaultPending=!0),e}var Gradient=(zp=ClickableStringEditor,__extends(Ap,zp),Object.defineProperty(Ap.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e,this.rendered&&this.setInputValue(),this.refreshValue()},enumerable:!1,configurable:!0}),Ap.prototype.preRender=function(){var t=this;this.options.watermark="tint",this.options.eraser=!1,this.options.click=function(e){t.api.showColorPickerDialog(e.target,t)}},Ap.prototype.render=function(){zp.prototype.render.call(this);var e=!1,t=!1,n=this.value||this.schema.default||"#ffffff";return this.schema.options&&(e=this.schema.options.gradient||!1,t=this.schema.options.noColor||!1),this.input.setAttribute("gradient",String(e)),this.input.setAttribute("noColor",String(t)),this.input.setAttribute("class","gradient"),$(this.input).css("background",n),this.el},Ap.prototype.refreshValue=function(){""===this.value?($(this.input).css("background","#ffffff"),0===$(this.input).next(".fa-times").length&&$(this.input).after('<i class="fa fa-times" style="color:red;" />')):$(this.input).css("background",this.value).next(".fa-times").remove()},Ap),zp;function Ap(e,t,n,i){return zp.call(this,e,t,n,i)||this}var GradientViewState=(Lp=ClickableStringEditor,__extends(Mp,Lp),Object.defineProperty(Mp.prototype,"value",{get:function(){return this._value},set:function(e){ViewStateMethods.prototype.setValue.apply(this,arguments)},enumerable:!1,configurable:!0}),Mp.prototype.onClick=function(e){this.api.showColorPickerDialog(e,this)},Mp.prototype.preRender=function(){var t=this;this.options.click=function(e){t.onClick(e.target)}},Mp.prototype.render=function(){var t=this,e=(Lp.prototype.render.call(this),ViewStateMethods.prototype.render.apply(this),!1),n=!1,i=this.schema.default||"#ffffff",o=document.createElement("i");return o.className="fa fa-fw watermark fa-tint",this.el.append(o),this.schema.options&&(e=this.schema.options.gradient||!1,n=this.schema.options.noColor||!1),this.input.setAttribute("gradient",String(e)),this.input.setAttribute("noColor",String(n)),this.input.setAttribute("class","gradient gradient-viewstate"),$(this.input).css("background",i),this.input.addEventListener("keyup",function(e){e.preventDefault(),e.stopPropagation(),32!==e.keyCode&&13!==e.keyCode||t.onClick(e.target)}),this.input.addEventListener("focusin",_.bind(function(e){t.el.classList.add("has-focus")},this)),this.input.addEventListener("blur",_.bind(function(e){t.el.classList.remove("has-focus")},this)),this.el},Mp.prototype.refreshValue=function(){var e,t,n=this;this.input&&void 0!==this.value&&!this.isViewState&&(e=this.value&&this.value.get instanceof Function?this.value.get("value"):this.value,_.isString(e)&&0===e.indexOf("#")?(t=QuickBase.Tools.calculateFontContrast(e),$(this.input).css({background:e,color:t}).next(".fa-times").remove()):($(this.input).css("background","#ffffff"),0===$(this.input).next(".fa-times").length&&($(this.input).after('<i class="fa fa-times" style="color:red;" />'),$(this.input).next(".fa-times").on("click",function(){n.onClick(n.input)}))))},Mp.prototype.setInputValue=function(){var e;ViewStateMethods.prototype.setInputValue.apply(this),this.input&&void 0!==this.input.value&&(e=this.value,this.value instanceof Backbone.Model&&(e=this.value.get("value")),this.input.value=e),this.refreshValue()},Mp),Lp;function Mp(e,t,n,i){e=Lp.call(this,e,t,n,i)||this;return LocalTools.applyViewStateMethods(e,Mp),e}var HTMLEditor=(gq=ClickableStringEditor,__extends(hq,gq),Object.defineProperty(hq.prototype,"value",{get:function(){return this._value},set:function(e){ViewStateMethods.prototype.setValue.apply(this,arguments)},enumerable:!1,configurable:!0}),hq.prototype.preRender=function(){var t=this;this.schemaOptions.format="textarea",this.options.eraser=!1,this.options.click=function(){t.api.showHtmlDialog(function(e){t.onInput(e)})}},hq.prototype.render=function(){return gq.prototype.render.call(this),ViewStateMethods.prototype.render.apply(this),this.el},hq.prototype.sanitize=function(e){return e},hq.prototype.setInputValue=function(){gq.prototype.setInputValue.call(this),ViewStateMethods.prototype.setInputValue.apply(this)},hq),gq;function hq(e,t,n,i){e=gq.call(this,e,t,n,i)||this;return LocalTools.applyViewStateMethods(e,hq),e}var HandlebarEditor=(rq=ClickableStringEditor,__extends(sq,rq),sq.prototype.preRender=function(){var t=this,e=this.schema&&this.schema.options;this.schemaOptions.format="textarea",this.options.eraser=!1,this.options.click=function(){t.api.showTemplateDialog(t.schema,t.value,e,function(e){t.onInput(e)})}},sq.prototype.sanitize=function(e){return e},sq),rq;function sq(){return null!==rq&&rq.apply(this,arguments)||this}var IconEditor=(xq=ClickableStringEditor,__extends(yq,xq),Object.defineProperty(yq.prototype,"value",{get:function(){return this._value},set:function(e){ViewStateMethods.prototype.setValue.apply(this,arguments)},enumerable:!1,configurable:!0}),yq.prototype.preRender=function(){var t=this;this.options.watermark="hand-pointer",this.options.click=function(){t.api.showIconDropDownDialog("fa"===t.schema.iconTypes,function(e){t.onInput(e)})}},yq.prototype.render=function(){return xq.prototype.render.call(this),ViewStateMethods.prototype.render.apply(this),this.el},yq.prototype.setInputValue=function(){xq.prototype.setInputValue.call(this),ViewStateMethods.prototype.setInputValue.apply(this)},yq),xq;function yq(e,t,n,i){e=xq.call(this,e,t,n,i)||this;return LocalTools.applyViewStateMethods(e,yq),e}var JSONEditor=(Hq=ClickableStringEditor,__extends(Iq,Hq),Object.defineProperty(Iq.prototype,"value",{get:function(){return this._value},set:function(e){ViewStateMethods.prototype.setValue.apply(this,arguments)},enumerable:!1,configurable:!0}),Iq.prototype.preRender=function(){var t=this;this.schemaOptions.format="json",this.options.click=function(){t.api.showJsonDialog(t,t.value,function(e){t.onInput(e)})}},Iq.prototype.onClick=function(){var t=this;this.api.showJsonDialog(this,this.value,function(e){t.onInput(e)})},Iq.prototype.render=function(){return Hq.prototype.render.call(this),ViewStateMethods.prototype.render.apply(this),this.el},Iq.prototype.sanitize=function(e){return e},Iq.prototype.setInputValue=function(){Hq.prototype.setInputValue.call(this),ViewStateMethods.prototype.setInputValue.apply(this)},Iq),Hq;function Iq(e,t,n,i){e=Hq.call(this,e,t,n,i)||this;return LocalTools.applyViewStateMethods(e,Iq),e}var NavEditor=(Uq=BaseEditor,__extends(Vq,Uq),Object.defineProperty(Vq.prototype,"value",{get:function(){return this._value},set:function(e){ViewStateMethods.prototype.setValue.apply(this,arguments)},enumerable:!1,configurable:!0}),Vq.prototype.preRender=function(){var t=this;this.dashCollection=new Backbone.Collection,this.screenCollection=new Backbone.Collection,this.dashCollection.comparator="title",this.dashOptions={options:[],titles:[]},this.screenOptions={options:[],titles:[]},t.dashCollection.add(new Backbone.Model({title:"<none>",value:"<none>"})),t.dashCollection.add(new Backbone.Model({title:"<this>",value:"<this>"})),this.api.appModel.get("documents").each(function(e){t.dashCollection.add(new Backbone.Model({title:e.get("name"),value:e.id}))})},Vq.prototype.render=function(){Uq.prototype.render.call(this);var e=document.createElement("div"),t=document.createElement("div");return e.className="dash-input",t.className="screen-input",this.input=this.dashInput=document.createElement("select"),this.screenInput=document.createElement("select"),_.isObject(this.value)||(this.value={}),this.getSelectOptions(this.dashOptions,this.dashCollection),this.setSelectOptions(this.dashInput,this.dashOptions.options,this.dashOptions.titles),$(this.dashInput).trigger("change"),this.value.dashboard||(this.value.dashboard=this.dashOptions.options[0]),this.getScreens(this.value.dashboard.id),this.value.screen||(this.value.screen=this.screenOptions.options[0]),e.appendChild(this.dashInput),t.appendChild(this.screenInput),this.el.appendChild(e),this.el.appendChild(t),this.dashSelect2=this.setupSelect2(this.dashInput),this.screenSelect2=this.setupSelect2(this.screenInput),ViewStateMethods.prototype.render.apply(this),this.el},Vq.prototype.postRender=function(){var i=this;this.rendered=!0,this.screenCollection.on("reset",function(){var e;i.getSelectOptions(i.screenOptions,i.screenCollection),i.setSelectOptions(i.screenInput,i.screenOptions.options,i.screenOptions.titles),$(i.screenInput).trigger("change"),i.value?i.value.screen?e=i.value.screen:(e=i.screenOptions.options[0],i.value.screen=e):e=i.screenOptions.options[0],$(i.screenInput).val(e).trigger("change")}),this.dashSelect2.on("select2:select",function(e){var e=e.params.data.id,t=Object.assign({},i.value),n=t.screen!==e;t.dashboard=e,n&&i.onInput(t)}),this.screenSelect2.on("select2:select",function(e){var e=e.params.data.id,t=Object.assign({},i.value),n=t.screen!==e;t.screen=e,n&&i.onInput(t)}),ViewStateMethods.prototype.applyControlState.apply(this),this.setInputValue()},Vq.prototype.getDefault=function(){return{dashboard:"<none>",screen:"<none>"}},Vq.prototype.setInputValue=function(){var e,t,n,i;this.isViewState?ViewStateMethods.prototype.setInputValue.apply(this):(t=this.options.linked_oneof_property,i=e=void 0,i=(n=this.value)&&"<none>"!==n?(e=this.parseId(n.dashboard),this.parseId(n.screen)):e="<none>",(!_.isObject(this.value)||this.value instanceof Backbone.Model)&&(this.value={}),t&&_.isObject(n)&&n[t.property]&&(this.value[t.property]=n[t.property]),this.value._dashboardsType="navigation",this.setValueDash(e),this.setValueScreen(i))},Vq.prototype.getScreens=function(e){function t(e){0===e.length&&e.push({title:"<none>",value:"<none>"}),n.screenCollection.reset(e)}var n=this,i=!0,o=("<this>"===e&&(i=!1,e=this.api.viewModel.get("selectedDocumentId")),this.api.appModel.get("documents").get(e));o&&(e===this.api.viewModel.get("selectedDocumentId")?t(_.map(o.get("screens").models,function(e){return{title:e.get("name"),value:i?e.get("id"):e.get("name")}})):_.isEmpty(o.get("screenDetails"))?o.fetch({success:function(e){t(_.map(e.get("screenDetails"),function(e){return{title:e.label,value:e.value}}))}}):t(_.map(o.get("screenDetails"),function(e){return{title:e.label,value:e.value}})))},Vq.prototype.getSelectOptions=function(t,e){t.options=[],t.titles=[],e.each(function(e){t.options.push(e.get("value")),t.titles.push(e.get("title"))})},Vq.prototype.parseId=function(e){return e=_.isObject(e)&&e.id?e.id:e},Vq.prototype.setSelectOptions=function(i,e,o){i.options.length=0,e.forEach(function(e,t){var n=document.createElement("option");n.value=e,n.text=o[t],i.appendChild(n)}),$(i).trigger("change")},Vq.prototype.setValueDash=function(e){var t=Object.assign({},this.value),n=t.dashboard===e;(t.dashboard=e)!==$(this.dashInput).val()&&$(this.dashInput).val(e).trigger("change"),n&&this.getScreens(e)},Vq.prototype.setValueScreen=function(e){(Object.assign({},this.value).screen=e)!==$(this.screenInput).val()&&$(this.screenInput).val(e).trigger("change")},Vq.prototype.setupSelect2=function(e){e=$(e).select2({minimumResultsForSearch:10,theme:"dashboards-properties"});return e.addClass("property-editor-select"),e},Vq),Uq;function Vq(e,t,n,i){e=Uq.call(this,e,t,n,i)||this;return e.enumDisplay=[],e.enumOptions=[],e.enumValues=[],LocalTools.applyViewStateMethods(e,Vq),e}var StringEditor=(Tr=BaseEditor,__extends(Ur,Tr),Ur.prototype.render=function(){return this.input=document.createElement("input"),this.input.setAttribute("type",this.inputType),this.options.readonly&&this.input.setAttribute("readonly","true"),this.el.append(this.input),this.el},Ur.prototype.postRender=function(){Tr.prototype.postRender.call(this),rxjs.fromEvent(this.input,"change").pipe(rxjs.operators.map(function(e){return e.target.value})).subscribe(this.onInput.bind(this)),this.input.setAttribute("draggable","true"),this.input.addEventListener("dragstart",function(e){e.preventDefault(),e.stopPropagation()})},Ur.prototype.sanitize=function(e){var t;return"string"==typeof e&&(t=DOMPurify.sanitize(e,{ADD_ATTR:["target"]}),e=(new DOMParser).parseFromString("<!doctype html><body>"+t,"text/html").body.textContent),e},Ur.prototype.setInputValue=function(){this.input&&void 0!==this.input.value&&(this.input.value=void 0!==this.value?this.value:"")},Ur),Tr;function Ur(e,t,n,i){e=Tr.call(this,e,t,n,i)||this;return e.inputType="text",e}var NumberEditor=(es=StringEditor,__extends(fs,es),fs),es;function fs(e,t,n,i){e=es.call(this,e,t,n,i)||this;return e.inputType="number",e}var ViewStateEditor=(ls=ClickableStringEditor,__extends(ms,ls),Object.defineProperty(ms.prototype,"value",{get:function(){return this.model||""},set:function(e){!e&&this._value?(this._value="",this.model=""):(this._value,this._value=e,this.setModel(e)),this.rendered&&this.setInputValue()},enumerable:!1,configurable:!0}),ms.prototype.onClick=function(){this.api.showViewStateDialog(this.model instanceof QuickBase.DocumentViewModel?this.model.path:"",_.bind(function(e){this.onInput(e)},this))},ms.prototype.getModel=function(){return this.model},ms.prototype.preRender=function(){this.options.watermark="eye",this.options.eraser=!0,this.options.onFocusOrBlur=this.onFocusOrBlur.bind(this),this.options.click=this.onClick.bind(this)},ms.prototype.setModel=function(e){this.model=e},ms.prototype.onFocusOrBlur=function(e){var t=this;this.input.onkeyup=null,"focus"===e.type&&(this.input.onkeyup=_.bind(function(e){32!==e.keyCode&&13!==e.keyCode||t.onClick()},this))},ms.prototype.setInputValue=function(){this.applyBaseState(),this.input.value=this.value&&this.value.path||""},ms),ls;function ms(e,t,n,i){return ls.call(this,e,t,n,i)||this}var CheckBoxViewStateEditor=(ys=CheckBoxEditor,__extends(zs,ys),Object.defineProperty(zs.prototype,"value",{get:function(){return this._value},set:function(e){e instanceof Backbone.Model||(e=!!e),ViewStateMethods.prototype.setValue.call(this,e)},enumerable:!1,configurable:!0}),zs.prototype.render=function(){return ys.prototype.render.call(this),ViewStateMethods.prototype.render.apply(this),this.el},zs.prototype.setInputValue=function(){ViewStateMethods.prototype.setInputValue.apply(this),ys.prototype.setInputValue.call(this)},zs),ys;function zs(e,t,n,i){e=ys.call(this,e,t,n,i)||this;return LocalTools.applyViewStateMethods(e,zs),e}var DropDownViewStateEditor=(Gs=DropdownEditor,__extends(Hs,Gs),Object.defineProperty(Hs.prototype,"value",{get:function(){return this._value},set:function(e){ViewStateMethods.prototype.setValue.apply(this,arguments)},enumerable:!1,configurable:!0}),Hs.prototype.render=function(){return Gs.prototype.render.call(this),ViewStateMethods.prototype.render.apply(this),this.el},Hs.prototype.setInputValue=function(){ViewStateMethods.prototype.setInputValue.apply(this),Gs.prototype.setInputValue.call(this)},Hs.prototype.getStringValue=function(){var e=this.value||"";return(e=e instanceof Backbone.Model?e.get("value"):e).toString()},Hs.prototype.onWatchedFieldChange=function(e,t){this.isViewState||Gs.prototype.onWatchedFieldChange.call(this,e,t)},Hs),Gs;function Hs(e,t,n,i){e=Gs.call(this,e,t,n,i)||this;return LocalTools.applyViewStateMethods(e,Hs),e}var StringViewStateEditor=(Rs=StringEditor,__extends(Ss,Rs),Object.defineProperty(Ss.prototype,"value",{get:function(){return this._value},set:function(e){ViewStateMethods.prototype.setValue.apply(this,arguments)},enumerable:!1,configurable:!0}),Ss.prototype.onClick=function(){this.api.showViewStateDialog(this.model instanceof QuickBase.DocumentViewModel?this.model.path:"",_.bind(function(e){this.onInput(e)},this))},Ss.prototype.render=function(){return Rs.prototype.render.call(this),ViewStateMethods.prototype.render.apply(this),this.el},Ss.prototype.setInputValue=function(){ViewStateMethods.prototype.setInputValue.apply(this),Rs.prototype.setInputValue.call(this)},Ss),Rs;function Ss(e,t,n,i){e=Rs.call(this,e,t,n,i)||this;return LocalTools.applyViewStateMethods(e,Ss),e}var NumberViewStateEditor=($s=StringViewStateEditor,__extends(_s,$s),_s.prototype.validate=function(e){return null!==this.schema.min&&e<this.schema.min?"Number must be greater than "+this.schema.min:this.schema.max&&e>this.schema.max?"Number must be less than "+this.schema.max:""},_s.prototype.onInput=function(e){$s.prototype.onInput.call(this,e=""===e?null:e)},_s),$s;function _s(e,t,n,i){e=$s.call(this,e,t,n,i)||this;return e.inputType="number",e}var STANDARD={boolean:CheckBoxEditor,booleanViewState:CheckBoxViewStateEditor,customDropdown:ColSelectorEditor,css:CSSEditor,data:DataSourceEditor,dataConnection:DataConnectionEditor,gradient:Gradient,gradientViewState:GradientViewState,default:DefaultEditor,dropdown:DropdownEditor,dropdownViewState:DropDownViewStateEditor,handlebar:HandlebarEditor,html:HTMLEditor,icon:IconEditor,json:JSONEditor,nav:NavEditor,number:NumberEditor,numberViewState:NumberViewStateEditor,integer:NumberEditor,integerViewState:NumberViewStateEditor,string:StringEditor,stringViewState:StringViewStateEditor,tooltip:HandlebarEditor,tooltipTemplate:HandlebarEditor,viewstate:ViewStateEditor},VIEWSTATE={boolean:CheckBoxViewStateEditor,gradient:GradientViewState,dropdown:DropDownViewStateEditor,number:NumberViewStateEditor,integer:NumberViewStateEditor,string:StringViewStateEditor},Editors=(ht.get=function(e){var t=ht.EDITORS;return e.enum||e.enumSource?t.dropdown:t[e.type]||t.default},ht.setViewStateEditors=function(e){ht.EDITORS=(ht.viewStateEditors=e)?Object.assign({},STANDARD,VIEWSTATE):STANDARD},ht.viewStateEditors=!0,ht);function ht(){}[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach(function(e){e.hasOwnProperty("append")||Object.defineProperty(e,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),n=document.createDocumentFragment();e.forEach(function(e){var t=e instanceof Node;n.appendChild(t?e:document.createTextNode(String(e)))}),this.appendChild(n)}})}),[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach(function(e){e.hasOwnProperty("prepend")||Object.defineProperty(e,"prepend",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),n=document.createDocumentFragment();e.forEach(function(e){var t=e instanceof Node;n.appendChild(t?e:document.createTextNode(String(e)))}),this.insertBefore(n,this.firstChild)}})}),Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};var ItemContainer=(Object.defineProperty(At.prototype,"expanded",{get:function(){return this._expanded},set:function(e){this._expanded=e},enumerable:!1,configurable:!0}),Object.defineProperty(At.prototype,"path",{get:function(){return this._path},set:function(e){this._path!==e&&(this._path=e,this.updatePaths(),this.watch())},enumerable:!1,configurable:!0}),Object.defineProperty(At.prototype,"schema",{get:function(){return this._schema},set:function(e){var t=this._schema;this._schema=e,this.value=this.getDefault(),_.isEqual(this._schema,t)||((t=this.rendered&&!_.isEqual(_.omit(t,["hidden","options.hidden"]),_.omit(e,["hidden","options.hidden"])))&&this.editor&&this.editor.remove(),this.editor=this.initEditor(e),t&&this.el.append(this.renderEditor()),this._schema.type&&this.el.setAttribute("data-type",this.schema.type)),this.rendered&&(this.isHidden()?this.hide():this.unhide())},enumerable:!1,configurable:!0}),Object.defineProperty(At.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e,this.editor&&(this.editor.value=e),this.emit(),this.determineEmpty(e)&&"data"!==this.schema.type?this.el.classList.add("undefined"):this.el.classList.remove("undefined")},enumerable:!1,configurable:!0}),At.prototype.addListener=function(e){return this.listener||(this.listener=new rxjs.BehaviorSubject(this.value)),this.listener.subscribe(e)},At.prototype.expand=function(e){var t=_.isBoolean(e)?this.path+"._self":this.path;this.root.expand(e,t)},At.prototype.filter=function(e){if(e){if(new Fuse([this.getTitle()],{threshold:.4}).search(e).length)return this.el.classList.remove("filtered"),this.label&&(this.label.innerHTML=this.highlightText(this.getTitle(),e)),!0;this.el.classList.add("filtered")}else this.label&&(this.label.innerHTML=this.label.innerText),this.el.classList.remove("filtered")},At.prototype.getDefault=function(){if(void 0!==this.schema.default)return this.schema.default;if(this.schema.enum)return this.schema.enum[0];var e=this.schema.type||this.schema.oneOf;if("string"==typeof(e=(e=(e=e&&Array.isArray(e)?e[0]:e)&&"object"==typeof e?e.type:e)&&Array.isArray(e)?e[0]:e)){if("number"===e)return 0;if("boolean"===e)return!1;if("integer"===e)return 0;if("string"===e||"customDropdown"===e)return"";if("object"===e)return{};if("array"===e||"actions"===e||"popups"===e)return[]}return null},At.prototype.hide=function(){this.el.classList.add("hidden")},At.prototype.initEditor=function(e,t){var n=this,e=new(Editors.get(e))(e,function(e){n.setValueByPath(e,n.path)},this.root.api,t||{});return e.value=this.value,e},At.prototype.onClick=function(){this.editor&&this.editor.onClick&&this.editor.onClick()},At.prototype.paste=function(e){for(var t,n=_.get(this,"schema.properties")||_.get(this,"schema.items"),n=Object.keys(n),i=Object.keys(e),o=this.value,a=_.intersection(n,i).filter(function(e){return"ComponentName"!==e}),s=0;s<a.length;s++)o[a[s]]!==e[a[s]]&&("advanced"===a[s]&&(t=e[a[s]].substring(e[a[s]].indexOf("data-widgetid=")+15,e[a[s]].indexOf("data-widgetid=")+51),e[a[s]]=e[a[s]].split(t).join(this.root.api.getWidget().id)),o[a[s]]=e[a[s]]);this.setValueByPath(o,this.path)},At.prototype.postRender=function(){this.rendered=!0,this.updatePaths(),this.watch()},At.prototype.remove=function(){var t=this;this.editor&&this.editor.remove(),this.el.innerHTML="",this.schema.watch&&Object.keys(this.schema.watch).forEach(function(e){t.watchSubscriptions[e]&&(t.watchSubscriptions[e].unsubscribe(),delete t.watchSubscriptions[e])}),this.listener&&this.listener.unsubscribe(),this.rendered=!1,this.expand(null)},At.prototype.render=function(){return this.schema.headerTemplate&&(this.headerTemplate=Handlebars.compile(this.schema.headerTemplate)),this.schema&&this.schema.options&&this.schema.options.custom_class_name&&this.el.classList.add(this.schema.options.custom_class_name),this.editor&&(this.labelled&&void 0!==this.schema.type&&(this.label=this.renderLabel(),this.el.append(this.label)),this.el.append(this.renderEditor())),this.el},At.prototype.renderLabel=function(){var e=document.createElement("div"),t=this.getLabelText();return e.textContent=t,e.className="label",e.setAttribute("title",t),e},At.prototype.unhide=function(){this.el.classList.remove("hidden")},At.prototype.updatePaths=function(){var t;this.el.setAttribute("data-schemapath",this.path),this.key=this.path.split(".").pop(),this.path&&this.editor&&this.editor.input&&(t="",_.each(this.path.split("."),function(e){t+="root"!==e?"["+e+"]":e}),$(this.editor.input).attr("name",t))},At.prototype.determineEmpty=function(e){return void 0===e},At.prototype.emit=function(){this.listener&&this.listener.next(this.value)},At.prototype.getTitle=function(){return this.schema.title||this.key},At.prototype.highlightText=function(e,t){t=new RegExp("("+t+")","gi");return e.replace(t,"<mark>$1</mark>")},At.prototype.isHidden=function(){return _.get(this.schema,"hidden")||_.get(this.schema,"options.hidden")},At.prototype.renderEditor=function(){var e=this.editor.startRender();return e.classList.add("editor"),e},At.prototype.setValueByPath=function(e,t){return this.root.setValueByPath(e,t)},At.prototype.watch=function(){var n=this;this.schema.watch&&Object.keys(this.schema.watch).forEach(function(t){n.watchSubscriptions[t]&&n.watchSubscriptions[t].unsubscribe(),n.watchSubscriptions[t]=n.root.addListener(n.schema.watch[t],function(e){n.editor&&n.editor.onWatchedFieldChange(e,t)},n.path)})},At.prototype.getLabelText=function(){var e=this.options.custom,t=this.path.substr(this.path.lastIndexOf(".")+1),n=this.schema.title;return e||n||t},At);function At(e,t,n,i){this.el=document.createElement("div"),this.el.classList.add("container"),this.options=i||{},this.root=n,this._path=t,this.watchSubscriptions={},this.defaultExpanded=!e.options||!e.options.collapsed;n=this.defaultExpanded;_.isEmpty(i.expanded)&&!_.isBoolean(i.expanded)||(n=i.expanded),this.expanded=_.isObject(n)?n:{_self:n},this.schema=e,this.schemaOptions=e.options||{},this.labelled=!!_.isUndefined(i.labelled)||i.labelled,this.updatePaths(),this.root.register(this)}var CollapsibleContainer=(Au=ItemContainer,__extends(Bu,Au),Object.defineProperty(Bu.prototype,"expanded",{get:function(){return this._expanded},set:function(e){var t={};_.isNil(e)||(t=_.omit(e,"_self"),this._expanded=e),this._expanded._self?(this.el.classList.add("expanded"),this.setCaret(),this.rendered?this.renderChildren():this.pendingRenderChildren=!0):(this.el.classList.remove("expanded"),this.setCaret()),this.getChildren().forEach(function(e){e.expanded=t[e.key]})},enumerable:!1,configurable:!0}),Object.defineProperty(Bu.prototype,"schema",{get:function(){return this._schema},set:function(e){var n=this;this._schema=e,this.children={},_.each(this.schema.properties,function(e,t){n.initChild(t)}),this._value=this.getDefault(),_.each(this.schema.properties,function(e,t){n._value[t]=n.children[t].getDefault()}),this.schema.type&&this.el.setAttribute("data-type",this.schema.type),this.rendered&&(this.isHidden()?this.hide():this.unhide())},enumerable:!1,configurable:!0}),Object.defineProperty(Bu.prototype,"value",{set:function(e){this._value=e,this.setTitle(),this.emit()},enumerable:!1,configurable:!0}),Bu.prototype.filter=function(n){var i=this;if(!n)return this.rendered&&(this.getChildren().forEach(function(e){e.filter(null)}),this.el.classList.remove("filtered"),this.expand(this.defaultExpanded),this.titleText.innerHTML=this.titleText.innerText),!0;var o=!1;return new Fuse([this.getTitle()],{threshold:.4}).search(n).length&&(o=!0,this.rendered&&(this.titleText.innerHTML=this.highlightText(this.titleText.innerText,n))),this.getChildren().forEach(function(e,t){e.filter(n)&&(o=!0,i.rendered&&!e.rendered&&(i.renderChild(e,t),e.expand&&e.expand(!0),e.filter(n)))}),this.rendered&&(o?(this.renderChildren(),this.el.classList.remove("filtered"),this.expand(!0)):(this.el.classList.add("filtered"),this.expand(!1))),o},Bu.prototype.getDefault=function(){var t=this;if(void 0!==this.schema.default)return this.schema.default;var n={};return this.children&&Object.keys(this.children).forEach(function(e){n[e]=t.children[e].getDefault()}),n},Bu.prototype.hide=function(){Au.prototype.hide.call(this),this.hideChildren()},Bu.prototype.postRender=function(){var i=this;Au.prototype.postRender.call(this),this.title.onblur=function(){return i.root.onFocus(null)},this.title.onfocus=function(){return i.root.onFocus(i.path)},this.title.onmouseover=function(){return i.root.setCopyPasteIcons()},this.canCollapse?(this.caret=document.createElement("i"),this.title.prepend(this.caret),this.setCaret(),this.el.classList.add("collapsible"),rxjs.fromEvent(this.title,"click").pipe(rxjs.operators.filter(function(e){var t=/MSIE|Trident/.test(window.navigator.userAgent),n=e.target;return t&&(t=e.clientX,e=e.clientY,n=document.elementFromPoint(t,e)),n===i.title||n===i.titleText||n===i.caret}),rxjs.operators.scan(function(e,t){return t.stopPropagation(),!i.expanded._self},this.expanded._self),rxjs.operators.startWith(this.expanded)).subscribe(this.expand.bind(this))):this.expand(!0),this.pendingRenderChildren&&(this.renderChildren(),this.pendingRenderChildren=!1)},Bu.prototype.reloadHeaderTemplates=function(){this.getChildren().forEach(function(e){_.has(e,"header_template")&&e.editor&&e.editor.onWatchedFieldChange&&e.editor.onWatchedFieldChange()})},Bu.prototype.remove=function(){this.getChildren().forEach(function(e){return e.remove()}),Au.prototype.remove.call(this)},Bu.prototype.render=function(){return Au.prototype.render.call(this),this.childrenEl=document.createElement("div"),this.childrenEl.classList.add("editor"),this.inline?this.el.classList.add("inline"):(this.renderTitle(),this.setTitle(),this.el.prepend(this.childrenEl),this.el.prepend(this.title),!/\d/.test(this.path)&&this.root.api.viewModel.get("selectedWidgetId")&&this.renderCopyPasteIcons()),this.el},Bu.prototype.setCopyState=function(e){e?this.el.classList.add("copied"):this.el.classList.remove("copied")},Bu.prototype.unhide=function(){Au.prototype.unhide.call(this),this.expanded._self&&this.unhideChildren()},Bu.prototype.updatePaths=function(){Au.prototype.updatePaths.call(this),this.setTitle()},Bu.prototype.appendChild=function(e,t){this.childrenEl.insertBefore(e.el,this.childrenEl.children[t]||null)},Bu.prototype.getChildren=function(){var t=this;return this.children instanceof Object?Object.keys(this.children).sort(this.sortIndexes.bind(this)).map(function(e){return t.children[e]}):this.children||[]},Bu.prototype.getChildSchema=function(e){return this.schema.properties[e]},Bu.prototype.getTitle=function(){var e=this.el.getAttribute("data-i"),t=this.schema.title||this.key;return t&&e&&(t+=" "+(Number(e)+1)),t},Bu.prototype.hideChildren=function(){this.getChildren().forEach(function(e){return e.hide()})},Bu.prototype.initChild=function(e){this.children[e]=this.root.initItem(this.getChildSchema(e),(this.path?this.path+".":"")+e,{expanded:this.expanded[e]})},Bu.prototype.removeChild=function(e){var t=this.children[e];t&&(t.remove(),delete this.children[e],this.childrenEl.contains(t.el)&&this.childrenEl.removeChild(t.el))},Bu.prototype.renderChild=function(e,t){e.render(),this.appendChild(e,t),e.postRender(),e.isHidden()&&e.hide()},Bu.prototype.renderCopyPasteIcons=function(){var e=this;this.copyPaste=document.createElement("span"),this.copyPaste.id="copyPaste",this.copyPaste.contentEditable="false",this.copyIcon=document.createElement("BUTTON"),this.copyIcon.id="copy",this.copyIcon.className="fa fa-copy",this.copyIcon.title="Copy property section to clipboard",this.pasteIcon=document.createElement("BUTTON"),this.pasteIcon.id="paste",this.pasteIcon.className="fa fa-paste",this.pasteIcon.title="Paste property section from clipboard",this.copyPaste.appendChild(this.copyIcon),this.copyPaste.appendChild(this.pasteIcon),this.title.append(this.copyPaste),this.copyIcon.onclick=function(){e.root.onFocus(e.path),e.root.startCopy()},this.pasteIcon.onclick=function(){e.root.onFocus(e.path),e.root.startPaste()}},Bu.prototype.renderTitle=function(){this.title=document.createElement(this.canCollapse?"button":"div"),this.titleText=document.createElement("span"),this.title.append(this.titleText),this.title.className="title",this.titleText.className="title-text",this.titleText.contentEditable="false",this.el.classList.add("titled")},Bu.prototype.setTitle=function(){this.titleText?this.titleText.textContent=this.generateTitle():this.title&&(this.title.textContent=this.generateTitle())},Bu.prototype.unhideChildren=function(){var n=this;this.getChildren().forEach(function(e,t){e.isHidden()||(e.rendered||n.renderChild(e,t),e.unhide())})},Bu.prototype.generateTitle=function(){return this.headerTemplate?this.headerTemplate({key:this.key,i:this.key,i0:Number(this.key),i1:Number(this.key)+1,self:this.unpackHandlebarsValues(),title:this.getTitle()}):this.getTitle()},Bu.prototype.renderChildren=function(){var n=this;this.getChildren().forEach(function(e,t){e.rendered||n.renderChild(e,t)})},Bu.prototype.setCaret=function(){this.caret&&(this.expanded._self?this.caret.className="caret fa fa-caret-down":this.caret.className="caret fa fa-caret-right")},Bu.prototype.sortIndexes=function(e,t){var n=this.children[e],i=this.children[t];return e&&t?(Number.isInteger(n.schema.propertyOrder)?n.schema.propertyOrder:1e3)-(Number.isInteger(i.schema.propertyOrder)?i.schema.propertyOrder:1e3):0},Bu.prototype.unpackHandlebarsValues=function(){return this.value instanceof Object?_.mapValues(this.value,function(e){return e instanceof Backbone.Model?e.get("value"):e}):this.value},Bu),Au;function Bu(e,t,n,i){t=Au.call(this,e,t,n,i)||this;return t.canPaste=!0,t.canCollapse=!e.options||!e.options.disable_collapse,t.labelled=!_.isUndefined(i.labelled)&&i.labelled,e.options&&e.options.inline&&(t.inline=!0,t.canCollapse=!1),t}var ArrayContainer=(Mv=CollapsibleContainer,__extends(Nv,Mv),Object.defineProperty(Nv.prototype,"schema",{get:function(){return this._schema},set:function(e){var t=this;this._schema=e,this.getChildren().forEach(function(e){t.removeChild(e)}),this.children=[],this._value=this.getDefault(),this.schema.type&&this.el.setAttribute("data-type",this.schema.type),this.rendered&&(this.isHidden()?this.hide():this.unhide())},enumerable:!1,configurable:!0}),Object.defineProperty(Nv.prototype,"value",{get:function(){if(void 0!==this._value)return this.children.map(function(e){return e.value})},set:function(e){var n=this;if(this._value=e,Array.isArray(e)){e.forEach(function(e,t){n.children[t]||n.initChild(t),n.rendered&&!n.children[t].rendered&&n.renderChild(n.children[t],t),n.children[t].value=e});for(var t=this.children.length-1;t>e.length-1;t--)this.removeChild(this.children[t])}this.emit(),this.determineEmpty(e)?this.el.classList.add("undefined"):this.el.classList.remove("undefined")},enumerable:!1,configurable:!0}),Nv.prototype.onClick=function(){0===this.value.length&&this.addRow(0)},Nv.prototype.paste=function(e){var t,n=this,i=this.value;e instanceof Array?_.each(e,function(e){var t=n.children.length;n.addRow(t),i.push(_.extend(n.children[t].getDefault(),e))}):e instanceof Object&&(t=this.children.length,this.addRow(t),i.push(_.extend(this.children[t].getDefault(),e))),this.setValueByPath(i,this.path)},Nv.prototype.render=function(){return Mv.prototype.render.call(this),this.bulkEditor&&(this.btnBulkEdit=document.createElement("i"),this.btnBulkEdit.className="bulkEditor fa fa-pencil-square-o",this.copyPaste?this.title.insertBefore(this.btnBulkEdit,this.copyPaste):this.title.append(this.btnBulkEdit)),this.reset&&(this.btnReset=document.createElement("i"),this.btnReset.className="btnReset fa fa-refresh",this.copyPaste?this.title.insertBefore(this.btnReset,this.copyPaste):this.title.append(this.btnReset)),this.endOfList=document.createElement("button"),this.endOfList.classList.add("end-of-list"),this.el.append(this.endOfList),this.canAdd&&(this.endOfList.classList.add("add-item"),this.endOfList.innerHTML="+ "+(this.schema.items&&this.schema.items.title?this.schema.items.title:"Item")),this.canDrag&&(this.dragContainer=this.childrenEl,this.placeholder=document.createElement("div"),this.placeholder.classList.add("placeholder"),this.el.append(this.placeholder)),this.el},Nv.prototype.postRender=function(){var n=this;Mv.prototype.postRender.call(this),this.bulkEditor&&this.btnBulkEdit.addEventListener("click",function(){n.root.api.showBulkColumnEditor(n)}),this.reset&&this.btnReset.addEventListener("click",this.onResetClick.bind(this)),this.canAdd&&this.endOfList.addEventListener("click",function(){var e=n.children.length,t=n.value.slice();n.addRow(e),n.renderChild(n.children[e],n.children.length-1),t[e]=n.children[e].value,n.setValueByPath(t,n.path)}),this.canDrag&&this.endOfList.addEventListener("dragenter",function(e){n.fromElement&&(n.dragContainer.append(n.fromElement),n.setPlaceholder(n.fromElement))})},Nv.prototype.updatePaths=function(){var n=this;Mv.prototype.updatePaths.call(this),this.getChildren().forEach(function(e,t){e.path=(n.path?n.path+".":"")+t,e.el.setAttribute("data-i",t)})},Nv.prototype.addDragListeners=function(e){function n(e){for(var t=0;null!==(e=e.previousSibling);)t++;return t}var i=this;e.setAttribute("draggable",!0),e.addEventListener("dragstart",function(e){var t=e.target;e.stopPropagation(),i.fromElement=t,i.fromIndex=n(t),i.el.classList.add("moving")}),e.addEventListener("dragenter",function(e){e.stopPropagation(),i.fromElement&&(i.dragContainer.insertBefore(i.fromElement,e.currentTarget),i.setPlaceholder(i.fromElement))}),e.addEventListener("dragend",function(e){var t=n(e.currentTarget);e.stopPropagation(),i.el.classList.remove("moving"),i.setPlaceholder(null),i.children.splice(t,0,i.children.splice(i.fromIndex,1)[0]),i.updatePaths(),i.setValueByPath(i.value,i.path),i.expand(i.expanded),i.fromElement=null})},Nv.prototype.addRow=function(e){this.children[e]||this.initChild(e)},Nv.prototype.getChildSchema=function(){return this.schema.items||{type:"string"}},Nv.prototype.removeChild=function(e){var t=this.children.indexOf(e);e.remove(),this.rendered&&this.childrenEl.removeChild(e.el),this.children.splice(t,1)},Nv.prototype.renderChild=function(e,t){var n,i=this;Mv.prototype.renderChild.call(this,e,t),e.el.setAttribute("data-i",t),e.expanded=this.expanded[t],this.canRemove&&((n=document.createElement("i")).className="remove fa fa-trash",n.onclick=function(){event.stopPropagation(),event.preventDefault(),i.children.splice(Number(n.parentElement.getAttribute("data-i")),1),n.parentElement.parentElement.removeChild(n.parentElement),i.updatePaths(),i.setValueByPath(i.value,i.path),i.expand(i.expanded)},e.el.append(n)),this.canDrag&&this.addDragListeners(e.el)},Nv.prototype.onResetClick=function(){this.setValueByPath(["reset",Date.now()],"root.notificationEvent")},Nv.prototype.setPlaceholder=function(e){e?(e=e.getBoundingClientRect(),this.placeholder.classList.add("active"),this.placeholder.style.marginLeft=this.fromElement.offsetLeft+"px",this.placeholder.style.width=e.width+"px",this.placeholder.style.height=e.height+"px",this.placeholder.style.top=e.top-36+"px"):this.placeholder.classList.remove("active")},Nv),Mv;function Nv(e,t,n,i){t=Mv.call(this,e,t,n,i)||this;return t.bulkEditor=!!e.options&&e.options.bulkEditor,t.canAdd=!e.options||!e.options.disable_array_add,t.canDrag=!e.options||!e.options.disable_array_reorder,t.canRemove=!e.options||!e.options.disable_array_delete,t.reset=!!e.options&&e.options.reset,t}var ActionsContainer=(Hw=ArrayContainer,__extends(Iw,Hw),Iw.prototype.extendSchema=function(){var t={},n=(_.each(["map","nav","query","url"],_.bind(function(e){t[e]={_Type:{default:e,type:"string",options:{hidden:!0}}},this.originalSchema&&this.originalSchema.fields&&_.extend(t[e],this.originalSchema.fields[e])},this)),_.extend(this.originalSchema,{options:{custom_class_name:"actions-array"},items:{title:"Action",headerTemplate:"Action {{ i1 }}",options:{keep_oneof_values:!1},oneOf:[{type:"object",title:"View State Mapping",uniqueItems:!1,options:{no_title:!0,custom_class_name:"mapping-object",linked_oneof_property:{property:"_Type",value:"map"}},properties:_.extend({Current:{propertyOrder:10,default:"",type:"string",options:{custom_class_name:"mapping-current"}},Target:{default:"",propertyOrder:11,type:"string",options:{custom_class_name:"mapping-target"}}},t.map)},{type:"object",title:"Open Dashboard/Screen",options:{linked_oneof_property:{property:"_Type",value:"nav"}},properties:_.extend({SelectDashboardScreen:{type:"nav",title:"Select Dashboard/Screen",default:{dashboard:"<none>",screen:"<none>"}},Target:{type:"string",enum:["_self","_blank"],options:{enum_titles:["This Window","New Window"]}}},t.nav)},{type:"object",title:"Run Query",options:{linked_oneof_property:{property:"_Type",value:"query"}},properties:_.extend({DataSource:{type:"data"}},t.query)},{type:"object",title:"Open Url",options:{linked_oneof_property:{property:"_Type",value:"url"}},properties:_.extend({Url:{type:"string"},Target:{type:"string",enum:["_self","_blank"],options:{enum_titles:["This Window","New Window"]}}},t.url)}]}}),this.originalSchema.excludedFields);n&&_.remove(this.originalSchema.items.oneOf,function(e){return _.includes(n,e.options.linked_oneof_property.value)}),this.schema=this.originalSchema,_.extend(this.schemaOptions,this.schema.options)},Iw),Hw;function Iw(e,t,n,i){t=Hw.call(this,e,t,n,i)||this;return t.originalSchema=_.cloneDeep(e),t.extendSchema(),t}var BackboneContainer=(Sw=CollapsibleContainer,__extends(Tw,Sw),Tw.prototype.remove=function(){this.instance&&(this.instance.remove(),this.instance=null),Sw.prototype.remove.call(this)},Tw.prototype.render=function(){var n=this;return Sw.prototype.render.call(this),this.instance=new this.view(Object.assign({el:this.childrenEl},_.reduce(this.parameters,function(e,t){return e[t]=n.root.api.getParameter(t),e},{}))),this.el},Tw.prototype.hideChildren=function(){this.instance&&this.instance.$el.hide()},Tw.prototype.unhideChildren=function(){this.instance&&this.instance.$el.show()},Tw),Sw;function Tw(e,t,n,i){t=Sw.call(this,e,t,n,i)||this;return t.parameters=e.options.parameters,t.view=e.options.view,t}var ObjectContainer=(ax=CollapsibleContainer,__extends(bx,ax),Object.defineProperty(bx.prototype,"schema",{get:function(){var t=this,n=this._schema;return Object.keys(this.children).forEach(function(e){n.properties[e]=t.children[e].schema}),n},set:function(e){var n=this;this._schema=e,this.getChildren().forEach(function(e){n.removeChild(e.key)}),this.children={},_.each(this.schema.properties,function(e,t){n.initChild(t)}),this._value=this.getDefault(),_.each(this.schema.properties,function(e,t){n._value[t]=n.children[t].getDefault()}),this.schema.type&&this.el.setAttribute("data-type",this.schema.type),this.rendered&&(this.isHidden()?this.hide():this.unhide())},enumerable:!1,configurable:!0}),Object.defineProperty(bx.prototype,"value",{get:function(){var t=this,n={};if(void 0!==this._value)return Object.keys(this.children).forEach(function(e){void 0!==t.children[e].value&&(n[e]=t.children[e].value)}),n},set:function(t){var n=this;this._value=t,this.determineEmpty(t)?this.el.classList.add("undefined"):(this.el.classList.remove("undefined"),_.isEmpty(t)||Object.keys(this.children).forEach(function(e){n.children[e].value=t[e]})),this.setTitle()},enumerable:!1,configurable:!0}),bx.prototype.updatePaths=function(){var t=this;ax.prototype.updatePaths.call(this),this.getChildren().forEach(function(e){e.path=(t.path?t.path+".":"")+e.key})},bx),ax;function bx(e,t,n,i){return ax.call(this,e,t,n,i)||this}var OneOfContainer=(yx=ItemContainer,__extends(zx,yx),Object.defineProperty(zx.prototype,"expanded",{get:function(){return this._expanded},set:function(e){_.isNil(e)||(this._expanded=e,this.childItem&&((this.childItem.expanded=e)&&e._self?this.el.classList.add("child-expanded"):this.el.classList.remove("child-expanded")))},enumerable:!1,configurable:!0}),Object.defineProperty(zx.prototype,"schema",{get:function(){return this._schema},set:function(e){this.childItem&&this.childItem.remove(),this._schema=e,this._value=this.getDefault(),this.schema.type&&this.el.setAttribute("data-type",this.schema.type)},enumerable:!1,configurable:!0}),Object.defineProperty(zx.prototype,"value",{get:function(){return this.childItem?this.childItem.value:this._value},set:function(e){var t=this.determineEditor(e);t!==this.selectedEditor&&(this.selectedEditor=t,this.switchEditor(e),this.rendered&&this.renderChildItem()),this._value=e,this.childItem&&(this.childItem.value=this._value),this.emit(),this.determineEmpty(e)?this.el.classList.add("undefined"):this.el.classList.remove("undefined")},enumerable:!1,configurable:!0}),zx.prototype.filter=function(e){var t,n;return this.childItem?(t=this.childItem.rendered,(n=this.childItem.filter(e))?(this.el.classList.remove("filtered"),t||this.renderChildItem()):this.el.classList.add("filtered"),n):yx.prototype.filter.call(this,e)},zx.prototype.getDefault=function(){return this.childItem?this.childItem.getDefault():yx.prototype.getDefault.call(this)},zx.prototype.hide=function(){yx.prototype.hide.call(this),this.childItem&&this.childItem.hide()},zx.prototype.postRender=function(){yx.prototype.postRender.call(this),this.select2=$(this.input).select2({minimumResultsForSearch:10,theme:"dashboards-properties"}),this.select2El=this.el.getElementsByClassName("select2-container")[0],rxjs.fromEvent(this.select2,"select2:select").pipe(rxjs.operators.map(function(e){return e.params.data.id})).subscribe(this.onSelectEditor.bind(this))},zx.prototype.remove=function(){this.childItem&&this.childItem.remove(),yx.prototype.remove.call(this)},zx.prototype.render=function(){return this.input=document.createElement("select"),this.el.append(this.input),this.renderOptions(),this.switchEditor(this.value),this.renderChildItem(),this.el.classList.add("select2-wrapper"),this.el.classList.add("oneOf"),this.updatePaths(),this.watch(),this.el},zx.prototype.switchEditor=function(e){this.select2El&&this.el.append(this.select2El),this.childItem&&this.childItem.remove(),this.initChild();var t=this.childItem.getDefault();e&&_.mergeWith(t,e,function(e,t,n,i){void 0===t&&_.set(i,n,void 0)}),this._value=t,void 0===(this.childItem.value=t)?this.el.classList.add("undefined"):this.el.classList.remove("undefined")},zx.prototype.unhide=function(){yx.prototype.unhide.call(this),this.childItem&&this.childItem.unhide()},zx.prototype.updatePaths=function(){yx.prototype.updatePaths.call(this),this.childItem&&(this.childItem.path=this.path,this.childItem.el.setAttribute("data-i",this.el.getAttribute("data-i")))},zx.prototype.renderChildItem=function(){this.select2&&this.select2.val(this.selectedEditor).trigger("change"),this.rendered=!0;var e=this.childItem.render();return this.el.append(e),this.childItem.postRender(),_.defer(function(){this.select2El&&(this.inline?this.childItem.el.insertBefore(this.select2El,this.childItem.editor):this.childItem.title&&this.childItem.title.append(this.select2El))}.bind(this)),this.el},zx.prototype.determineEditor=function(l){var r=0;return this.schema.oneOf.some(function(e,t){if(e.options&&e.options.linked_oneof_property){for(var n=e.options.linked_oneof_property,i=n.property.split("."),o=l,a=void 0,s=!1;o&&(a=i.shift());)i.length?o=o[a]:s=o[a]===n.value;if(s)return r=t,!0}}),r},zx.prototype.initChild=function(){this.childItem=this.root.initItem(this.schema.oneOf[this.selectedEditor||0],this.path,{expanded:this.expanded,labelled:this.inline,label:this.schema.title})},zx.prototype.onSelectEditor=function(e){var e=this.editors[e].linkedProperty,t=this.value,n=(e&&LocalTools.setValue(t,e.property,e.value),this.determineEditor(t)),n=(n!==this.selectedEditor&&(this.selectedEditor=n,this.switchEditor(this.keepValues?t:null),this.renderChildItem()),this.value);e&&LocalTools.setValue(n,e.property,e.value),this.setValueByPath(n,this.path),this.childItem.expanded=this.expanded},zx.prototype.renderOptions=function(){var n=this;this.input.options.length=0,Object.keys(this.editors).forEach(function(e){var t=document.createElement("option");t.value=e,t.text=n.editors[e].title,Number(t.value)===n.selectedEditor&&(t.selected=!0),n.input.append(t)}),$(this.input).trigger("change")},zx.labelled=!1,zx),yx;function zx(e,t,n,i){var o=yx.call(this,e,t,n,i)||this;return o.editors={},o.inline=o.schema.options&&o.schema.options.inline,o.keepValues=!o.schema.options||void 0===o.schema.options.keep_oneof_values||o.schema.options.keep_oneof_values,o.schema.oneOf.forEach(function(t,e){["headerTemplate","type"].forEach(function(e){!t[e]&&o.schema[e]&&(t[e]=o.schema[e])}),["collapsed","custom_class_name","disable_collapse","inline","title"].forEach(function(e){t.options&&!t.options.hasOwnProperty(e)&&o.schema.options&&o.schema.options[e]&&(t.options[e]=o.schema.options[e])}),t.headerTemplate||(t.headerTemplate=o.schema.title||o.key||"Item","array"===t.type&&(t.headerTemplate+=" {{ i1 }}")),o.editors[e]={linkedProperty:t.options?t.options.linked_oneof_property:null,title:t.title}}),o.selectedEditor=0,o.switchEditor(),o}var PopupsContainer=(ny=ArrayContainer,__extends(oy,ny),oy.prototype.renderChild=function(e,t){var n,i=this;ny.prototype.renderChild.call(this,e,t),this.schemaOptions.editPopupButton&&((n=document.createElement("i")).className="fa fa-pencil editPopup",n.setAttribute("title","Edit Popup"),n.addEventListener("click",function(){event.preventDefault(),event.stopPropagation(),i.root.api.showPopupEditor(e.value.id)}),this.children[t].el.appendChild(n))},oy),ny;function oy(){return null!==ny&&ny.apply(this,arguments)||this}var TableContainer=(ty=ArrayContainer,__extends(uy,ty),uy.prototype.render=function(){return ty.prototype.render.call(this),this.table=document.createElement("table"),this.tableBody=document.createElement("tbody"),this.table.append(this.tableBody),this.childrenEl.prepend(this.table),this.canDrag&&(this.dragContainer=this.tableBody),this.el},uy.prototype.updatePaths=function(){if(ty.prototype.updatePaths.call(this),this.rendered)for(var e=this.tableBody.children,t=0;t<e.length;t++)e[t].setAttribute("data-i",t.toString())},uy.prototype.removeChild=function(e){var t=this.children.indexOf(e);e.remove(),this.children.splice(t,1),this.rendered&&(e=this.tableBody.querySelector("[data-i='"+t+"']"))&&this.tableBody.removeChild(e)},uy.prototype.renderChild=function(n,e){var t,i,o=this,a=[],s=document.createElement("tr");this.tableHeader||this.renderTableHeader(n.schema),n.render().setAttribute("data-i",e),s.setAttribute("data-i",e),n.children?Object.keys(n.children).filter(function(e){return!(n.children[e].schemaOptions&&n.children[e].schemaOptions.hidden)}).forEach(function(e){var e=n.children[e],t=document.createElement("td");t.classList.add("container"),t.setAttribute("data-type",e.schema.type),e.rendered||(e.render(),t.append(e.editor.el),s.append(t),a.push(e))}):((t=document.createElement("td")).classList.add("container"),t.setAttribute("data-type",n.schema.type),t.append(n.editor.el),s.append(t)),this.canRemove&&(t=document.createElement("td"),e=document.createElement("i"),i=document.createElement("span"),e.classList.add("remove","fa","fa-trash"),e.onclick=function(e){e.stopPropagation(),e.preventDefault(),o.children.splice(Number(s.getAttribute("data-i")),1),s.remove(),o.updatePaths(),o.setValueByPath(o.value,o.path),o.children.length||(o.tableHeader.remove(),o.tableHeader=null)},i.append(e),t.classList.add("container"),t.classList.add("remove-icon"),t.append(i),s.append(t)),this.tableBody.append(s),n.pendingRenderChildren=!1,n.postRender(),a.forEach(function(e){return e.postRender()}),this.canDrag&&this.addDragListeners(s)},uy.prototype.renderTableHeader=function(e){var t=e.properties||{},n=[],i=document.createElement("tr");Object.keys(t).forEach(function(e){t[e].options&&t[e].options.hidden||n.push(t[e].title||e)}),this.tableHeader=document.createElement("thead"),this.tableHeader.append(i),n.forEach(function(e){var t=document.createElement("th");t.innerHTML=e,i.append(t)}),this.canRemove&&((e=document.createElement("th")).className="remove",i.append(e)),this.table.prepend(this.tableHeader)},uy),ty;function uy(e,t,n,i){e=ty.call(this,e,t,n,i)||this;return e.el.setAttribute("data-format","table"),e}var CONTAINERS={actions:ActionsContainer,array:ArrayContainer,backbone:BackboneContainer,object:ObjectContainer,oneOf:OneOfContainer,popups:PopupsContainer,table:TableContainer},Containers=(bz.get=function(e){return e.oneOf?CONTAINERS.oneOf:"array"===e.type&&"table"===e.format?CONTAINERS.table:CONTAINERS[e.type]||ItemContainer},bz),ChangeType,dz;function bz(){}dz=ChangeType=ChangeType||{},dz[dz.Expanded=0]="Expanded",dz[dz.Value=1]="Value";var PropertyEditor=(ez.prototype.addListener=function(e,t,n){e=this.getItemByPath(e,n);return e?e.addListener(t):null},ez.prototype.canPaste=function(e){e=this.itemsById[e];return!!e&&e.canPaste},ez.prototype.copy=function(){return this.copiedItem&&this.copiedItem.setCopyState(!1),this.copiedItem=this.itemsById[this.getFocusedPath()],this.copiedItem?(this.copiedItem.setCopyState(!0),this.copiedItem.value):null},ez.prototype.expand=function(e,t){var n=_.cloneDeep(this.expanded);null===e?_.unset(n,this.trimPath(t)):"root"===t?_.extend(n,e):LocalTools.setValue(n,this.trimPath(t),e),_.isEqual(n,this.expanded)||(this.expanded=n,this.debouncedApplyExpanded())},ez.prototype.filter=function(e){e&&2<e.length?this.item.filter(e):e||this.item.filter(null)},ez.prototype.focusItemByPath=function(e){this.getItemByPath(e).onClick()},ez.prototype.getItemByPath=function(e,t){e=this.getNodes(e,t);return e[e.length-1]},ez.prototype.getExpanded=function(){return this.item.expanded},ez.prototype.getFocusedPath=function(){return this.focusedPath},ez.prototype.getSchema=function(){return this.item.schema},ez.prototype.getValue=function(){return this.item.value},ez.prototype.initItem=function(e,t,n){return new(Containers.get(e))(e,t,this,n||{})},ez.prototype.onChange=function(e){this.subject.closed||this.subject.next(e)},ez.prototype.onFocus=function(e){QuickBase.ErrorTooltip.clearAll(!1),this.focusedPath=e||""},ez.prototype.pasteProperties=function(n,i){var t=this,e=this.itemsById[i];this.copiedItem&&this.copiedItem.setCopyState(!1),e&&rxjs.concat.apply(rxjs,this.getModifiers("paste",i).map(function(e){return rxjs.Observable.create(function(t){e.fn(n,i,function(e){t.next(e),t.complete()})})})).pipe(rxjs.operators.timeout(1e4)).subscribe({next:function(e){n=e},error:function(e){t.setEditorState(!0),console.error(e)},complete:function(){e.paste(n),t.setEditorState(!0),t.onChange(ChangeType.Value)}})},ez.prototype.register=function(e){var t=e.schema&&e.schema.id?e.schema.id+"."+e.key:e.path;this.itemsById[t]=e},ez.prototype.reloadHeaderTemplates=function(){this.item.reloadHeaderTemplates()},ez.prototype.remove=function(){this.item.remove(),QuickBase.ErrorTooltip.clearAll(!1),this.el.innerHTML="",this.subject.unsubscribe()},ez.prototype.setExpanded=function(e){this.expand(e,"root")},ez.prototype.setSchema=function(e){this.item.schema=e},ez.prototype.setValue=function(e){this.item.value=e},ez.prototype.setValueByPath=function(e,t){var n=this,i=e;this.setEditorState(!1),this.transform(e,t).subscribe({next:function(e){i=e},error:function(e){n.setEditorState(!0),console.error(e)},complete:function(){n.item.value=i,n.setEditorState(!0),n.onChange(ChangeType.Value)}})},ez.prototype.subscribe=function(e){this.subject.subscribe(e)},ez.prototype.startCopy=function(){$(window).trigger($.Event("keydown",{ctrlKey:!0,keyCode:67}))},ez.prototype.startPaste=function(){$(window).trigger($.Event("keydown",{ctrlKey:!0,keyCode:86}))},ez.prototype.setCopyPasteIcons=function(){this.setCopyIcon(!0),this.setPasteIcon(!0)},ez.prototype.setCopyIcon=function(e){e?this.item.el.classList.add("clipboardCopy"):this.item.el.classList.remove("clipboardCopy")},ez.prototype.setPasteIcon=function(e){e?this.item.el.classList.add("clipboardPaste"):this.item.el.classList.remove("clipboardPaste")},ez.prototype.applyExpanded=function(){this.item.expanded=this.expanded,this.onChange(ChangeType.Expanded)},ez.prototype.getAbsolutePath=function(e,t){var n=e.split(".");if("root"===n[0])return e;var i,o,e=this.getNodes(t);return(i=(i=e[e.map(function(e){return e.schema.id||e.key}).indexOf(n[0])])?i:(o=e[e.length-1].children)?o[n[0]]:null)||1<e.length&&(i=(o=e[e.length-2].children)?o[n[0]]:null),t&&i?(n.shift(),__spreadArrays([i.path],n).join(".")):""},ez.prototype.getMask=function(){var e=document.createElement("div"),t=document.createElement("i");return e.className="mask",t.className="mask-icon fa fa-spinner fa-pulse",e.append(t),e},ez.prototype.getNodes=function(e,t){var e=this.getAbsolutePath(e,t),n=this.item,i=[n],t=e.split(".");return t.shift(),t.forEach(function(e){(n=n&&("object"===(n=n.schema.oneOf?n.childItem||n.children[n.selectedEditor]:n).schema.type||"array"===n.schema.type?n.children[e]:n))&&i.push(n)}),i},ez.prototype.getModifiers=function(t,e){var n=[];return this.getNodes(e).forEach(function(e){e.schema["_"+t]&&"function"==typeof e.schema["_"+t]&&n.push({fn:e.schema["_"+t],path:e.path})}),n.reverse()},ez.prototype.transform=function(n,a){var s,l=this,e=this.trimPath(a);return"root"===e?s=n:(s=this.item.value,LocalTools.setValue(s,e,n)),rxjs.concat.apply(rxjs,this.getModifiers("transform",a).map(function(e){var i=l.getItemByPath(e.path),t=i.path,o="root"===t?s:i.value;return a!==i.path&&(t=a.replace(i.path+".",""),LocalTools.setValue(o,t,n)),rxjs.Observable.create(function(n){e.fn(o,_.cloneDeep(i.schema),t,function(e,t){t&&(i.schema=t),_.isUndefined(e)||("root"===i.path?s=e:LocalTools.setValue(s,i.path.substring(5),e),n.next(s)),n.complete()})})})).pipe(rxjs.operators.startWith(s),rxjs.operators.timeout(1e4))},ez.prototype.trimPath=function(e){return"root."===e.substring(0,5)?e.substring(5):e},ez.prototype.registerHandlebarsHelpers=function(){Handlebars.registerHelper("valueProp",function(e){return"string"==typeof e?e:"object"==typeof e&&new Handlebars.SafeString(e.get("value"))})},ez.prototype.setEditorState=function(e){e?this.el.classList.remove("loading"):this.el.classList.add("loading")},ez.ChangeType=ChangeType,ez);function ez(e,t,n,i,o,a){this.el=i,this.el.classList.add("property-editor"),this.registerHandlebarsHelpers(),this.itemsById={},this.expanded=n||{},this.listeners={},this.debouncedApplyExpanded=_.debounce(this.applyExpanded.bind(this),50),this.api=o,this.schema=e,Editors.setViewStateEditors(a),this.subject=new rxjs.Subject(""),this.item=this.initItem(e,"root",{expanded:this.expanded}),this.el.append(this.item.render()),this.item.postRender(),this.el.append(this.getMask()),this.setValueByPath(t,"root")}!function(){var l=jQuery;l.widget("ui.dialogExtend",{version:"2.0.0",modes:{},options:{closable:!0,dblclick:!1,titlebar:!1,icons:{close:"ui-icon-closethick",restore:"ui-icon-newwin"},load:null,beforeRestore:null,restore:null},_create:function(){return this._state="normal",l(this.element[0]).data("ui-dialog")||l.error("jQuery.dialogExtend Error : Only jQuery UI Dialog element is accepted"),this._verifyOptions(),this._initStyles(),this._initButtons(),this._initTitleBar(),this._setState("normal"),this._on("load",function(e){return console.log("test",e)}),this._trigger("load")},_setState:function(e){return l(this.element[0]).removeClass("ui-dialog-"+this._state).addClass("ui-dialog-"+e),this._state=e},_verifyOptions:function(){var e,t,n;for(e in!this.options.dblclick||this.options.dblclick in this.modes||(l.error("jQuery.dialogExtend Error : Invalid <dblclick> value '"+this.options.dblclick+"'"),this.options.dblclick=!1),this.options.titlebar&&"none"!==(t=this.options.titlebar)&&"transparent"!==t&&(l.error("jQuery.dialogExtend Error : Invalid <titlebar> value '"+this.options.titlebar+"'"),this.options.titlebar=!1),n=[],this.modes)this["_verifyOptions_"+e]?n.push(this["_verifyOptions_"+e]()):n.push(void 0);return n},_initStyles:function(){var e,t;for(e in l(".dialog-extend-css").length||l('<style class="dialog-extend-css" type="text/css">.ui-dialog .ui-dialog-titlebar-buttonpane>a { float: right; }.ui-dialog .ui-dialog-titlebar-restore { width: 19px; height: 18px; }.ui-dialog .ui-dialog-titlebar-restore span { display: block; margin: 1px; }.ui-dialog .ui-dialog-titlebar-restore:hover,.ui-dialog .ui-dialog-titlebar-restore:focus { padding: 0; }.ui-dialog .ui-dialog-titlebar ::selection { background-color: transparent; }</style>').appendTo("body"),t=[],this.modes)t.push(this["_initStyles_"+e]());return t},_initButtons:function(){var e,t,n,i=this,o=l(this.element[0]).dialog("widget").find(".ui-dialog-titlebar"),a=l('<div class="ui-dialog-titlebar-buttonpane"></div>').appendTo(o);for(t in a.css({position:"absolute",top:"50%",right:"0.3em","margin-top":"-10px",height:"18px"}),o.find(".ui-dialog-titlebar-close").css({position:"relative",float:"right",top:"auto",right:"auto",margin:0}).find(".ui-icon").removeClass("ui-icon-closethick").addClass(this.options.icons.close).end().appendTo(a).end(),a.append('<a class="ui-dialog-titlebar-restore ui-corner-all ui-state-default" href="#"><span class="ui-icon '+this.options.icons.restore+'" title="restore">restore</span></a>').find(".ui-dialog-titlebar-restore").attr("role","button").mouseover(function(){return l(this).addClass("ui-state-hover")}).mouseout(function(){return l(this).removeClass("ui-state-hover")}).focus(function(){return l(this).addClass("ui-state-focus")}).blur(function(){return l(this).removeClass("ui-state-focus")}).end().find(".ui-dialog-titlebar-close").toggle(this.options.closable).end().find(".ui-dialog-titlebar-restore").hide().click(function(e){return e.preventDefault(),i.restore()}).end(),n=this.modes)e=n[t],this._initModuleButton(t,e);return o.dblclick(function(e){if(i.options.dblclick)return"normal"!==i._state?i.restore():i[i.options.dblclick]()}).select(function(){return!1})},_initModuleButton:function(t,e){var n=this;return l(this.element[0]).dialog("widget").find(".ui-dialog-titlebar-buttonpane").append('<a class="ui-dialog-titlebar-'+t+' ui-corner-all ui-state-default" href="#" title="'+t+'"><span class="ui-icon '+this.options.icons[t]+'">'+t+"</span></a>").find(".ui-dialog-titlebar-"+t).attr("role","button").mouseover(function(){return l(this).addClass("ui-state-hover")}).mouseout(function(){return l(this).removeClass("ui-state-hover")}).focus(function(){return l(this).addClass("ui-state-focus")}).blur(function(){return l(this).removeClass("ui-state-focus")}).end().find(".ui-dialog-titlebar-"+t).toggle(this.options[e.option]).click(function(e){return e.preventDefault(),n[t]()}).end()},_initTitleBar:function(){var e;switch(this.options.titlebar){case!1:return 0;case"none":return l(this.element[0]).dialog("option","draggable")&&(e=l("<div />").addClass("ui-dialog-draggable-handle").css("cursor","move").height(5),l(this.element[0]).dialog("widget").prepend(e).draggable("option","handle",e)),l(this.element[0]).dialog("widget").find(".ui-dialog-titlebar").find(".ui-dialog-title").html("&nbsp;").end().css({"background-color":"transparent","background-image":"none",border:0,position:"absolute",right:0,top:0,"z-index":9999}).end();case"transparent":return l(this.element[0]).dialog("widget").find(".ui-dialog-titlebar").css({"background-color":"transparent","background-image":"none",border:0});default:return l.error("jQuery.dialogExtend Error : Invalid <titlebar> value '"+this.options.titlebar+"'")}},state:function(){return this._state},restore:function(){return this._trigger("beforeRestore"),this._restore(),this._toggleButtons(),this._trigger("restore")},_restore:function(){if("normal"!==this._state)return this["_restore_"+this._state](),this._setState("normal"),l(this.element[0]).dialog("widget").focus()},_saveSnapshot:function(){if("normal"===this._state)return this.original_config_resizable=l(this.element[0]).dialog("option","resizable"),this.original_config_draggable=l(this.element[0]).dialog("option","draggable"),this.original_size_height=l(this.element[0]).dialog("widget").outerHeight(),this.original_size_width=l(this.element[0]).dialog("option","width"),this.original_size_maxHeight=l(this.element[0]).dialog("option","maxHeight"),this.original_position_mode=l(this.element[0]).dialog("widget").css("position"),this.original_position_left=l(this.element[0]).dialog("widget").offset().left-l("body").scrollLeft(),this.original_position_top=l(this.element[0]).dialog("widget").offset().top-l("body").scrollTop(),this.original_titlebar_wrap=l(this.element[0]).dialog("widget").find(".ui-dialog-titlebar").css("white-space")},_loadSnapshot:function(){return{config:{resizable:this.original_config_resizable,draggable:this.original_config_draggable},size:{height:this.original_size_height,width:this.original_size_width,maxHeight:this.original_size_maxHeight},position:{mode:this.original_position_mode,left:this.original_position_left,top:this.original_position_top},titlebar:{wrap:this.original_titlebar_wrap}}},_toggleButtons:function(e){var t,n,i,o,a,s=e||this._state;for(n in l(this.element[0]).dialog("widget").find(".ui-dialog-titlebar-restore").toggle("normal"!==s).css({right:"1.4em"}).end(),i=this.modes)t=i[n],l(this.element[0]).dialog("widget").find(".ui-dialog-titlebar-"+n).toggle(s!==t.state&&this.options[t.option]);for(n in a=[],o=this.modes)(t=o[n]).state===s?a.push(l(this.element[0]).dialog("widget").find(".ui-dialog-titlebar-restore").insertAfter(l(this.element[0]).dialog("widget").find(".ui-dialog-titlebar-"+n)).end()):a.push(void 0);return a}})}.call(this),!function(){var n=jQuery;n.extend(!0,n.ui.dialogExtend.prototype,{modes:{collapse:{option:"collapsable",state:"collapsed"}},options:{collapsable:!1,icons:{collapse:"ui-icon-triangle-1-s"},beforeCollapse:null,collapse:null},collapse:function(){var e,t=n(this.element[0]).dialog("widget").find(".ui-dialog-titlebar").height()+15;return this._trigger("beforeCollapse"),"normal"!==this._state&&this._restore(),this._saveSnapshot(),e=n(this.element[0]).dialog("widget").position(),n(this.element[0]).dialog("option",{resizable:!1,height:t,maxHeight:t,position:[e.left-n(document).scrollLeft(),e.top-n(document).scrollTop()]}).on("dialogclose",this._collapse_restore).hide().dialog("widget").find(".ui-dialog-buttonpane:visible").hide().end().find(".ui-dialog-titlebar").css("white-space","nowrap").end().find(".ui-dialog-content"),this._setState("collapsed"),this._toggleButtons(),this._trigger("collapse")},_restore_collapsed:function(){var e=this._loadSnapshot();return n(this.element[0]).show().dialog("widget").find(".ui-dialog-buttonpane:hidden").show().end().find(".ui-dialog-titlebar").css("white-space",e.titlebar.wrap).end().find(".ui-dialog-content").dialog("option",{resizable:e.config.resizable,height:e.size.height,maxHeight:e.size.maxHeight}).off("dialogclose",this._collapse_restore)},_initStyles_collapse:function(){if(!n(".dialog-extend-collapse-css").length)return""+'<style class="dialog-extend-collapse-css" type="text/css">'+".ui-dialog .ui-dialog-titlebar-collapse { width: 19px; height: 18px; }"+".ui-dialog .ui-dialog-titlebar-collapse span { display: block; margin: 1px; }"+".ui-dialog .ui-dialog-titlebar-collapse:hover,"+".ui-dialog .ui-dialog-titlebar-collapse:focus { padding: 0; }"+"</style>",n('<style class="dialog-extend-collapse-css" type="text/css">.ui-dialog .ui-dialog-titlebar-collapse { width: 19px; height: 18px; }.ui-dialog .ui-dialog-titlebar-collapse span { display: block; margin: 1px; }.ui-dialog .ui-dialog-titlebar-collapse:hover,.ui-dialog .ui-dialog-titlebar-collapse:focus { padding: 0; }</style>').appendTo("body")},_collapse_restore:function(){return n(this).dialogExtend("restore")}})}.call(this),!function(){var n=jQuery;n.extend(!0,n.ui.dialogExtend.prototype,{modes:{maximize:{option:"maximizable",state:"maximized"}},options:{maximizable:!1,icons:{maximize:"ui-icon-extlink"},beforeMaximize:null,maximize:null},maximize:function(){var e=n(window).height()-11,t=n(window).width()-11;return this._trigger("beforeMaximize"),"normal"!==this._state&&this._restore(),this._saveSnapshot(),n(this.element[0]).dialog("option","draggable")&&n(this.element[0]).dialog("widget").draggable("option","handle",null).find(".ui-dialog-draggable-handle").css("cursor","text").end(),n(this.element[0]).dialog("widget").css("position","fixed").find(".ui-dialog-content").show().dialog("widget").find(".ui-dialog-buttonpane").show().end().find(".ui-dialog-content").dialog("option",{resizable:!1,draggable:!1,height:e,width:t,position:{my:"left top",at:"left top",of:window}}),this._setState("maximized"),this._toggleButtons(),this._trigger("maximize")},_restore_maximized:function(){var e=this._loadSnapshot();if(n(this.element[0]).dialog("widget").css("position",e.position.mode).find(".ui-dialog-titlebar").css("white-space",e.titlebar.wrap).end().find(".ui-dialog-content").dialog("option",{resizable:e.config.resizable,draggable:e.config.draggable,height:e.size.height,width:e.size.width,maxHeight:e.size.maxHeight,position:{my:"left top",at:"left+"+e.position.left+" top+"+e.position.top,of:window}}),n(this.element[0]).dialog("option","draggable"))return n(this.element[0]).dialog("widget").draggable("option","handle",n(this.element[0]).dialog("widget").find(".ui-dialog-draggable-handle").length?n(this.element[0]).dialog("widget").find(".ui-dialog-draggable-handle"):".ui-dialog-titlebar").find(".ui-dialog-draggable-handle").css("cursor","move")},_initStyles_maximize:function(){if(!n(".dialog-extend-maximize-css").length)return""+'<style class="dialog-extend-maximize-css" type="text/css">'+".ui-dialog .ui-dialog-titlebar-maximize { width: 19px; height: 18px; }"+".ui-dialog .ui-dialog-titlebar-maximize span { display: block; margin: 1px; }"+".ui-dialog .ui-dialog-titlebar-maximize:hover,"+".ui-dialog .ui-dialog-titlebar-maximize:focus { padding: 0; }"+"</style>",n('<style class="dialog-extend-maximize-css" type="text/css">.ui-dialog .ui-dialog-titlebar-maximize { width: 19px; height: 18px; }.ui-dialog .ui-dialog-titlebar-maximize span { display: block; margin: 1px; }.ui-dialog .ui-dialog-titlebar-maximize:hover,.ui-dialog .ui-dialog-titlebar-maximize:focus { padding: 0; }</style>').appendTo("body")}})}.call(this),!function(){var n=jQuery;n.extend(!0,n.ui.dialogExtend.prototype,{modes:{minimize:{option:"minimizable",state:"minimized"}},options:{minimizable:!1,minimizeLocation:"left",icons:{minimize:"ui-icon-minus"},beforeMinimize:null,minimize:null},minimize:function(){var e,t;return this._trigger("beforeMinimize"),"normal"!==this._state&&this._restore(),n("#dialog-extend-fixed-container").length?t=n("#dialog-extend-fixed-container"):(t=n('<div id="dialog-extend-fixed-container"></div>').appendTo("body")).css({position:"fixed",bottom:1,left:1,right:1,"z-index":9999}),this._toggleButtons("minimized"),e=n(this.element[0]).dialog("widget").clone().children().remove().end(),n(this.element[0]).dialog("widget").find(".ui-dialog-titlebar").clone(!0,!0).appendTo(e),e.css({float:this.options.minimizeLocation,margin:1}),t.append(e),n(this.element[0]).data("dialog-extend-minimize-controls",e),n(this.element[0]).dialog("option","draggable")&&e.removeClass("ui-draggable"),e.css({height:"auto",width:200,position:"static"}),n(this.element[0]).on("dialogbeforeclose",this._minimize_restoreOnClose).dialog("widget").hide(),this._setState("minimized"),this._trigger("minimize")},_restore_minimized:function(){return n(this.element[0]).dialog("widget").show(),n(this.element[0]).off("dialogbeforeclose",this._minimize_restoreOnClose),n(this.element[0]).data("dialog-extend-minimize-controls").remove(),n(this.element[0]).removeData("dialog-extend-minimize-controls")},_initStyles_minimize:function(){if(!n(".dialog-extend-minimize-css").length)return""+'<style class="dialog-extend-minimize-css" type="text/css">'+".ui-dialog .ui-dialog-titlebar-minimize { width: 19px; height: 18px; }"+".ui-dialog .ui-dialog-titlebar-minimize span { display: block; margin: 1px; }"+".ui-dialog .ui-dialog-titlebar-minimize:hover,"+".ui-dialog .ui-dialog-titlebar-minimize:focus { padding: 0; }"+"</style>",n('<style class="dialog-extend-minimize-css" type="text/css">.ui-dialog .ui-dialog-titlebar-minimize { width: 19px; height: 18px; }.ui-dialog .ui-dialog-titlebar-minimize span { display: block; margin: 1px; }.ui-dialog .ui-dialog-titlebar-minimize:hover,.ui-dialog .ui-dialog-titlebar-minimize:focus { padding: 0; }</style>').appendTo("body")},_verifyOptions_minimize:function(){var e;if(!this.options.minimizeLocation||"left"!==(e=this.options.minimizeLocation)&&"right"!==e)return n.error("jQuery.dialogExtend Error : Invalid <minimizeLocation> value '"+this.options.minimizeLocation+"'"),this.options.minimizeLocation="left"},_minimize_restoreOnClose:function(){return n(this).dialogExtend("restore")}})}.call(this);var BulkColumnEditorDialog=Backbone.View.extend({className:"dlgBulkColumnEditorDialog",initialize:function(e){var n=this;this.editor=(e=e||{}).editor,n.$el.html(T.BulkColumnEditorDialog()),n.initControls(),n.initRenderedDialogOnce=_.once(n.initRenderedDialog),this.$dialog=n.$el.dialog(_.extend({appendTo:e.container,title:t("Multi Column Editor "),dialogClass:"quick-dash",resizable:!0,height:540,width:600,minWidth:600,modal:!0,autoOpen:!1,buttons:[{text:t("Apply"),disabled:!0,click:$.proxy(n.applyChanges,n),icons:{primary:"fa fa-check-square-o"}},{text:t("Close"),click:$.proxy(n.onCloseButtonClick,n),icons:{primary:"fa fa-times"}}],open:function(){n.initRenderedDialogOnce()}},e))},applyChanges:function(){var e=this,n=e.bulkEditor.value,i=e.editor.getValue(),o=!1,a=$.map(e.$lstProperties.find("> .ui-selected"),function(e){return $(e).data("schemapath").replace("root.","")});_.each(e.$lstColumns.find(">li"),function(e,t){$(e).is(".ui-selected")&&_.each(a,function(e){n[t][e]!==i[e]&&(n[t][e]=i[e],o=!0)})}),o&&e.bulkEditor.setValueByPath(n,e.bulkEditor.path)},initControls:function(){this.$pnlPropertyEditor=this.$(".pnlPropertyEditor"),this.$propertiesPanel=this.$(".properties-panel"),this.$lstColumns=this.$(".lstColumns"),this.$pnlInfo=this.$(".pnlInfo")},initRenderedDialog:function(){$('<i class="fa fa-columns" />').insertBefore(this.$el.parent().find(".ui-dialog-title")),this.$btnApply=this.$el.next().find("button:nth-of-type(1)")},checkSelectableStatuses:function(){var e=!0,t=this.$lstColumns.find(">.ui-selected").length,n=this.$lstProperties?this.$lstProperties.find(">.ui-selected").length:0;0===t&&0===n?this.$pnlInfo.html("Use the mouse to select items, individually or in a group.<br/> Hold down the CTRL key to make multiple non-adjacent selections."):0===t?this.$pnlInfo.html(n+(1===n?" property":" properties")+" selected. Please select columns to format.<br/>Hold down the CTRL key to make multiple non-adjacent selections."):0==n?this.$pnlInfo.html(t+(1===t?" column":" columns")+" selected. Please select properties to be changed.<br/>Hold down the CTRL key to make multiple non-adjacent selections."):(this.$pnlInfo.html("Click 'Apply' to change format for selected columns.<br/>Changes ("+n+(1===n?" property":" properties")+") will be applied to "+t+(1===t?" column.":" columns.")),e=!1),this.$btnApply.button({disabled:e})},onCloseButtonClick:function(){this.$el.dialog("close")},open:function(){this.$propertiesPanel.removeClass("kx-light"),"kx-light"===$.cookie("dashboard-theme")&&this.$propertiesPanel.addClass("kx-light"),this.$el.dialog("open"),this.checkSelectableStatuses()},remove:function(){self.$lstColumns.is(":ui-selectable")&&self.$lstColumns.selectable("destroy"),this.$dialog.dialog("destroy"),Backbone.View.prototype.remove.call(this)},setEditor:function(e){var t,n=this;n.bulkEditor=e,n.$lstColumns.is(":ui-selectable")&&n.$lstColumns.selectable("destroy"),n.$lstColumns.empty(),t=n.bulkEditor.value,n.$lstColumns.append(_.map(t,function(e){var t=document.createElement("li");return t.textContent=_.get(e.DisplayName,"attributes.value",e.DisplayName)||_.get(e.Field,"attributes.value",e.Field),t})),n.$lstColumns.selectable({stop:function(){n.checkSelectableStatuses()}}),(t=_.cloneDeep(n.bulkEditor.getChildSchema())).headerTemplate=null,t.title="Properties",t.options.disable_collapse=!0,t.options.collapsed=!1,t.properties=_.omit(t.properties,"Field","DisplayName"),n.$pnlPropertyEditor.empty(),n.editor=new PropertyEditor(t,null,null,n.$pnlPropertyEditor[0],e.root.api),n.$lstProperties=n.$pnlPropertyEditor.find("> .container > .editor"),n.$lstProperties.selectable({filter:">.container",stop:function(){n.checkSelectableStatuses()}})}}),$B,cC,gC,jC,kC,lC,mC,nC,oC,qC,sC,wC,xC,zC,AC,CC,DC,IC,JC,LC,MC,NC,PC,QC,RC,SC,TC,dC;function pC(e,t){cC(t).data("colorpicker").currentColor.css("backgroundColor","#"+TC(e))}function rC(e){if(e=e.charCode||e.keyCode||-1,gC<e&&e<=90||32==e)return!1;!0===cC(this).parent().parent().data("colorpicker").livePreview&&sC.apply(this)}function tC(e){cC(this).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus")}function uC(){gC=0<this.parentNode.className.indexOf("_hex")?70:65,cC(this).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus"),cC(this).parent().addClass("colorpicker_focus")}function vC(e){var t=cC(this).parent().find("input").focus(),e={el:cC(this).parent().addClass("colorpicker_slider"),max:0<this.parentNode.className.indexOf("_hsb_h")?360:0<this.parentNode.className.indexOf("_hsb")?100:255,y:e.pageY,field:t,val:parseInt(t.val(),10),preview:cC(this).parent().parent().data("colorpicker").livePreview};cC(document).bind("mouseup",e,xC),cC(document).bind("mousemove",e,wC)}function yC(e){var t={cal:cC(this).parent(),y:cC(this).offset().top};t.preview=t.cal.data("colorpicker").livePreview,cC(document).bind("mouseup",t,AC),cC(document).bind("mousemove",t,zC)}function BC(e){var t={cal:cC(this).parent(),pos:cC(this).offset()};t.preview=t.cal.data("colorpicker").livePreview,cC(document).bind("mouseup",t,DC),cC(document).bind("mousemove",t,CC)}function EC(e){cC(this).addClass("colorpicker_focus")}function FC(e){cC(this).removeClass("colorpicker_focus")}function GC(e){var t=cC(this).parent(),n=t.data("colorpicker").color;t.data("colorpicker").origColor=n,pC(n,t.get(0)),t.data("colorpicker").onSubmit(n,TC(n),RC(n),t.data("colorpicker").el)}function HC(e){var t=cC("#"+cC(this).data("colorpickerId")),n=(t.data("colorpicker").onBeforeShow.apply(this,[t.get(0)]),cC(this).offset()),i=(i="CSS1Compat"==document.compatMode,{l:window.pageXOffset||(i?document.documentElement:document.body).scrollLeft,t:window.pageYOffset||(i?document.documentElement:document.body).scrollTop,w:window.innerWidth||(i?document.documentElement:document.body).clientWidth,h:window.innerHeight||(i?document.documentElement:document.body).clientHeight}),o=n.top+this.offsetHeight,n=n.left;return i.t+i.h<o+176&&(o-=this.offsetHeight+176),i.l+i.w<n+356&&(n-=356),t.css({left:n+"px",top:o+"px"}),0!=t.data("colorpicker").onShow.apply(this,[t.get(0)])&&t.show(),cC(document).bind("mousedown",{cal:t},IC),!1}function UC(){var e=cC(this).parent(),t=e.data("colorpicker").origColor;e.data("colorpicker").color=t,kC(t,e.get(0)),mC(t,e.get(0)),lC(t,e.get(0)),nC(t,e.get(0)),oC(t,e.get(0)),qC(t,e.get(0))}function ctrlPtComparator(e,t){return e.position-t.position}function bind(e,t){return"function"==typeof e.bind?e.bind(t):function(){e.apply(t,arguments)}}$B=jQuery,$B.fn.extend({collapsiblePanel:function(){$B(this).each(function(){var e=$B(this).find(".ui-expander").first(),t=$B(this).find(".ui-widget-header").first(),n=$B(this).find(".ui-widget-content").first();n.is(":visible")?e.removeClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-e"):e.removeClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-s"),t.click(function(){n.slideToggle(500,function(){console.log(n.is(":visible")),n.is(":visible")?e.removeClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-e"):e.removeClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-s")})})})}}),cC=jQuery,jC={eventName:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},color:"ff0000",livePreview:!0,flat:!(gC=65)},kC=function(e,t){e=RC(e);cC(t).data("colorpicker").fields.eq(1).val(e.r).end().eq(2).val(e.g).end().eq(3).val(e.b).end()},lC=function(e,t){cC(t).data("colorpicker").fields.eq(4).val(e.h).end().eq(5).val(e.s).end().eq(6).val(e.b).end()},mC=function(e,t){cC(t).data("colorpicker").fields.eq(0).val(TC(e)).end()},nC=function(e,t){cC(t).data("colorpicker").selector.css("backgroundColor","#"+TC({h:e.h,s:100,b:100})),cC(t).data("colorpicker").selectorIndic.css({left:parseInt(200*e.s/100,10),top:parseInt(200*(100-e.b)/100,10)})},oC=function(e,t){cC(t).data("colorpicker").hue.css("top",parseInt(200-200*e.h/360,10))},qC=function(e,t){cC(t).data("colorpicker").newColor.css("backgroundColor","#"+TC(e))},sC=function(e){var t,n=cC(this).parent().parent();0<this.parentNode.className.indexOf("_hex")?n.data("colorpicker").color=t=PC(NC(this.value)):0<this.parentNode.className.indexOf("_hsb")?n.data("colorpicker").color=t=LC({h:parseInt(n.data("colorpicker").fields.eq(4).val(),10),s:parseInt(n.data("colorpicker").fields.eq(5).val(),10),b:parseInt(n.data("colorpicker").fields.eq(6).val(),10)}):n.data("colorpicker").color=t=QC(MC({r:parseInt(n.data("colorpicker").fields.eq(1).val(),10),g:parseInt(n.data("colorpicker").fields.eq(2).val(),10),b:parseInt(n.data("colorpicker").fields.eq(3).val(),10)})),e&&(kC(t,n.get(0)),mC(t,n.get(0)),lC(t,n.get(0))),nC(t,n.get(0)),oC(t,n.get(0)),qC(t,n.get(0)),n.data("colorpicker").onChange.apply(n,[t,TC(t),RC(t)])},wC=function(e){return e.data.field.val(Math.max(0,Math.min(e.data.max,parseInt(e.data.val+e.pageY-e.data.y,10)))),e.data.preview&&sC.apply(e.data.field.get(0),[!0]),!1},xC=function(e){return sC.apply(e.data.field.get(0),[!0]),e.data.el.removeClass("colorpicker_slider").find("input").focus(),cC(document).unbind("mouseup",xC),cC(document).unbind("mousemove",wC),!1},zC=function(e){return sC.apply(e.data.cal.data("colorpicker").fields.eq(4).val(parseInt(360*(200-Math.max(0,Math.min(200,e.pageY-e.data.y)))/200,10)).get(0),[e.data.preview]),!1},AC=function(e){return zC(e),kC(e.data.cal.data("colorpicker").color,e.data.cal.get(0)),mC(e.data.cal.data("colorpicker").color,e.data.cal.get(0)),cC(document).unbind("mouseup",AC),cC(document).unbind("mousemove",zC),!1},CC=function(e){return sC.apply(e.data.cal.data("colorpicker").fields.eq(6).val(parseInt(100*(200-Math.max(0,Math.min(200,e.pageY-e.data.pos.top)))/200,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(200,e.pageX-e.data.pos.left))/200,10)).get(0),[e.data.preview]),!1},DC=function(e){return CC(e),kC(e.data.cal.data("colorpicker").color,e.data.cal.get(0)),mC(e.data.cal.data("colorpicker").color,e.data.cal.get(0)),cC(document).unbind("mouseup",DC),cC(document).unbind("mousemove",CC),!1},IC=function(e){JC(e.data.cal.get(0),e.target,e.data.cal.get(0))||(0!=e.data.cal.data("colorpicker").onHide.apply(this,[e.data.cal.get(0)])&&e.data.cal.hide(),cC(document).unbind("mousedown",IC))},JC=function(e,t,n){if(e==t)return!0;if(e.contains)return e.contains(t);if(e.compareDocumentPosition)return!!(16&e.compareDocumentPosition(t));for(var i=t.parentNode;i&&i!=n;){if(i==e)return!0;i=i.parentNode}return!1},LC=function(e){return{h:Math.min(360,Math.max(0,e.h)),s:Math.min(100,Math.max(0,e.s)),b:Math.min(100,Math.max(0,e.b))}},MC=function(e){return{r:Math.min(255,Math.max(0,e.r)),g:Math.min(255,Math.max(0,e.g)),b:Math.min(255,Math.max(0,e.b))}},NC=function(e){var t=6-e.length;if(0<t){for(var n=[],i=0;i<t;i++)n.push("0");n.push(e),e=n.join("")}return e},PC=function(e){return QC((e=e,{r:(e=parseInt(-1<e.indexOf("#")?e.substring(1):e,16))>>16,g:(65280&e)>>8,b:255&e}))},QC=function(e){var t={h:0,s:0,b:0},n=Math.min(e.r,e.g,e.b),i=Math.max(e.r,e.g,e.b),n=i-n;return t.b=i,t.s=0!=i?255*n/i:0,0!=t.s?e.r==i?t.h=(e.g-e.b)/n:e.g==i?t.h=2+(e.b-e.r)/n:t.h=4+(e.r-e.g)/n:t.h=-1,t.h*=60,t.h<0&&(t.h+=360),t.s*=100/255,t.b*=100/255,t},RC=function(e){var t,n={},i=Math.round(e.h),o=Math.round(255*e.s/100),e=Math.round(255*e.b/100);return 0==o?n.r=n.g=n.b=e:(e=i%60*((t=e)-(o=(255-o)*e/255))/60,(i=360==i?0:i)<60?(n.r=t,n.b=o,n.g=o+e):i<120?(n.g=t,n.b=o,n.r=t-e):i<180?(n.g=t,n.r=o,n.b=o+e):i<240?(n.b=t,n.r=o,n.g=t-e):i<300?(n.b=t,n.g=o,n.r=o+e):i<360?(n.r=t,n.g=o,n.b=t-e):(n.r=0,n.g=0,n.b=0)),{r:Math.round(n.r),g:Math.round(n.g),b:Math.round(n.b)}},SC=function(e){var n=[e.r.toString(16),e.g.toString(16),e.b.toString(16)];return cC.each(n,function(e,t){1==t.length&&(n[e]="0"+t)}),n.join("")},TC=function(e){return SC(RC(e))},dC={init:function(n){if("string"==typeof(n=cC.extend({},jC,n||{})).color)n.color=PC(n.color);else if(null!=n.color.r&&null!=n.color.g&&null!=n.color.b)n.color=QC(n.color);else{if(null==n.color.h||null==n.color.s||null==n.color.b)return this;n.color=LC(n.color)}return this.each(function(){var e,t;cC(this).data("colorpickerId")||((e=cC.extend({},n)).origColor=n.color,t="collorpicker_"+parseInt(1e3*Math.random()),cC(this).data("colorpickerId",t),t=cC('<div class="colorpicker"><div class="colorpicker_color"><div><div></div></div></div><div class="colorpicker_hue"><div></div></div><div class="colorpicker_new_color"></div><div class="colorpicker_current_color"></div><div class="colorpicker_hex"><input type="text" maxlength="6" size="6" /></div><div class="colorpicker_rgb_r colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_g colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_h colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_s colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_submit"></div></div>').attr("id",t),e.flat?t.appendTo(this).show():t.appendTo(document.body),e.fields=t.find("input").bind("keyup",rC).bind("change",sC).bind("blur",tC).bind("focus",uC),t.find("span").bind("mousedown",vC).end().find(">div.colorpicker_current_color").bind("click",UC),e.selector=t.find("div.colorpicker_color").bind("mousedown",BC),e.selectorIndic=e.selector.find("div div"),e.el=this,e.hue=t.find("div.colorpicker_hue div"),t.find("div.colorpicker_hue").bind("mousedown",yC),e.newColor=t.find("div.colorpicker_new_color"),e.currentColor=t.find("div.colorpicker_current_color"),t.data("colorpicker",e),t.find("div.colorpicker_submit").bind("mouseenter",EC).bind("mouseleave",FC).bind("click",GC),kC(e.color,t.get(0)),lC(e.color,t.get(0)),mC(e.color,t.get(0)),oC(e.color,t.get(0)),nC(e.color,t.get(0)),pC(e.color,t.get(0)),qC(e.color,t.get(0)),e.flat?t.css({position:"relative",display:"block"}):cC(this).bind(e.eventName,HC))})},showPicker:function(){return this.each(function(){cC(this).data("colorpickerId")&&HC.apply(this)})},hidePicker:function(){return this.each(function(){cC(this).data("colorpickerId")&&cC("#"+cC(this).data("colorpickerId")).hide()})},setColor:function(t){if("string"==typeof t)t=PC(t);else if(null!=t.r&&null!=t.g&&null!=t.b)t=QC(t);else{if(null==t.h||null==t.s||null==t.b)return this;t=LC(t)}return this.each(function(){var e;cC(this).data("colorpickerId")&&((e=cC("#"+cC(this).data("colorpickerId"))).data("colorpicker").color=t,e.data("colorpicker").origColor=t,kC(t,e.get(0)),lC(t,e.get(0)),mC(t,e.get(0)),oC(t,e.get(0)),nC(t,e.get(0)),pC(t,e.get(0)),qC(t,e.get(0)))})}},cC.fn.extend({ColorPicker:dC.init,ColorPickerHide:dC.hidePicker,ColorPickerShow:dC.showPicker,ColorPickerSetColor:dC.setColor}),$.event.special.destroyed||($.event.special.destroyed={remove:function(e){e.handler&&e.handler()}});var browserPrefix="",agent=window.navigator.userAgent;function GradientSelection(e,t){this.$el=e,this.$el.css("position","relative"),this.opts=t;var e=$("<canvas class='gradientPicker-preview'></canvas>"),n=(this.$el.append(e),e[0]),n=(n.width=n.clientWidth,n.height=n.clientHeight,this.g2d=n.getContext("2d"),$("<div class='gradientPicker-ctrlPts'></div>"));this.$el.append(n),this.$ctrlPtContainer=n,this.updatePreview=bind(this.updatePreview,this),this.controlPoints=[],this.ctrlPtConfig=new ControlPtConfig(this.$el,t);for(var i=0;i<t.controlPoints.length;++i){var o=this.createCtrlPt(t.controlPoints[i]);this.controlPoints.push(o)}this.docClicked=bind(this.docClicked,this),this.destroyed=bind(this.destroyed,this),$(document).bind("click",this.docClicked),this.$el.bind("destroyed",this.destroyed),this.previewClicked=bind(this.previewClicked,this),e.click(this.previewClicked),this.updatePreview()}function ControlPoint(e,t,n,i,o){this.$el=$("<div class='gradientPicker-ctrlPt'></div>"),e.append(this.$el),this.$parentEl=e,this.configView=o,"string"==typeof t?(t=t.split(" "),this.position=parseFloat(t[1])/100,this.color=t[0]):(this.position=t.position,this.color=t.color),this.listener=i,this.outerWidth=this.$el.outerWidth(),this.$el.css("background-color",this.color),"horizontal"==n?(o=(e.width()-this.$el.outerWidth())*this.position,this.$el.css("left",o)):(t=(e.height()-this.$el.outerHeight())*this.position,this.$el.css("top",t)),this.drag=bind(this.drag,this),this.stop=bind(this.stop,this),this.clicked=bind(this.clicked,this),this.colorChanged=bind(this.colorChanged,this),this.$el.draggable({axis:"horizontal"==n?"x":"y",drag:this.drag,stop:this.stop,containment:e}),this.$el.css("position","absolute"),this.$el.click(this.clicked)}function ControlPtConfig(e,t){var n=this,e=(this.$el=$('<div class="gradientPicker-ptConfig" style="visibility: hidden"></div>'),e.append(this.$el),$('<div class="color-chooser"></div>')),i=(this.$el.append(e),$("<div class='gradientPicker-close'></div>"));this.$el.append(i),this.$txtPerc=$("<input class='gradientPicker-locationPerc' type='text'/>").appendTo(this.$el),this.$txtPerc.spinner({min:0,max:100,numberFormat:"n",spin:function(e,t){_.defer(function(){n.onValueChange()})}}),this.$txtPerc.on("input",$.proxy(n.onValueChange,n)),this.$txtPerc.parent().click(function(e){e.stopPropagation()}),this.colorChanged=bind(this.colorChanged,this),this.removeClicked=bind(this.removeClicked,this),e.ColorPicker({onChange:this.colorChanged}),this.$cpicker=e,this.opts=t,this.visible=!1,i.click(this.removeClicked)}browserPrefix=0<=agent.indexOf("WebKit")?"-webkit-":0<=agent.indexOf("Mozilla")?"-moz-":0<=agent.indexOf("Microsoft")?"-ms-":"",GradientSelection.prototype={docClicked:function(){this.ctrlPtConfig.hide()},createCtrlPt:function(e){return new ControlPoint(this.$ctrlPtContainer,e,this.opts.orientation,this,this.ctrlPtConfig)},destroyed:function(){$(document).unbind("click",this.docClicked)},updateOptions:function(e){$.extend(this.opts,e),this.updatePreview()},updatePreview:function(){var e,t=[];if(this.controlPoints.sort(ctrlPtComparator),"horizontal"==this.opts.orientation)for(var n=this.g2d.createLinearGradient(0,0,this.g2d.canvas.width,0),i=0;i<this.controlPoints.length;++i){var o=this.controlPoints[i];n.addColorStop(o.position,o.color),t.push({position:o.position,color:o.color})}this.g2d.fillStyle=n,this.g2d.fillRect(0,0,this.g2d.canvas.width,this.g2d.canvas.height),this.opts.generateStyles&&(e=this._generatePreviewStyles()),this.opts.change(t,e)},removeControlPoint:function(e){var t=this.controlPoints.indexOf(e);-1!=t&&(this.controlPoints.splice(t,1),e.$el.remove())},previewClicked:function(e){var t=$(e.target).offset(),n=e.pageX-t.left,e=e.pageY-t.top,t=this.g2d.getImageData(n,e,1,1),e="rgb("+t.data[0]+","+t.data[1]+","+t.data[2]+")",t=this.createCtrlPt({position:n/this.g2d.canvas.width,color:e});this.controlPoints.push(t),this.controlPoints.sort(ctrlPtComparator)},_generatePreviewStyles:function(){for(var e=this.opts.type+"-gradient("+("linear"==this.opts.type?this.opts.fillDirection+", ":""),t=!0,n=0;n<this.controlPoints.length;++n){var i=this.controlPoints[n];t?t=!1:e+=", ",e+=i.color+" "+(100*i.position|0)+"%"}return[e+=")",browserPrefix+e]}},ControlPoint.prototype={drag:function(e,t){t=t.position.left;this.position=t/(this.$parentEl.width()-this.outerWidth),this.listener.updatePreview()},stop:function(e,t){this.listener.updatePreview(),this.configView.show(this.$el.position(),this.color,this)},clicked:function(e){return this.configView.show(this.$el.position(),this.color,this),e.stopPropagation(),!1},colorChanged:function(e){this.color=e,this.$el.css("background-color",this.color),this.listener.updatePreview()},removeClicked:function(){this.listener.removeControlPoint(this),this.listener.updatePreview()}},ControlPtConfig.prototype={onValueChange:function(){var e=this,t=e.$txtPerc.spinner("value"),t=parseInt(t)/100;$.isNumeric(t)&&(e.listener.position=t,t=(e.listener.$parentEl.width()-e.listener.$el.outerWidth())*e.listener.position,e.listener.$el.css("left",t),e.listener.listener.updatePreview())},show:function(e,t,n){var i=Math.round(100*n.position);this.visible=!0,this.listener=n,this.$txtPerc.spinner("value",i),this.$el.css("visibility","visible"),this.$cpicker.ColorPickerSetColor(t),this.$cpicker.css("background-color",t),"horizontal"===this.opts.orientation?this.$el.css("left",e.left):this.$el.css("top",e.top)},hide:function(){this.visible&&(this.$el.css("visibility","hidden"),this.visible=!1)},colorChanged:function(e,t,n){this.listener.colorChanged(t="#"+t),this.$cpicker.css("background-color",t)},removeClicked:function(){this.listener.removeClicked(),this.hide()}};var methods={init:function(n){n=$.extend({controlPoints:["#FFF 0%","#000 100%"],orientation:"horizontal",type:"linear",fillDirection:"left",generateStyles:!0,change:function(){}},n),this.each(function(){var e=$(this),t=new GradientSelection(e,n);e.data("gradientPicker-sel",t)})},update:function(t){this.each(function(){var e=$(this).data("gradientPicker-sel");null!=e&&e.updateOptions(t)})}},ColorPickerDialog=($.fn.gradientPicker=function(e,t){"string"==typeof e&&"init"!==e?methods[e].call(this,t):methods.init.call(this,t=e)},Backbone.View.extend({initialize:function(e){var n=this,i=[];n.options=e,n.showGradient="true"===e.values,n.noColor="true"===e.noColor,n.path=void 0===n.options.path?"none":n.options.path,n.$el.html(T.ColorPickerDialog()),n.$el.tabs({activate:function(){1===n.$el.tabs("option","active")?(n.loadGradient(),n.gradient=!0):n.gradient=!1}}),n.showGradient?n.height=333:n.height=293,i.push({text:"OK",click:$.proxy(n.onOKButtonClick,n),type:"submit"}),n.noColor&&i.push({text:"No Color",click:$.proxy(n.onNoColorClick,n),type:"submit"}),i.push({text:"Cancel",click:$.proxy(n.onCancelButtonClick,n),type:"submit"}),n.$el.dialog(_.extend({appendTo:e.container,dialogClass:"quick-dash color-picker-dialog",title:t("Select Background Color ..."),resizable:!0,height:n.height,width:458,minWidth:n.height,modal:!0,autoOpen:!0,buttons:i,close:function(){},open:function(){n.initColorPicker(),n.initOverlayClick(),n.$el.dialog("option",{position:{my:"left top",at:"left bottom",collision:"flip flip",of:$(n.options.target)}}),n.showGradient?n.$el.find(".ui-tabs-nav").show():n.$el.find(".ui-tabs-nav").hide()}},e))},colorChanged:function(){},cssToControlPoint:function(e){var t=[],n=e.split("(");return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(this.path)||"none"===e||n.length<2?t=["black 0%","grey 50%","black 100%"]:(0<=n[0].indexOf("linear")?this.$el.find(".colorPickerType").val("linear"):this.$el.find(".colorPickerType").val("radial"),this.$el.find(".colorPickerType").selectmenu("refresh"),_.each(n[1].split(","),function(e){0<=_.indexOf(e,"%")&&t.push(e.toString().trim().replace(")",""))})),t},initColorPicker:function(){var e=this,t=this.$el.find(".solid_color"),n="ff00ff";/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(this.path)&&(n=this.path.replace("#","")),t.ColorPicker({flat:!0,onChange:function(){e.colorChanged()}}),this.$el.find(".colorpicker_hex").change(function(){e.colorChanged()}),this.$el.find(".colorpicker_color div").dblclick(function(){e.onOKButtonClick()}),this.$cpicker=t,this.$cpicker.ColorPickerSetColor(n),this.$cpicker.css("background-color",n)},initGradient:function(){var n,i=this,o=i.$el.find(".left"),a=i.$el.find(".cssGradient"),e=i.$el.find(".colorPickerType"),t=i.$el.find(".colorPickerDirection");i.$el.find(".grad_ex").html(""),i.$el.find("#ex1").gradientPicker({change:function(e,t){for(n=0;n<t.length;n+=1)o.css("background-image",t[n]),a.val(t[n]),i.path=t[n],i.colorChanged()},fillDirection:t.val(),type:e.val(),controlPoints:i.cssToControlPoint(i.path)}),i.setFillDirection(i.path)},initOverlayClick:function(){var e=this;$(this.$el.parent().parent().find(".ui-widget-overlay")).on("click",function(){e.onCancelButtonClick(),$(e.$el.parent().parent().find(".ui-widget-overlay")).off("click")})},loadGradient:function(){var t=this,e=t.$el.find(".colorPickerType"),n=t.$el.find(".colorPickerDirection");e.selectmenu({width:90}).on("selectmenuchange",function(){var e=t.$el.find(".colorPickerDirection").next(".ui-selectmenu-button");"linear"===$(this).val()?e.show():e.hide(),t.initGradient()}),n.selectmenu({width:90}).on("selectmenuchange",function(){t.initGradient()}),t.setFillDirection(t.path),t.initGradient()},onCancelButtonClick:function(){this.$el.dialog("close"),this.remove()},onNoColorClick:function(){var e=this.options.selectCallback;e&&e(""),this.$el.dialog("close"),this.remove()},onOKButtonClick:function(){var e=this.options.selectCallback;this.gradient||(this.path="#"+this.$cpicker.find(".colorpicker_hex input").val()),e&&e(this.path),this.$el.dialog("close"),this.remove()},onSelectButtonClick:function(){this.options.model.tooltips=this.result,this.options.editor.setValue(this.options.model),this.onCancelButtonClick()},setFillDirection:function(e){var n="left",t=e.split("(");!/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(this.path)&&"none"!==e&&1<t.length?_.each(t[1].split(","),function(e,t){-1===_.indexOf(e,"%")&&0===t&&(n=e.toString().trim())}):this.cssControls="linear-gradient("+n+", black 0%, grey 50%, black 100%)",this.$el.find(".colorPickerDirection").val(n),this.$el.find(".colorPickerDirection").selectmenu("refresh")}})),ColSelectorDialog=Backbone.View.extend({className:"dropdown-dialog",initialize:function(e){var n=this;n.options=e,n.path=void 0,this.$el.html(T.DropDownSelectableDialog()),this.$el.find(".pnlCustom").toggle(this.options.isUserDefined),this.options.isUserDefined&&this.$el.find(".customDropwdownInput").val(e.selected||""),n.$el.dialog(_.extend({appendTo:this.options.container,dialogClass:"quick-dash dd-Panel",title:t("Please select a column"),resizable:!0,width:280,modal:!0,autoOpen:!0,close:function(){n.remove()},open:function(){var t="";n.$el.closest(".ui-dialog").siblings(".ui-widget-overlay:last").on("click",function(){n.closeDialog()}),_.each(n.options.values,function(e){e===n.options.selected?(t=t+'<li class="ui-widget-content ui-selected">'+e+"</li>",n.result=e):t=t+'<li class="ui-widget-content">'+e+"</li>"}),_.indexOf(n.options.values,n.options.selected)<0&&n.options.selected&&(t=t+'<li class="ui-widget-content ui-selected">'+n.options.selected+"</li>"),n.$el.find(".tp-selectable").append(t),n.initSelect(),n.$el.find(".customDropwdownSelect").button().click(_.bind(n.onCustomColumnAdded,n)),n.$el.find(".customDropwdownInput").on("keydown",function(e){13===e.keyCode&&n.onCustomColumnAdded()}),n.$el.dialog("option",{position:{my:"left top",at:"left bottom",collision:"flip flip",of:$(n.options.target)}})}},this.options))},initSelect:function(){var t=this;t.$el.find(".tp-selectable").selectable({selected:function(){t.$el.find(".ui-selected",this).addClass("ui-selected").siblings().removeClass("ui-selected"),t.$el.find(".ui-selected",this).each(function(){t.result=this.textContent;var e=t.options.selectCallback;e&&e(this.textContent)}),t.closeDialog()}})},closeDialog:function(){this.$el.closest(".ui-dialog").siblings(".ui-widget-overlay:last").off("click"),this.$el.dialog("close")},onCustomColumnAdded:function(){var e=this.$el.find(".customDropwdownInput"),t=e.val(),n=this.options.selectCallback;t?(n&&n(t),this.closeDialog()):e.effect("highlight").focus()},onCancelButtonClick:function(){this.closeDialog()},onSelectButtonClick:function(){this.options.model.tooltips=this.result,this.onCancelButtonClick()},remove:function(){this.$(".tp-selectable").data("uiSelectable")&&this.$(".tp-selectable").selectable("destroy"),this.$(".customDropwdownSelect").data("uiButton")&&this.$(".customDropwdownSelect").off().button("destroy"),this.$(".customDropwdownInput").off(),this.$el.data("uiDialog")&&this.$el.dialog("destroy"),Backbone.View.prototype.remove.apply(this,arguments)}}),DomOutline=function(e){var s={},l={opts:{namespace:(e=e||{}).namespace||"DomOutline",borderWidth:e.borderWidth||2,filter:e.filter||!1,onClick:e.onClick||!1,onHover:e.onHover||!1,parentElement:e.parentElement||!1},keyCodes:{BACKSPACE:8,ESC:27,DELETE:46},active:!1,initialized:!1,elements:{}};function t(){var e,t;!0!==l.initialized&&(e="."+l.opts.namespace+" {    background: #09c;    position: absolute;    z-index: 1000000;}."+l.opts.namespace+"_label {    background: #09c;    border-radius: 2px;    color: #fff;    font: bold 12px/12px Helvetica, sans-serif;    padding: 4px 6px;    position: absolute;    text-shadow: 0 1px 1px rgba(0, 0, 0, 0.25);    z-index: 1000001;}",e=e,(t=document.createElement("style")).type="text/css",t.setAttribute("class",l.opts.namespace),document.getElementsByTagName("head")[0].appendChild(t),t.styleSheet?t.styleSheet.cssText=e:t.innerHTML=e,l.initialized=!0)}function n(e){var t,n,i,o,a=jQuery(e.target);a.attr("class")&&-1!==a.attr("class").indexOf(l.opts.namespace)||l.opts.filter&&!a.is(l.opts.filter)||l.opts.parentElement&&!a.is(l.opts.parentElement)&&!a.parents(l.opts.parentElement).length||(s.element=e.target,s.clickHandler=_.once(function(){l.opts.parentElement&&!jQuery(s.element).is(l.opts.parentElement)&&!jQuery(s.element).parents(l.opts.parentElement).length||(s.stop(),l.opts.onClick(s.element))}),a=l.opts.borderWidth,l.elements.window||(l.elements.window=jQuery(window)),e=l.elements.window.scrollTop(),n=(t=s.element.getBoundingClientRect()).top+e,i=s.element,t.width,t.height,o=i.tagName.toLowerCase(),i.id&&(o+="#"+i.id),$(i).attr("class")&&(o+=("."+jQuery.trim($(i).attr("class")).replace(/ /g,".")).replace(/\.\.+/g,".")),i=o,o=Math.max(0,n-20-a,e),e=Math.max(0,t.left-a),l.elements.label.css({top:o,left:e}).text(i),l.elements.top.css({top:Math.max(0,n-a),left:t.left-a,width:t.width+a,height:a}),l.elements.bottom.css({top:n+t.height,left:t.left-a,width:t.width+a,height:a}),l.elements.left.css({top:n-a,left:Math.max(0,t.left-a),width:a,height:t.height+a}),l.elements.right.css({top:n-a,left:t.left+t.width,width:a,height:t.height+2*a}),l.elements.clickBlocker.css({top:n,left:t.left,width:t.width,height:t.height}),l.opts.onHover&&l.opts.onHover(i),jQuery(s.element).off("mousedown."+l.opts.namespace),jQuery("body").off("mouseup."+l.opts.namespace),jQuery(s.element).on("mousedown."+l.opts.namespace,function(e){jQuery(s.element).off("mousedown."+l.opts.namespace),l.elements.clickBlocker.show(),jQuery("body").on("mouseup."+l.opts.namespace,function(e){if(jQuery("body").off("mouseup."+l.opts.namespace),l.elements.clickBlocker.hide(),l.opts.filter&&!jQuery(e.target).is(l.opts.filter))return!1;s.clickHandler()})}))}function i(e){return e.keyCode!==l.keyCodes.ESC&&e.keyCode!==l.keyCodes.BACKSPACE&&e.keyCode!==l.keyCodes.DELETE||s.stop(),!1}return s.start=function(){t(),!0!==l.active&&(l.active=!0,l.elements.label=jQuery("<div></div>").addClass(l.opts.namespace+"_label").appendTo("body"),l.elements.top=jQuery("<div></div>").addClass(l.opts.namespace).appendTo("body"),l.elements.bottom=jQuery("<div></div>").addClass(l.opts.namespace).appendTo("body"),l.elements.left=jQuery("<div></div>").addClass(l.opts.namespace).appendTo("body"),l.elements.right=jQuery("<div></div>").addClass(l.opts.namespace).appendTo("body"),l.elements.clickBlocker=jQuery("<div></div>").addClass(l.opts.namespace).appendTo("body").hide().css("background","none"),jQuery("body").on("mousemove."+l.opts.namespace,n),jQuery("body").on("keyup."+l.opts.namespace,i),l.opts.onClick&&setTimeout(function(){},50))},s.stop=function(){l.active=!1,jQuery.each(l.elements,function(e,t){t.remove()}),jQuery("body").off("mousemove."+l.opts.namespace).off("mousedown."+l.opts.namespace).off("mouseup."+l.opts.namespace).off("keyup."+l.opts.namespace).off("click."+l.opts.namespace)},s},CssDialog=(jQuery.fn.extend({getPath:function(e,t,n,i,o,a){if(e=e||"html",this.is(e=void 0===(o=void 0===o?"":o)?"html":e))return e+o;if(this.is(i))return this.parent().getPath(e,t,n,i,o.substring(o.indexOf(">")+1),!0);var s,l=this.get(0).nodeName.toLowerCase(),r=this.attr("id"),c=this.attr("class");return t&&(s=this.data(t)),r&&_.every(n.id,function(e){return 0!==r.indexOf(e)})&&!n.ignoreIds&&(l+="#"+r),void 0!==c&&""!==c&&(c=c.split(/[\s\n]+/),(c=_.reject(c,function(t){return _.some(n.class,function(e){return 0===t.indexOf(e)})})).length&&(l+="."+c.join("."))),void 0!==s?(l="[data-"+t+'="'+s+'"]')+o:a?this.parent().getPath(e,t,n,i,o,a):this.parent().getPath(e,t,n,i," > "+l+o,a)}}),Backbone.View.extend({DIALOG_HEIGHT:540,DIALOG_HEIGHT_INSPECTING:0,INSPECTING_PROP:"isInspecting",IGNORE_ID_WIDGET_KEYS:["TreeView"],className:"css-dialog",dataView:null,propertiesView:null,initialize:function(n){var e,i=this;i.applyCallback=n.applyCallback,i.viewModel=n.viewModel,i.isPropertiesCollapsed=!1,e=i.viewModel.get("selectedWidget")?'[data-widgetid="'+i.viewModel.get("selectedWidgetId")+'"]':"div.worksheet",i.path=void 0,i.$el.html(T.CssDialog()),i.$elementPicker=i.$el.find(".element-picker"),i.$highlightedElement=i.$el.find(".highlighted-element"),i.domOutline=new DomOutline({namespace:"DomOutline",onClick:function(e){var t;i.stopInspecting(),e&&(t=(t=$(e).parents("div[data-componentid]")).length&&-1!==i.IGNORE_ID_WIDGET_KEYS.indexOf(t.attr("data-componentid")),e=$(e).getPath(".content-panel","widgetid",{id:["date_","graphHeader_","graphing_","upload","slickgrid_"],class:["active","component-build-view","has-tools","hover","mouseDown","nv-chart-","selected","slickgrid_","ui-sortable","ui-state-","ui-widget","grid-stack-instance-"],ignoreIds:t},".app-div"),i.viewModel.get("selectedWidgetView")&&_.isFunction(i.viewModel.attributes.selectedWidgetView.app.getCssPrefix)&&(e=i.viewModel.attributes.selectedWidgetView.app.getCssPrefix()+e),t=i.editor.getValue(),i.editor.setValue(t=t+(t?"\n\n":"")+e+" {\n    \n}"),t&&(e=t.split("\n").length-1,i.editor.setPosition({column:4,lineNumber:e}),i.editor.revealLine(1+e)),i.editor.focus())},onHover:function(e){i.$highlightedElement.text(e)},parentElement:n.parentElement||e}),i.$dialog=i.$el.dialog({appendTo:n.container,title:t("Advanced CSS"),resizable:!0,height:i.DIALOG_HEIGHT,width:800,minWidth:354,modal:!1,autoOpen:!0,buttons:[{text:t("Element Selector"),click:$.proxy(i.toggleInspecting,i),icons:{primary:"fa fa-mouse-pointer"}},{text:t("Apply"),click:$.proxy(i.onApplyButtonClick,i),icons:{primary:"fa fa-check"}},{text:t("Close"),click:function(){i.$el.dialog("close")},icons:{}}],beforeClose:function(){n.beforeClose&&n.beforeClose()},close:function(){i.stopInspecting(),i.remove(),n.close&&n.close()},open:function(){$('<i class="fa fa-css3" />').insertBefore(i.$el.parent().find(".ui-dialog-title")),MonacoHelpers.require({language:"css"},function(e){var e=e.monaco,t=i.$el.find(".query-editor")[0];i.editor=e.editor.create(t,_.assign({},MonacoHelpers.DEFAULT_OPTIONS(),{value:n.styles,language:"css",peekWidgetDefaultFocus:!0}))})}}),i.initializeEvents()},initializeEvents:function(){this.listenTo(this.viewModel,"change:"+this.INSPECTING_PROP,this.onViewInspectingChange),this.listenTo(this.viewModel,"change:buildMode",this.remove),this.$elementPicker.on("click",$.proxy(this.toggleInspecting,this))},onApplyButtonClick:function(){this.applyCallback(this.editor.getValue())},onViewInspectingChange:function(){var e=this.viewModel.get(this.INSPECTING_PROP);this.$el.toggleClass("inspecting",e),this.setDialogCompact(e),e?(this.domOutline.start(),this.viewModel.get("selectedWidgetView")&&_.isFunction(this.viewModel.attributes.selectedWidgetView.app.startInspecting)&&this.viewModel.attributes.selectedWidgetView.app.startInspecting()):(this.domOutline.stop(),this.$highlightedElement.text(""),this.viewModel.get("selectedWidgetView")&&_.isFunction(this.viewModel.attributes.selectedWidgetView.app.stopInspecting)&&this.viewModel.attributes.selectedWidgetView.app.stopInspecting())},onResize:function(){MonacoHelpers.adjustAfterResize(this.editor)},remove:function(){$(".DomOutline_label").remove(),$(".DomOutline").remove(),Backbone.View.prototype.remove.call(this)},setDialogCompact:function(e){this.$el.dialog("option","height",e?this.DIALOG_HEIGHT_INSPECTING:this.DIALOG_HEIGHT)},stopInspecting:function(){this.viewModel.set(this.INSPECTING_PROP,!1)},toggleInspecting:function(){this.viewModel.set(this.INSPECTING_PROP,!this.viewModel.get(this.INSPECTING_PROP))}})),DataModelPropertiesView=Backbone.View.extend({initialize:function(e){var t=this,n=[];t.model&&_.each(_.filter(_.keys(t.model.attributes),function(e){return 0===e.indexOf("_")}),function(e){n.push({key:e,val:t.model.get(e)})}),t.$el.html(T.DataModelProperties(n)),t.$el.find(".config-btn").button({icons:{primary:"fa fa-cog fa-fw"}}).click(function(e){e.preventDefault(),e.stopPropagation(),t.trigger("configure")})}}),AccordionView=(_H.prototype.adjustWeights=function(e,n){var i=this.sum(_.map(e,function(e){return e.weight})),o=this.sum(n);_.each(e,function(e,t){e.weight=i*(n[t]/o)})},_H.prototype.onSectionResize=function(e,t,n){for(var i=e.$el.height(),o=i-n.originalSize.height,a=[e],s=[i],l=0,r=this.sections.indexOf(e)+1;r<this.sections.length;r+=1){var c=this.sections[r];if(c.isExpanded&&!c.fixed&&!c.hidden){var d=Math.max(this.HEADING_HEIGHT,c.startHeight-(o-l));if(l+=Math.min(c.startHeight-this.HEADING_HEIGHT,o-l),c.$el.height(d+"px"),a.push(c),s.push(d),l===o)break}}this.adjustWeights(a,s)},_H.prototype.resize=function(){this.updateLayout(!1)},_H.prototype.sum=function(e){return _.reduce(e,function(e,t){return e+t},0)},_H.prototype.updateLayout=function(e){var i=this,t=this.$el.height(),n=(this.$el.toggleClass("animate",e),_.filter(this.sections,function(e){return e.isExpanded&&!e.hidden})),n=(t=(t-=_.filter(this.sections,function(e){return!e.hidden&&!e.isExpanded}).length*this.HEADING_HEIGHT)-this.sum(_.map(_.filter(n,function(e){return e.isExpanded&&e.fixed}),function(e){return e.fixed||0})),this.sum(_.map(n,function(e){return e.fixed?0:e.weight}))),o=t/n;this.sections.forEach(function(e,t){var n;e.$el.toggleClass("expanded",e.isExpanded),e.isExpanded&&!e.hidden?(n=e.fixed||e.weight*o,e.$el.height(n)):e.$el.height(0),e.resize&&!e.hidden&&e.resize(),e.hidden?e.$el.hide():(e.$el.show(),e.isExpanded&&!e.fixed&&!e.hidden&&t<i.sections.length-1&&_.some(i.sections.slice(t+1),function(e){return e.isExpanded&&!e.fixed})?e.resizeable=e.$el.resizable({handles:"s",resize:$.proxy(i.onSectionResize,i,e),start:function(){_.each(i.sections,function(e){e.startHeight=e.$el.height()}),e.$el.resizable("option","maxHeight",i.$el.height()-(i.sections.length-1)*i.HEADING_HEIGHT)},stop:function(){return i.updateLayout()}}):e.resizeable&&(e.$el.resizable("destroy"),delete e.resizeable))}),e?this.debouncedRemoveAnimate():this.onUpdate&&this.onUpdate(this.sections)},_H),YI;function _H(e){var t=this;this.className="accordion",this.HEADING_HEIGHT=28,this.el=e.el,this.$el=$(e.el),this.el.classList.add("accordion"),this.onUpdate=e.onUpdate,this.sections=e.sections||[{heading:"Section 1",weight:2,isExpanded:!0,$el:$("<div>yooo1</div>")},{heading:"Section 2",weight:1,isExpanded:!0,$el:$("<div>yooo2</div>")}],_.each(this.sections,function(e){e.$el&&(e.$heading=e.$el.find(e.$heading),e.$content=e.$el.find(e.$content))}),this.debouncedRemoveAnimate=_.debounce(function(){t.el.classList.remove("animate"),t.onUpdate&&t.onUpdate(t.sections)},300),this.updateLayout(!1)}jQuery.fn.caret=function(e){var t,n=this[0],i="true"===n.contentEditable;if(0!=arguments.length)return-1==e&&(e=this[i?"text":"val"]().length),window.getSelection?i?(n.focus(),window.getSelection().collapse(n.firstChild,e)):n.setSelectionRange(e,e):document.body.createTextRange&&(i?((a=document.body.createTextRange()).moveToElementText(n),a.moveStart("character",e),a.collapse(!0)):(a=n.createTextRange()).move("character",e),a.select()),i||n.focus(),e;if(window.getSelection)return i?(n.focus(),(o=(t=window.getSelection().getRangeAt(0)).cloneRange()).selectNodeContents(n),o.setEnd(t.endContainer,t.endOffset),o.toString().length):n.selectionStart;if(document.selection){if(n.focus(),i)return t=document.selection.createRange(),(o=document.body.createTextRange()).moveToElementText(n),o.setEndPoint("EndToEnd",t),o.text.length;var o,e=0,a=n.createTextRange(),i=(o=document.selection.createRange().duplicate()).getBookmark();for(a.moveToBookmark(i);0!==a.moveStart("character",-1);)e++;return e}return n.selectionStart||0},YI=jQuery,YI.fn.tagEditorInput=function(){var t=" ",n=YI(this),i=parseInt(n.css("fontSize")),o=YI("<span/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:n.css("fontSize"),fontFamily:n.css("fontFamily"),fontWeight:n.css("fontWeight"),letterSpacing:n.css("letterSpacing"),whiteSpace:"nowrap"});return o.insertAfter(n),n.bind("keyup keydown focus",function(){var e;t!==(t=n.val())&&(o.html(t.replace(/&/g,"&amp;").replace(/\s/g,"&nbsp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),(e=(e=o.width()+i)<20?20:e)!=n.width()&&n.width(e))})},YI.fn.tagEditor=function(o,a,s){function m(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}var g,l,f=YI.extend({},YI.fn.tagEditor.defaults,o);return f.dregex=new RegExp("["+f.delimiter.replace("-","-")+"]","g"),"string"==typeof o?(l=[],this.each(function(){var e=YI(this),t=e.data("options"),n=e.next(".tag-editor");if("getTags"==o)l.push({field:e[0],editor:n,tags:n.data("tags")});else if("addTag"==o){if(t.maxTags&&n.data("tags").length>=t.maxTags)return!1;YI('<li><div class="tag-editor-spacer">&nbsp;'+t.delimiter[0]+'</div><div class="tag-editor-tag"></div><div class="tag-editor-delete"><i></i></div></li>').appendTo(n).find(".tag-editor-tag").html('<input type="text" maxlength="'+t.maxLength+'">').addClass("active").find("input").val(a).blur(),s?YI(".placeholder",n).remove():n.click()}else"removeTag"==o?(YI(".tag-editor-tag",n).filter(function(){return YI(this).html()==a}).closest("li").find(".tag-editor-delete").click(),s||n.click()):"destroy"==o&&e.removeClass("tag-editor-hidden-src").removeData("options").off("focus.tag-editor").next(".tag-editor").remove()}),"getTags"==o?l:this):(window.getSelection&&YI(document).off("keydown.tag-editor").on("keydown.tag-editor",function(e){if(8==e.which||46==e.which||e.ctrlKey&&88==e.which){try{var t=getSelection(),n=YI(t.getRangeAt(0).commonAncestorContainer)}catch(e){n=0}if(n&&n.hasClass("tag-editor")){var o=[],a=t.toString().split(n.prev().data("options").dregex);for(i=0;i<a.length;i++){var s=YI.trim(a[i]);s&&o.push(s)}return YI(".tag-editor-tag",n).each(function(){~YI.inArray(YI(this).html(),o)&&YI(this).closest("li").find(".tag-editor-delete").click()}),!1}}}),this.each(function(){var t,n,r=YI(this),c=[],d=YI("<ul "+(f.clickDelete?'oncontextmenu="return false;" ':"")+'class="tag-editor"></ul>').insertAfter(r),u=(r.addClass("tag-editor-hidden-src").data("options",f).on("focus.tag-editor",function(){d.click()}),d.append('<li style="width:1px">&nbsp;</li>'),'<li><div class="tag-editor-spacer">&nbsp;'+f.delimiter[0]+'</div><div class="tag-editor-tag"></div><div class="tag-editor-delete"><i></i></div></li>');function o(){!f.placeholder||c.length||YI(".deleted, .placeholder, input",d).length||d.append('<li class="placeholder"><div>'+f.placeholder+"</div></li>")}function p(e){var t=c.toString();c=YI(".tag-editor-tag:not(.deleted)",d).map(function(e,t){t=YI.trim(YI(this).hasClass("active")?YI(this).find("input").val():YI(t).text());if(t)return t}).get(),d.data("tags",c),r.val(c.join(f.delimiter[0])),e||t!=c.toString()&&f.onChange(r,d,c),o()}function a(e){for(var t,n=e.closest("li"),i=e.val().replace(/ +/," ").split(f.dregex),o=e.data("old_tag"),a=c.slice(0),s=!1,l=0;l<i.length;l++)if(h=YI.trim(i[l]).slice(0,f.maxLength),f.forceLowercase&&(h=h.toLowerCase()),t=f.beforeTagSave(r,d,a,o,h),h=t||h,!1!==t&&h&&(f.removeDuplicates&&~YI.inArray(h,a)&&YI(".tag-editor-tag",d).each(function(){YI(this).html()==h&&YI(this).closest("li").remove()}),a.push(h),n.before('<li><div class="tag-editor-spacer">&nbsp;'+f.delimiter[0]+'</div><div class="tag-editor-tag">'+m(h)+'</div><div class="tag-editor-delete"><i></i></div></li>'),f.maxTags&&a.length>=f.maxTags)){s=!0;break}e.attr("maxlength",f.maxLength).removeData("old_tag").val(""),s?e.blur():e.focus(),p()}d.click(function(i,o){var a,s,l=99999;if(!window.getSelection||""==getSelection())return f.maxTags&&d.data("tags").length>=f.maxTags?(d.find("input").blur(),!1):(g=!0,YI("input:focus",d).blur(),g&&(g=!0,YI(".placeholder",d).remove(),o&&o.length?s="before":YI(".tag-editor-tag",d).each(function(){var e=YI(this),t=e.offset(),n=t.left,t=t.top;i.pageY>=t&&i.pageY<=t+e.height()&&(a=i.pageX<n?(s="before",n-i.pageX):(s="after",i.pageX-n-e.width()))<l&&(l=a,o=e)}),("before"==s?YI(u).insertBefore(o.closest("li")):"after"==s?YI(u).insertAfter(o.closest("li")):YI(u).appendTo(d)).find(".tag-editor-tag").click()),!1)}),d.on("click",".tag-editor-delete",function(e){if(YI(this).prev().hasClass("active"))return YI(this).closest("li").find("input").caret(-1),!1;var t=YI(this).closest("li"),n=t.find(".tag-editor-tag");return!1===f.beforeTagDelete(r,d,c,n.html())||(n.addClass("deleted").animate({width:0},f.animateDelete,function(){t.remove(),o()}),p()),!1}),f.clickDelete&&d.on("mousedown",".tag-editor-tag",function(e){var t;if(e.ctrlKey||1<e.which)return e=(t=YI(this).closest("li")).find(".tag-editor-tag"),!1===f.beforeTagDelete(r,d,c,e.html())||(e.addClass("deleted").animate({width:0},f.animateDelete,function(){t.remove(),o()}),p()),!1}),d.on("click",".tag-editor-tag",function(e){return f.clickDelete&&(e.ctrlKey||1<e.which)||YI(this).hasClass("active")||(n=YI(this).html(),e=Math.abs((YI(this).offset().left-e.pageX)/YI(this).width()),e=parseInt(n.length*e),(t=YI(this).html('<input type="text" maxlength="'+f.maxLength+'" value="'+n+'">').addClass("active").find("input")).data("old_tag",n).tagEditorInput().focus().caret(e),f.autocomplete&&(n=YI.extend({},f.autocomplete),i="select"in n?f.autocomplete.select:"",n.select=function(e,t){i&&i(e,t),setTimeout(function(){d.trigger("click",[YI(".active",d).find("input").closest("li").next("li").find(".tag-editor-tag")])},20)},t.autocomplete(n))),!1;var t,n,i}),d.on("blur","input",function(e){e.stopPropagation();var t=YI(this),n=t.data("old_tag"),i=YI.trim(t.val().replace(/ +/," ").replace(f.dregex,f.delimiter[0]));if(i){if(0<=i.indexOf(f.delimiter[0]))return void a(t);if(i!=n)if(f.forceLowercase&&(i=i.toLowerCase()),cb_val=f.beforeTagSave(r,d,c,n,i),i=cb_val||i,!1===cb_val){if(n)return t.val(n).focus(),g=!1,void p();try{t.closest("li").remove()}catch(e){}n&&p()}else f.removeDuplicates&&YI(".tag-editor-tag:not(.active)",d).each(function(){YI(this).html()==i&&YI(this).closest("li").remove()})}else{if(n&&!1===f.beforeTagDelete(r,d,c,n))return t.val(n).focus(),g=!1,void p();try{t.closest("li").remove()}catch(e){}n&&p()}t.parent().html(m(i)).removeClass("active"),i!=n&&p(),o()}),d.on("paste","input",function(e){YI(this).removeAttr("maxlength"),t=YI(this),setTimeout(function(){a(t)},30)}),d.on("keypress","input",function(e){0<=f.delimiter.indexOf(String.fromCharCode(e.which))&&(n=YI(this),setTimeout(function(){a(n)},20))}),d.on("keydown","input",function(e){var t,n,i=YI(this);if((37==e.which||!f.autocomplete&&38==e.which)&&!i.caret()||8==e.which&&!i.val())return(t=i.closest("li").prev("li").find(".tag-editor-tag")).length?t.click().find("input").caret(-1):!i.val()||f.maxTags&&d.data("tags").length>=f.maxTags||YI(u).insertBefore(i.closest("li")).find(".tag-editor-tag").click(),!1;if((39==e.which||!f.autocomplete&&40==e.which)&&i.caret()==i.val().length)return(n=i.closest("li").next("li").find(".tag-editor-tag")).length?n.click().find("input").caret(0):i.val()&&d.click(),!1;if(9==e.which){if(e.shiftKey){if((t=i.closest("li").prev("li").find(".tag-editor-tag")).length)t.click().find("input").caret(0);else{if(!i.val()||f.maxTags&&d.data("tags").length>=f.maxTags)return r.attr("disabled","disabled"),void setTimeout(function(){r.removeAttr("disabled")},30);YI(u).insertBefore(i.closest("li")).find(".tag-editor-tag").click()}return!1}if((n=i.closest("li").next("li").find(".tag-editor-tag")).length)n.click().find("input").caret(0);else{if(!i.val())return;d.click()}return!1}if(!(46!=e.which||YI.trim(i.val())&&i.caret()!=i.val().length))return(n=i.closest("li").next("li").find(".tag-editor-tag")).length?n.click().find("input").caret(0):i.val()&&d.click(),!1;if(13==e.which)return d.trigger("click",[i.closest("li").next("li").find(".tag-editor-tag")]),!1;if(36!=e.which||i.caret()){if(35==e.which&&i.caret()==i.val().length)d.find(".tag-editor-tag").last().click();else if(27==e.which)return i.val(i.data("old_tag")?i.data("old_tag"):"").blur(),!1}else d.find(".tag-editor-tag").first().click()});for(var e=f.initialTags.length?f.initialTags:r.val().split(f.dregex),i=0;i<e.length&&!(f.maxTags&&i>=f.maxTags);i++){var h=YI.trim(e[i].replace(/ +/," "));h&&(f.forceLowercase&&(h=h.toLowerCase()),c.push(h),d.append('<li><div class="tag-editor-spacer">&nbsp;'+f.delimiter[0]+'</div><div class="tag-editor-tag">'+m(h)+'</div><div class="tag-editor-delete"><i></i></div></li>'))}p(!0),f.sortable&&YI.fn.sortable&&d.sortable({distance:5,cancel:".tag-editor-spacer, input",helper:"clone",update:function(){p()}})}))},YI.fn.tagEditor.defaults={initialTags:[],maxTags:0,maxLength:50,delimiter:",;",placeholder:"",forceLowercase:!0,removeDuplicates:!0,clickDelete:!1,animateDelete:175,sortable:!0,autocomplete:null,onChange:function(){},beforeTagSave:function(){},beforeTagDelete:function(){}};var PropertiesTagView=Backbone.View.extend({tagName:"textarea",className:"tagEditor",preventModelUpdate:!1,visibleTagsList:[],initialize:function(e){this.options=e,this.$el.addClass(this.className),this.render(),this.initializeEvents()},initializeEvents:function(){this.listenTo(this.model,"change:"+this.options.property,this.render)},addMultipleTags:function(e){var t=this;_.each(e,function(e){t.$el.tagEditor("addTag",e)})},onTagsChanged:function(e,t,n){this.preventModelUpdate||(this.stopListening(),this.visibleTagsList=n,this.model.set(this.options.property,n),this.initializeEvents())},render:function(){var e=this.model.get(this.options.property),t=(this.options.placeholder,this.options.removeDuplicates||!1);this.$el.tagEditor("destroy"),this.$el.val(""),this.$el.tagEditor({initialTags:e,forceLowercase:!1,animateDelete:0,sortable:!0,removeDuplicates:t,delimiter:" |",onChange:$.proxy(this.onTagsChanged,this),autocomplete:this.options.autocomplete||null})},refreshTags:function(e){0<this.visibleTagsList.length&&(this.preventModelUpdate=!0,this.removeAllTags(),this.addMultipleTags(e),this.visibleTagsList=e,this.preventModelUpdate=!1)},removeAllTags:function(){var t=this;_.each(_.uniq(t.visibleTagsList),function(e){t.$el.tagEditor("removeTag",e)})}}),DataConfigAggregateRow=Backbone.View.extend({tagName:"li",className:"pivotRow",AGGREGATE_FNS:["count","sum","avg","max","min","first","last"],events:{"change input":"onValueChange"},initialize:function(e){this.options=e,this.render()},checkAggregateFn:function(e){return-1<this.AGGREGATE_FNS.indexOf(e)||-1<e.indexOf(";")},handleInvalidEntry:function(e){$(e).addClass("invalidEntry"),_.delay(function(){$(e).removeClass("invalidEntry")},3e3)},onValueChange:function(e){var t=$.trim(this.$el.find(".aggregateColItm").val()),n=this.model.get("_aggregateCols"),i=$.trim(this.$el.find(".aggregateFnItm").val()),o=this.model.get("_aggregateFns"),a=this.model.get("_aggregateLabels"),s=$.trim(this.$el.find(".aggregateLabelItm").val());-1===a.indexOf(s)||""===s||$(e.currentTarget).hasClass("aggregateColItm")||$(e.currentTarget).hasClass("aggregateFnItm")?($(e.currentTarget).hasClass("aggregateFnItm")&&!this.checkAggregateFn(i)&&this.handleInvalidEntry(e.currentTarget),n[n=this.$el.index()]=t,o[n]=i,a[n]=s,this.model.trigger("change:_aggregateCols")):this.handleInvalidEntry(e.currentTarget)},removeModelDetails:function(){var e=this.$el.index();-1<e&&(this.model.get("_aggregateCols").splice(e,1),this.model.get("_aggregateFns").splice(e,1),this.model.get("_aggregateLabels").splice(e,1),this.model.trigger("change:_aggregateCols"),this.remove())},render:function(){this.$el.html(T.DataConfigAggregateRow(this.options.aggregateDetails)),this.$el.find(".deleteRow").button({icons:{primary:"fa fa-trash"},text:!1}).click($.proxy(this.removeModelDetails,this))}}),TreeView=($K=Backbone.View,__extends(_K,$K),_K.prototype.updateTheme=function(){var e=$("#appdiv .toolbar").hasClass("kx-light")?"kx-light":"kx-darkroom",t=$(document).find(".vakata-context.jstree-contextmenu");t&&(t.removeClass("kx-light kx-darkroom"),t.addClass(e))},_K.prototype.initializeEvents=function(){var s=this,e=_.debounce(function(){s.onSearchInputKeyUp()},250);s.$createButton.click($.proxy(s.onCreateClick,s)),s.$renameButton.click($.proxy(s.onRenameClick,s)),s.$deleteButton.click($.proxy(s.onDeleteClick,s)),s.$searchInput.keyup(e),s.$clearSearch.click($.proxy(s.onClearSearchClick,s)),s.$tree.on("contextmenu.jstree",function(e){var t;e.target==s.$tree[0]&&(e.preventDefault(),$(document).one("context_show.vakata.jstree",function(e,t){$(t.element).addClass("jstree-contextmenu jstree-default-contextmenu")}),t={create:{label:"New",submenu:{create_node:{label:s.nodeLabel,action:function(e){return s.onCreateNode(e,"node")}},create_group:{separator_after:!0,label:"Group",action:function(e){return s.onCreateNode(e,"group")}}}},ccp:{label:"Edit",submenu:{paste:{label:"Paste",_disabled:_.isEmpty($.jstree.core.prototype.get_buffer().node),action:function(e){return s.$tree.jstree("paste","#")}}}}},$.vakata.context.show($(this),{x:e.pageX,y:e.pageY},t),s.updateTheme())}),s.$tree.on("show_contextmenu.jstree",$.proxy(s.updateTheme,s)),this.$tree.on("ready.jstree",function(e,a){var t,n;s.$tree.jstree("deselect_all"),s.$tree.on("copy_node.jstree",function(e,t){var n,i,o=t.node.text;t.parent===a.old_parent&&(i=o,o+=" copy"),n=_K.calculateParentPath(t),t=_K.calculatePath({node:t.instance._model.data[t.old_parent],instance:t.instance},t.old_parent),s.onTreeNodeCopy(n,t,o,i)}),s.$tree.on("create_node.jstree",function(e,t){var n="group"===t.node.original.type,i=_K.calculateParentPath(t),o=t.instance._model.data[t.node.id].text;n?s.onTreeGroupCreate(i,o):s.onTreeNodeCreate(i,o,t.node.original),s.$tree.jstree("deselect_all",!0),s.$tree.jstree("select_node",t.node.id,!0),s.trigger("select_property",n?"":i?i+"/"+o:o,!0)}),s.$tree.on("delete_node.jstree",function(e,t){var n=_K.calculateParentPath(t),t=t.instance._model.data[t.node.id].text;s.onTreeNodeDelete(n,t)}),s.$tree.on("move_node.jstree",function(e,t){var n=t.node.text,i=_K.calculateParentPath(t),o=_K.calculatePath({node:t.instance._model.data[t.old_parent],instance:t.instance},t.old_parent);s.onTreeNodeMove(i,o,n),s.pending&&s.pending.id===t.node.id&&s.setPending(t.node),_.includes(s.$tree.jstree("get_selected"),t.node.id)&&"node"===t.node.type&&(s.selectionChanged=!1,s.trigger("select_property",_K.calculatePath(t,t.node.id)))}),s.$tree.on("rename_node.jstree",function(e,t){var n=_K.calculateParentPath(t);s.onTreeNodeRename(t.node.id,n,t.old,t.text),_.includes(s.$tree.jstree("get_selected"),t.node.id)&&(s.$tree.jstree("deselect_all"),s.$tree.jstree("select_node",t.node.id)),s.setPending(s.pending)}),s.$tree.on("search.jstree",function(e,t,n){0===t.nodes.length&&s.$tree.jstree(!0).hide_all(!1)}),s.initialSelection&&(t=s.model.getByPath(s.initialSelection),n=a.instance._model.data,t&&(n=_.find(n,function(e){return e.data===t.cid}))&&(s.$tree.jstree("select_node",n),s.selectedNode=n,s.$renameButton.button("option","disabled",!1),s.$deleteButton.button("option","disabled",!1),s.trigger("select_property",s.initialSelection),s.$el.find("#"+n.id)[0].scrollIntoView())),s.$tree.on("changed.jstree",$.proxy(s.onTreeItemSelectionChanged,s))})},_K.prototype.convertJSTreeModelToJSON=function(t,e){var n=this,e=t[e],i={};return e.type&&"node"===e.type?e.original.value||"":(_.each(e.children,function(e){i[t[e].text]=n.convertJSTreeModelToJSON(t,e)}),i)},_K.prototype.convertModelToJSTreeModel=function(n){var i,o=this,a=[];return _.each(_.keys(n),function(e){var t=n[e];t instanceof Backbone.Model&&!t.has("_dataType")&&!t.has("_viewType")?a.push({data:t.cid,text:e,type:"group",children:o.convertModelToJSTreeModel(t.attributes)}):(i={data:t.cid,text:e,type:_.isFunction(o.determineTypeFn)?o.determineTypeFn(t):"node",value:t||""},_.includes(o.disabledNodes,t.path)&&(i.state={disabled:!0}),a.push(i))}),a},_K.prototype.getModelFromPath=function(e,t){var n,i=t.indexOf("/");return 0<t.length?-1!==i?(n=e.get(t.substring(0,i)),this.getModelFromPath(n,t.substring(i+1))):e.get(t):e},_K.prototype.getTreeReference=function(){return this.$el.find(".tree").jstree(!0)},_K.prototype.onSearchInputKeyUp=function(){var e=this.$searchInput.val();this.$clearSearch.toggle(!_.isEmpty(e)),this.debouncedSearch(e)},_K.prototype.onClearSearchClick=function(){this.$searchInput.val("").trigger("keyup")},_K.prototype.onCreateClick=function(){var e,t;{if(!this.pending)return(t=(t=(e=this.getTreeReference()).get_selected()).length?t[0]:null)&&"group"!==e._model.data[t].type&&(t=e._model.data[t].parent),(t=e.create_node(t||null,{type:"node"}))&&e.edit(t),!0;this.renderAreYouSure(this.onCreateClick.bind(this))}},_K.prototype.onCreateNode=function(e,t){var n;this.pending?this.renderAreYouSure(this.onCreateNode.bind(this,e,t)):((e=(n=$.jstree.reference(e.reference)).get_node(e.reference)||null)&&"group"!==e.type&&(e=n.get_node(e.parent)||null),n.create_node(e,{type:t},"last",function(e){_.defer(function(){n.edit(e)})}))},_K.prototype.onRenameClick=function(){var e=this.getTreeReference(),t=e.get_selected();return!!t.length&&(t=t[0],e.edit(t),!0)},_K.prototype.onDeleteClick=function(){var e=this.getTreeReference(),t=e.get_selected();return!!t.length&&(e.delete_node(t),!0)},_K.prototype.onTreeItemSelectionChanged=function(e,t){var n="";"select_node"===t.action&&("group"!==t.instance._model.data[t.node.id].type?(n=_K.calculatePath(t,t.node.id),this.$renameButton.button("option","disabled",0===n.length)):this.$renameButton.button("option","disabled",!1),this.$deleteButton.button("option","disabled",0===n.length),this.selectionChanged=!this.selectedNode||this.selectedNode&&this.selectedNode.id!==t.node.id,this.lastSelectedNode=this.selectedNode||t.node,this.selectedNode=t.node,this.trigger("select_property",n))},_K.prototype.onTreeNodeCreate=function(e,t,n){e=this.getModelFromPath(this.model,e);e.set(t,this.newNodeFn(n)),e.trigger("materialChange")},_K.prototype.onTreeGroupCreate=function(e,t){e=this.getModelFromPath(this.model,e);e.set(t,this.newGroupFn()),e.trigger("materialChange")},_K.prototype.onTreeNodeCopy=function(e,t,n,i){var o=this,a=this.getModelFromPath(this.model,e),t=this.getModelFromPath(this.model,t).get(i||n).clone();a.set(n,t),a.trigger("materialChange"),this.setPathFn(t,e?e+"/"+n:n),_.defer(function(){o.trigger("select_property",e?e+"/"+n:n)})},_K.prototype.onTreeNodeDelete=function(e,t){e=this.getModelFromPath(this.model,e);e.unset(t),e.trigger("materialChange"),this.trigger("select_property")},_K.prototype.onTreeNodeMove=function(e,t,n){var i=this.getModelFromPath(this.model,e),t=this.getModelFromPath(this.model,t),o=t.get(n);t.unset(n),i.set(n,o),i.trigger("materialChange"),this.setPathFn(o,e?e+"/"+n:n)},_K.prototype.onTreeNodeRename=function(e,t,n,i){var o=this,t=this.getModelFromPath(this.model,t),a=t.get(n);QuickBase.ErrorTooltip.clear(this.$errorTooltip),i===_.unescape(i)&&/^[\w&.\- ]+$/.test(i)?(t.unset(n),a&&(t.set(i,a),t.trigger("materialChange"),this.setPathFn(a,t.path?t.path+"/"+i:i))):(this.$errorTooltip=QuickBase.ErrorTooltip.show("Invalid name (a-Z 0-9 _-. allowed)",this.$el.find("#"+e+"_anchor"),!0),_.delay(function(){QuickBase.ErrorTooltip.clear(o.$errorTooltip,!0)},5e3),this.$tree.jstree("rename_node",e,n))},_K.prototype.jstreeSearch=function(e){this.$tree.jstree(!0).show_all(!1),this.$tree.jstree().search(e)},_K.prototype.renderAreYouSure=function(e){var t=this;this.areYouSureDialog=new QuickBase.AreYouSureDialog({saveCb:function(){t.saveCb(),t.setPending(),t.selectionChanged=null,e()},onClose:function(){t.areYouSureDialog.remove(),delete t.areYouSureDialog},noSaveCb:function(){t.noSaveCb(),t.setPending(),t.selectionChanged=null,e()},dashChanged:!0,message:this.areYouSureMessage||"There are unsaved changes to the selected item"})},_K.prototype.setPending=function(e){var t,n,i=e||this.pending,o=!!e;i&&((n=(t=this.$tree.jstree())._model.data[i.id].li_attr.class)?(n=n.split(" "),o&&!_.includes(n,"save-pending")?n.push("save-pending"):o||_.remove(n,function(e){return"save-pending"===e})):o&&(n=["save-pending"]),t.get_node(i,!0).toggleClass("save-pending",o),n&&(t._model.data[i.id].li_attr.class=n.join(" "))),this.pending=e||null},_K.prototype.showTargetExistsError=function(e){var t=this;QuickBase.ErrorTooltip.clear(this.$errorTooltip),this.$errorTooltip=QuickBase.ErrorTooltip.show("Target already exists",this.$el.find("#"+e.obj),!0),_.delay(function(){QuickBase.ErrorTooltip.clear(t.$errorTooltip,!0)},5e3)},_K.prototype.updateNodeValue=function(e,t,n){e=e.substring(0,e.lastIndexOf("/")),e=this.getModelFromPath(this.model,e);t.original.value=n,e.set(t.text,n)},_K.calculatePath=function(t,e){return _.map([e].concat(t.node.parents.slice(0,-1)),function(e){return t.instance._model.data[e].text}).reverse().join("/")},_K.calculateParentPath=function(t){return _.map(t.node.parents.slice(0,-1),function(e){return t.instance._model.data[e].text}).reverse().join("/")},_K),$K;function _K(e){var t=$K.call(this,_.extend({},e,{className:"dataView"}))||this;return t.contextMenuFn=e.contextMenuFn,t.determineTypeFn=e.determineTypeFn,t.disabledNodes=e.disabledNodes,t.initialSelection=e.selected,t.newGroupFn=e.newGroupFn,t.newNodeFn=e.newNodeFn,t.nodeLabel=e.nodeLabel||"Node",t.nodeTypes=e.nodeTypes||{},t.setPathFn=e.setPathFn,t.saveCb=e.saveCb,t.noSaveCb=e.noSaveCb,t.areYouSureMessage=e.areYouSureMessage,t.$el.addClass("dataView"),t.$el.html(T.TreeView()),t.$createButton=t.$el.find(".new").button({icons:{primary:"fa fa-square-o"}}),t.$renameButton=t.$el.find(".rename").button({icons:{primary:"fa fa-pencil-square-o"},disabled:!0}),t.$deleteButton=t.$el.find(".delete").button({icons:{primary:"fa fa-trash-o"},disabled:!0}),t.$searchInput=t.$el.find(".search"),t.$clearSearch=t.$el.find(".clearSearch"),t.debouncedSearch=_.debounce(_.bind(t.jstreeSearch,t),250),require(["jstree"],function(){var l=t;t.$tree=t.$el.find(".tree").jstree({core:{data:t.convertModelToJSTreeModel(_.omit(t.model.attributes,".settings")),error:function(e){var t,n,i,o,a,s=JSON.parse(e.data);switch(e.id){case"unique_01":_.defer(function(){this.edit(s.obj)}.bind(this)),QuickBase.ErrorTooltip.clear(l.$errorTooltip),l.$errorTooltip=QuickBase.ErrorTooltip.show("Name already exists",l.$el.find("#"+s.obj),!0),_.delay(function(){QuickBase.ErrorTooltip.clear(l.$errorTooltip,!0)},5e3);break;case"core_01":case"types_02":case"unique_02":if(i=this.get_json(s.obj),"core_01"===e.id&&"group"===i.type)break;if(n="unique_02"===e.id?_K.calculatePath({node:this.get_node(s.par),instance:this},s.par):_K.calculateParentPath({node:this.get_node(s.par),instance:this}),t=l.getModelFromPath(l.model,n),"types_02"===e.id&&"move_node"===s.chk&&t.get(i.text)){l.showTargetExistsError(s);break}for(o=i.text;t.get(i.text);)i.text+=" copy";delete i.id,delete i.a_attr,delete i.li_attr,a="unique_02"===e.id?s.par:this.get_node(s.par).parent,"move_node"!==s.chk?(this.create_node("#"===a?null:a,i),l.onTreeNodeCopy(n,_K.calculateParentPath({node:this.get_node(s.obj),instance:this}),i.text,o)):(this.move_node(this.get_node(s.obj),this.get_node(a)),l.onTreeNodeMove(n,_K.calculateParentPath({node:this.get_node(s.obj),instance:this}),i.text));break;case"core_03":case"unique_03":l.showTargetExistsError(s)}},check_callback:function(e,t,n,i,o){t=this.get_node(t);return"move_node"!==e||t.parent!==this.get_node(n).id},themes:{dots:!0}},sort:function(e,t){var n=(this.get_type(e)||"").match(/^[a-z]+/)[0],i=(this.get_type(t)||"").match(/^[a-z]+/)[0];return n===i?this.get_text(e)>this.get_text(t)?1:-1:i<=n?1:-1},contextmenu:{items:function(e){var t;if(!l.pending||!l.selectionChanged)return t=$.jstree.defaults.contextmenu.items(),e=this.get_type(e),delete t.create.action,t.create.label="New",t.create.submenu={create_node:{label:l.nodeLabel,action:function(e){return l.onCreateNode(e,"node")}},create_group:{separator_after:!0,label:"Group",action:function(e){return l.onCreateNode(e,"group")}}},_.isFunction(l.contextMenuFn)&&_.extend(t,l.contextMenuFn(e)),t}},search:{show_only_matches:!0,show_only_matches_children:!0},types:_.extend({node:{valid_children:[],icon:"fa fa-fw fa-file-text"},group:{icon:"fa fa-fw fa-folder"}},t.nodeTypes),unique:{duplicate:function(e,t){return e+" "+t}},plugins:["contextmenu","dnd","search","stackedicon","state","types","wholerow","unique","sort"]}),t.initializeEvents()}),t}var ViewStateDialog=Backbone.View.extend({className:"view-state-dialog",initialize:function(n){var o=this,e=parseInt(o.getCookie("dashboard-viewStateDialog-size").split(",")[1])+90||560,e=(o.isPropertiesCollapsed=!1,Tools.calcDialogHeight(e,"viewStateDialog")),i=parseInt(o.getCookie("dashboard-viewStateDialog-size").split(",")[0])||480;i>window.innerWidth?i=window.innerWidth-300:e>window.innerHeight?e=window.innerHeight-200:i>innerWidth&&e>innerHeight&&(i=window.innerWidth-300,e=window.innerHeight-200),o.cancelCallback=n.cancelCallback,o.dialogContainer=n.dialogContainer,o.disabledNodes=n.disabledNodes,o.docDataModel=n.docDataModel,o.selectCallback=n.selectCallback,o.path=void 0,o.$el.html(T.ViewStateDialog()),o.$tree=o.$el.find("> .tree"),o.$collapsible=o.$el.find(".accordian-container > .collapsible"),o.$header=o.$collapsible.find("> h3"),o.$icon=o.$header.find("i"),o.$collapsibleContent=o.$collapsible.find("> .properties"),o.$el.dialog(_.extend({appendTo:n.dialogContainer,title:t("Select View State... "),dialogClass:"quick-dash viewstate-dialog",resizable:!0,height:e,width:i,minWidth:480,position:{my:"center",at:"center",of:"#appdiv",collision:"fit"},modal:!0,autoOpen:!0,buttons:[{text:t("Select Item"),click:$.proxy(o.onSelectButtonClick,o),disabled:!0,icons:{primary:"fa fa-check"}},{text:t("Cancel"),click:$.proxy(o.onCancelButtonClick,o),icons:{primary:"fa fa-times"}}],close:function(){o.cancelCallback&&o.cancelCallback(),o.setCookie("dashboard-viewStateDialog-position",o.el.parentElement.style.left+","+o.el.parentElement.style.top,90),o.setCookie("dashboard-viewStateDialog-weights",o.accordion.sections[0].weight+","+o.accordion.sections[1].weight,90),o.removeDialog(),QuickBase.ErrorTooltip.clearAll()},open:function(){$('<i class="fa fa-eye" />').insertBefore(o.$el.parent().find(".ui-dialog-title"));var e=o.getCookie("dashboard-viewStateDialog-weights").split(",");o.dataView=new TreeView({el:o.$el.find(".tree"),disabledNodes:o.disabledNodes,model:o.model,nodeLabel:"View State",nodeTypes:{node:{icon:"fa fa-fw fa-eye",valid_children:[]}},selected:n.path,newGroupFn:function(){return new QuickBase.DocumentViewModel},newNodeFn:function(){return new QuickBase.DocumentViewModel({_viewType:!0,_default:""})},setPathFn:function(e,t){var n,i=e.path;t!==i&&(e.path=t,n=new RegExp("^"+i),e.getViewStateList().forEach(function(e){e=e.model;e.path&&(e.path=e.path.replace(n,t))}),o.docDataModel.getTreeList().forEach(function(e){e.updateParameterPath("vs",i,t)}))}}),o.sections=[{$el:o.$el.find(".treeview"),$content:o.$tree,isExpanded:!0,hidden:!1,minHeight:15,weight:isNaN(parseFloat(e[0]))?1:parseFloat(e[0])},{$el:o.$collapsible,heading:o.$header,isExpanded:!0,hidden:!1,weight:isNaN(parseFloat(e[1]))?2:parseFloat(e[1])}],o.accordion=new AccordionView({el:o.$el.get(0),sections:o.sections}),o.$header.click(function(){o.isPropertiesCollapsed=!o.isPropertiesCollapsed,o.$collapsibleContent.toggle(!o.isPropertiesCollapsed),o.isPropertiesCollapsed?(o.$el.find(".tree.jstree")[0].style.position="relative",o.$el.find(".tree.jstree")[0].style.top="0px",o.accordion.sections[1].fixed=28):(o.$el.find(".tree.jstree")[0].style.position="absolute",o.$el.find(".tree.jstree")[0].style.top="2.5em",o.accordion.sections[1].fixed=0),o.accordion.updateLayout()}),o.dataView.on("select_property",$.proxy(o.onTreeViewSelectProperty,o)),"FSBL"in window&&o.$el.parent().css("margin-top",window.finApi.DIALOGS_TOP_MARGIN),o.$el.parent().find(".ui-dialog-buttonpane > div > button:last-child").focus()},resizeStart:function(){},resizeStop:function(){o.accordion.updateLayout(),o.setCookie("dashboard-viewStateDialog-size",o.$el.width()+","+o.$el.height(),90)}},n)),o.getCookie("dashboard-viewStateDialog-position")&&(o.$el[0].parentElement.style.left=o.getCookie("dashboard-viewStateDialog-position").split(",")[0],o.$el[0].parentElement.style.top=o.getCookie("dashboard-viewStateDialog-position").split(",")[1])},setCookie:function(e,t,n){var i=new Date,n=(i.setTime(i.getTime()+24*n*60*60*1e3),"expires="+i.toUTCString());document.cookie=e+"="+encodeURIComponent(t)+";"+n+";path=/"},getCookie:function(e){for(var t=e+"=",n=decodeURIComponent(document.cookie).split(";"),i=0;i<n.length;i++){for(var o=n[i];" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return""},onCancelButtonClick:function(){this.cancelCallback&&this.cancelCallback(),QuickBase.ErrorTooltip.clearAll(),this.$el.dialog("close"),this.remove()},onSelectButtonClick:function(){this.selectCallback&&this.selectCallback(this.path),this.onCancelButtonClick()},onTreeViewSelectProperty:function(e){this.path=e,this.$el.next().find("button:first").button({disabled:void 0===e}),this.updateProperties(e)},remove:function(){this.removeProperties(),Backbone.View.prototype.remove.call(this)},removeDialog:function(){this.$el.dialog&&this.$el.dialog("destroy"),Backbone.View.prototype.remove.call(this)},removeProperties:function(){this.form&&(this.form.remove(),this.form=null)},sayNoToSubmit:function(){return!1},updateProperties:function(t){var e,o=this,a=!1,s=o.model.getByPath(t);o.removeProperties(),s&&(s.get("value")||(a=!0),s.has("value")||s.set("value","",{silent:!0}),s.has("_default")||s.set("_default","",{silent:!0}),"dict"===s.get("_type")&&(s.schema.value.type="ThreeColumnDict",delete s.schema._default),_.includes(["date","datetime","time","timestamp","minute","second"],s.get("_type"))&&s.schema?(s.schema._default=BBForm.RTTI.getByName(s.get("_type")+"Rolling").editor,s.schema._default.options.editorModel=new Backbone.Model,s.get("_rolling")?s.schema._default.options.editorModel.set("rolling",!0):s.schema._default.options.editorModel.set("rolling",!1),this.listenTo(s.schema._default.options.editorModel,"change:rolling",function(e,t){s.set("_rolling",t),this.stopListening(s,"change:_default"),s.get("_rolling")&&(this.listenTo(s,"change:_default",function(){s.set("value",QuickBase.Helpers.convertRollingToDate(s.get("_default"),s.get("_type")))}),s.trigger("change:_default"))}),this.stopListening(s,"change:_default"),s.get("_rolling")&&this.listenTo(s,"change:_default",function(){s.set("value",QuickBase.Helpers.convertRollingToDate(s.get("_default"),s.get("_type")))})):s.unset("_rolling"),"list"!==s.get("_type")||s.get("_listtype")||s.set("_listtype","symbol"),s.schema._type.width="off",o.form=new BBForm({model:s,openViewStateDialog:function(e,t){new ViewStateDialog({dialogContainer:o.dialogContainer,disabledNodes:_.map(_.filter(o.model.attributes,function(e){return"dict"===e.get("_type")}),"path"),docDataModel:o.docDataModel,model:o.model,path:e,selectCallback:function(e){e=o.model.getByPath(e);t(e)}})},theme:"environment",viewStates:o.model.getViewStateList()}).render(),o.form.on("changeList",function(e,t){s.set("_default",e.getValue()._default),s.set("value",e.getValue().value)}),o.form.$el.on("submit",o.sayNoToSubmit),_.includes(["dict","list"],s.get("_type"))&&(e=$("<span />").addClass("fa fa-undo reset-to-default").prop("title","Reset to Default"),o.form.$el.find(".field-value label").append(e),e.click(function(){s.forceRender=!0,s.set("value",_.clone(s.get("_default"))),s.forceRender=!1})),o.$collapsibleContent.append(o.form.el),o.$collapsibleContent.scrollTop=0,o.form.fields._type&&s.schema&&s.schema._type&&o.form.fields._type.editor.setOptions(s.schema._type.options),o.debouncedUpdate=_.debounce(function(){var n,e,i;o.form&&(s.get("_type")!==o.form.getValue()._type?(s.set("_type",o.form.getValue()._type),o.removeProperties(),s.unset("value",{silent:!0}),s.unset("_default",{silent:!0}),s.updateSchema(),o.updateProperties(t),s.set("value",o.form.getValue().value),"dict"!==s.get("_type")&&s.set("_default",o.form.getValue()._default)):(n=o.form.getValue(),e=o.form.validate({appendToBody:!0,onLeft:!1}),"dict"!==n._type||n._default||(n._default={},_.each(n.value,function(e,t){n._default[t]=e._default,n.value[t]=e.value})),e?(i=_.keys(e),_.each(n,function(e,t){_.includes(i,t)||s.set(t,e)})):s.set(n),a&&(s.get("_rolling")?s.set("value",QuickBase.Helpers.convertRollingToDate(s.get("_default"),s.get("_type"))):s.set("value",_.isDate(s.get("_default"))?s.get("_default").toISOString():_.clone(s.get("_default"))))))},300),o.listenTo(o.form,"change",o.debouncedUpdate),o.listenTo(o.form,"_default:blur value:focus",function(){a=!1}))}}),DataConfigQuery_Pivot=Backbone.View.extend({AGGREGATE_FNS:["count","sum","avg","max","min","first","last"],AGGREGATE_COLS_PROP:"_aggregateCols",AGGREGATE_FNS_PROP:"_aggregateFns",AGGREGATE_LABELS_PROP:"_aggregateLabels",BREAKDOWN_PROP:"_breakdownCols",initialize:function(e){var t=this;t.options=e,t.$el.html(T.DataConfigQuery_Pivot(_.extend({guid:_.uniqueId("pivot_"),hasAggregateViewState:t.model.get(t.AGGREGATE_COLS_PROP)instanceof Backbone.Model},this.model.toJSON()))),t.$el.find("._columnLabel").change(function(){t.model.set("_columnLabel",$(this).val())}),t.$el.find("._columnLabel").val(t.model.get("_columnLabel")||""),t.$aggregateContainer=t.$el.find(".aggregateContainer"),t.$aggregateList=t.$aggregateContainer.find(".aggregateList"),t.$aggregateViewStateCheckBox=t.$aggregateContainer.find(".viewStateCheckbox"),t.switchCache={},t.upgradeModel(),t.initPivotOptions(),t.initializeAggregateEvents(),t.updateLayout(),t.$aggregateViewStateCheckBox.is(":checked")?(t.aggregateViewStateCache=!0,t.aggregateColsCache=t.model.get(t.AGGREGATE_COLS_PROP),t.aggregateFnCache=t.model.get(t.AGGREGATE_FNS_PROP),t.aggregateLabelsCache=t.model.get(t.AGGREGATE_LABELS_PROP)):(t.aggregateViewStateCache=!1,t.aggregateColsCache=$.extend(!0,[],t.model.get(t.AGGREGATE_COLS_PROP)),t.aggregateFnCache=$.extend(!0,[],t.model.get(t.AGGREGATE_FNS_PROP)),t.aggregateLabelsCache=$.extend(!0,[],t.model.get(t.AGGREGATE_LABELS_PROP))),t.initializeEvents()},initializeEvents:function(){this.listenTo(this.model,"change:_aggregateCols",this.onAggregateDetailsChange),this.listenTo(this.model,"change:_columnLabel",this.displayColumnLabel)},addAggregateRow:function(e,t,n){e=new DataConfigAggregateRow({model:this.model,aggregateDetails:{aggCol:e,aggFn:t||"avg",aggLabel:n||""}});this.$aggregateList.find("ul").append(e.$el)},checkNewAggregateEntry:function(e,t,n){return(-1<this.AGGREGATE_FNS.indexOf(t)||-1<t.indexOf(";"))&&0<e.length&&0<t.length},displayColumnLabel:function(){this.$el.find("._columnLabel").val(this.model.get("_columnLabel"))},initializeAggregateEvents:function(){function t(){e=n.$el.find(".newAggregate .aggregateColItm").val(),newAggregateFn=n.$el.find(".newAggregate .aggregateFnItm").val(),newAggregateLabel=n.$el.find(".newAggregate .aggregateLabelItm").val(),n.model.get(n.AGGREGATE_COLS_PROP).push(e),n.model.get(n.AGGREGATE_FNS_PROP).push(newAggregateFn),n.model.get(n.AGGREGATE_LABELS_PROP).push(newAggregateLabel),n.$el.find(".newAggregate .aggregateFnItm, .newAggregate .aggregateColItm, .newAggregate .aggregateLabelItm").val(""),n.$el.find(".newAggregate .aggregateFnItm").focus(),n.checkNewAggregateEntry(e,newAggregateFn,newAggregateLabel)||(n.$el.find(".newAggregate input").addClass("invalidEntry"),_.delay(function(){n.$el.find(".newAggregate input").removeClass("invalidEntry")},3e3)),n.model.trigger("change:_aggregateCols")}var e,n=this;n.$aggregateAddBtn=n.$el.find(".newAggregate .addBtn"),n.$aggregateCancelBtn=n.$el.find(".newAggregate .cancelBtn"),n.$aggregateResetBtn=n.$el.find(".resetBtn"),n.$aggregateSaveBtn=n.$el.find(".newAggregate .saveBtn"),n.$aggregateAddBtn.button({icons:{primary:"fa fa-plus"},text:!1}).click(t),n.$aggregateResetBtn.button({icons:{primary:"fa fa-repeat"},text:!1}).click($.proxy(n.resetAggregateCols,n)),n.$aggregateViewStateCheckBox.button({icons:{primary:"fa fa-eye"},text:!1}).click($.proxy(n.onViewStateCheckBoxClick,n)),n.$el.find(".newAggregate input").on("keydown",function(e){13===e.which&&t()}),n.initializeAggregateViewstate()},initializeAggregateViewstate:function(){var n=this,e={};e[n.AGGREGATE_COLS_PROP]={title:"Columns:",type:"ViewState"},e[n.AGGREGATE_FNS_PROP]={title:"Functions:",type:"ViewState"},e[n.AGGREGATE_LABELS_PROP]={title:"Labels:",type:"ViewState"},this.aggregateViewStateForm=new BBForm({model:n.model,openViewStateDialog:function(e,t){new ViewStateDialog({dialogContainer:n.options.dialogContainer,docDataModel:n.options.docDataModel,model:n.options.docViewModel,path:e,selectCallback:function(e){e=n.options.docViewModel.getByPath(e);t(e)}})},placeholder:"Type aggregate column name and hit enter",removeDuplicates:!0,schema:e}).render(),this.aggregateViewStateForm.on("change",function(){n.aggregateViewStateForm.commit()}),n.$el.find(".aggregateViewState").append(n.aggregateViewStateForm.el)},initPivotOptions:function(){var n=this;this.model.schema={},this.model.schema[this.BREAKDOWN_PROP]="ListViewState",this.breakdownPanel=new BBForm({model:this.model,openViewStateDialog:function(e,t){new ViewStateDialog({dialogContainer:n.options.dialogContainer,docDataModel:n.options.docDataModel,model:n.options.docViewModel,path:e,selectCallback:function(e){e=n.options.docViewModel.getByPath(e);t(e)}})},placeholder:"Type breakdown column name and hit enter",removeDuplicates:!0}).render(),this.breakdownPanel.on("change",function(){n.breakdownPanel.commit()}),this.breakdownPanel.on("changeList",function(e){n.model.set(n.BREAKDOWN_PROP,e.getValue()[n.BREAKDOWN_PROP])}),this.$el.find("."+this.BREAKDOWN_PROP).append(this.breakdownPanel.el),this.populateAggregateDetails()},onAggregateDetailsChange:function(e){e&&e.forceRender&&this.breakdownPanel&&this.aggregateViewStateForm?(e=this.model.get(this.AGGREGATE_COLS_PROP)instanceof Backbone.Model,this.breakdownPanel.off(),this.breakdownPanel.remove(),this.aggregateViewStateForm.off(),this.aggregateViewStateForm.remove(),this.$aggregateViewStateCheckBox.prop("checked",e),this.initPivotOptions(),this.initializeAggregateViewstate(),this.updateLayout()):this.populateAggregateDetails()},onViewStateCheckBoxClick:function(){var i=this;_.each([i.AGGREGATE_COLS_PROP,i.AGGREGATE_FNS_PROP,i.AGGREGATE_LABELS_PROP],function(e){var t=i.model.get(e),n=(n=i.switchCache[e])||(i.$aggregateViewStateCheckBox.is(":checked")?"":[]);i.model.set(e,n),i.switchCache[e]=t}),this.updateLayout()},populateAggregateDetails:function(){var o=this;o.model.get(o.AGGREGATE_COLS_PROP);o.$aggregateViewStateCheckBox.is(":checked")||(o.$aggregateList.find("li").remove(),0<o.model.get(o.AGGREGATE_COLS_PROP).length?o.$aggregateList.find("ul").addClass("populated-list"):o.$aggregateList.find("ul").removeClass("populated-list"),_.each(o.model.get(o.AGGREGATE_COLS_PROP),function(e,t){var n=o.model.get(o.AGGREGATE_FNS_PROP)||[],i=o.model.get(o.AGGREGATE_LABELS_PROP)||[];n[t]||(n[t]="avg"),i[t]||(i[t]=""),o.addAggregateRow(e,n[t],i[t])}),o.$aggregateList.find("ul").sortable({handle:".moveRow",placeholder:"ui-state-highlight",scrollSensitivity:5,scrollSpeed:5,axis:"y",stop:function(){o.model.set({_aggregateCols:[],_aggregateFns:[],_aggregateLabels:[]},{silent:!0}),_.each(o.$aggregateList.find("li"),function(e){o.model.get(o.AGGREGATE_COLS_PROP).push($(e).find(".aggregateColItm").val()),o.model.get(o.AGGREGATE_FNS_PROP).push($(e).find(".aggregateFnItm").val()),o.model.get(o.AGGREGATE_LABELS_PROP).push($(e).find(".aggregateLabelItm").val())}),o.model.trigger("change:_aggregateCols")}}))},refreshPivotDetails:function(){},remove:function(){this.$aggregateAddBtn.off(),this.$aggregateResetBtn.off(),this.$aggregateViewStateCheckBox.off(),Backbone.View.prototype.remove.call(this)},resetAggregateCols:function(){this.$aggregateViewStateCheckBox.prop("checked",this.aggregateViewStateCache),this.model.set(this.AGGREGATE_COLS_PROP,this.aggregateColsCache),this.model.set(this.AGGREGATE_FNS_PROP,this.aggregateFnCache),this.model.set(this.AGGREGATE_LABELS_PROP,this.aggregateLabelsCache),this.populateAggregateDetails(),this.updateLayout()},updateLayout:function(){this.$aggregateViewStateCheckBox.is(":checked")?this.$aggregateContainer.addClass("isViewState"):this.$aggregateContainer.removeClass("isViewState")},upgradeModel:function(){var e;this.model.has(this.AGGREGATE_LABELS_PROP)||(e=this.model.get(this.AGGREGATE_COLS_PROP),this.model.set(this.AGGREGATE_LABELS_PROP,_.map(e instanceof Backbone.Model?e.get("value"):e,function(){return""})))}}),qFunctionKeywordsOutsideSheet="aj0|wj1",qFunctionKeywords="abs|aj|acos|all|and|any|asc|asin|asof|atan|attr|avg|avgs|bin|binr|by|ceiling|cols|cor|cos|count|cov|cross|csv|cut|delete|deltas|desc|dev|differ|distinct|div|do|dsave|each|ej|ema|enlist|eval|except|exec|exit|exp|fby|fills|first|flip|floor|fkeys|from|get|getenv|group|gtime|hclose|hcount|hdel|hopen|hsym|iasc|idesc|if|ij|in|insert|inter|inv|key|keys|last|ljf|like|lj|load|log|lower|lsq|ltime|ltrim|mavg|max|maxs|mcount|md5|mdev|med|meta|min|mins|mmax|mmin|mmu|mod|msum|neg|next|not|null|or|over|parse|peach|pj|prd|prds|prev|prior|rand|rank|ratios|raze|read0|read1|reciprocal|reval|reverse|rload|rotate|rsave|rtrim|save|scan|scov|sdev|svar|select|set|setenv|show|signum|sin|sqrt|ss|ssr|string|sublist|sum|sums|sv|system|tables|tan|til|trim|type|uj|ungroup|union|update|upper|upsert|value|var|view|views|vs|wavg|where|while|within|wj|wsum|ww|xasc|xbar|xcol|xcols|xdesc|xexp|xgroup|xkey|xlog|xprev|xrank",helperFunctionKeywords="asBoolean|asByte|asChar|asDate|asDatetime|asFloat|asGUID|asInt|asList|asLong|asMinute|asMonth|asReal|asSecond|asShort|asString|asSymbol|asTime|asTimespan|asTimestamp|asType|catch|INFINITY|isAtom|isBoolean|isByte|isChar|isCompound|isDate|isDatetime|isDict|isDictionary|isEmpty|isEnum|isFloat|isFunction|isGeneral|isGUID|isInfinity|isInt|isKeyedTable|isLinked|isList|isLong|isMinute|isMonth|isNull|isNumber|isReal|isSecond|isShort|isString|isSymbol|isTable|isTime|isTimespan|isTimestamp|isType|isVector|NULL|parseBoolean|parseByte|parseChar|parseDate|parseDatetime|parseFloat|parseGUID|parseInt|parseLong|parseMinute|parseMonth|parseReal|parseSecond|parseShort|parseSymbol|parseTime|parseTimespan|parseTimestamp|parseType|typeOf|typeSymbol|until|xor",illegalQKeywords="Mlim|Q7|access|accp|adict|arch|assign|badtail|branch|cast|char|conn|constants|domain|elim|glim|globals|length|limit|locals|loop|mismatch|mq|noamend|nosocket|noupdate|nyi|os|par|params|part|pl|pwuid|splay|srv|stack|step|stop|stype|sys|threadview|unmappable|upd|user|utf8|vd1|wha|wsfull|wsm",illegalQKeywordsRegex=new RegExp("^("+illegalQKeywords+")\\b"),StringStream=(zP.prototype.eol=function(){return this.pos>=this.string.length},zP.prototype.sol=function(){return this.pos==this.lineStart},zP.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},zP.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},zP.prototype.eat=function(e){var t=this.string.charAt(this.pos),e="string"==typeof e?t==e:t&&(e.test?e.test(t):e(t));if(e)return++this.pos,t},zP.prototype.eatWhile=function(e){for(var t=this.pos;this.eat(e););return this.pos>t},zP.prototype.eatSpace=function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},zP.prototype.skipToEnd=function(){this.pos=this.string.length},zP.prototype.skipTo=function(e){e=this.string.indexOf(e,this.pos);if(-1<e)return this.pos=e,!0},zP.prototype.backUp=function(e){this.pos-=e},zP.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?countColumn(this.string,this.lineStart,this.tabSize):0)},zP.prototype.indentation=function(){return countColumn(this.string,null,this.tabSize)-(this.lineStart?countColumn(this.string,this.lineStart,this.tabSize):0)},zP.prototype.match=function(e,t,n){var i;if("string"!=typeof e)return(i=this.string.slice(this.pos).match(e))&&0<i.index?null:(i&&!1!==t&&(this.pos+=i[0].length),i);function o(e){return n?e.toLowerCase():e}return o(this.string.substr(this.pos,e.length))==o(e)?(!1!==t&&(this.pos+=e.length),!0):void 0},zP.prototype.current=function(){return this.string.slice(this.start,this.pos)},zP.prototype.hideFirstChars=function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}},zP.prototype.lookAhead=function(e){var t=this.lineOracle;return t&&t.lookAhead(e)},zP.prototype.baseToken=function(){var e=this.lineOracle;return e&&e.baseToken(this.pos)},zP);function zP(e,t,n){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=n}function countColumn(e,t,n,i,o){null==t&&-1==(t=e.search(/[^\s\u00a0]/))&&(t=e.length);for(var a=i||0,s=o||0;;){var l=e.indexOf("\t",a);if(l<0||t<=l)return s+(t-a);s=(s+=l-a)+(n-s%n),a=l+1}}var State=(eQ.prototype.clone=function(){return new eQ(this)},eQ.prototype.equals=function(e){return e===this},eQ);function eQ(e){var t=e.mode,n=e.prevToken,i=e.braceDepth,o=e.qukeMixed,e=e.depth;this.mode=t,this.prevToken=n,this.braceDepth=i,this.qukeMixed=o,this.depth=e}var tokenFunction=function(t,e){function o(e,t){return t.mode!==O.afterCloseBracket&&e.match(H,!0,!1)?(t.mode=O.afterVarNumSym,m(t,"number")):(t.mode=O.afterPunctuation,m(t,"keyword"))}function i(e,t,n){return e.match(V,!0,!1),t.mode=O.afterVarNumSym,m(t,n)}function a(e,t){for(;;){if(e.eat('"'))return t.mode=O.afterPunctuation,m(t,"string");if(e.eol())return t.mode=O.unclosedString,m(t,"string");if(e.eat("\\")){if(!e.eat(N))return e.next(),m(t,"error-invalidEscape")}else e.next()}}function s(e,t){return e.eat(T)?e.match(x,!0,!1):e.eat(":")&&e.match(_,!0,!1),t.mode=O.afterVarNumSym,m(t,"symbol")}function l(e,t){var n=e.match(B,!0,!1);return t.mode=O.afterVarNumSym,E.test(n[0])?m(t,"error-datetime"):z.test(n[0])?m(t,"keyword"):S.test(n[0])?m(t,"error-illegalKeyword"):e.eat(".")?i(e,t,"variable"):g&&n[0].match(D)?m(t,"cell"):m(t,"variable")}function r(e,t){return e.match(M,!0)?(e.skipToEnd(),m(t,"toDo")):(e.skipToEnd(),m(t,"comment"))}function c(e,t){return e.eol()||e.match(I)?(e.eatSpace(),t.mode=O.commentTilEnd,e.skipToEnd(),m(t,"error-multilineComment")):0<t.depth?(t.mode=O.afterPunctuation,m(t,"error-unindentedToken")):(t=t,((e=e).match(A,!0,!1)?function(e,t){return e.eat(" ")||e.eol()?m(t,"command"):n(e,t)}:n)(e,t))}function n(e,t){return e.skipToEnd(),m(t,"command")}function d(e,t){return e.match(b,!1,!1)?i(e,t,"keyword"):e.match(F,!0,!1)?m(t,"error-reservedInContext"):e.match(k,!1,!1)?i(e,t,"variable"):e.match(U,!0,!1)?(t.mode=O.afterVarNumSym,m(t,"number")):(t.mode=O.afterPunctuation,m(t,"keyword"))}function u(e,t){return e.eatWhile(":"),t.mode=O.afterPunctuation,m(t,"keyword")}function p(e){return e.depth--,e.mode=O.afterCloseBracket,null}function h(e){return e.depth++,e.mode=O.afterOpenBracket,null}function m(e,t){return e.prevToken=t}var g=!!e.isSpreadsheet,f=/^[\[({]/,v=/^[\])}]/,b=/^[a-zA-Z](\.|$|(?![a-zA-Z0-9_]))/,y=/^[~!@#$%^&*:<>,\?|+=_-]/,C=/^[012]:/,w=/^(&&|\|\||(<>|[<>]=):|[~!@#$%\^&*\-_+\\,?]=)/,S=new RegExp("^("+illegalQKeywords+")\\b"),E=/^(asDatetime|parseDatetime)$/,k=/^[a-zA-Z]/,T=/^[a-zA-Z0-9.]/,_=/^[a-zA-Z0-9._/:]*/,x=/^[a-zA-Z0-9._]*(:[a-zA-Z0-9._/:]*)?/,D=/^[a-zA-Z][a-zA-Z]?[1-9][0-9]*\b/,A=/^([abBcCdefgopPsStTuvwWxz]|ts)\b/,M=/^\/*\s*@?TODO\b/i,L=/^k\)/,N=/^([\\\/nrt"0-7])/,I=/^\s+$/,B=/^[a-zA-Z0-9_]*/,V=/^[a-zA-Z0-9_]*(\.[a-zA-Z0-9_]+)*\.?/,F=new RegExp("^[a-zA-Z0-9_]+\\.("+qFunctionKeywords+"|"+helperFunctionKeywords+")(\\.[a-zA-Z0-9_]+)*\\.?\\b"),U=/^([0-9]+(f|e(-?[0-9]+e?)?)?|(f|e(-?[0-9]+e?)?))/,$="0x[\\da-fA-Fa-f]*",P=["0[nNwW][hjemdzuvtifpgn]?","[10]+b",$,"\\d{4}\\.\\d{2}([ptnm]|\\.\\d{2}([DPtdp](\\d{2}(:\\d{2}(:\\d{2}(\\.\\d{0,9})?)?)?)[pn]?|[pnd]?))","\\d{2}:\\d{2}(:\\d{2}(\\.\\d{0,9})?)?[ptnvu]?|\\d{2}[ptnvu]","\\d{1,6}D(\\d{1,2}(:\\d{2}(:\\d{2}(\\.\\d{0,9}|\\.?)?)?)?)?[np]?","\\d{1,6}P\\d{2}:\\d{2}([np]|:\\d{2}([np]|\\.[np]|\\.\\d{0,9}[np]|\\.\\d{3,9}[np]?))","(\\d+(\\.\\d*)?|\\d*\\.\\d+)(e[+-]?\\d+)[ef]?|(\\d+\\.\\d*|\\d*\\.\\d+)[ef]?|\\d+[eihjf]?"].join("|"),R=new RegExp("^([10]+b|"+$+"|"+P+")"),H=new RegExp("^("+P+")"),z=new RegExp("^("+qFunctionKeywords+"|"+helperFunctionKeywords+(g?"":"|"+qFunctionKeywordsOutsideSheet)+")\\b"),O={SOL:0,afterSpace:1,afterVarNumSym:2,afterPunctuation:3,unclosedString:4,multilineComment:5,commentTilEnd:6,afterOpenBracket:7,afterCloseBracket:8};return{startState:function(){return new State({mode:O.SOL,prevToken:null,braceDepth:0,qukeMixed:!!e.qukeMixed,depth:0})},indent:function(e){return t.indentUnit*e.depth},token:function(e,t){if(e.sol()&&t.mode!==O.commentTilEnd&&t.mode!==O.multilineComment&&t.mode!==O.unclosedString&&(t.mode=O.SOL,t.prevToken="SOL"),t.mode===O.unclosedString)return e.eat("\\")?m(t,"error-SOLBackslashInString"):a(e,t);if(t.mode===O.SOL){if(e.eatSpace())return t.mode=O.afterSpace,null;if(e.eat("/"))return i=t,(n=e).eol()||n.match(I)?(n.eatSpace(),i.mode=O.multilineComment,m(i,"error-multilineComment")):r(n,i);if(!t.qukeMixed&&0<t.depth&&")"!==e.peek()&&"]"!==e.peek()&&"}"!==e.peek())return e.next(),m(t,"error-unindentedToken");if(e.match(L,!1,!1))return n=t,e.skipToEnd(),m(n,"command");if(e.match(k,!1,!1))return l(e,t);if(e.eat(";"))return t.mode=O.afterPunctuation,null;if(e.eat("\\"))return c(e,t);if(e.eat("`"))return s(e,t);if(e.eat("."))return d(e,t);if(e.eat('"'))return a(e,t);if(e.eat("'"))return u(e,t);if(e.eat("-"))return o(e,t);if(e.match(w,!0,!1))return t.mode=O.afterPunctuation,m(t,"error");if(e.eat(y))return t.mode=O.afterPunctuation,m(t,"keyword");if(e.eat(f))return h(t);if(e.eat(v))return p(t),m(t,"error-unindentedToken");if(e.match(C,!0,!1))return t.mode=O.afterPunctuation,m(t,"keyword");if(e.match(R,!0,!1))return t.mode=O.afterVarNumSym,m(t,"number")}else if(t.mode===O.afterSpace){if(e.eatSpace(),e.match(k,!1,!1))return l(e,t);if(e.eat(";"))return t.mode=O.afterPunctuation,null;if(e.eat("/"))return r(e,t);if(e.eat("`"))return s(e,t);if(e.eat("."))return d(e,t);if(e.eat('"'))return a(e,t);if("\\"===e.peek()&&"SOL"===t.prevToken)return e.next(),m(t,"error-indentedCommand");if(e.eat(/['\\]/))return u(e,t);if(e.eat("-"))return o(e,t);if(e.match(w,!0,!1))return t.mode=O.afterPunctuation,m(t,"error");if(e.eat(y))return t.mode=O.afterPunctuation,m(t,"keyword");if(e.eat(f))return h(t);if(e.eat(v))return p(t);if(e.match(C,!0,!1))return t.mode=O.afterPunctuation,m(t,"keyword");if(e.match(R,!0,!1))return t.mode=O.afterVarNumSym,m(t,"number")}else if(t.mode===O.afterVarNumSym){if(e.eatSpace())return t.mode=O.afterSpace,null;if(e.eat(";"))return t.mode=O.afterPunctuation,null;if(e.eat("`"))return s(e,t);if(e.eat('"'))return a(e,t);if(e.eat(/['/\\]/))return u(e,t);if(e.match(w,!0,!1))return t.mode=O.afterPunctuation,m(t,"error");if(e.eat(y))return t.mode=O.afterPunctuation,m(t,"keyword");if(e.eat(f))return h(t);if(e.eat(v))return p(t);if(e.match(/^[Tz]/))return t.mode=O.afterPunctuation,m(t,"error-datetime")}else if(t.mode===O.afterPunctuation||t.mode===O.afterOpenBracket||t.mode===O.afterCloseBracket){if(e.eatSpace())return t.mode=O.afterSpace,null;if(e.match(k,!1,!1))return l(e,t);if(e.eat(";"))return t.mode=O.afterPunctuation,null;if(e.eat("`"))return s(e,t);if(e.eat("."))return d(e,t);if(e.eat('"'))return a(e,t);if(e.eat(/['/\\]/))return u(e,t);if(e.eat("-"))return o(e,t);if(e.match(w,!0,!1))return t.mode=O.afterPunctuation,m(t,"error");if(e.eat(y))return t.mode=O.afterPunctuation,m(t,"keyword");if(e.eat(f))return h(t);if(e.eat(v))return p(t);if(e.match(C,!0,!1))return t.mode=O.afterPunctuation,m(t,"keyword");if(e.match(R,!0,!1))return t.mode=O.afterVarNumSym,m(t,"number")}else{if(t.mode===O.commentTilEnd)return e.skipToEnd(),m(t,"comment");if(t.mode===O.multilineComment)return i=t,(t=e).eat("\\")&&(t.eol()||t.match(I))?(t.eatSpace(),i.mode=O.SOL):t.skipToEnd(),m(i,"error-multilineComment")}var n,i;return e.next()}}},tokenizer=tokenFunction({},{name:"q",isSpreadsheet:"false"}),MonacoHelpers=(_R.DEFAULT_OPTIONS=function(){return{automaticLayout:!0,theme:"kx-light"!==$.cookie("dashboard-theme")?"vs-dark":"vs",contextmenu:!0,autoIndent:!0,fixedOverflowWidgets:!0,fontSize:12,lineDecorationsWidth:0,lineNumbersMinChars:2,minimap:{enabled:!1},scrollBeyondLastLine:!1,wordWrap:"on",dragAndDrop:!1}},_R.adjustAfterResize=function(e){e&&e._domElement&&e.updateOptions({minimap:{enabled:800<e._domElement.clientWidth}})},_R.require=function(e,i){var t=e.language;require(_R.MONACO_PATH,function(n){switch(t){case"handlebars":_R.registerHandlebarFormatting(function(){_R.registerHandlebarIntellisense(function(e){var t=e.docs,e=e.disposable;i({monaco:n,docs:t,disposable:e})})});break;case"javascript":_R.registerLodashIntellisense(function(e){i({monaco:n,unload:e})});break;case"q":_R.registerQLanguage(),_R.fetchAutoCompleteItems(function(e){i({monaco:n,autocompleteItems:e})});break;default:i({monaco:n})}})},_R.fetchAutoCompleteItems=function(t){$.ajax(requirejs.toUrl("vendor/types/q.json")).then(function(e){e=e.autocompleteItems;t(e)})},_R.registerHandlebarFormatting=function(e){require(["polyfill"],function(){require(["beautify-html"],function(n){monaco.languages.registerDocumentFormattingEditProvider("handlebars",{provideDocumentFormattingEdits:function(e){var t=e.getValue(),t=n.html_beautify(t);return[{range:e.getFullModelRange(),text:t}]}}),e()})})},_R.registerLodashIntellisense=function(t){monaco.languages.typescript.javascriptDefaults.setCompilerOptions({target:monaco.languages.typescript.ScriptTarget.ES5,allowNonTsExtensions:!0}),$.ajax(requirejs.toUrl("vendor/types/lodash.d.ts")).then(function(e){t(monaco.languages.typescript.javascriptDefaults.addExtraLib(e))})},_R.registerHandlebarIntellisense=function(t){$.ajax(requirejs.toUrl("vendor/types/handlebarhelpersdocs.json")).then(function(o){var e=monaco.languages.registerHoverProvider("handlebars",{provideHover:function(e,t){var n=t.lineNumber,t=t.column,e=e.getLineContent(n),n={lineNumber:n,column:t},t=n.lineNumber,i=n.column;if((n=function(e){var t=0,n=[];while(true){var i=e.substring(t);var o=i.indexOf("{{");if(t>e.length||o<0)break;var a=i.indexOf("}}");n.push([o+t,a+t]);t=a+t+2}return n}(e).find(function(e){return i>=e[0]&&i<=e[1]}))&&e.match(/{{#?([A-Za-z]+)/))return e=e.match(/{{#?([A-Za-z]+)/)[1],{range:{startLineNumber:t,startColumn:n[0]+1,endColumn:n[1]+3,endLineNumber:t},contents:o[e]?[{value:o[e].comment.replace(/(\/\*\*|\*\/|\*)/g,"").replace(/\n/g,"  \n").replace(/(```handlebars|```)/g,"`")}]:[]}}});t({docs:o,disposable:e})})},_R.getScopeFromStyle=function(e){switch(e){case null:return"default";case"error-multilineComment":return"comment.block";case"symbol":return"symbol";case"error-unindentedToken":return"invalid";default:return e}},_R.registerQLanguage=function(){monaco.languages.register({id:"q"}),monaco.editor.defineTheme("q-theme",{base:"vs-dark",inherit:!0,rules:[{background:"#161616",foreground:"#aaaaaa"},{token:"number",background:"#ce3595",foreground:"#ce3595"},{token:"keyword",background:"#161616",foreground:"#bd9c39"},{token:"string",background:"#161616",foreground:"#78abd2"},{token:"variable",background:"#161616",foreground:"#bdbdbd"},{token:"symbol",background:"#161616",foreground:"#8e7bbb"}],colors:{"editor.background":"#161616","editorLineNumber.foreground":"#8d8d8d"}}),monaco.editor.defineTheme("q-theme-light",{base:"vs",inherit:!0,rules:[{background:"#ffffff",foreground:"#09026f"},{token:"number",background:"#ffffff",foreground:"#0000ef"},{token:"keyword",background:"#ffffff",foreground:"#996900"},{token:"comment",background:"#ffffff",foreground:"#109900"},{token:"string",background:"#ffffff",foreground:"#006b99"},{token:"variable",background:"#ffffff",foreground:"#09026f"},{token:"symbol",background:"#ffffff",foreground:"#845df4"}],colors:{"editor.background":"#ffffff","editorLineNumber.foreground":"#09026f"}}),monaco.languages.setTokensProvider("q",{getInitialState:function(){return tokenizer.startState()},tokenize:function(e,t){for(var n=new StringStream(e),i=[];!n.eol();){var o=tokenizer.token(n,t);i.push({scopes:_R.getScopeFromStyle(o),startIndex:n.start}),n.start=n.pos}return{endState:t,tokens:i}}}),monaco.languages.setLanguageConfiguration("q",{brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[],indentationRules:{decreaseIndentPattern:void 0,increaseIndentPattern:/[{(\[]/},onEnterRules:[{beforeText:/^[^\[]*[})\]]/,action:{indentAction:3}}]})},_R.MONACO_PATH=["vs/editor/editor.main"],_R);function _R(){}Handlebars.registerHelper("type-cast",function(e,t){return e.toLowerCase()});var DataParameter=($S=Backbone.View,__extends(_S,$S),_S.prototype.addParam=function(e,t,n,i,o,a,s){var l=this,e=new Backbone.Model({id:_.uniqueId("param_"),name:e,type:t,value:n,required:i,description:o,editable:!0,isViewState:s}),t=(this.listenTo(e,"change",this.updateValue),new _S(e,this.dataModel,this.docViewModel,this.vsCallback));this.listenTo(t,"paramRemoved",this.onParamRemoved),this.listenTo(t,"ValueChanged",function(){return l.updateValue()}),t.$el.appendTo(this.$listItems),this.parameters.push(t),a||this.updateValue()},_S.prototype.initializeEvents=function(){var e=this;this.listenTo(this.model,"change:type",this.onTypeChanged),this.listenTo(this.model,"change:name",function(){e.updateValue()}),this.$viewStateApply.on("click",this.showViewStateDialog.bind(this)),this.$viewStateDisplay.on("click",this.showViewStateDialog.bind(this)),this.$viewStateClear.on("click",this.onViewStateClear.bind(this)),this.$generateValue.on("click",this.generateViewState.bind(this)),this.$typeSelect.on("change",this.onTypeChange.bind(this)),this.$nameInput.on("change",this.onNameChange.bind(this))},_S.prototype.applyControlState=function(){this.model.get("isViewState")?this.$form.addClass("is-bound"):this.$form.removeClass("is-bound")},_S.prototype.disableListEditing=function(){this.$buttonRow.hide(),this.$listItems.hide()},_S.prototype.enableListEditing=function(){"dict"===this.model.get("type")&&(this.$buttonRow.show(),this.$listItems.show())},_S.prototype.getPath=function(){var e=this.dataModel.path;return e.substring(e.lastIndexOf("/")+1)+"/"+this.model.get("name")},_S.prototype.getInputValue=function(){var e=this.valueInput.getValue()||"";return _.isString(e)?e.replace("&lt;","<").replace("&gt;",">"):e},_S.prototype.generateViewState=function(){var n,i=this,o=this.docViewModel,a=(this.viewStateName=this.getPath(),this.viewStateName.split("/")||[]);return a.forEach(function(e,t){t===a.length-1?(o.has(e)||(n=new QuickBase.DocumentViewModel({_viewType:!0,_type:i.model.get("type").toLowerCase(),_default:i.model.get("value"),value:i.model.get("value")},{root:o,path:i.viewStateName},null),o.set(e,n)),i.selectGeneratedViewState(i.viewStateName)):(o.has(e)||(t=new QuickBase.DocumentViewModel({},null,null),o.set(e,t)),o=o.getByPath(e))}),n},_S.prototype.onAddItemClicked=function(){this.addParam("parameter0","symbol","",!1,"")},_S.prototype.onNameChange=function(){var e=this.$nameInput.val();this.model.set({name:e})},_S.prototype.onParamRemoved=function(e){this.parameters=_.without(this.parameters,e),this.updateValue()},_S.prototype.onRemoveClick=function(){this.trigger("paramRemoved",this),this.remove()},_S.prototype.onSelectViewState=function(e){var t=this.docViewModel.getByPath(e);t?t&&t.has("_type")&&(this.model.set("type",t.get("_type")),this.model.set("isViewState",!0),this.model.set("value","<%"+e+"%>"),this.$viewStateInput.val(e),this.$viewStateDisplay.val(e),this.applyControlState(),this.disableListEditing(),this.trigger("ValueChanged")):this.onViewStateClear()},_S.prototype.onTypeChange=function(){var e=this.$typeSelect.val();"dict"===e?this.model.set({value:{},type:e}):this.model.set({type:e})},_S.prototype.onTypeChanged=function(){var e,t,n=this.model.get("type"),i=this;_.each(this.parameters,function(e){e.remove()}),this.parameters=[],this.$el.attr("data-type",n),this.$typeSelect.val(n).trigger("change"),"dict"===n?(this.enableListEditing(),this.removeValueInput(),"string"==typeof(n=i.model.get("value")||this.originalValue)?(e=n.split(""),_.each(e,function(e){6==(t=e.split("")).length&&i.addParam(t[0],t[1],t[2],t[3],t[4])})):"object"==typeof n&&_.each(n,function(t,e){try{i.addParam(t.name,t.type,t.value,!1,"",void 0,"dict"!==t.type&&0===t.value.indexOf("<%"))}catch(e){console.error("Param error ",t)}})):(this.disableListEditing(),this.renderInput()),this.trigger("ValueChanged")},_S.prototype.onViewStateClear=function(){this.model.set("isViewState",!1),this.model.set("value",null),this.$viewStateInput.val(""),this.applyControlState(),this.$generateValue.removeClass("disabled"),this.enableListEditing(),this.trigger("ValueChanged")},_S.prototype.onValueInput=function(){this.model.set({value:this.getInputValue(),isViewState:!1}),this.trigger("ValueChanged")},_S.prototype.remove=function(){return _.each(this.parameters,function(e){e.remove()}),this.parameters=[],Backbone.View.prototype.remove.apply(this)},_S.prototype.removeValueInput=function(){this.valueInput&&(this.stopListening(this.valueInput),this.valueInput.remove(),this.valueInput=null)},_S.prototype.renderInput=function(){var e,t,n=this;this.removeValueInput(),this.$valueInput.empty(),(t=this.model.get("type"))&&(t=BBForm.RTTI.getByName(t),e=BBForm.editors[t.editor.type],this.valueInput=new e({id:_.uniqueId("valueInput_"),key:"value",model:this.model,schema:{editorClass:"data-parameter-editor",options:t.editor.options,validators:t.editor.validators}}).render(),this.$valueInput.append(this.valueInput.el),this.model.get("isViewState")||this.model.get("value")===this.getInputValue()||this.onValueInput()),this.listenTo(this.valueInput,"change changeList",function(){var e=n.valueInput.validate();e?n.setError(e.message):(n.setError(null),n.onValueInput())})},_S.prototype.sayNoToSubmit=function(){return!1},_S.prototype.selectGeneratedViewState=function(e){this.onSelectViewState(e),this.$generateValue.addClass("disabled")},_S.prototype.setError=function(e){e&&this.valueInput?(this.valueInput.$el.addClass("error"),this.$errorTooltip&&BBForm.ErrorTooltip.clear(this.$errorTooltip),this.$errorTooltip=BBForm.ErrorTooltip.show(e,this.$valueInput)):(this.valueInput.$el.removeClass("error"),BBForm.ErrorTooltip.clear(this.$errorTooltip))},_S.prototype.showViewStateDialog=function(){var t=this;this.vsCallback({beforeClose:function(){},close:function(){},cancelCallback:function(e){},path:this.$viewStateInput.val(),selectCallback:function(e){return t.onSelectViewState(e)}})},_S.prototype.updateValue=function(){var t;"dict"===this.model.get("type")&&(t={},_.each(this.parameters,function(e){t[e.model.get("name")]={type:e.model.get("type"),IsKdbParam:!0,isViewState:e.model.get("isViewState"),name:e.model.get("name"),value:e.model.get("value")}}),this.model.set({value:t})),this.trigger("ValueChanged")},_S),$S;function _S(e,t,n,i,o){var a=$S.call(this,{className:"data-parameter",model:e})||this;return a.parameters=[],a.viewStateName="",a.originalValue=a.model.get("value"),a.model.set({type:a.model.get("type").toLowerCase()},{silent:!0}),a.model=e,a.docViewModel=n,a.dataModel=t,a.vsCallback=i,a.$el.html(T.DataParameter(a.model.toJSON())),a.$form=a.$(".form-control"),a.$viewStateApply=a.$(".viewstate-apply"),a.$viewStateClear=a.$(".binding-clear"),a.$viewStateContainer=a.$(".binding-container"),a.$viewStateInput=a.$("input:not(.name-input)").attr("type","text"),a.$viewStateDisplay=a.$(".value-display"),a.$valueInput=a.$(".value-input"),a.$generateValue=a.$(".generate-value"),a.$typeSelect=a.$(".type-select"),a.$typeSelect.val(a.model.get("type")),a.$addItemBtn=a.$(".add-item-btn"),a.$listItems=a.$(".list-items"),a.$buttonRow=a.$(".button-row"),a.$nameInput=a.$(".name-input"),a.$removeItemBtn=a.$(".remove-item-btn"),a.$addItemBtn.button({icons:{primary:"fa fa-plus"},text:!1}).click($.proxy(a.onAddItemClicked,a)),0<a.$removeItemBtn.length&&a.$removeItemBtn.button({icons:{primary:"fa fa-minus"},text:!1}).click($.proxy(a.onRemoveClick,a)),o&&o.length&&a.$typeSelect.find("option").filter(function(e,t){return!_.includes(o,t.text)}).remove(),a.$typeSelect.select2({theme:"dashboards",width:"100%"}),a.$typeSelect.on("select2:open",function(){$("body > .select2-container--dashboards.select2-container--open").addClass("select2--environment")}),a.model.get("isViewState")&&a.model.get("value")?a.onSelectViewState(a.model.get("value").split("%")[1]):"dict"!==a.model.get("type")&&a.valueInput&&a.valueInput.setValue(a.model.get("value")),a.onTypeChanged(),_.defer(function(){a.viewStateName=a.getPath(),a.initializeEvents()}),a}var KdbTableCompletionProvider=(hU.prototype.provideCompletionItems=function(e,t,n,i){if(t.column<=1)return{suggestions:[]};try{var o=e.getLineContent(t.lineNumber).substring(0,t.column),a=o.lastIndexOf(" "),s=o.substring(a).trim(),l=new RegExp(_.escapeRegExp(s));return{suggestions:this.possibleTokens.filter(function(e){return!(t.column<=1)&&e.match(l)}).map(function(e){return{label:e,insertText:e,kind:monaco.languages.CompletionItemKind.Variable,range:{startLineNumber:t.lineNumber,startColumn:t.column-s.length,endLineNumber:t.lineNumber,endColumn:t.column+e.length-s.length}}})}}catch(e){return{suggestions:[]}}},hU);function hU(e){this.possibleTokens=e}var KdbFunctionCompletionProvider=(vU.prototype.provideCompletionItems=function(e,t,n,i){if(t.column<=1)return{suggestions:[]};try{var o=e.getLineContent(t.lineNumber).substring(0,t.column),a=o.lastIndexOf(" "),s=o.substring(a).trim(),l=new RegExp(_.escapeRegExp(o.substring(a).trim()));return{suggestions:this.possibleFns.filter(function(e){return!(t.column<=1)&&e.label.match(l)}).map(function(e){return{label:e.label,detail:e.detail,insertText:e.insertText,kind:monaco.languages.CompletionItemKind.Function,range:{startLineNumber:t.lineNumber,startColumn:t.column-s.length,endLineNumber:t.lineNumber,endColumn:t.column+e.insertText.length-s.length}}})}}catch(e){return{suggestions:[]}}},vU);function vU(e){this.possibleFns=e}var AutoCompleteParams=(JU.sqlBuiltInFunctions=["AVG","CHECKSUM_AGG","COUNT","COUNT_BIG","GROUPING","GROUPING_ID","MAX","MIN","SUM","STDEV","STDEVP","VAR","VARP","CUME_DIST","FIRST_VALUE","LAG","LAST_VALUE","LEAD","PERCENTILE_CONT","PERCENTILE_DISC","PERCENT_RANK","COLLATE","COLLATIONPROPERTY","TERTIARY_WEIGHTS","FEDERATION_FILTERING_VALUE","CAST","CONVERT","PARSE","TRY_CAST","TRY_CONVERT","TRY_PARSE","ASYMKEY_ID","ASYMKEYPROPERTY","CERTPROPERTY","CERT_ID","CRYPT_GEN_RANDOM","DECRYPTBYASYMKEY","DECRYPTBYCERT","DECRYPTBYKEY","DECRYPTBYKEYAUTOASYMKEY","DECRYPTBYKEYAUTOCERT","DECRYPTBYPASSPHRASE","ENCRYPTBYASYMKEY","ENCRYPTBYCERT","ENCRYPTBYKEY","ENCRYPTBYPASSPHRASE","HASHBYTES","IS_OBJECTSIGNED","KEY_GUID","KEY_ID","KEY_NAME","SIGNBYASYMKEY","SIGNBYCERT","SYMKEYPROPERTY","VERIFYSIGNEDBYCERT","VERIFYSIGNEDBYASYMKEY","CURSOR_STATUS","DATALENGTH","IDENT_CURRENT","IDENT_INCR","IDENT_SEED","IDENTITY","SQL_VARIANT_PROPERTY","CURRENT_TIMESTAMP","DATEADD","DATEDIFF","DATEFROMPARTS","DATENAME","DATEPART","DATETIME2FROMPARTS","DATETIMEFROMPARTS","DATETIMEOFFSETFROMPARTS","DAY","EOMONTH","GETDATE","GETUTCDATE","ISDATE","MONTH","SMALLDATETIMEFROMPARTS","SWITCHOFFSET","SYSDATETIME","SYSDATETIMEOFFSET","SYSUTCDATETIME","TIMEFROMPARTS","TODATETIMEOFFSET","YEAR","CHOOSE","COALESCE","IIF","NULLIF","ABS","ACOS","ASIN","ATAN","ATN2","CEILING","COS","COT","DEGREES","EXP","FLOOR","LOG","LOG10","PI","POWER","RADIANS","RAND","ROUND","SIGN","SIN","SQRT","SQUARE","TAN","APP_NAME","APPLOCK_MODE","APPLOCK_TEST","ASSEMBLYPROPERTY","COL_LENGTH","COL_NAME","COLUMNPROPERTY","DATABASE_PRINCIPAL_ID","DATABASEPROPERTYEX","DB_ID","DB_NAME","FILE_ID","FILE_IDEX","FILE_NAME","FILEGROUP_ID","FILEGROUP_NAME","FILEGROUPPROPERTY","FILEPROPERTY","FULLTEXTCATALOGPROPERTY","FULLTEXTSERVICEPROPERTY","INDEX_COL","INDEXKEY_PROPERTY","INDEXPROPERTY","OBJECT_DEFINITION","OBJECT_ID","OBJECT_NAME","OBJECT_SCHEMA_NAME","OBJECTPROPERTY","OBJECTPROPERTYEX","ORIGINAL_DB_NAME","PARSENAME","SCHEMA_ID","SCHEMA_NAME","SCOPE_IDENTITY","SERVERPROPERTY","STATS_DATE","TYPE_ID","TYPE_NAME","TYPEPROPERTY","DENSE_RANK","NTILE","RANK","ROW_NUMBER","PUBLISHINGSERVERNAME","OPENDATASOURCE","OPENQUERY","OPENROWSET","OPENXML","CERTENCODED","CERTPRIVATEKEY","CURRENT_USER","HAS_DBACCESS","HAS_PERMS_BY_NAME","IS_MEMBER","IS_ROLEMEMBER","IS_SRVROLEMEMBER","LOGINPROPERTY","ORIGINAL_LOGIN","PERMISSIONS","PWDENCRYPT","PWDCOMPARE","SESSION_USER","SESSIONPROPERTY","SUSER_ID","SUSER_NAME","SUSER_SID","SUSER_SNAME","SYSTEM_USER","USER","USER_ID","USER_NAME","ASCII","CHAR","CHARINDEX","CONCAT","DIFFERENCE","FORMAT","LEFT","LEN","LOWER","LTRIM","NCHAR","PATINDEX","QUOTENAME","REPLACE","REPLICATE","REVERSE","RIGHT","RTRIM","SOUNDEX","SPACE","STR","STUFF","SUBSTRING","UNICODE","UPPER","BINARY_CHECKSUM","CHECKSUM","CONNECTIONPROPERTY","CONTEXT_INFO","CURRENT_REQUEST_ID","ERROR_LINE","ERROR_NUMBER","ERROR_MESSAGE","ERROR_PROCEDURE","ERROR_SEVERITY","ERROR_STATE","FORMATMESSAGE","GETANSINULL","GET_FILESTREAM_TRANSACTION_CONTEXT","HOST_ID","HOST_NAME","ISNULL","ISNUMERIC","MIN_ACTIVE_ROWVERSION","NEWID","NEWSEQUENTIALID","ROWCOUNT_BIG","XACT_STATE","TEXTPTR","TEXTVALID","COLUMNS_UPDATED","EVENTDATA","TRIGGER_NESTLEVEL","UPDATE","CHANGETABLE","CHANGE_TRACKING_CONTEXT","CHANGE_TRACKING_CURRENT_VERSION","CHANGE_TRACKING_IS_COLUMN_IN_MASK","CHANGE_TRACKING_MIN_VALID_VERSION","CONTAINSTABLE","FREETEXTTABLE","SEMANTICKEYPHRASETABLE","SEMANTICSIMILARITYDETAILSTABLE","SEMANTICSIMILARITYTABLE","FILETABLEROOTPATH","GETFILENAMESPACEPATH","GETPATHLOCATOR","PATHNAME","GET_TRANSMISSION_STATUS"],JU.sqlOperators=["ALL","AND","ANY","BETWEEN","EXISTS","IN","LIKE","NOT","OR","SOME","EXCEPT","INTERSECT","UNION","APPLY","CROSS","FULL","INNER","JOIN","LEFT","OUTER","RIGHT","CONTAINS","FREETEXT","IS","NULL","PIVOT","UNPIVOT","MATCHED"],JU.sqlKeywords=["ABORT_AFTER_WAIT","ABSENT","ABSOLUTE","ACCENT_SENSITIVITY","ACTION","ACTIVATION","ACTIVE","ADD","ADDRESS","ADMIN","AES","AES_128","AES_192","AES_256","AFFINITY","AFTER","AGGREGATE","ALGORITHM","ALL_CONSTRAINTS","ALL_ERRORMSGS","ALL_INDEXES","ALL_LEVELS","ALL_SPARSE_COLUMNS","ALLOW_CONNECTIONS","ALLOW_MULTIPLE_EVENT_LOSS","ALLOW_PAGE_LOCKS","ALLOW_ROW_LOCKS","ALLOW_SINGLE_EVENT_LOSS","ALLOW_SNAPSHOT_ISOLATION","ALLOWED","ALTER","ANONYMOUS","ANSI_DEFAULTS","ANSI_NULL_DEFAULT","ANSI_NULL_DFLT_OFF","ANSI_NULL_DFLT_ON","ANSI_NULLS","ANSI_PADDING","ANSI_WARNINGS","APPEND","APPLICATION","APPLICATION_LOG","ARITHABORT","ARITHIGNORE","AS","ASC","ASSEMBLY","ASYMMETRIC","ASYNCHRONOUS_COMMIT","AT","ATOMIC","ATTACH","ATTACH_REBUILD_LOG","AUDIT","AUDIT_GUID","AUTHENTICATION","AUTHORIZATION","AUTO","AUTO_CLEANUP","AUTO_CLOSE","AUTO_CREATE_STATISTICS","AUTO_SHRINK","AUTO_UPDATE_STATISTICS","AUTO_UPDATE_STATISTICS_ASYNC","AUTOMATED_BACKUP_PREFERENCE","AUTOMATIC","AVAILABILITY","AVAILABILITY_MODE","BACKUP","BACKUP_PRIORITY","BASE64","BATCHSIZE","BEGIN","BEGIN_DIALOG","BIGINT","BINARY","BINDING","BIT","BLOCKERS","BLOCKSIZE","BOUNDING_BOX","BREAK","BROKER","BROKER_INSTANCE","BROWSE","BUCKET_COUNT","BUFFER","BUFFERCOUNT","BULK","BULK_LOGGED","BY","CACHE","CALL","CALLED","CALLER","CAP_CPU_PERCENT","CASCADE","CASE","CATALOG","CATCH","CELLS_PER_OBJECT","CERTIFICATE","CHANGE_RETENTION","CHANGE_TRACKING","CHANGES","CHAR","CHARACTER","CHECK","CHECK_CONSTRAINTS","CHECK_EXPIRATION","CHECK_POLICY","CHECKALLOC","CHECKCATALOG","CHECKCONSTRAINTS","CHECKDB","CHECKFILEGROUP","CHECKIDENT","CHECKPOINT","CHECKTABLE","CLASSIFIER_FUNCTION","CLEANTABLE","CLEANUP","CLEAR","CLOSE","CLUSTER","CLUSTERED","CODEPAGE","COLLATE","COLLECTION","COLUMN","COLUMN_SET","COLUMNS","COLUMNSTORE","COLUMNSTORE_ARCHIVE","COMMIT","COMMITTED","COMPATIBILITY_LEVEL","COMPRESSION","COMPUTE","CONCAT","CONCAT_NULL_YIELDS_NULL","CONFIGURATION","CONNECT","CONSTRAINT","CONTAINMENT","CONTENT","CONTEXT","CONTINUE","CONTINUE_AFTER_ERROR","CONTRACT","CONTRACT_NAME","CONTROL","CONVERSATION","COOKIE","COPY_ONLY","COUNTER","CPU","CREATE","CREATE_NEW","CREATION_DISPOSITION","CREDENTIAL","CRYPTOGRAPHIC","CUBE","CURRENT","CURRENT_DATE","CURSOR","CURSOR_CLOSE_ON_COMMIT","CURSOR_DEFAULT","CYCLE","DATA","DATA_COMPRESSION","DATA_PURITY","DATABASE","DATABASE_DEFAULT","DATABASE_MIRRORING","DATABASE_SNAPSHOT","DATAFILETYPE","DATE","DATE_CORRELATION_OPTIMIZATION","DATEFIRST","DATEFORMAT","DATETIME","DATETIME2","DATETIMEOFFSET","DAY","DAYOFYEAR","DAYS","DB_CHAINING","DBCC","DBREINDEX","DDL_DATABASE_LEVEL_EVENTS","DEADLOCK_PRIORITY","DEALLOCATE","DEC","DECIMAL","DECLARE","DECRYPTION","DEFAULT","DEFAULT_DATABASE","DEFAULT_FULLTEXT_LANGUAGE","DEFAULT_LANGUAGE","DEFAULT_SCHEMA","DEFINITION","DELAY","DELAYED_DURABILITY","DELETE","DELETED","DENSITY_VECTOR","DENY","DEPENDENTS","DES","DESC","DESCRIPTION","DESX","DHCP","DIAGNOSTICS","DIALOG","DIFFERENTIAL","DIRECTORY_NAME","DISABLE","DISABLE_BROKER","DISABLED","DISK","DISTINCT","DISTRIBUTED","DOCUMENT","DOUBLE","DROP","DROP_EXISTING","DROPCLEANBUFFERS","DUMP","DURABILITY","DYNAMIC","EDITION","ELEMENTS","ELSE","EMERGENCY","EMPTY","EMPTYFILE","ENABLE","ENABLE_BROKER","ENABLED","ENCRYPTION","END","ENDPOINT","ENDPOINT_URL","ERRLVL","ERROR","ERROR_BROKER_CONVERSATIONS","ERRORFILE","ESCAPE","ESTIMATEONLY","EVENT","EVENT_RETENTION_MODE","EXEC","EXECUTABLE","EXECUTE","EXIT","EXPAND","EXPIREDATE","EXPIRY_DATE","EXPLICIT","EXTENDED_LOGICAL_CHECKS","EXTENSION","EXTERNAL","EXTERNAL_ACCESS","FAIL_OPERATION","FAILOVER","FAILOVER_MODE","FAILURE_CONDITION_LEVEL","FALSE","FAN_IN","FAST","FAST_FORWARD","FETCH","FIELDTERMINATOR","FILE","FILEGROUP","FILEGROWTH","FILELISTONLY","FILENAME","FILEPATH","FILESTREAM","FILESTREAM_ON","FILETABLE_COLLATE_FILENAME","FILETABLE_DIRECTORY","FILETABLE_FULLPATH_UNIQUE_CONSTRAINT_NAME","FILETABLE_NAMESPACE","FILETABLE_PRIMARY_KEY_CONSTRAINT_NAME","FILETABLE_STREAMID_UNIQUE_CONSTRAINT_NAME","FILLFACTOR","FILTERING","FIRE_TRIGGERS","FIRST","FIRSTROW","FLOAT","FMTONLY","FOLLOWING","FOR","FORCE","FORCE_FAILOVER_ALLOW_DATA_LOSS","FORCE_SERVICE_ALLOW_DATA_LOSS","FORCED","FORCEPLAN","FORCESCAN","FORCESEEK","FOREIGN","FORMATFILE","FORMSOF","FORWARD_ONLY","FREE","FREEPROCCACHE","FREESESSIONCACHE","FREESYSTEMCACHE","FROM","FULL","FULLSCAN","FULLTEXT","FUNCTION","GB","GEOGRAPHY_AUTO_GRID","GEOGRAPHY_GRID","GEOMETRY_AUTO_GRID","GEOMETRY_GRID","GET","GLOBAL","GO","GOTO","GOVERNOR","GRANT","GRIDS","GROUP","GROUP_MAX_REQUESTS","HADR","HASH","HASHED","HAVING","HEADERONLY","HEALTH_CHECK_TIMEOUT","HELP","HIERARCHYID","HIGH","HINT","HISTOGRAM","HOLDLOCK","HONOR_BROKER_PRIORITY","HOUR","HOURS","IDENTITY","IDENTITY_INSERT","IDENTITY_VALUE","IDENTITYCOL","IF","IGNORE_CONSTRAINTS","IGNORE_DUP_KEY","IGNORE_NONCLUSTERED_COLUMNSTORE_INDEX","IGNORE_TRIGGERS","IMAGE","IMMEDIATE","IMPERSONATE","IMPLICIT_TRANSACTIONS","IMPORTANCE","INCLUDE","INCREMENT","INCREMENTAL","INDEX","INDEXDEFRAG","INFINITE","INFLECTIONAL","INIT","INITIATOR","INPUT","INPUTBUFFER","INSENSITIVE","INSERT","INSERTED","INSTEAD","INT","INTEGER","INTO","IO","IP","ISABOUT","ISOLATION","JOB","KB","KEEP","KEEP_CDC","KEEP_NULLS","KEEP_REPLICATION","KEEPDEFAULTS","KEEPFIXED","KEEPIDENTITY","KEEPNULLS","KERBEROS","KEY","KEY_SOURCE","KEYS","KEYSET","KILL","KILOBYTES_PER_BATCH","LABELONLY","LANGUAGE","LAST","LASTROW","LEVEL","LEVEL_1","LEVEL_2","LEVEL_3","LEVEL_4","LIFETIME","LIMIT","LINENO","LIST","LISTENER","LISTENER_IP","LISTENER_PORT","LOAD","LOADHISTORY","LOB_COMPACTION","LOCAL","LOCAL_SERVICE_NAME","LOCK_ESCALATION","LOCK_TIMEOUT","LOGIN","LOGSPACE","LOOP","LOW","MANUAL","MARK","MARK_IN_USE_FOR_REMOVAL","MASTER","MAX_CPU_PERCENT","MAX_DISPATCH_LATENCY","MAX_DOP","MAX_DURATION","MAX_EVENT_SIZE","MAX_FILES","MAX_IOPS_PER_VOLUME","MAX_MEMORY","MAX_MEMORY_PERCENT","MAX_QUEUE_READERS","MAX_ROLLOVER_FILES","MAX_SIZE","MAXDOP","MAXERRORS","MAXLENGTH","MAXRECURSION","MAXSIZE","MAXTRANSFERSIZE","MAXVALUE","MB","MEDIADESCRIPTION","MEDIANAME","MEDIAPASSWORD","MEDIUM","MEMBER","MEMORY_OPTIMIZED","MEMORY_OPTIMIZED_DATA","MEMORY_OPTIMIZED_ELEVATE_TO_SNAPSHOT","MEMORY_PARTITION_MODE","MERGE","MESSAGE","MESSAGE_FORWARD_SIZE","MESSAGE_FORWARDING","MICROSECOND","MILLISECOND","MIN_CPU_PERCENT","MIN_IOPS_PER_VOLUME","MIN_MEMORY_PERCENT","MINUTE","MINUTES","MINVALUE","MIRROR","MIRROR_ADDRESS","MODIFY","MONEY","MONTH","MOVE","MULTI_USER","MUST_CHANGE","NAME","NANOSECOND","NATIONAL","NATIVE_COMPILATION","NCHAR","NEGOTIATE","NESTED_TRIGGERS","NEW_ACCOUNT","NEW_BROKER","NEW_PASSWORD","NEWNAME","NEXT","NO","NO_BROWSETABLE","NO_CHECKSUM","NO_COMPRESSION","NO_EVENT_LOSS","NO_INFOMSGS","NO_TRUNCATE","NO_WAIT","NOCHECK","NOCOUNT","NOEXEC","NOEXPAND","NOFORMAT","NOINDEX","NOINIT","NOLOCK","NON","NON_TRANSACTED_ACCESS","NONCLUSTERED","NONE","NORECOMPUTE","NORECOVERY","NORESEED","NORESET","NOREWIND","NORMAL","NOSKIP","NOTIFICATION","NOTRUNCATE","NOUNLOAD","NOWAIT","NTEXT","NTLM","NUMANODE","NUMERIC","NUMERIC_ROUNDABORT","NVARCHAR","OBJECT","OF","OFF","OFFLINE","OFFSET","OFFSETS","OLD_ACCOUNT","OLD_PASSWORD","ON","ON_FAILURE","ONLINE","ONLY","OPEN","OPEN_EXISTING","OPENTRAN","OPTIMISTIC","OPTIMIZE","OPTION","ORDER","OUT","OUTPUT","OUTPUTBUFFER","OVER","OVERRIDE","OWNER","OWNERSHIP","PAD_INDEX","PAGE","PAGE_VERIFY","PAGECOUNT","PAGLOCK","PARAMETERIZATION","PARSEONLY","PARTIAL","PARTITION","PARTITIONS","PARTNER","PASSWORD","PATH","PER_CPU","PER_NODE","PERCENT","PERMISSION_SET","PERSISTED","PHYSICAL_ONLY","PLAN","POISON_MESSAGE_HANDLING","POOL","POPULATION","PORT","PRECEDING","PRECISION","PRIMARY","PRIMARY_ROLE","PRINT","PRIOR","PRIORITY","PRIORITY_LEVEL","PRIVATE","PRIVILEGES","PROC","PROCCACHE","PROCEDURE","PROCEDURE_NAME","PROCESS","PROFILE","PROPERTY","PROPERTY_DESCRIPTION","PROPERTY_INT_ID","PROPERTY_SET_GUID","PROVIDER","PROVIDER_KEY_NAME","PUBLIC","PUT","QUARTER","QUERY","QUERY_GOVERNOR_COST_LIMIT","QUEUE","QUEUE_DELAY","QUOTED_IDENTIFIER","RAISERROR","RANGE","RAW","RC2","RC4","RC4_128","READ","READ_COMMITTED_SNAPSHOT","READ_ONLY","READ_ONLY_ROUTING_LIST","READ_ONLY_ROUTING_URL","READ_WRITE","READ_WRITE_FILEGROUPS","READCOMMITTED","READCOMMITTEDLOCK","READONLY","READPAST","READTEXT","READUNCOMMITTED","READWRITE","REAL","REBUILD","RECEIVE","RECOMPILE","RECONFIGURE","RECOVERY","RECURSIVE","RECURSIVE_TRIGGERS","REFERENCES","REGENERATE","RELATED_CONVERSATION","RELATED_CONVERSATION_GROUP","RELATIVE","REMOTE","REMOTE_PROC_TRANSACTIONS","REMOTE_SERVICE_NAME","REMOVE","REORGANIZE","REPAIR_ALLOW_DATA_LOSS","REPAIR_FAST","REPAIR_REBUILD","REPEATABLE","REPEATABLEREAD","REPLICA","REPLICATION","REQUEST_MAX_CPU_TIME_SEC","REQUEST_MAX_MEMORY_GRANT_PERCENT","REQUEST_MEMORY_GRANT_TIMEOUT_SEC","REQUIRED","RESAMPLE","RESEED","RESERVE_DISK_SPACE","RESET","RESOURCE","RESTART","RESTORE","RESTRICT","RESTRICTED_USER","RESULT","RESUME","RETAINDAYS","RETENTION","RETURN","RETURNS","REVERT","REVOKE","REWIND","REWINDONLY","ROBUST","ROLE","ROLLBACK","ROLLUP","ROOT","ROUTE","ROW","ROWCOUNT","ROWGUIDCOL","ROWLOCK","ROWS","ROWS_PER_BATCH","ROWTERMINATOR","ROWVERSION","RSA_1024","RSA_2048","RSA_512","RULE","SAFE","SAFETY","SAMPLE","SAVE","SCHEDULER","SCHEMA","SCHEMA_AND_DATA","SCHEMA_ONLY","SCHEMABINDING","SCHEME","SCROLL","SCROLL_LOCKS","SEARCH","SECOND","SECONDARY","SECONDARY_ONLY","SECONDARY_ROLE","SECONDS","SECRET","SECURITY_LOG","SECURITYAUDIT","SELECT","SELECTIVE","SELF","SEND","SENT","SEQUENCE","SERIALIZABLE","SERVER","SERVICE","SERVICE_BROKER","SERVICE_NAME","SESSION","SESSION_TIMEOUT","SET","SETS","SETUSER","SHOW_STATISTICS","SHOWCONTIG","SHOWPLAN","SHOWPLAN_ALL","SHOWPLAN_TEXT","SHOWPLAN_XML","SHRINKDATABASE","SHRINKFILE","SHUTDOWN","SID","SIGNATURE","SIMPLE","SINGLE_BLOB","SINGLE_CLOB","SINGLE_NCLOB","SINGLE_USER","SINGLETON","SIZE","SKIP","SMALLDATETIME","SMALLINT","SMALLMONEY","SNAPSHOT","SORT_IN_TEMPDB","SOURCE","SPARSE","SPATIAL","SPATIAL_WINDOW_MAX_CELLS","SPECIFICATION","SPLIT","SQL","SQL_VARIANT","SQLPERF","STANDBY","START","START_DATE","STARTED","STARTUP_STATE","STAT_HEADER","STATE","STATEMENT","STATIC","STATISTICAL_SEMANTICS","STATISTICS","STATISTICS_INCREMENTAL","STATISTICS_NORECOMPUTE","STATS","STATS_STREAM","STATUS","STATUSONLY","STOP","STOP_ON_ERROR","STOPAT","STOPATMARK","STOPBEFOREMARK","STOPLIST","STOPPED","SUBJECT","SUBSCRIPTION","SUPPORTED","SUSPEND","SWITCH","SYMMETRIC","SYNCHRONOUS_COMMIT","SYNONYM","SYSNAME","SYSTEM","TABLE","TABLERESULTS","TABLESAMPLE","TABLOCK","TABLOCKX","TAKE","TAPE","TARGET","TARGET_RECOVERY_TIME","TB","TCP","TEXT","TEXTIMAGE_ON","TEXTSIZE","THEN","THESAURUS","THROW","TIES","TIME","TIMEOUT","TIMER","TIMESTAMP","TINYINT","TO","TOP","TORN_PAGE_DETECTION","TRACEOFF","TRACEON","TRACESTATUS","TRACK_CAUSALITY","TRACK_COLUMNS_UPDATED","TRAN","TRANSACTION","TRANSFER","TRANSFORM_NOISE_WORDS","TRIGGER","TRIPLE_DES","TRIPLE_DES_3KEY","TRUE","TRUNCATE","TRUNCATEONLY","TRUSTWORTHY","TRY","TSQL","TWO_DIGIT_YEAR_CUTOFF","TYPE","TYPE_WARNING","UNBOUNDED","UNCHECKED","UNCOMMITTED","UNDEFINED","UNIQUE","UNIQUEIDENTIFIER","UNKNOWN","UNLIMITED","UNLOAD","UNSAFE","UPDATE","UPDATETEXT","UPDATEUSAGE","UPDLOCK","URL","USE","USED","USER","USEROPTIONS","USING","VALID_XML","VALIDATION","VALUE","VALUES","VARBINARY","VARCHAR","VARYING","VERIFYONLY","VERSION","VIEW","VIEW_METADATA","VIEWS","VISIBILITY","WAIT_AT_LOW_PRIORITY","WAITFOR","WEEK","WEIGHT","WELL_FORMED_XML","WHEN","WHERE","WHILE","WINDOWS","WITH","WITHIN","WITHOUT","WITNESS","WORK","WORKLOAD","WRITETEXT","XACT_ABORT","XLOCK","XMAX","XMIN","XML","XMLDATA","XMLNAMESPACES","XMLSCHEMA","XQUERY","XSINIL","YEAR","YMAX","YMIN"],JU);function JU(){}var DataConfigQuery_Query=(KU=Backbone.View,__extends(LU,KU),LU.prototype.focusEditor=function(){this.editor&&this.editor.focus()},LU.prototype.loadText=function(e){"query"===e?$["Cache.Q.Text"]?this.setEditorText($["Cache.Q.Text"],$["Cache.Q.Param"]):$["Cache.SQL.Text"]&&this.setEditorText("",[]):"sql"===e&&($["Cache.SQL.Text"]?this.setEditorText($["Cache.SQL.Text"],$["Cache.SQL.Param"]):$["Cache.Q.Text"]&&this.setEditorText("",[]))},LU.prototype.initializeEvents=function(){this.listenTo(this.params,"add reset remove",this.onParamsChanged),this.listenTo(this.model,"change:_queryParams",this.onModelParamsChange),this.listenTo(this.model,"change:_queryString",this.onModelTextChange),this.listenTo(this.model,"change:_connection",this.onModelConnectionChange),this.listenTo(this.model,"change:_dataSource",this.onModelDataSourceChange),this.debounceEditorChange=_.debounce($.proxy(this.onEditorTextChange,this),100),this.editor.onDidChangeModelContent(this.debounceEditorChange)},LU.prototype.setEditorText=function(e,t){this.lastText=e,this.model.set("_queryParams",t),this.editor&&this.editor.setValue(this.lastText)},LU.prototype.onModelDataSourceChange=function(){this.editor&&monaco.editor.setModelLanguage(this.editor.getModel(),"kdb"==this.model.get("_dataSource")?"q":"sql")},LU.prototype.getTables=function(n){var e=this.model.get("_connection");QuickBase.DeltaClientLib.getQueryData(void 0,e,'raze (raze k!{@[{ {".",(string y),".",string x}[;x] each tables[`$".",string x] };x;{`}]} each k: key `; tables `.)',void 0,function(e){var t=e.rows;n(Object.keys(t[0]).map(function(e){return t[0][e]}))},function(){n([])})},LU.prototype.getText=function(){return this.lastText},LU.prototype.onEditorTextChange=function(){this.linter&&this.editor&&"kdb"===this.model.get("_dataSource")&&this.linter.postMessage({code:this.editor.getValue(),version:this.editor.getModel().getVersionId()}),this.lastText=this.editor.getValue(),this.model.set({_queryString:this.lastText}),this.updateParams()},LU.prototype.onModelConnectionChange=function(){this.appModel.get("isLite")&&this.registerFnAutocomplete(),this.registerTableAutocomplete()},LU.prototype.onModelParamsChange=function(){this.params.reset(this.model.get("_queryParams")||[]),"sql"===this.model.get("_dataType")?$["Cache.SQL.Param"]=this.model.get("_queryParams"):$["Cache.Q.Param"]=this.model.get("_queryParams")},LU.prototype.onModelTextChange=function(e,t){(t=this.isTableUpdateDialog&&0===t.length?"{[add;upd;del]  }":t)!==this.lastText&&(this.lastText=t,this.editor.setValue(t),""!==t&&("sql"===this.model.get("_dataType")?$["Cache.SQL.Text"]=this.lastText:$["Cache.Q.Text"]=this.lastText))},LU.prototype.onParamsChanged=function(){var i=this;_.each(i.paramViews,function(e){i.stopListening(e.model),e.remove()}),i.paramViews=[],i.params.each(function(t,e){try{"sql"===i.model.get("_dataSource")&&t.set("ShowRemoveButton",!0),t.set("index",e);var n=new DataParameter(t,i.model,i.docViewModel,function(e){new ViewStateDialog(_.extend({dialogContainer:i.dialogContainer,docDataModel:i.docDataModel,model:i.docViewModel},e))});i.listenTo(n.model,"change",i.updateModelParams),n.on("resizeEvent",function(e){_.delay(function(){},e)}),i.paramViews.push(n),i.$paramsBox.append(n.$el)}catch(e){console.error("Parameter editor error ",t)}}),i.querySection&&(i.querySection.params=i.params),0<i.paramViews.length?i.$paramsBox.show():i.$paramsBox.hide(),i.onResize()},LU.prototype.onResize=function(){0<this.params.length?this.$el.find(".query-editor").css("bottom",this.$el.find(".params-box").height()+"px"):this.$el.find(".query-editor").css("bottom",0),this.editor&&monaco.editor.setTheme("kx-light"!==$.cookie("dashboard-theme")?"q-theme":"q-theme-light"),MonacoHelpers.adjustAfterResize(this.editor)},LU.prototype.registerFnAutocomplete=function(){var o=this;MonacoHelpers.require({language:"q"},function(e){var t,i=e.monaco,n=e.autocompleteItems;o.fnAutocomplete&&(o.fnAutocomplete.dispose(),delete o.fnAutocomplete),"sql"===o.model.get("_dataType")?o.fnAutocomplete=i.languages.registerCompletionItemProvider("sql",{provideCompletionItems:function(){var e=AutoCompleteParams.sqlKeywords,t=AutoCompleteParams.sqlOperators,n=AutoCompleteParams.sqlBuiltInFunctions;return{suggestions:e.map(function(e){return{label:e,kind:i.languages.CompletionItemKind.Keyword,insertText:e}}).concat(t.map(function(e){return{label:e,kind:i.languages.CompletionItemKind.Operator,insertText:e}})).concat(n.map(function(e){return{label:e,kind:i.languages.CompletionItemKind.Function,insertText:e}}))}}}):o.appModel.get("isLite")?(t=function(e){e=e.rows.map(function(e){return e.parameters=e.parameters.rows,e}).sort(function(e,t){return e.name.localeCompare(t.name)}),e=n.concat(e.map(function(e){return{label:e.name,detail:e.description||e.name+"["+_.filter(e.parameters,function(e){return e.name}).map(function(e){return e.name}).join(";")+"]"}})).map(function(e){return __assign(__assign({},e),{insertText:e.label})});o.fnAutocomplete=i.languages.registerCompletionItemProvider("q",new KdbFunctionCompletionProvider(e))},QuickBase.DeltaClientLib.runAnalytic(".api.getFunctions",o.model.get("_connection"),[],t,function(){QuickBase.DeltaClientLib.getQueryData("q",o.model.get("_connection"),DataConfigAnalytic.LITE_FN_LIST,[],t,function(){})})):QuickBase.DeltaClientLib.getDeltaAnalytics(function(e){e=n.concat(e.map(function(e){return{label:e.name,detail:e.description}})).map(function(e){return __assign(__assign({},e),{insertText:e.label})});o.fnAutocomplete=i.languages.registerCompletionItemProvider("q",new KdbFunctionCompletionProvider(e))})})},LU.prototype.registerTableAutocomplete=function(){var n=this;MonacoHelpers.require({language:"sql"===this.model.get("_dataType")?"sql":"q"},function(e){var t=e.monaco;e.autocompleteItems;n.tableAutocomplete&&(n.tableAutocomplete.dispose(),delete n.fnAutocomplete),n.getTables(function(e){n.tableAutocomplete&&n.tableAutocomplete.dispose(),n.tableAutocomplete=t.languages.registerCompletionItemProvider("sql"===n.model.get("_dataType")?"sql":"q",new KdbTableCompletionProvider(e))})})},LU.prototype.remove=function(){return this.editor&&(this.editor=null),this.fnAutocomplete&&this.fnAutocomplete.dispose(),this.tableAutocomplete&&this.tableAutocomplete.dispose(),_.each(["Q.Text","SQL.Text","Q.Param","Q.Text"],function(e){$["Cache."+e]&&($["Cache."+e]=null)}),Backbone.View.prototype.remove.call(this)},LU.prototype.updateModelParams=function(){this.stopListening(this.model,"change:_queryParams"),this.model.set("_queryParams",this.params.toJSON()),this.listenTo(this.model,"change:_queryParams",this.onModelParamsChange)},LU.prototype.updateParams=function(){var e,i,t,o=this,a=!1,s=[];o.isTableUpdateDialog||("kdb"!==o.model.get("_dataSource")&&"deltaclient"!==o.model.get("_dataSource")||(t=o.deltaParameterRx.exec(o.model.get("_queryString")),e=_.map(o.model.get("_queryString").match(o.inlineParameterRx),function(e){return e.substring(2,e.length-2)}),"sql"===this.model.get("_dataType")&&(e=_.map(o.model.get("_queryString").match(o.inlineSQLParmaterRx),function(e){return e.substring(2,e.length-2)})),0<(t=(t?t[1].split(";"):[]).concat(e)).length?(a=t.length!==o.params.length,_.each(t,function(e,t){var n=o.params.findWhere({name:e});n?(s.push(n),a=a||n.get("index")===t,n.set({index:t},{silent:!0})):(i=new Backbone.Model({name:e,index:t,type:"symbol",value:"",IsKdbParam:!0}),s.push(i),a=!0)})):o.params.reset([]),a&&o.params.reset(s)),o.updateModelParams())},LU),KU;function LU(n){var o=KU.call(this,n)||this;return o.tagName="div",o.deltaParameterRx=/^{\[([a-z0-9A-Z\;\w\/ ]+?)\]/,o.inlineParameterRx=/<%[^<>%]+%>/g,o.inlineSQLParmaterRx=/\{\{([^}]*)\}\}/g,o.params=new Backbone.Collection,o.docDataModel=n.docDataModel,o.docViewModel=n.docViewModel,o.appModel=n.appModel,o.dialogContainer=n.dialogContainer,o.isTableUpdateDialog=n.isTableUpdateDialog,o.$el.html(T.DataConfigQuery_Query(o.model.toJSON())),o.$paramsBox=o.$el.find(".params-box"),o.lastText=o.model.get("_queryString"),Worker&&(o.linter=new Worker(requirejs.toUrl("qlinter")+".js")),MonacoHelpers.require({language:"q"},function(e){var t,i=e.monaco;o.editor||(e=o.$el.find(".query-editor")[0],(t="sql"===o.model.get("_dataSource")||"sql"===o.model.get("_dataType"))?($["Cache.SQL.Text"]=o.lastText,$["Cache.SQL.Param"]=o.model.get("_queryParams")):($["Cache.Q.Text"]=o.lastText,$["Cache.Q.Param"]=o.model.get("_queryParams")),o.editor=i.editor.create(e,_.assign({},MonacoHelpers.DEFAULT_OPTIONS(),{value:o.lastText,language:t?"sql":"q",theme:"kx-light"!==$.cookie("dashboard-theme")?"q-theme":"q-theme-light",fontFamily:'"Lucida Console", Monaco, monospace',fontSize:"12px",wordWrap:!0,tabSize:2,readOnly:!n.appModel.get("CanExecuteQueries")})),o.editor.addAction({id:"Execute",label:"Execute Data Source",keybindings:[i.KeyMod.chord(i.KeyMod.CtrlCmd|i.KeyCode.Enter)],precondition:null,keybindingContext:null,contextMenuGroupId:"navigation",contextMenuOrder:1.5,run:function(e){var t=e.getModel().getValueInRange(e.getSelection());return o.deltaParameterRx.exec(t)?n.execute(t):t?n.execute("{["+o.params.map(function(e){return e.get("name")}).join(";")+"] "+t+"}"):n.execute(e.getValue()),null}}),o.editor.addAction({id:"Help-Menu",label:"Help",keybindings:[i.KeyMod.CtrlCmd|i.KeyCode.F10,i.KeyMod.chord(i.KeyMod.CtrlCmd|i.KeyCode.KEY_Q)],precondition:null,keybindingContext:null,contextMenuGroupId:"navigation",contextMenuOrder:1.5,run:function(e){var e=e.getModel().getValueInRange(e.getSelection()),t="https://code.kx.com/v2/ref/";return window.open(e?t+e:t,"_blank"),null}}),document.activeElement instanceof HTMLInputElement||o.editor.focus(),o.linter&&o.linter.addEventListener("message",function(e){var e=e.data,t=e.markers,e=e.version,n=o.editor.getModel();n&&n.getVersionId()===e&&"kdb"===o.model.get("_dataSource")?i.editor.setModelMarkers(n,"lint",t):n&&i.editor.setModelMarkers(n,"lint",[])}),o.registerFnAutocomplete(),o.registerTableAutocomplete()),o.onModelParamsChange(),o.updateParams(),o.onParamsChanged(),o.onEditorTextChange(),o.initializeEvents()}),o}var DataConfigQuery_Update=(jW=Backbone.View,__extends(kW,jW),kW.prototype.initializeEvents=function(){this.listenTo(this.params,"add reset remove",this.onParamsChanged),this.listenTo(this.model,"change:_updateQueryParams",this.onModelParamsChange),this.listenTo(this.model,"change:_updateQueryString",this.refreshQueryEditor),this.listenTo(this.model,"change:_updateType",this.onUpdateTypeChange)},kW.prototype.onUpdateTypeChange=function(){"analytic"===this.model.get("_updateType")?(this.$el.find(".update-editor").hide(),this.$el.find(".fa-info-circle").hide(),this.$el.find(".update-analytic-picker").show(),this.$paramsBox.hide(),this.datagridAppWrapper&&this.datagridAppWrapper.onResize()):(this.$paramsBox.show(),this.$el.find(".update-editor").show(),this.$el.find(".fa-info-circle").show(),this.$el.find(".update-analytic-picker").hide())},kW.prototype.onModelParamsChange=function(){this.params.reset(this.model.get("_updateQueryParams")||[])},kW.prototype.initializeAnalyticPicker=function(){var o=this;require(["Datagrid"],function(e){var t,n,i="Dark";"kx-light"===$.cookie("dashboard-theme")&&(i="Light"),t=o.model.get("_updateAnalytic"),(n=new QuickBase.DocumentDataModel({_subscriptionKey:"name",_dataType:"copy",_maxRows:1e5},null,null,null)).apply(),o.selectedUpdateAnalytic=new QuickBase.DocumentViewModel({_default:t,_viewType:!0,_type:"symbol",value:t},null),o.listenTo(o.selectedUpdateAnalytic,"change:value",function(e,t){t&&o.model.set("_updateAnalytic",t)}),t=e.getSettingsModel({Basics:{Data:n,Filtering:"Column Filters",ShowPagingControl:!1,EnableGrouping:!1},ColumnsConfiguration:[e.getColumnSettingsModel({Field:"name",TextAlign:"left"})],Selection:{Mode:"Single Row",RowSelectionColumn:"name",SelectedValue:o.selectedUpdateAnalytic,FollowSelectedValue:!0},FileExport:{ShowExportCsvButton:!1,ShowExportExcelButton:!1},Style:{FontSize:"11px",RowHeight:20,HeaderRowHeight:20}}),o.datagridAppWrapper=new QuickBase.AppView({el:o.$el.find(".update-analytic-picker .picker")[0],key:"Datagrid",settings:t,dashboardViewModel:new Backbone.Model({DashboardTheme:i}),dashboardAppModel:new Backbone.Model,docViewModel:o.options.docViewModel,deltaClient:QuickBase.DeltaClientLib.deltaClient,callback:function(){QuickBase.DeltaClientLib.getDeltaAnalytics(function(e){e.sort(function(e,t){return e.name.localeCompare(t.name)}).filter(function(e){return 3===e.parameters.length}),n.onExecuteSuccess({columns:["name"],meta:{name:11},rows:e},!0)})}})},function(e){QuickBase.Log.Error(t("DataConfigAnalytic.js: Datagrid initialization error")+e)})},kW.prototype.onResize=function(){0<this.params.length?this.$el.find(".update-editor").css("bottom",this.$el.find(".update-params-box").height()+"px"):this.$el.find(".update-editor").css("bottom",0),this.updateEditor&&(MonacoHelpers.adjustAfterResize(this.updateEditor),monaco.editor.setTheme("kx-light"!==$.cookie("dashboard-theme")?"vs-dark":"vs"),this.datagridAppWrapper&&this.datagridAppWrapper.onResize())},kW.prototype.initializeCodeMirror=function(){var n=this,i=this;MonacoHelpers.require({language:"q"},function(e){var t,e=e.monaco;n.updateEditor||(t=n.$el.find(".update-editor")[0],n.updateEditor=e.editor.create(t,_.assign({},MonacoHelpers.DEFAULT_OPTIONS(),{language:"q"}))),n.updateEditor.setValue(i.lastUpdateText),n.debounceUpdateEditorChange=_.debounce(function(){return i.onUpdateEditorTextChange()},100),n.updateEditor.onDidChangeModelContent(n.debounceUpdateEditorChange),n.onModelParamsChange(),n.updateParams(),n.onParamsChanged(),n.onUpdateEditorTextChange()})},kW.prototype.refreshQueryEditor=function(){this.updateEditor&&this.updateEditor.getValue()!==this.model.get("_updateQueryString")&&this.updateEditor.setValue(this.model.get("_updateQueryString"))},kW.prototype.onParamsChanged=function(){var o=this;_.each(this.paramViews,function(e){o.stopListening(e.model),e.remove()}),this.paramViews=[],this.params.each(function(n,e){try{"sql"===o.model.get("_dataSource")&&n.set("ShowRemoveButton",!0),n.set("index",e);var i=new DataParameter(n,o.model,o.docViewModel,function(e){new ViewStateDialog(_.extend({dialogContainer:o.dialogContainer,docDataModel:o.docDataModel,model:o.docViewModel},e))});o.listenTo(i.model,"change",o.updateModelParams.bind(o)),i.on("resizeEvent",function(e){_.delay(function(){},e)}),o.paramViews.push(i),o.$paramsBox.append(i.$el)}catch(e){QuickBase.Log.Error(t("Parameter editor error ")+n.toJSON())}}),0<this.paramViews.length?this.$paramsBox.show():this.$paramsBox.hide(),this.onResize()},kW.prototype.onUpdateEditorTextChange=function(){this.model.set({_updateQueryString:this.updateEditor.getValue()}),this.updateParams()},kW.prototype.updateModelParams=function(){this.stopListening(this.model,"change:_updateQueryParams"),this.model.set("_updateQueryParams",this.params.toJSON()),this.listenTo(this.model,"change:_updateQueryParams",this.onModelParamsChange.bind(this))},kW.prototype.updateParams=function(){var i,o=this,a=!1,s=[],e=this.deltaParameterRx.exec(this.model.get("_updateQueryString")),t=_.map(this.model.get("_updateQueryString").match(this.inlineParameterRx),function(e){return e.substring(2,e.length-2)}),e=(e?e[1].split(";"):[]).concat(t);3<e.length?(e=e.slice(3),a=e.length!==this.params.length,_.each(e,function(e,t){var n=o.params.findWhere({name:e});n?(s.push(n),a=a||n.get("index")===t,n.set({index:t},{silent:!0})):(i=new Backbone.Model({name:e,index:t,type:"symbol",value:"",IsKdbParam:!0}),s.push(i),a=!0)})):this.params.reset([]),a&&this.params.reset(s),this.updateModelParams()},kW),jW;function kW(e){var t=jW.call(this,e)||this;return t.deltaParameterRx=/^{\[([a-z0-9A-Z\;\w\/ ]+?)\]/,t.inlineParameterRx=/<%[^<>%]+%>/g,t.lastUpdateText=t.model.get("_updateQueryString"),t.options=e,t.params=new Backbone.Collection,t.docDataModel=e.docDataModel,t.docViewModel=e.docViewModel,t.dialogContainer=e.dialogContainer,t.lastUpdateText||(t.lastUpdateText=["{[dgAdd;dgUpd;dgDel]","  / this sample requires keyed table","  / always use unique key (id), 'Force Reset': checked","","  /testTable:: `id xkey ([] id:`int$();name:`symbol$();note1:`symbol$());","  /`testTable upsert(0i;`dummy;`);","  /testTable","","    availablePK: 1 + exec max id from testTable;","","    $[((count dgUpd)>0);`testTable upsert flip dgUpd;];","    $[((count dgDel)>0);delete from `testTable where id in (dgDel[`id]);];","","    /generate unique ids for new items","    addedCount: count dgAdd[`id];","    dgAdd[`id]:(availablePK + til addedCount);","    $[((count dgAdd)>0);`testTable upsert flip dgAdd;];","}"].join("\n"),t.model.set("_updateQueryString",t.lastUpdateText,{silent:!0})),t.$el.html(T.DataConfigQuery_Update({})),t.$paramsBox=t.$el.find(".update-params-box"),t.onUpdateTypeChange(),t.initializeCodeMirror(),t.initializeAnalyticPicker(),t.initializeEvents(),t.onUpdateTypeChange(),t.refreshQueryEditor(),t}var DataDialog=Backbone.View.extend({appModel:null,cookieKey:"dashboard-datadialog-settings",className:"data-dialog",dataView:null,propertiesView:null,isModelChanged:!1,areYouSureDialog:null,areYouSureMessage:"There are unsaved changes to this data source.",DOCUMENT_DEFAULTS:function(e){return _.extend({_autoExec:!0,_autoExecute:!0,_columns:[],_subscriptionKey:"",_dataSource:"kdb",_dataType:this.appModel.get("CanExecuteQueries")?"query":"analytic",_serverPaging:!1,_subscriptionType:"static",_subscriptionInterval:3,_maxRows:2e3,_layout:[{weight:2,isExpanded:!0},{weight:1,isExpanded:!1},{weight:1,isExpanded:!1},{weight:1,isExpanded:!0},{weight:2,isExpanded:!1}],_mappings:{},_pageSize:2e3,_pagingNum:0,_pagingType:"NONE",_query_connection:"",_queryParams:[],_isStreamingSubscription:!1,_selectedAnalytic:"",_analyticParams:{},_analyticParameters:{},_streamingParameters:{},_table:"",_pivotSource:"query",_pivotType:"",_pivotQuery:"",_aggregateFns:[],_aggregateCols:[],_aggregateLabels:[],_breakdownCols:[],_columnLabel:"",_aggFn:"avg",_topX:"",_from:"",_to:"",_ordering:"",_queryString:"",_hasUpdateQuery:!1,_updateQueryString:"",_updateQueryParams:[],_virtualParams:[],_virtualQueryString:"",_analyticString:"",_builderParams:[],_queryBuilderParams:[],_graphJSON:""},e)},initialize:function(e){var n,o=this,i=(this.debounceUpdateCookie=_.debounce(this.updateCookie,100),JSON.parse($.cookie(this.cookieKey)||"{}")),a=Tools.calcDialogHeight(i.height||750,"dataDialog"),s=(a>window.innerHeight&&(a=window.innerHeight-200),n=i.width>window.innerWidth?window.innerWidth-300:i.width,a<750?"top":"center");this.appModel=e.appModel,this.docViewModel=e.docViewModel,this.dialogContainer=e.dialogContainer,this.disabledNodes=e.disabledNodes,this.initialTab=e.initialTab,this.selectCallback=e.selectCallback,this.isPropertiesCollapsed=!1,this.path=void 0,this.$el.html(T.DataDialog()),this.$tree=this.$el.find("> .tree"),this.$collapsible=this.$el.find("> .collapsible"),this.$header=this.$collapsible.find("> h3"),this.$icon=this.$header.find("i"),this.$collapsibleContent=this.$collapsible.find("> .properties"),this.resizeConfigDialogDebounced=_.debounce(_.bind(this.resizeConfigDialog,this),100),this.$dialog=this.$el.dialog(_.extend({appendTo:e.dialogContainer,title:t("Data "),dialogClass:"quick-dash datasource-dialog",resizable:!0,height:a,width:n,minWidth:850,position:{my:"center",at:s,of:"#appdiv",collision:"fit"},modal:!0,autoOpen:!0,buttons:[{text:t("Select Item"),disabled:!0,click:$.proxy(o.onSelectButtonClick,o),icons:{primary:"fa fa-check"}},{text:t("Apply"),disabled:!0,click:$.proxy(o.onSaveButtonClick,o),icons:{primary:"fa fa-check-square-o"}},{text:t("Close"),click:$.proxy(o.onCancelButtonClick,o),icons:{primary:"fa fa-times"}}],open:function(){$('<i class="fa fa-database" />').insertBefore(o.$el.parent().find(".ui-dialog-title")),_.isUndefined(i.left)||_.isUndefined(i.top)||(o.el.parentElement.style.left=i.left+"px",o.el.parentElement.style.top=i.top+"px"),o.updateLayout(),o.$header.click(function(){o.isPropertiesCollapsed=!o.isPropertiesCollapsed,o.updateLayout()}),o.dataView=new TreeView({areYouSureMessage:this.areYouSureMessage,el:o.$el.find("> .tree"),model:o.model,disabledNodes:o.disabledNodes,nodeLabel:"Data Source",nodeTypes:{node:{icon:"fa fa-fw fa-database",valid_children:[]},node_mapped:{icon:"fa fa-fw fa-database",a_attr:{class:"mapped"},valid_children:[]},virtual_node:{icon:"fa fa-calculator",valid_children:[]},virtual_node_mapped:{icon:"fa fa-calculator",a_attr:{class:"mapped"},valid_children:[]}},selected:e.path,contextMenuFn:function(e){var t={};return"node"!==e&&"node_mapped"!==e||(t.create_virtual_node={label:"Add Virtual Data Source",action:function(e){var t=$.jstree.reference(e.reference),e=t.get_node(e.reference),n=t.get_path(e,"/");t.create_node(e.parent,{source:n,type:"virtual_node"},"last",function(e){_.defer(function(){t.edit(e)})})}}),t},determineTypeFn:function(e){return e&&e.get?e.isMapping()?"virtual"===e.get("_dataType")?"virtual_node_mapped":"node_mapped":"virtual"===e.get("_dataType")?"virtual_node":"node":"node"},newGroupFn:function(){return new QuickBase.DocumentDataModel({},o.root,"",o.docViewModel,!0)},newNodeFn:function(e){var t=DataConfigForm.filterAttributes(o.DOCUMENT_DEFAULTS());return e&&"virtual_node"===e.type&&(t._dataType="virtual",e.source&&(t._virtualParams=[{type:"datasource",name:"source",value:e.source}],t._virtualQueryString=o.generateSampleVirtualQuery(e.source))),o.editModel&&o.editModel.get("_connection")&&(t._connection=o.editModel.get("_connection")),new QuickBase.DocumentDataModel(t,o.model?o.model.root:null,"",o.docViewModel,!1)},setPathFn:function(e,t){var n,i=e.path;t!==i&&(e.path=t,n=new RegExp("^"+i),e.getTreeList().forEach(function(e){e.path&&(e.path=e.path.replace(n,t))}),o.model.getTreeList().forEach(function(e){"virtual"===e.get("type")&&e.updateParameterPath("ds",i,t)}))},saveCb:function(){o.onSaveButtonClick()},noSaveCb:function(){o.isModelChanged=!1,o.setSaveEnabled(o.isModelChanged)}}),o.initHorizontalResize(),o.dataView.on("select_property",$.proxy(o.onTreeViewSelectProperty,o)),"FSBL"in window&&o.$el.parent().css("margin-top",window.finApi.DIALOGS_TOP_MARGIN),o.$el.parent().find(".ui-dialog-buttonpane > div > button:last-child").focus()},close:function(){o.remove()},drag:function(){o.debounceUpdateCookie()},resize:function(){o.onHorizontalResize(),o.debounceUpdateCookie(),o.resizeConfigDialogDebounced()}},this.options)).dialogExtend({maximizable:!0,maximize:function(){o.configDialog&&_.defer(function(){o.configDialog.onResize()}),o.onHorizontalResize(),_.defer(function(){o.initHorizontalResize()}),o.debounceUpdateCookie()},restore:function(){o.configDialog&&o.configDialog.onResize(),o.onHorizontalResize(),_.defer(function(){o.initHorizontalResize()}),o.debounceUpdateCookie()}}),i.isMaximized&&this.$dialog.dialogExtend("maximize"),this.resizeEvent=function(){o.maximizedResize()},window.addEventListener("resize",this.resizeEvent)},getDataTypeCookie:function(){var e=$.cookie("KXQueryType");return _.isNil(e)||["sql","query"].indexOf(e)<0?"sql":e},maximizedResize:function(){"maximized"===this.$dialog.dialogExtend("state")&&this.$dialog.dialogExtend("maximize")},updateCookie:function(){var e,t,n,i,o;this.el.parentElement&&(o=(e="maximized"===this.$dialog.dialogExtend("state"))?(t=(o=JSON.parse($.cookie(this.cookieKey)||"{}")).left,n=o.top,i=o.width,o.height):(t=(o=this.el.parentElement.style).left,n=o.top,i=o.width,o.height),$.cookie(this.cookieKey,JSON.stringify({left:parseInt(t),top:parseInt(n),width:parseInt(i),height:parseInt(o),isMaximized:e}),{expires:90}))},generateSampleVirtualQuery:function(e){var t,e=this.model.getByPath(e),n=["sym","bid","ask"],i={sym:11,bid:9,ask:9},o=[{sym:"AUD/CAD",bid:1.0052,ask:1.0055},{sym:"EUR/USD",bid:1.3945,ask:1.3941},{sym:"GBP/USD",bid:1.5896,ask:1.59}];return e&&e.dataSet&&e.dataSet.columns&&!e.dataSet.columns.isEmpty()&&(t=QuickBase.DocumentDataModel.convertMetaToDeltaClientColumnSpec(e.dataSet.columns.toJSON()))&&(n=t.columns.slice(0,3),i=_.pick(t.meta,n),o=_.map(e.dataSet.collection.toJSON().slice(0,3),function(e){return _.pick(e,n)})),T.VirtualQuerySample({columns:JSON.stringify(n,null,2).replace(/\n/g,"\n\t//"),meta:JSON.stringify(i,null,2).replace(/\n/g,"\n\t//"),rows:JSON.stringify(o,null,2).replace(/\n/g,"\n\t//")})},initHorizontalResize:function(){try{this.dataView.$el.resizable("destroy")}catch(e){}this.dataView.$el.resizable({handles:"e",minWidth:220,maxWidth:400}).on("resize",$.proxy(this.onHorizontalResize,this))},onCancelButtonClick:function(){function e(){t.$el.dialog("close"),t.remove()}var t=this;this.isModelChanged?this.areYouSureDialog=new QuickBase.AreYouSureDialog({saveCb:function(){t.onSaveButtonClick(),e()},onClose:function(){t.areYouSureDialog.remove(),delete t.areYouSureDialog},noSaveCb:function(){e()},dashChanged:!0,message:this.areYouSureMessage}):e()},onHorizontalResize:function(){var e=this.$el.width();this.$el.find("> .form").css({width:e-this.$el.find("> .tree").width()+7+"px",left:"auto"}),this.resizeConfigDialogDebounced()},onModelCopyChanged:function(e){!this.isModelChanged&&_.find(_.keys(e.changed),function(e){return 0===e.indexOf("_")&&"_layout"!==e})&&(this.isModelChanged=!0,this.dataView.setPending(this.dataView.selectedNode),this.setSaveEnabled(this.isModelChanged))},onSaveButtonClick:function(){var e,t=this;t.editModel&&((e=t.model.getByPath(t.path)).clear({silent:!0}),e.set(DataConfigForm.filterAttributes(t.editModel.attributes)),Log.Info("Saved",e.attributes),e.apply(),e.start(),t.deferSaveID=_.defer(function(){t.isModelChanged=!1,t.dataView.selectionChanged=null,t.dataView.setPending(),t.setSaveEnabled(t.isModelChanged)}))},onSelectButtonClick:function(){var e;this.selectCallback&&((e=this.model.getByPath(this.path))?(e.path=this.path,this.selectCallback(e)):this.selectCallback({path:this.path})),this.onCancelButtonClick()},onTreeViewSelectProperty:function(e,a){function t(e){s.path=e;var t,n,i=s.model.getByPath(e),o=i&&i.has("_dataType");s.$el.next().find("button:first").button({disabled:!o}),o?(Log.Info("Select model: ",i.attributes),"copy"===i.get("_dataType")&&i.set("_dataType","query",{silent:!0}),s.configDialog?(s.configDialog.$el.show(),s.configDialog.stopListening(s.configDialog.model,"change:"+s.configDialog.SUBCRIPTION_PROPERTY),s.editModel.forceRender=!0,o=i.get("_dataType"),t="streaming"===i.get("_subscriptionType"),n="streaming"===s.editModel.get("_subscriptionType"),s.editModel.set($.extend(!0,r,i.attributes)),s.editModel.get("_dataType")===o&&n!=t&&(s.$el.find("input:radio[name=_dataType]").val([t?"streaming":o]),s.editModel.trigger("change:_dataType",s.editModel,i.get("_dataType"))),s.editModel.forceRender=!1,s.configDialog.clearData(),"builder"===s.editModel.get("_dataType")&&s.configDialog.dataConfigBuilder&&s.configDialog.dataConfigBuilder.settingsModel.set({"Basics.JSON":s.editModel.get("_graphJSON"),"Basics.Selected":s.editModel.get("_selectedNode")}),s.editModel.builderNeedsRender=!0,s.configDialog.listenTo(s.configDialog.model,"change:"+s.configDialog.SUBCRIPTION_PROPERTY,s.configDialog.onModelSubscriptionTypeChange)):(s.editModel=new QuickBase.DocumentDataModel($.extend(!0,{},r,i.attributes),i.root,i.path,i.viewState,!1,_.mapKeys(i.virtualSubscriptions,function(e,t){return t+"#edit"})),s.configDialog=new DataConfigForm({el:s.$el.find("> .form").get(0),dataDialogView:s,docDataModel:s.model,docViewModel:s.docViewModel,dialogContainer:s.dialogContainer,initialTab:s.initialTab,model:s.editModel,appModel:s.appModel}),s.listenTo(s.editModel,"change",s.onModelCopyChanged),s.listenTo(s.editModel,"isValid",function(e){(this.isModelChanged=e)&&this.dataView.setPending(this.dataView.selectedNode),this.setSaveEnabled(e),this.setSelectEnabled(e)})),s.configDialog.updateQueryRadio(!0),s.editModel.path=e,s.configDialog.onResize()):s.configDialog&&s.configDialog.$el.hide(),l.isModelChanged=!1,l.dataView.selectionChanged=null,l.dataView.setPending(),l.setSaveEnabled(l.isModelChanged),a||_.delay(function(){l.configDialog.focusEditor()},100)}var s=this,l=this,r=$.extend(!0,{},this.DOCUMENT_DEFAULTS());this.areYouSureDialog||(!_.isUndefined(e)&&this.isModelChanged&&this.dataView.pending&&this.dataView.selectionChanged?this.areYouSureDialog=new QuickBase.AreYouSureDialog({saveCb:function(){s.dataView.setPending(),l.onSaveButtonClick(),t(e)},onClose:function(){s.areYouSureDialog.isCancel&&(l.dataView.$tree.jstree("deselect_node",l.dataView.selectedNode),l.dataView.$tree.jstree("select_node",l.dataView.lastSelectedNode)),s.areYouSureDialog.remove(),delete s.areYouSureDialog},noSaveCb:function(){s.dataView.setPending(),t(e)},dashChanged:!0,message:"There are unsaved changes to this data source."}):_.isUndefined(e)||!1!==this.dataView.selectionChanged?t(e):(this.path=e,this.editModel&&(this.editModel.path=e)))},remove:function(){this.editModel&&(this.stopListening(this.editModel),this.editModel=null),this.configDialog&&(this.configDialog.remove(),this.configDialog=null),window.clearTimeout(this.deferSaveID),window.removeEventListener("resize",this.resizeEvent),QuickBase.ErrorTooltip.clearAll(),Backbone.View.prototype.remove.call(this)},resizeConfigDialog:function(){this.configDialog&&this.configDialog.onResize()},updateProperties:function(e){var t=this;t.propertiesView&&t.propertiesView.remove(),e&&(t.propertiesView=new DataModelPropertiesView({model:t.model.getByPath(e)}),t.listenTo(t.propertiesView,"configure",function(){t.onConfigureClick(e)}),t.$collapsibleContent.append(t.propertiesView.el))},updateLayout:function(){var e=this.$header.outerHeight(!0),e=this.isPropertiesCollapsed?e:this.$collapsibleContent.outerHeight(!0)+e;this.$collapsible.css("height",e+"px"),this.$tree.css("bottom",e+"px"),this.isPropertiesCollapsed?(this.$icon.removeClass("fa-caret-down"),this.$icon.addClass("fa-caret-right")):(this.$icon.removeClass("fa-caret-right"),this.$icon.addClass("fa-caret-down"))},setSaveEnabled:function(e){this.configDialog&&this.configDialog.$connectionSelect[0].value&&this.$el.next().find("button:nth-of-type(2)").button({disabled:!e})},setSelectEnabled:function(e){this.$el.next().find("button:nth-of-type(1)").button({disabled:!e})}}),VirtualParameter=Backbone.View.extend({BINDABLE_TYPES:["datasource","viewstate"],className:"data-parameter",errorDialog:null,initialize:function(e){var t=this;this.appModel=e.appModel,this.docDataModel=e.docDataModel,this.docViewModel=e.docViewModel,this.dialogContainer=e.dialogContainer,this.paramModel=e.paramModel,this.render(),_.includes(this.BINDABLE_TYPES,this.model.get("type"))?this.onBindingSelected(this.model.get("value")):this.$valueInput.val(this.model.get("value")),this.onTypeChanged(),_.defer(function(){t.initializeEvents()})},initializeEvents:function(){this.listenTo(this.model,"change:type",this.onTypeChanged),this.$bindingContainer.on("click",$.proxy(this.onShowBindingDialog,this)),this.$clearBinding.on("click",$.proxy(this.onClearBinding,this)),this.$selectBinding.on("click",$.proxy(this.onShowBindingDialog,this)),this.$valueInput.on("change",$.proxy(this.onValueInput,this)),this.$typeRadio.find("input[type=radio]").change(_.bind(this.onTypeRadioChange,this))},applyControlState:function(){_.includes(this.BINDABLE_TYPES,this.model.get("type"))?this.$form.addClass("is-bound"):this.$form.removeClass("is-bound")},getPath:function(){var e=this.paramModel.path;return e.substring(e.lastIndexOf("/")+1)+"/"+this.model.get("name")},onClearBinding:function(){this.model.set("value",null),this.$viewStateInput.val(""),this.$viewStateDisplay.val(""),this.applyControlState()},onBindingSelected:function(e){switch(this.stopListening(this.boundModel,"change"),this.model.get("type")){case"datasource":this.boundModel=this.docDataModel.getByPath(e);break;case"viewstate":this.boundModel=this.docViewModel.getByPath(e),this.listenTo(this.boundModel,"change:value",this.onBoundModelChange)}this.model.set("value",e),this.$valueInput.val(e),this.$valueDisplay.val(e),this.applyControlState()},onBoundModelChange:function(){this.trigger("change")},onTypeRadioChange:function(){var e=this.$typeRadio.find(":radio:checked").val();this.model.set({type:e}),this.onShowBindingDialog()},onTypeChanged:function(){var e=this.model.get("type");switch(this.$bindingIcon.removeClass("fa-eye fa-database"),e){case"datasource":this.$bindingIcon.addClass("fa-database");break;case"viewstate":this.$bindingIcon.addClass("fa-eye")}this.applyControlState()},onValueInput:function(){var e=this.$valueInput.val();this.model.set({value:e,isViewState:!1})},render:function(){var e=_.uniqueId("virtualParam_");this.$el.html(T.VirtualParameter(_.extend({uniqueId:e},this.model.toJSON()))),this.$bindingContainer=this.$(".binding-container"),this.$bindingIcon=this.$(".binding-icon"),this.$clearBinding=this.$(".binding-clear"),this.$form=this.$el.find(".form-control"),this.$selectBinding=this.$(".binding-apply"),this.$valueDisplay=this.$el.find(".value-display"),this.$valueInput=this.$el.find(".value-input"),this.$typeRadio=this.$el.find(".type-radio"),this.$typeRadio.val(this.model.get("type")),this.$typeButtonDatasource=this.$typeRadio.find("#"+e+"_datasource"),this.$typeButtonText=this.$typeRadio.find("#"+e+"_text"),this.$typeButtonViewstate=this.$typeRadio.find("#"+e+"_viewstate"),this.$typeRadio.find(":radio[value="+this.model.get("type")+"]").prop("checked",!0),this.$typeRadio.buttonset(),this.$typeButtonDatasource.button({icons:{primary:"fa fa-database"},text:!1}),this.$typeButtonText.button({icons:{primary:"fa fa-font"},text:!1}),this.$typeButtonViewstate.button({icons:{primary:"fa fa-eye"},text:!1})},remove:function(){this.$bindingContainer.off(),this.$clearBinding.off(),this.$selectBinding.off(),this.$valueInput.off(),Backbone.View.prototype.remove.apply(this)},onShowBindingDialog:function(){var e,t=this,n={dialogContainer:t.dialogContainer,path:t.model.get("value")};switch(t.model.get("type")){case"datasource":e=DataDialog,_.extend(n,{appModel:t.appModel,disabledNodes:[t.paramModel.path],docViewModel:t.docViewModel,model:t.docDataModel,selectCallback:function(e){e&&t.onBindingSelected(e.path)}});break;case"viewstate":e=ViewStateDialog,_.extend(n,{model:t.docViewModel,selectCallback:function(e){t.onBindingSelected(e)}})}e&&new e(n)}}),DataConfigQuery_Virtual=Backbone.View.extend({tagName:"div",params:null,$paramsBox:null,$queryEditor:null,lastText:null,initialize:function(e){var t=this;t.appModel=e.appModel,t.docDataModel=e.docDataModel,t.docViewModel=e.docViewModel,t.dialogContainer=e.dialogContainer,t.params=new Backbone.Collection,t.render(),t.initializeMonaco()},initializeMonaco:function(){var i=this;this.lastText=this.model.get("_virtualQueryString"),MonacoHelpers.require({language:"javascript"},function(e){var t=e.monaco,e=e.unload,n=i.$el.find(".query-editor")[0];i.unregisterTypes=e,i.editor=t.editor.create(n,_.assign({},MonacoHelpers.DEFAULT_OPTIONS(),{language:"javascript"})),i.onModelParamsChange(),i.onParamsChanged(),i.initializeEvents(),i.editor.setValue(i.lastText)})},initializeEvents:function(){this.listenTo(this.params,"add reset remove",this.onParamsChanged),this.listenTo(this.model,"change:_virtualParams",this.onModelParamsChange),this.listenTo(this.model,"change:_virtualQueryString",this.onModelTextChange),this.debounceEditorChange=_.debounce($.proxy(this.onEditorTextChange,this),100),this.editor.onDidChangeModelContent(this.debounceEditorChange)},focusEditor:function(){this.editor&&(this.editor.setPosition({lineNumber:2,column:1}),this.editor.focus())},onEditorTextChange:function(){this.lastText=this.editor.getValue(),this.model.set("_virtualQueryString",this.lastText),this.updateParams()},onModelParamsChange:function(){this.params.reset(this.model.get("_virtualParams")||[])},onModelTextChange:function(e,t){t!==this.lastText&&(this.lastText=t,this.editor.setValue(t))},onParamsChanged:function(){var n=this;_.each(n.paramViews,function(e){n.stopListening(e.model),e.remove()}),n.paramViews=[],n.params.each(function(e){var t=new VirtualParameter({appModel:n.appModel,dialogContainer:n.dialogContainer,docDataModel:n.docDataModel,docViewModel:n.docViewModel,model:e,paramModel:n.model});n.listenTo(e,"change",n.updateDataModelParams),n.paramViews.push(t),n.$paramsBox.append(t.$el)}),0<n.paramViews.length?n.$paramsBox.show():n.$paramsBox.hide(),n.onResize()},onResize:function(){0<this.params.length?this.$queryEditor.css("bottom",this.$paramsBox.height()+"px"):this.$queryEditor.css("bottom",0),MonacoHelpers.adjustAfterResize(this.editor)},remove:function(){this.editor&&(this.editor=null),this.unregisterTypes(),Backbone.View.prototype.remove.call(this)},render:function(){this.$el.html(T.DataConfigQuery_Virtual(this.model.toJSON())),this.$paramsBox=this.$el.find(".params-box"),this.$queryEditor=this.$el.find(".query-editor")},updateDataModelParams:function(){this.stopListening(this.model,"change:_virtualParams"),this.model.set("_virtualParams",this.params.toJSON()),this.listenTo(this.model,"change:_virtualParams",this.onModelParamsChange)},updateParams:function(){var i=this,o=[],a=!1,e=QuickBase.DocumentDataModel.VIRTUAL_QUERY_REGEX.exec(i.model.get("_virtualQueryString"));e&&6===e.length?(e=e[2].split(","),a=e.length!==i.params.length,_.each(e,function(e,t){var n;e=e.trim(),(n=i.params.findWhere({name:e}))?(n.get("index")!==t&&(a=!0,n.set({index:t},{silent:!0})),o.push(n)):(o.push(new Backbone.Model({name:e,index:t,type:"datasource",value:""})),a=!0)})):console.warn("Virtual Query: Function Declaration Invalid. Function call must have at least one source & callback."),a&&i.params.reset(o),i.updateDataModelParams()}}),DataConfigQuery_Builder=Backbone.View.extend({className:"data-config-builder",$isStreamingSub:null,$parametersPanel:null,selectedAnalyticParams:[],subscriptionSelect:null,analyticDetailsObj:{},height:0,width:0,initialize:function(e){this.options=e,this.render()},onChange_queryBuilderParams:function(){0<this.model.get("_queryBuilderParams").length&&this.$el.closest(".data-div").siblings(".toolbar").find("#datasource-execute-query").click()},onModelColumnsChange:function(){var e,t=this.queryBuilderWrapper.app.selectedNode;t&&this.model.get("_selectedNode")===t.id&&((e=JSON.parse(this.settingsModel.get("Basics.JSON"))).nodes[t.id].subscription={cols:this.model.get("_columns"),key:this.model.get("_subscriptionKey")},this.setJsonProperty(JSON.stringify(e)))},onResize:function(){this.queryBuilderWrapper&&this.$el.is(":visible")&&(this.height!==this.$el.height()||this.width!==this.$el.width())&&(this.queryBuilderWrapper.onResize(),this.height=this.$el.height(),this.width=this.$el.width())},remove:function(){this.$parametersPanel&&(this.$parametersPanel.remove(),delete this.$parametersPanel),this.queryBuilderWrapper&&this.queryBuilderWrapper.remove(),Backbone.View.prototype.remove.call(this)},render:function(){var s=this;s.queryBuilderWrapper&&s.queryBuilderWrapper.app.sideDialog;if(!1===s.model.builderNeedsRender)return!1;s.model.builderNeedsRender=!1,s.$el.html(T.DataConfigQuery_Builder()),require(["QueryBuilder"],function(e){var t=s.model.get("_selectedNode")||"result",n=s.model.get("_graphJSON")||"";s.settingsModel=e.getSettingsModel({Basics:{Data:"",Connection:s.model.get("_connection"),Direction:"Left-Right",DialogPlacement:"Left",AutoSave:!0,ReadOnly:!1,Selected:t,JSON:n,qIPC:"",UseViewStates:!0,Theme:"Dark"},Bindings:[],Style:{advanced:"",LevelSeparation:220,NodeSpacing:150}}),s.listenTo(s.settingsModel,"change:Basics.JSON",function(e,t){var n=s.queryBuilderWrapper.app,i=s.model.get("_graphJSON"),n=n.selectedNode;if(i!==t){if(n&&_.includes(["data","function","stream","filter","groupBy","join"],n.group)){var o,a,i=JSON.parse(i).nodes[n.id];if(_.includes(["data","function","stream"],n.group)&&("string"==typeof n.data&&n.data!==i.data||"object"==typeof n.data&&n.data.name!==i.data.name)||"filter"===n.group&&!_.isEqual(n.data.select,i.data.select)||"groupBy"===n.group&&!_.isEqual(n.data.groupBy,i.data.groupBy)||"join"===n.group&&!_.isEqual(n.data,i.data))return s.options.subscriptionSelect.reset(),o=JSON.parse(t),(a=function(e){delete e.subscription,"result"!==e.id&&a(o.nodes[o.edges[e.id]])})(o.nodes[n.id]),i=JSON.stringify(o),s.model.set("_graphJSON",i),void s.setJsonProperty(i)}s.model.set("_graphJSON",t)}else s.resetSubscription(s.model.get("_selectedNode"))}),s.listenTo(s.settingsModel,"change:Basics.Selected",function(e,t){s.model.get("_selectedNode")!==t&&s.resetSubscription(t),s.model.set("_selectedNode",t)}),s.listenTo(s.model,"change:_connection",function(e,t){var n,i;"builder"===s.model.get("_dataType")&&(i=(n=s.queryBuilderWrapper.app).selectedNode,n.api.setProperty("Basics.Connection",t),-1<i.id.indexOf("data")&&n.doCommand(i.group))}),s.listenTo(s.model,"change:_subscriptionKey",function(e,t){var n,i,o;"builder"===s.model.get("_dataType")&&s.model.get("_graphJSON")&&(n=s.queryBuilderWrapper.app,(o=(o=(i=JSON.parse(s.model.get("_graphJSON"))).nodes)[s.model.get("_selectedNode")||_.keys(o)[1]])&&o.subscription&&o.subscription.key!==t&&n.selectedNode&&n.selectedNode.id===s.model.get("_selectedNode")&&(o.subscription.key=t,s.setJsonProperty(JSON.stringify(i))))}),s.queryBuilderWrapper=new QuickBase.AppView({el:s.$el.find(".graph-container")[0],key:"QueryBuilder",settings:s.settingsModel,dashboardViewModel:new Backbone.Model({DashboardTheme:"Dark"}),dashboardAppModel:s.options.appModel,docDataModel:s.options.model,docViewModel:s.options.docViewModel,deltaClient:QuickBase.DeltaClientLib,callback:function(){this.app.setViewModel(s.options.docViewModel,s.options.model,function(e){e.path=e.path?e.path.toString():null,new ViewStateDialog(_.extend({dialogContainer:s.options.dialogContainer,docDataModel:s.options.docDataModel,model:s.options.docViewModel},e))})}})})},resetSubscription:function(e){var t=JSON.parse(this.model.get("_graphJSON")).nodes,e=t[e||_.keys(t)[1]];e&&e.subscription?(this.model.set("_subscriptionKey",e.subscription.key),this.options.subscriptionSelect.updateSubscriptionKeyMenu(e.subscription.cols)):this.options.subscriptionSelect.reset()},setJsonProperty:function(e){var t=this.queryBuilderWrapper.app;t.isSaving=!0,t.api.setProperty("Basics.JSON",e)}}),AnalyticParamsView=(NZ=Backbone.View,__extends(OZ,NZ),OZ.prototype.getParams=function(){var n=[];return _.each(this.parameterArray,function(e,t){n.push(e.model.toJSON())}),n},OZ.prototype.onParamItemChanged=function(){this.trigger("ParamItemChanged")},OZ.prototype.refreshParameterList=function(){var n,i=this;i.parameterArray=[],i.$parameterList.html(""),this.model.get("Parameters").length?_.each(this.model.get("Parameters"),function(e){n=new DataParameter(new Backbone.Model(_.extend({},e)),i.options.analyticModel,i.options.docViewModel,function(e){new ViewStateDialog(_.extend({dialogContainer:i.options.dialogContainer,docDataModel:i.options.docDataModel,model:i.options.docViewModel},e))},i.options.possibleTypes),i.listenTo(n,"ValueChanged",i.onParamItemChanged),i.parameterArray.push(n),i.$parameterList.append(n.$el)}):i.$parameterList.append($("<div />").addClass("noParameters").text(t("No Parameters")))},OZ.prototype.render=function(){return this.$el.html(T.AnalyticParamsView(this.model.toJSON())),this.$parameterList=this.$el.find(".parameterList"),this},OZ),NZ;function OZ(e){var t=NZ.call(this,e)||this;return t.$parameterList=null,t.parameterArray=[],t.options=e,t.render(),t.listenTo(t.model,"change",t.refreshParameterList),t.refreshParameterList(),t}var SubscriptionSelect=Backbone.View.extend({className:"row data-source-row",hasStreamingNode:!1,isLite:!1,DATA_TYPE_PROP:"_dataType",DATA_SOURCE_PROP:"_dataSource",COLUMNS_PROPERTY:"_columns",SUBCRIPTION_PROPERTY:"_subscriptionType",INTERVAL_PROPERTY:"_subscriptionInterval",SUBSCRIPTION_KEY_PROPERTY:"_subscriptionKey",FORCE_RESET_PROPERTY:"_forceReset",$subscriptionSelect:null,$maxRowsInput:null,$subscriptionCheckedRadio:null,$polling:null,$static:null,$streaming:null,$subscription:null,initialize:function(n){var e,t=this;this.isLite=n.isLite,this.subscriptionKey=_.uniqueId("subscriptionSelect_"),this.$el.html(T.SubscriptionSelect()),this.$autoExecute=this.$el.find(".auto-execute"),this.$subscriptionSelect=this.$el.find("input[name='"+this.SUBCRIPTION_PROPERTY+"']"),this.$subscriptionKey=this.$el.find("select[name='"+this.SUBSCRIPTION_KEY_PROPERTY+"']"),this.$intervalSelectContainer=this.$el.find(".subscriptionIntervalContainer"),this.$forceResetCheck=this.$el.find("."+this.FORCE_RESET_PROPERTY),this.$streaming=this.$el.find(".streamingRadio"),this.$subscription=this.$el.find(".subscriptionRadio"),this.$static=this.$el.find(".staticRadio"),this.$polling=this.$el.find(".pollingRadio"),this.debouncedUpdateSubscriptionKeyMenu=_.debounce(this.updateSubscriptionKeyMenu,100),this.onModelColumnsChange(),this.listenTo(this.model,"change:"+this.COLUMNS_PROPERTY,this.onModelColumnsChange),this.onModelDataTypeChange(),this.listenTo(this.model,"change:"+this.DATA_TYPE_PROP+" change:"+this.DATA_SOURCE_PROP,this.onModelDataTypeChange),this.onModelSubscriptionChange(),this.listenTo(this.model,"change:"+this.SUBCRIPTION_PROPERTY,this.onModelSubscriptionChange),this.$subscriptionSelect.change($.proxy(this.onInputSubscriptionChange,this)),this.onModelGraphChange(),this.listenTo(this.model,"change:_graphJSON",this.onModelGraphChange),e=new Backbone.Form.editors.NumberViewState({key:this.INTERVAL_PROPERTY,model:this.model,openViewStateDialog:function(e,t){new ViewStateDialog({dialogContainer:n.dialogContainer,docDataModel:n.docDataModel,model:n.docViewModel,path:e,selectCallback:function(e){e=n.docViewModel.getByPath(e);t(e)}})},schema:{editorAttrs:{max:3600,min:.5,step:.1}}}).render(),this.$intervalSelectContainer.append(e.el),e.on("change",function(){t.model.set(t.INTERVAL_PROPERTY,e.getValue())}),this.onModelSubscriptionKeyChange(),this.listenTo(this.model,"change:"+this.SUBSCRIPTION_KEY_PROPERTY,this.onModelSubscriptionKeyChange),this.$subscriptionKey.change($.proxy(this.onInputSubscriptionKeyChange,this)),this.onModelForceResetChange(),this.listenTo(this.model,"change:"+this.FORCE_RESET_PROPERTY,this.onModelForceResetChange),this.$forceResetCheck.change($.proxy(this.onInputForceResetChange,this)),this.onModelAutoExecuteChange(),this.listenTo(this.model,"change:"+QuickBase.DocumentDataModel.AUTO_EXECUTE,this.onModelAutoExecuteChange.bind(this)),this.$autoExecute.on("click",this.onAutoExecuteChange.bind(this))},appendOption:function(e,t){this.$subscriptionKey.append($("<option>",{value:e,text:t}))},enableStreamingOnly:function(e){this.$static.toggle(!e),this.$polling.toggle(!e),this.$subscription.toggle(!this.isLite&&!e),this.$streaming.toggle(e);var t=this.model.get(this.SUBCRIPTION_PROPERTY);({static:this.$static,polling:this.$polling,subscription:this.$subscription,streaming:this.$streaming})[e?"streaming":"streaming"===t?"static":t].find("input").prop("checked",!0).trigger("change")},onAutoExecuteChange:function(e){this.model.set(QuickBase.DocumentDataModel.AUTO_EXECUTE,$(e.target).prop("checked"))},onInputForceResetChange:function(e){this.model.set(this.FORCE_RESET_PROPERTY,$(e.currentTarget).is(":checked"))},onInputSubscriptionKeyChange:function(e){this.model.set(this.SUBSCRIPTION_KEY_PROPERTY,$(e.currentTarget).val()),Log.Info("Subscription Key Change "+this.SUBSCRIPTION_KEY_PROPERTY,$(e.currentTarget).val())},onInputSubscriptionChange:function(e){e=$(e.currentTarget).val();e&&this.model.set(this.SUBCRIPTION_PROPERTY,e)},onModelAutoExecuteChange:function(){this.$autoExecute.prop("checked",this.model.get(QuickBase.DocumentDataModel.AUTO_EXECUTE))},onModelColumnsChange:function(){this.updateSubscriptionKeyMenu(this.model.get(this.COLUMNS_PROPERTY))},onModelDataTypeChange:function(){var e=this.model.get(this.DATA_TYPE_PROP),t=this.model.get(this.DATA_SOURCE_PROP),n=this.$el.closest(".subscription").siblings(".function").find("input:checked");"analytic"===e?this.enableStreamingOnly(!n.hasClass("analytic")&&"streaming"===this.model.get("_subscriptionType")||n.hasClass("streaming")):"builder"===e?this.enableStreamingOnly(this.hasStreamingNode):(this.$static.show(),this.$polling.show(),this.$streaming.toggle(this.isLite?"builder"===e&&this.hasStreamingNode||"streaming"===e:"analytic"===e&&"sql"!==t),this.$subscription.toggle(!this.isLite&&"sql"!==t&&"virtual"!==e),n=this.$el.find("input:checked")[0],-1===this.$el.find("input:visible").toArray().indexOf(n)&&this.$static.find("input").prop("checked",!0).trigger("change"))},onModelGraphChange:function(){var e;"builder"===this.model.get(this.DATA_TYPE_PROP)&&(e=this.model.get("_graphJSON"),this.hasStreamingNode=!_.isEmpty(e)&&_.some(JSON.parse(e).nodes,function(e){return"stream"===e.group}),this.enableStreamingOnly(this.hasStreamingNode))},onModelSubscriptionKeyChange:function(){"polling"!==this.model.get(this.SUBSCRIPTION_KEY_PROPERTY)&&"subscription"!==this.model.get(this.SUBSCRIPTION_KEY_PROPERTY)||this.debouncedUpdateSubscriptionKeyMenu()},onModelForceResetChange:function(){this.$forceResetCheck.prop("checked",!0===this.model.get(this.FORCE_RESET_PROPERTY))},onModelSubscriptionChange:function(){var e,t=this.$el.find("."+this.model.get(this.SUBCRIPTION_PROPERTY));this.$subscriptionCheckedRadio&&t!==this.$subscriptionCheckedRadio&&this.$subscriptionCheckedRadio.removeAttr("checked"),_.defer(function(){t.prop("checked",!0)}),"static"===(this.$subscriptionCheckedRadio=t).val()?this.$intervalSelectContainer.parent().hide():(e="streaming"===t.val()?"none":"inline-block",this.$intervalSelectContainer.parent().css("display",e),this.debouncedUpdateSubscriptionKeyMenu())},remove:function(){this.model.unsubscribe(this.subscriptionKey),Backbone.View.prototype.remove.call(this)},resetOptions:function(){this.$subscriptionKey.find("option").remove(),this.appendOption("","Row Num")},reset:function(){this.model.set(this.SUBSCRIPTION_KEY_PROPERTY,""),this.resetOptions()},updateSubscriptionKeyMenu:function(e){var t=this;e&&(t.resetOptions(),0<e.length?_.each(e,function(e){t.$subscriptionKey.append($("<option>",{value:e,text:e}))}):t.model.get(t.SUBSCRIPTION_KEY_PROPERTY)&&t.$subscriptionKey.append($("<option>",{value:t.model.get(t.SUBSCRIPTION_KEY_PROPERTY),text:t.model.get(t.SUBSCRIPTION_KEY_PROPERTY)}))),t.model.get(t.SUBSCRIPTION_KEY_PROPERTY)?t.$subscriptionKey.val(t.model.get(t.SUBSCRIPTION_KEY_PROPERTY)):t.model.set(t.SUBSCRIPTION_KEY_PROPERTY,t.$subscriptionKey.val())}}),DataConfigAnalytic=(A$=Backbone.View,__extends(B$,A$),B$.prototype.onModelConnectionChange=function(){this.options.appModel.get("isLite")&&this.updateLite()},B$.prototype.createJsTreeJSON=function(e,t,n){return{id:e,text:t,state:{selected:e===this.selectedAnalytic},children:[],type:n}},B$.prototype.getParams=function(){var e,t=this.parametersPanel.getParams();return this.ignoreParamsChanges=!0,this.model.set(((e={_analyticParams:t})[this.getParametersProperty()]=t,e)),this.ignoreParamsChanges=!1,t},B$.prototype.generateAnalyticParametersObject=function(e){var a=this,s=(this.selectedAnalyticParams=[],this.getParametersProperty());this.isStreaming()&&this.options.appModel.get("isLite")&&this.selectedAnalytic&&0===e.length&&e.push({name:"x",type:"Symbol"}),e.forEach(function(e){var t,n=null,i=null,o=_.find(a.model.get(s),{name:e.name});o&&(t=_.find(a.model.get(s),function(e){return e.id===o.id}))&&(i=t.value,n=t.type),a.selectedAnalyticParams.push({id:e.name,name:e.name,type:n||a.modifyParameterType(e.type),description:e.description||"",required:e.required||!1,value:i||e.value,isViewState:!(!o||!o.isViewState)})}),this.parametersPanel&&(this.parametersPanel.model.set({Parameters:this.selectedAnalyticParams}),this.getParams())},B$.prototype.getParametersProperty=function(){return this.isStreaming()?"_streamingParameters":"_analyticParameters"},B$.prototype.isStreaming=function(){return"streaming"===this.model.get("_subscriptionType")},B$.prototype.jstreeSearch=function(e){this.$tree.jstree(!0).show_all(!1),this.$tree.jstree().search(e)},B$.prototype.modifyParameterType=function(e){var t={Character:"Char",Integer:"Int"}[e];return t||e},B$.prototype.onModelAnalyticChange=function(){this.selectedAnalytic=this.model.get("_selectedAnalytic"),this.updateAnalyticUI(),this.model.forceRender&&(this.$tree.jstree("deselect_node",this.$tree.jstree("get_selected")[0]),this.$tree.jstree("select_node",this.selectedAnalytic),this.debouncedScrollToSelection())},B$.prototype.onModelAnalyticParamsChange=function(){this.ignoreParamsChanges||this.model.hasChanged("_selectedAnalytic")||this.updateAnalyticUI()},B$.prototype.onResize=function(){},B$.prototype.remove=function(){return this.parametersPanel&&(this.parametersPanel.remove(),delete this.parametersPanel),Backbone.View.prototype.remove.call(this)},B$.prototype.renderTree=function(e){var c,d=this,n=this,i=[];n.options.appModel.get("isLite")?(c={},_.each(e,function(o,e){var a=_.filter(e.split("."),function(e){return""!==e}),s=1===a.length&&e==="."+a[0],l=1<a.length||s?".":"",r=i;_.each(a,function(e,t){var n,i=l+e,t=t<a.length-1;t?(void 0===(n=c[i])&&(n=c[i]=d.createJsTreeJSON(i,(t||s?".":"")+e,t?"namespace":o),r.push(n)),r=n.children,l=i+"."):r.push(d.createJsTreeJSON(i,e,o))})})):_.each(e,function(e,t){var n=i.push(d.createJsTreeJSON(t,t,e?"namespace":d.analytics[t].streaming?"streaming":"analytic"));e&&_.each(e,function(e){i[n-1].children.push(d.createJsTreeJSON(e,e,d.analytics[e].streaming?"streaming":"analytic"))})}),require(["jstree"],function(){d.$tree&&d.$tree.jstree("destroy"),d.$tree.jstree({core:{data:i,multiple:!1},conditionalselect:function(e,t){return 0===e.children.length},types:{table:{icon:"fa fa-table"},analytic:{icon:"fa fa-line-chart"},namespace:{icon:"fa fa-folder"},streaming:{icon:n.options.appModel.get("isLite")?"fa fa-table streaming-icon":"fa fa-line-chart streaming-icon"}},search:{show_only_matches:!0,show_only_matches_children:!0},plugins:["conditionalselect","types","search","wholerow"]}),d.$tree.on("select_node.jstree",function(e,t){t&&(n.model.get("_selectedAnalytic")!==t.node.id&&n.options.subscriptionSelect.reset(),n.model.set("_selectedAnalytic",t.node.id))}),d.$tree.on("deselect_node.jstree",function(e,t){n.model.forceRender||n.model.set("_selectedAnalytic","")}),d.$tree.on("search.jstree",function(e,t,n){0===t.nodes.length&&d.$tree.jstree(!0).hide_all(!1)}),d.$tree.one("ready.jstree",d.scrollToSelection.bind(d))})},B$.prototype.scrollToSelection=function(){var e=this.selectedAnalytic;e&&(e=e.replace(/\./g,"\\."),(e=this.$tree.find("#"+e)[0])&&(this.$tree[0].scrollTop=e.offsetTop-this.$tree[0].offsetTop))},B$.prototype.standardSort=function(e){return e.sort(function(e,t){return e.localeCompare(t)})},B$.prototype.updateDelta=function(){var o=this;QuickBase.DeltaClientLib.getDeltaAnalytics(function(e){var t=_.reduce(e,function(t,n,e){return o.isStreaming()&&!n.streaming||!o.isStreaming()&&n.streaming||(0<n.groups.length?_.each(n.groups,function(e){t[e]||(t[e]=[]),t[e].push(n.name),o.analytics[n.name]=n}):(t[n.name]=!1,o.analytics[n.name]=n)),t},{}),n={},i={},e=(_.each(o.standardSort(_.keys(t)),function(e){t[e]?n[e]=o.standardSort(t[e]):i[e]=t[e]}),_.extend(n,i));o.renderTree(e),o.updateAnalyticUI()})},B$.prototype.updateLite=function(){function e(){QuickBase.DashClient.getQueryData("q",n,B$.LITE_FN_LIST,[],o,a)}var t=this,n=this.model.get("_connection"),i=this.isStreaming(),o=function(e){t.analytics={},i&&_.every(e.meta,function(e){return 11==e})&&e.rows[0]?_.values(e.rows[0]).sort(function(e,t){return e.localeCompare(t)}).forEach(function(e){0!==e.indexOf("01000000")&&(t.analytics[e]={name:e,parameters:[],type:"streaming"})}):e.rows.sort(function(e,t){return e.name.localeCompare(t.name)}).forEach(function(e){i===(1==e.streaming)&&(t.analytics[e.name]={name:e.name,parameters:e.parameters?_.filter(e.parameters.rows,function(e){return!!e.name}):[],type:e.streaming?"streaming":"analytic"})}),t.renderTree(_.fromPairs(_.keys(t.analytics).map(function(e){return[e,t.analytics[e].type]}))),t.updateAnalyticUI()},a=function(e){t.analytics={},t.renderTree({}),t.updateAnalyticUI()};try{i?QuickBase.DashClient.getQueryData("q",n,".u.t",[],o,e):QuickBase.DashClient.runAnalytic(".api.getFunctions",n,[],o,e)}catch(e){a(e)}},B$.prototype.updateAnalyticUI=function(){var e=this.analytics[this.selectedAnalytic];"analytic"===this.model.get("_dataType")&&e&&this.generateAnalyticParametersObject(e&&e.parameters||[])},B$.LITE_FN_LIST='kys: raze (raze k!{@[{ {".",(string y),".",string x}[;x] each key[`$".",string x] };x;{`}]} each k: (key `) except `j`q`Q`h`o`u; string key `.); select name,parameters:{flip `name`type!(x 1;`Symbol)} each parameters from ({`name`parameters!((`$x);(value (value x))) } each exec name from ({ `name`t!(x;type value x) } each kys) where (not (name like "*.")) and t=100h)',B$),A$;function B$(e){var t=A$.call(this,e)||this,n=(t.ignoreParamsChanges=!1,t.selectedAnalytic="",t.selectedAnalyticParams=[],t.subscriptionSelect=null,t.analytics={},t.options=e,t.$el.addClass("data-config-analtyic"),t.$el.attr("id",t.options.analyticGuid),t.$el.html(T.DataConfigAnalytic()),t.$tree=t.$el.find(".pnlAnalyticsTree"),t.$search=t.$el.find(".searchBox"),t.$clearSearch=t.$el.find(".clearSearch"),t.selectedAnalytic=t.model.get("_selectedAnalytic"),t.parametersPanel=new AnalyticParamsView({el:t.$el.find(".paramsView"),dialogContainer:t.options.dialogContainer,docDataModel:t.options.docDataModel,docViewModel:t.options.docViewModel,model:new Backbone.Model({Parameters:[]}),analyticModel:t.model,possibleTypes:t.options.appModel.get("isLite")&&t.isStreaming()?["symbol","list"]:[]}),t.listenTo(t.parametersPanel,"ParamItemChanged",t.getParams),t.options.appModel.get("isLite")?t.updateLite():t.updateDelta(),_.debounce(t.jstreeSearch.bind(t),250));return t.debouncedScrollToSelection=_.debounce(t.scrollToSelection,100),t.$search.keyup(function(e){e=e.target.value;e?t.$clearSearch.show():t.$clearSearch.hide(),n(e)}),t.$clearSearch.click(function(e){t.$search.val("").trigger("keyup")}),t.model.set(t.getParametersProperty(),t.model.get("_analyticParams")),t.listenTo(t.model,"change:_selectedAnalytic",t.onModelAnalyticChange),t.listenTo(t.model,"change:"+t.getParametersProperty(),t.onModelAnalyticParamsChange),t.listenTo(t.model,"change:_connection",t.onModelConnectionChange),t}var DataConfigMappingItem=(kaa=Backbone.View,__extends(laa,kaa),laa.prototype.initializeEvents=function(){this.listenTo(this.model,"destroy",this.remove),this.listenTo(this.model,"change:key",this.onModelMappingKeyChange),this.listenTo(this.model,"change:value",this.onModelMappingValueChange),this.$removeMapping.click(this.onRemoveMapping.bind(this)),this.$keySelect.on("select2:select",function(e){this.model.set("key",e.params.data.id)}.bind(this)),this.$keySelect.on("select2:open",this.setSelectClasses)},laa.prototype.onModelMappingKeyChange=function(){this.model.set("value",this.dataMapper.getValue(this.model.get("key")))},laa.prototype.onModelMappingValueChange=function(){this.$value.text(this.model.get("value"))},laa.prototype.onRemoveMapping=function(){this.model.destroy()},laa.prototype.onResize=function(){},laa.prototype.remove=function(){return Backbone.View.prototype.remove.call(this)},laa.prototype.render=function(){return this.$el.html(T.DataConfigMappingItem(this.model.toJSON())),this.$keySelect=this.$el.find(".key-select"),this.$removeMapping=this.$el.find(".remove-mapping"),this.$value=this.$el.find(".value"),this.$viewState=this.$el.find(".view-state"),this.$keySelect.select2({tags:!0,theme:"dashboards",width:"100%"}),this.$removeMapping.button({icons:{primary:"fa fa-minus"},text:!1}),this.viewStateEditor=new Backbone.Form.editors.ViewState({id:_.uniqueId("date_"),key:"viewstate",model:this.model,openViewStateDialog:this.openViewStateDialog}).render(),this.viewStateEditor.on("change",function(){this.model.set("viewstate",this.viewStateEditor.getValue())}.bind(this)),this.setSelectOptions(),this.$viewState.append(this.viewStateEditor.el),this},laa.prototype.setSelectOptions=function(){var e=_.union([this.model.get("key")],this.dataMapper.getPossibleKeys());this.$keySelect.empty(),_.each(e,function(e){this.$keySelect.append(new Option(e,e,!0,!0))}.bind(this)),this.$keySelect.val(this.model.get("key")).trigger("change")},laa),kaa;function laa(e){var t=kaa.call(this,_.extend(e,{tagName:"div"}))||this;return t.tagName="tr",t.dataMapper=e.dataMapper,t.openViewStateDialog=e.openViewStateDialog,t.setSelectClasses=e.setSelectClasses,t.render(),t.initializeEvents(),t.onModelMappingKeyChange(),t}var DataConfigMapping=(raa=Backbone.View,__extends(saa,raa),saa.prototype.initializeEvents=function(){this.listenTo(this.dataMapper,"key-change",this.onModelMappingKeyChange),this.listenTo(this.dataMapper,"mappings-change",this.renderMappings),this.listenTo(this.dataMapper,"on-data",this.onData),this.listenTo(this.dataMapper,"value-change",this.onModelMappingValueChange),this.$keySelect.on("select2:select",function(e){this.model.set("key",e.params.data.id)}.bind(this)),this.$valueSelect.on("select2:select",function(e){this.model.set("value",e.params.data.id)}.bind(this)),this.$keySelect.on("select2:open",this.setSelectClasses),this.$valueSelect.on("select2:open",this.setSelectClasses),this.$addMapping.click(_.bind(this.dataMapper.addMapping,this.dataMapper)),this.$resetMapping.click(_.bind(this.dataMapper.resetMappings,this.dataMapper))},saa.prototype.onData=function(){this.setSelectOptions(),this.renderMappings()},saa.prototype.onModelMappingKeyChange=function(){this.$keySelect.val(this.model.get("key")).trigger("change"),_.each(this.mappingViews,function(e){e.setSelectOptions()}.bind(this))},saa.prototype.onModelMappingValueChange=function(){this.$valueSelect.val(this.model.get("value")).trigger("change")},saa.prototype.onResize=function(){this.setScrollClasses()},saa.prototype.openViewStateDialog=function(e,t){new ViewStateDialog({dialogContainer:this.dialogContainer,docDataModel:this.docDataModel,model:this.docViewModel,path:e,selectCallback:function(e){e=this.docViewModel.getByPath(e);t(e)}.bind(this)}),$(".viewstate-dialog").css("z-index",102)},saa.prototype.remove=function(){return this.$keySelect.data("select2")&&this.$keySelect.select2("destroy"),this.$valueSelect.data("select2")&&this.$valueSelect.select2("destroy"),this.dataMapper.setSubscription(!1),Backbone.View.prototype.remove.call(this)},saa.prototype.removeMapping=function(e){this.dataMapper.removeMapping(e)},saa.prototype.render=function(e){return this.$el.html(T.DataConfigMapping({theme:"kx-light"!==$.cookie("dashboard-theme")?"Dark":"Light",singleValue:e})),this.$addMapping=this.$el.find(".add-mapping"),this.$mappings=this.$el.find(".table-body"),this.$mappingTable=this.$el.find(".mapping-table"),this.$keySelect=this.$el.find(".key-select"),this.$resetMapping=this.$el.find(".reset-mapping"),this.$valueSelect=this.$el.find(".value-select"),this.$addMapping.button({icons:{primary:"fa fa-plus"},text:!1}),this.$resetMapping.button({icons:{primary:"fa fa-undo"},text:!1}),this.$keySelect.select2({theme:"dashboards",width:"100%"}),this.$valueSelect.select2({theme:"dashboards",width:"100%"}),this.renderMappings(),this},saa.prototype.renderMappings=function(){_.each(this.mappingViews,function(e){this.stopListening(e.model),e.remove()}.bind(this)),this.mappingViews=[],this.dataMapper.mappings.each(function(e,t){t=new DataConfigMappingItem({className:"slick-row "+(t%2==0?"even":"odd"),dataMapper:this.dataMapper,model:e,openViewStateDialog:this.openViewStateDialog.bind(this),setSelectClasses:this.setSelectClasses.bind(this)});this.listenTo(e,"destroy",this.removeMapping),this.mappingViews.push(t),this.$mappings.append(t.$el)}.bind(this)),this.setScrollClasses()},saa.prototype.setScrollClasses=function(){this.$mappingTable.toggleClass("has-scrollbar",this.$mappings.get(0).scrollHeight>this.$mappings.height())},saa.prototype.setSelectClasses=function(){$("body > .select2-container--dashboards.select2-container--open").addClass("select2--environment")},saa.prototype.setSelectOptions=function(){var e=_.union([this.model.get("key"),this.model.get("value")],this.dataMapper.getColumns());this.$keySelect.empty(),this.$valueSelect.empty(),_.each(e,function(e,t){this.$keySelect.append(new Option(e,e,0===t,this.model.get("key")===e)),this.$valueSelect.append(new Option(e,e,0===t,this.model.get("value")===e))}.bind(this)),this.$keySelect.trigger("change"),this.$valueSelect.trigger("change")},saa),raa;function saa(e){var t=raa.call(this,e)||this;return t.tagName="div",t.dataMapper=e.dataMapper,t.docDataModel=e.docDataModel,t.docViewModel=e.docViewModel,t.model=t.dataMapper.model,t.mappings=t.dataMapper.mappings,t.viewModel=new Backbone.Model,t.render(),t.setSelectOptions(),t.initializeEvents(),t.onModelMappingKeyChange(),t.onModelMappingValueChange(),require(["Datagrid"]),t}var ConnectionManagement=(Laa=Backbone.View,__extends(Maa,Laa),Maa.prototype.openDialog=function(){var e,t,n;this.positionDialog(),this.$dialog.dialog("open"),this.launchObject&&(n=t=e=void 0,(e=this.connections.get(this.launchObject))?(this.currentConnection=this.launchObject,n="connection",t=0):(e=this.connectionGroups.get(this.launchObject))?(this.currentGroup=this.launchObject,n="group",t=1):(e=this.services.get(this.launchObject))&&(this.currentServices=this.launchObject,n="services",t=2),e&&void 0!==t&&(this.$el.find(".connectionsTabs").tabs({active:t}),this.launchObject="",this.setSelectedRows(),this.loadConnectionDetails(n,e.id)))},Maa.prototype.remove=function(){return this.$el.dialog("close"),this.multiselectDatagridWrapper.remove(),this.groupDatagridAppWrapper&&this.groupDatagridAppWrapper.remove(),this.datagridAppWrapper.remove(),this.trigger("onRemove"),Backbone.View.prototype.remove.call(this)},Maa.prototype.setDOMObjects=function(){this.$statusBar=this.$el.find(".statusBar"),this.$connectionDetailsPanel=this.$el.find(".connectionDetailsPanel"),this.$groupDetailsPanel=this.$el.find(".groupDetailsPanel")},Maa.prototype.setSelectedRows=function(){this.datagridAppWrapper.app&&this.datagridAppWrapper.app.grid&&this.selectedConnection.set("value",this.currentConnection),this.connectionGroups&&this.datagridAppWrapper.app&&this.groupDatagridAppWrapper.app.grid&&this.selectedGroup.set("value",this.currentGroup),this.services&&this.serviceDatagridAppWrapper&&this.serviceDatagridAppWrapper.app&&this.serviceDatagridAppWrapper.app.grid&&this.selectedServices.set("value",this.currentServices)},Maa.prototype.disableNewDuplicateEditButtons=function(){$(this.$editButtons[0]).button("disable"),$(this.$editButtons[1]).button("disable"),$(this.$editButtons[2]).button("disable")},Maa.prototype.enableNewDuplicateEditButtons=function(){$(this.$editButtons[0]).button("enable"),$(this.$editButtons[1]).button("enable"),$(this.$editButtons[2]).button("enable")},Maa.prototype.getTheme=function(){return"kx-light"===$.cookie("dashboard-theme")?"Light":"Dark"},Maa.prototype.onBtnNewClick=function(){switch(this.disableNewDuplicateEditButtons(),this.currentTab){case"Individual":return this.setTitle("Connection Management: New Connection"),this.isCreatingSingle=!0,this.$connectionDetailsPanel.show(),this.$groupDetailsPanel.hide(),this.enableInputs("connection"),this.$el.find(".saveConnectionBtn").show(),void this.$el.find(".cancelBtn").show();case"Groups":return this.setTitle("Connection Management: New Connection Group"),this.isCreatingGroup=!0,this.$groupDetailsPanel.show(),this.$connectionDetailsPanel.hide(),this.multiSelection.set("value",[]),this.enableInputs("group"),this.$el.find(".saveGroupBtn").show(),this.$el.find(".cancelBtn").show(),void this.$el.find(".groupName").prop("disabled","")}},Maa.prototype.onBtnDeleteClick=function(){switch(this.currentTab){case"Individual":return void this.deleteConnectionConfirm(this.deleteConnection.bind(this),this.$connectionDetailsPanel.find(".title")[0].innerText);case"Groups":return void this.deleteConnectionConfirm(this.deleteGroup.bind(this),this.$groupDetailsPanel.find(".title")[0].innerText)}},Maa.prototype.onBtnSaveClick=function(){this.enableNewDuplicateEditButtons(),this.$el.find(".groupName").prop("disabled","disabled"),this.isCreatingSingle||this.isCreatingGroup?"Individual"===this.currentTab?(this.createConnection(),this.isCreatingSingle=!1):(this.createGroup(),this.isCreatingGroup=!1):"Individual"===this.currentTab?this.editConnection():this.editGroup()},Maa.prototype.onBtnDuplicateClick=function(){switch(this.currentTab){case"Individual":return void this.createConnection(!0);case"Groups":return void this.createGroup(!0)}},Maa.prototype.createConnection=function(e){var n,i,o,a=this,s=this.$connectionDetailsPanel.find(".name").val()+(e?" (Copy)":""),e=this.$connectionDetailsPanel.find(".password").val();e!==this.$connectionDetailsPanel.find(".confirmPassword").val()?this.showError("Password and password confirmation don't match.",""):(n=(o=this.getHostPortDriver()).host,i=o.port,o=o.driver,this.connections.create({name:s,host:n,port:i,user:this.$connectionDetailsPanel.find(".user").val(),password:e,type:this.$connectionDetailsPanel.find(".type option:selected").val(),driver:o,tls:this.$el.find(".tls").is(":checked")?"on":"off"},{success:function(){a.isCreatingSingle=!1,a.currentConnection=s,a.populateConnectionsList(),a.populateConnectionGroupsList(),a.showMessageAndRefresh("Connection created successfully")},error:function(e){return a.showError(t("Error creating connection."),e)}}))},Maa.prototype.getHostPortDriver=function(){var e=this.$connectionDetailsPanel.find(".type option:selected").val(),t=this.$connectionDetailsPanel.find(".database").val(),n=this.$connectionDetailsPanel.find(".host").val(),i=this.$connectionDetailsPanel.find(".port").val(),o=this.$connectionDetailsPanel.find(".driver").val();switch(e){case"jdbc:com.mysql.jdbc.Driver":n="jdbc:mysql://"+n+":"+i+"/"+t+"?socketTimeout=35000",i=0,o="";case"jdbc:oracle.jdbc.OracleDriver":n="jdbc:oracle:thin:@"+n+":"+i+":"+t,i=0,o="";case"jdbc:com.microsoft.sqlserver.jdbc.SQLServerDriver":n="jdbc:sqlserver://"+n+":"+i+";databaseName="+t+";",i=0,o="",this.$el.find(".integratedSecurity").is(":checked")&&(n+="integratedSecurity=true;");case"daemon":i=0}return{host:n,port:i,driver:o}},Maa.prototype.createGroup=function(e){for(var n=this,i=e?this.$el.find(".groupName").val()+" (copy)":this.$el.find(".groupName").val(),o=this.multiSelection.get("value"),a=[],e=this.$el.find(".groupType").val(),s=0;s<o.length;s+=1)a.push("primary");new QuickBase.ConnectionGroup({name:i,type:e,connections:o,connectionsType:a}).sync("create",this.connectionGroups,{success:function(e){n.currentGroup=i,n.isCreatingGroup=!1,n.populateConnectionGroupsList(),n.showMessageAndRefresh("Connection group created successfully"),Log.Info("success",e)},error:function(e){return n.showError(t("Error creating connection group."),e)}})},Maa.prototype.createStatusBar=function(){var e=(1e6*Math.random()).toFixed()+"-statusBar",t=document.createElement("div");t.classList.add("statusBar"),t.classList.add(e),this.$el[0].parentElement.appendChild(t),this.$statusBar=$("."+e)},Maa.prototype.deleteConnectionConfirm=function(e,n){QuickBase.ConfirmDialog.ShowConfirm({callback:function(){e&&e(n)},renderTemplate:function(){return t("Are you sure you want to delete connection/Group?")},container:this.$el})},Maa.prototype.deleteConnection=function(e){var n=this;this.connections.get(e).destroy({success:function(e){n.populateConnectionsList(),n.populateConnectionGroupsList(),n.showMessageAndRefresh("Connection deleted successfully"),Log.Info("success",e)},error:function(e){return n.showError(t("Error deleting connection."),e)}})},Maa.prototype.deleteGroup=function(e){var n=this;this.connectionGroups.get(e).destroy({success:function(e){n.populateConnectionGroupsList(),n.showMessageAndRefresh("Connection group deleted successfully"),Log.Info("success",e)},error:function(e){n.showError(t("error creating connection group."),e)}})},Maa.prototype.editConnection=function(){var e,n,i,o,a=this,s=this.$connectionDetailsPanel.find(".password").val();s!==this.$connectionDetailsPanel.find(".confirmPassword").val()?this.showError("Password and password confirmation don't match.",""):(e=(i=this.getHostPortDriver()).host,n=i.port,i=i.driver,o=this.currentConnection,this.currentConnection=this.$el.find("input.name").val(),this.connections.get(o).save({name:o,originalName:this.currentConnection,host:e,port:n,user:this.$el.find("input.user").val(),password:s,type:this.$el.find(".type option:selected").val(),driver:i,tls:this.$el.find(".tls").is(":checked")?"on":"off"},{success:function(){a.populateConnectionsList(),a.populateConnectionGroupsList(),a.setSelectedRows(),a.showMessageAndRefresh("Connection edited successfully")},error:function(e){return a.showError(t("Error editing connection."),e)}}))},Maa.prototype.editGroup=function(){var n=this,e=this.multiSelection.get("value"),e={name:this.$el.find(".groupName").val(),originalName:this.currentGroup,connections:e,type:this.$el.find(".groupType").val()};this.connectionGroups.get(e.originalName).save(e,{success:function(){n.populateConnectionGroupsList(),n.showMessageAndRefresh("Connection edited successfully")},error:function(e){return n.showError(t("Error editing connection group."),e)}})},Maa.prototype.enableInputs=function(e){"connection"===e?(this.$connectionDetailsPanel.find(".title").text(t("New Connection")),this.$connectionDetailsPanel.find("input").removeAttr("readonly"),this.$connectionDetailsPanel.find("input").val(""),this.$connectionDetailsPanel.find("select").removeAttr("disabled"),this.$connectionDetailsPanel.find(".tls").removeAttr("disabled")):"group"===e&&(this.$groupDetailsPanel.find(".title").text(t("New Group")),this.$groupDetailsPanel.find("input").removeAttr("readonly").val(""),this.$groupDetailsPanel.find("select").removeAttr("disabled"),this.$el.find(".multipleSelect").show())},Maa.prototype.initializeDialogDisplay=function(){var n=this;this.connectionGroups?(this.populateConnectionGroupsList(),this.$el.find(".connectionsTabs").tabs({active:0,activate:function(e,t){n.currentTab=t.newTab[0].innerText,n.$editButtons.each(function(e,t){$(t).button("enable")}),"Groups"===n.currentTab?(n.$groupDetailsPanel.show(),n.groupDatagridAppWrapper.app.onResize(),n.multiselectDatagridWrapper.app.onResize(),n.setTitle("Connection Management: "+n.currentGroup),n.isCreatingGroup&&(n.disableNewDuplicateEditButtons.call(n),n.setTitle("Connection Management: New Connection Group"))):0===n.currentTab.localeCompare("Services")?(n.setTitle("Connection Management"),n.$editButtons.each(function(e,t){$(t).button("disable")}),n.serviceDatagridAppWrapper.app.onResize()):(n.$connectionDetailsPanel.show(),n.setTitle("Connection Management: "+n.currentConnection),n.datagridAppWrapper.app.onResize(),n.isCreatingSingle&&(n.disableNewDuplicateEditButtons(),n.setTitle("Connection Management: New Connection")))}})):(this.$el.find(".connectionsTabs > ul").hide(),this.$el.find(".connectionsList").css("top","-8px"),this.populateConnectionsList())},Maa.prototype.loadConnectionDetails=function(e,t){var n;"group"===e?(n=this.connectionGroups.get(t)||this.connectionGroups.first(),this.$el.find(".groupDetailsPanel").show(),this.currentGroup=n?n.get("name"):null):(n=this.connections.get(t)||this.connections.first(),this.$connectionDetailsPanel.show(),n&&this.onTypeChange(n.get("type")),this.currentConnection=n?n.get("name"):null),n&&this.populateDetailsPanel(e,n.attributes)},Maa.prototype.onTypeChange=function(e){_.includes(["q","daemon"],e)?(this.$el.find(".databaseRow").hide(),this.$el.find(".integratedSecurityRow").hide()):(this.$el.find(".databaseRow").show(),"jdbc:com.microsoft.sqlserver.jdbc.SQLServerDriver"===e&&this.$el.find(".integratedSecurityRow").show())},Maa.prototype.parseJdbcHost=function(e,t){var n,i,o,a,s,e=e.host,l=!1,r="database";"jdbc:com.mysql.jdbc.Driver"===this.$el.find(".type").val()?(n="jdbc:mysql://",s="mysql"):"jdbc:oracle.jdbc.OracleDriver"===this.$el.find(".type").val()?(n="jdbc:oracle:thin:@",s="oracle"):"jdbc:com.microsoft.sqlserver.jdbc.SQLServerDriver"===this.$el.find(".type").val()&&(n="jdbc:sqlserver://",s="mssql"),"mssql"!==s?(i=(e=e.substring(n.length)).split(":")[0],o=e.split(":")[1].split("/")[0],"mysql"===s?a=e.split(":")[1].split("/")[1].split("?")[0]:(a=e.split(":")[2],r="SID")):(i=(e=e.substring(n.length)).split(":")[0],o=e.split(":")[1].split(";")[0],a=e.split(":")[1].split("=")[1],2<e.split(":").length&&(l=-1<e.split(":")[2].indexOf("true"))),t.find(".integratedSecurity").prop("checked",l),t.find(".databaseRow label").text(r+":"),t.find(".host").val(i),t.find(".port").val(o),t.find(".database").val(a)},Maa.prototype.populateConnectionsList=function(){var i=this,o=this.$el.find(".singleConnectionsList ul");require(["Datagrid"],function(e){var n=new QuickBase.DocumentDataModel({_subscriptionKey:"name",_dataType:"copy",_maxRows:1e5},null,null,i.docViewModel),e=(n.apply(),i.selectedConnection=new QuickBase.DocumentViewModel({_default:i.currentConnection,_viewType:!0,_type:"symbol",value:i.currentConnection},{}),i.selectedConnection.path="dg_connection",i.listenTo(i.selectedConnection,"change:value",function(e,t){i.enableNewDuplicateEditButtons(),i.isCreatingSingle=!1,t&&(i.loadConnectionDetails("connection",t),i.currentConnection=t)}),e.getSettingsModel({Basics:{Data:n,Filtering:"Column Filters",ShowPagingControl:!1,EnableGrouping:!1},ColumnsConfiguration:[e.getColumnSettingsModel({Field:"name",TextAlign:"left"})],Selection:{Mode:"Single Row",RowSelectionColumn:"name",SelectedValue:i.selectedConnection,FollowSelectedValue:!0},FileExport:{ShowExportCsvButton:!1,ShowExportExcelButton:!1},Style:{FontSize:"11px",RowHeight:20,HeaderRowHeight:20}}));i.datagridAppWrapper=new QuickBase.AppView({el:i.$el.find(".singleConnectionsListGrid")[0],key:"Datagrid",settings:e,dashboardViewModel:new Backbone.Model({DashboardTheme:i.getTheme()}),dashboardAppModel:new Backbone.Model,docViewModel:i.docViewModel,deltaClient:null,callback:function(){i.connections.fetch({success:function(e){var t=e.map(function(e){return e.get("name")}).map(function(e){return'<li data-type="connection" data-value="'+_.escape(e)+'"><span class="conn_title">'+e+'</span><span class="deleteItem fa fa-trash-o"></li>'}).join("\n");o.html(""),o.append(t),n.onExecuteSuccess({class:"",columns:["name"],meta:{name:11},rows:e.map(function(e){return e.attributes})},!0),$(".ui-state-default.slick-headerrow-column.l0.r0 input")[0].setAttribute("placeholder","search connections..."),i.populateMultiSelect()},error:function(e){return alert(e)}})}})},function(e){console.log("DataConfigAnalytic.js: Datagrid initialization error",e)})},Maa.prototype.populateConnectionGroupsList=function(){var i=this,o=this.$el.find(".groupConnectionsList ul");this.connectionGroups&&require(["Datagrid"],function(e){var n=new QuickBase.DocumentDataModel({_subscriptionKey:"name",_dataType:"copy",_maxRows:1e5},null,null,null),e=(n.apply(),i.selectedGroup=new QuickBase.DocumentViewModel({_default:i.currentGroup,_viewType:!0,_type:"symbol",value:i.currentGroup},{}),i.selectedGroup.path="dg_group",i.listenTo(i.selectedGroup,"change:value",function(e,t){i.enableNewDuplicateEditButtons.call(i),i.$el.find(".groupName").prop("disabled","disabled"),i.isCreatingGroup=!1,t&&(i.loadConnectionDetails("group",t),i.currentGroup=t)}),e.getSettingsModel({Basics:{Data:n,Filtering:"Column Filters",ShowPagingControl:!1,EnableGrouping:!1},ColumnsConfiguration:[e.getColumnSettingsModel({Field:"name",TextAlign:"left"})],Selection:{Mode:"Single Row",RowSelectionColumn:"name",SelectedValue:i.selectedGroup,FollowSelectedValue:!0},FileExport:{ShowExportCsvButton:!1,ShowExportExcelButton:!1},Style:{FontSize:"11px",RowHeight:20,HeaderRowHeight:20}}));i.groupDatagridAppWrapper=new QuickBase.AppView({el:i.$el.find(".groupConnectionListGrid")[0],key:"Datagrid",settings:e,dashboardViewModel:new Backbone.Model({DashboardTheme:i.getTheme()}),dashboardAppModel:new Backbone.Model,docViewModel:i.docViewModel,deltaClient:null,callback:function(){i.connectionGroups.fetch({success:function(e){var t=e.map(function(e){return'<li data-type="group" data-value="'+_.escape(e.get("name"))+'"><span class="conn_title">'+e.get("name")+":</span> ("+e.get("connections").join(", ")+') <span class="deleteItem fa fa-trash-o"></span></li>'}).join("\n");o.html(t),n.onExecuteSuccess({class:"",columns:["name"],meta:{name:11},rows:e.map(function(e){return e.attributes})},!0),i.populateConnectionsList()}})}})},function(e){console.log("DataConfigAnalytic.js: Datagrid initialization error",e)})},Maa.prototype.populateDetailsPanel=function(e,t){var n=this.$groupDetailsPanel,i=this.$connectionDetailsPanel;switch(this.setTitle("Connection Management: "+this.currentTab=="Groups"?this.currentGroup:this.currentConnection),e){case"group":n.find(".title").text(t.name),n.find(".groupName").val(t.name),n.find(".groupType").val(t.type),n.find(".multipleSelect select").val(t.connections),this.multiSelection.set("value",t.connections);break;case"connection":if(t.confirmPassword="",i.find(".title").text(t.name),_.each(_.keys(t),function(e){"type"===e&&"deltaclient"===t[e]&&(t[e]="q"),"tls"===e?i.find("."+e).prop("checked","on"===t[e]):i.find("."+e).val(t[e])}),"q"!==t.type&&"daemon"!==t.type)try{this.parseJdbcHost(t,i)}catch(e){console.error("Failed to Parse Jdbc Host: ",e)}i.find(".saveConnectionBtn").hide()}},Maa.prototype.populateMultiSelect=function(){var n=this;require(["Datagrid"],function(e){var t=new QuickBase.DocumentDataModel({_subscriptionKey:"name",_dataType:"copy",_maxRows:1e5},null,null,null),e=(t.apply(),n.multiSelection=new QuickBase.DocumentViewModel({_default:[],_viewType:!0,_type:"list",value:[]},{}),n.multiSelection.path="dg_multiselect",e.getSettingsModel({Basics:{Data:t,Filtering:"Column Filters",ShowPagingControl:!1,EnableGrouping:!1},ColumnsConfiguration:[e.getColumnSettingsModel({Field:"name",TextAlign:"left"})],Selection:{Mode:"Multi Row",CheckboxAlignment:"left",RowSelectionColumn:"name",SelectedValue:n.multiSelection,FollowSelectedValue:!0},FileExport:{ShowExportCsvButton:!1,ShowExportExcelButton:!1},Style:{FontSize:"11px",RowHeight:20,HeaderRowHeight:20}}));n.multiselectDatagridWrapper=new QuickBase.AppView({el:n.$groupDetailsPanel.find(".multipleSelect")[0],key:"Datagrid",settings:e,dashboardViewModel:new Backbone.Model({DashboardTheme:n.getTheme()}),dashboardAppModel:new Backbone.Model,docViewModel:n.docViewModel,deltaClient:QuickBase.DeltaClientLib.deltaClient,callback:function(){n.connections.fetch({success:function(e){t.onExecuteSuccess({class:"",columns:["name"],meta:{name:11},rows:e.map(function(e){return e.attributes})},!0),n.setSelectedRows(),n.loadConnectionDetails("connection",n.currentConnection),n.connectionGroups&&n.loadConnectionDetails("group",n.currentGroup),n.services?n.populateServicesList():n.launchObject&&n.openDialog()},error:function(e){alert(e)}})}})},function(e){console.log("DataConfigAnalytic.js: Datagrid initialization error",e)})},Maa.prototype.populateServicesList=function(){var n=this;require(["Datagrid"],function(e){var t=new QuickBase.DocumentDataModel({_subscriptionKey:"name",_dataType:"copy",_maxRows:1e5},null,null,null),e=(n.selectedServices=new QuickBase.DocumentViewModel({_default:n.currentServices,_viewType:!0,_type:"symbol",value:n.currentServices},null),n.selectedServices.path="dg_services",t.apply(),e.getSettingsModel({Basics:{Data:t,Filtering:"Column Filters",ShowPagingControl:!1,EnableGrouping:!1},ColumnsConfiguration:[e.getColumnSettingsModel({Field:"name",TextAlign:"left"})],Selection:{Mode:"Single Row",RowSelectionColumn:"name",SelectedValue:n.selectedServices,FollowSelectedValue:!0},FileExport:{ShowExportCsvButton:!1,ShowExportExcelButton:!1},Style:{FontSize:"11px",RowHeight:20,HeaderRowHeight:20}}));n.serviceDatagridAppWrapper=new QuickBase.AppView({el:n.$el.find(".servicesListGrid")[0],key:"Datagrid",settings:e,dashboardViewModel:new Backbone.Model({DashboardTheme:n.getTheme()}),dashboardAppModel:new Backbone.Model,docViewModel:n.docViewModel,deltaClient:null,callback:function(){n.services.fetch({success:function(e){t.onExecuteSuccess({class:"",columns:["name"],meta:{name:11},rows:e.map(function(e){return e.attributes})},!0)}})}})})},Maa.prototype.positionDialog=function(){var e=QuickBase.Tools.calcDialogHeight(400,"dataDialog"),t=e<400?"top":"center";"FSBL"in window&&this.$dialog.parent().css("margin-top",window.finApi.DIALOGS_TOP_MARGIN),this.$dialog.dialog("option","height",e),this.$dialog.dialog("option","position",{my:"center",at:t,of:"#appdiv",collision:"fit"})},Maa.prototype.setTitle=function(e){this.$dialog.parent().find(".ui-dialog-title").text(e)},Maa.prototype.showError=function(e,n){var i=this;"string"==typeof n?this.$statusBar.text(e+" "+t("Error")+': "'+n+'"'):this.$statusBar.text(e),this.$statusBar.css({opacity:1,"background-color":"#ED3054"}),_.delay(function(){return i.$statusBar.css("opacity",0)},3500),_.delay(function(){i.$statusBar.css({"background-color":"#62BA62"})},4e3)},Maa.prototype.showMessageAndRefresh=function(e){var n=this;this.trigger("RefreshConnectionList"),this.$statusBar.text(t(e)),this.$statusBar.css({opacity:1}),_.delay(function(){return n.$statusBar.css({opacity:0})},3500)},Maa),Laa;function Maa(e){var n=Laa.call(this,_.extend(e,{className:"connectionManagementPanel"}))||this,i=(n.currentTab="Individual",n.currentConnection="",n.currentGroup="",n.currentServices="",n.isCreatingGroup=!1,n.isCreatingSingle=!1,n.connections=e.appModel.get("connections"),n.connectionGroups=e.appModel.get("connectionGroups"),n.services=e.appModel.get("services"),n.docViewModel=e.docViewModel,n.launchObject=e.launchObject,{singleConnectionsId:_.uniqueId("connectionsTab_"),groupConnectionsId:_.uniqueId("connectionsTab_"),serivcesTabId:_.uniqueId("connectionsTab_"),isLite:e.appModel.get("isLite")});return n.$el.html(T.ConnectionManagement(i)),n.setDOMObjects(),n.$dialog=n.$el.dialog({appendTo:e.container,dialogClass:"quick-dash new-connection-panel",modal:!0,resizable:!1,title:"Connection Management",height:400,width:600,create:function(){n.$editButtons=$(n).parent().find(".ui-dialog-buttonset").children(),n.$editButtons=n.$editButtons.slice(0,n.$editButtons.length-1),n.initializeDialogDisplay()},close:function(){n.remove()},buttons:[{text:t("New"),click:n.onBtnNewClick.bind(n),icons:{primary:"fa fa-plus"}},{text:t("Duplicate"),click:n.onBtnDuplicateClick.bind(n),icons:{primary:"fa fa-copy"}},{text:t("Delete"),click:n.onBtnDeleteClick.bind(n),icons:{primary:"fa fa-trash-o"}},{text:t("Save"),click:n.onBtnSaveClick.bind(n),icons:{primary:"fa fa-floppy-o"}},{text:t("Close"),click:n.remove.bind(n),icons:{primary:"fa fa-times"}}]}),n.positionDialog(),n.createStatusBar(),n.$el.find(".type").change(function(e){n.onTypeChange(n.$el.find(".type").val())}),n}var DataConfigForm=Backbone.View.extend({$dataDiv:null,$rawDataView:null,$resultsDiv:null,$queryStatus:null,$connectionsCombobox:null,$connectionTypeSelect:null,$connectionSelect:null,dataTable:null,$parametersBtn:null,$newConnectionGroupBtn:null,$addParameterButton:null,parameterDialog:null,guidObject:null,appModel:null,dataModel:null,data:{},className:"data-config-dialog",connectionManagementPanel:null,DATA_SOURCE_PROP:"_dataSource",DATA_TYPE_PROP:"_dataType",LAYOUT_PROP:"_layout",MAXROWS_PROP:"_maxRows",PAGESIZE_PROP:"_pageSize",PAGINGTYPE_PROP:"_pagingType",PIVOT_TYPE_PROP:"_pivotType",QUERY_STR_PROP:"_queryString",CONNECTION_PROP:"_connection",SERVER_PAGING_PROP:"_serverPaging",SUBCRIPTION_PROPERTY:"_subscriptionType",HAS_UPDATE_PROP:"_hasUpdateQuery",UPDATE_TYPE_PROP:"_updateType",subscriptionSz:34,hasSubscribed:!1,initialize:function(e){var t=this;t.appModel=e.appModel,t.connections=t.appModel.get("connections"),t.connectionGroups=t.appModel.get("connectionGroups"),t.services=t.appModel.get("services"),t.docDataModel=e.docDataModel,t.docViewModel=e.docViewModel,t.dataDialogView=e.dataDialogView,t.dataConnectionMiniMode=e.dataConnectionMiniMode,t.dialogContainer=e.dialogContainer,t.subscriptionKey=_.uniqueId("queryEditor_"),t.dataGridSubscriptionKey=_.uniqueId("queryEditor_DataGrid_"),t.columnInfo=new Backbone.Collection,t.domIds={tableId:_.uniqueId("dc_"),mappingId:_.uniqueId("dc_"),rawId:_.uniqueId("dc_"),objectId:_.uniqueId("dc_")},t.model.set("isSourceDataDialog",!0),t.$el.addClass(this.className),t.$el.html(T.DataConfigForm(_.extend(t.domIds,{query_graph:t.appModel.get("isLite")&&(t.appModel.get("query_graph")||!t.appModel.attributes.hasOwnProperty("query_graph"))||!t.appModel.get("isLite")&&"true"===QuickBase.DeltaClientLib.getDashboardProperty("query_graph")}))),t.$queryRadio=t.$el.find("input.query").parent(),t.debounceUpdateForm=_.debounce(t.updateForm,100),t.$connectionTypeSelect=t.$el.find(".connection-type-select select"),t.$connectionSelect=t.$el.find(".connection-select select"),t.$newConnectionGroupBtn=t.$el.find(".newConnectionGroup"),t.$connectionTypeSubscription=t.$el.find(".connection-subscription select"),t.$executeButton=t.$el.find(".run-btn"),t.$dataTypeRadio=t.$el.find("input:radio[name=_dataType]"),t.$functionFieldset=t.$el.find("fieldset.function"),t.$addParameterButton=t.$el.find(".add-parameter-btn"),t.$dataDiv=t.$el.find(".data-div"),t.$mappingDiv=this.$el.find("#"+t.domIds.mappingId),t.$resultsDiv=t.$el.find(".results-div"),t.$rawDataOutput=this.$el.find("#"+t.domIds.rawId),t.$queryStatus=t.$el.find(".queryStatus"),t.$tabs=t.$el.find(".tabs"),t.$pivotCheckbox=t.$el.find(".pivot-checkbox"),t.$updateCheckbox=t.$el.find(".update-checkbox"),t.$pivotTypeRadio=t.$el.find("input:radio[name=_pivotType]"),t.$subscription=t.$el.find(".subscription"),t.$updateTypeRadio=t.$el.find("input:radio[name=_updateType]"),t.$pivotLabel=t.$el.find(".pivot-label"),t.$updateLabel=t.$el.find(".update-label"),t.throttleStop=_.throttle(function(){t.model.stop(),t.throttleStop.flush()},5e3,{leading:!1}),t.$newConnectionGroupBtn.button({icons:{primary:"fa fa-cogs"},text:!1}).click($.proxy(t.openConnectionManagement,t)),t.$executeButton.button({icons:{primary:"fa fa-play"}}).click($.proxy(t.onExecuteButtonClick,t)),t.$addParameterButton.button({icons:{primary:"fa fa-plus"}}).click($.proxy(t.openParameterDialog,t)),t.model.get("_dataSource")&&"deltaclient"!==t.model.get("_dataSource")||t.model.set({_dataSource:"kdb"},{silent:!0}),t.$connectionTypeSelect.select2({dropdownAutoWidth:!1,minimumResultsForSearch:5,theme:"dashboards"}),t.$connectionTypeSelect.val(t.model.get("_dataSource")).trigger("change"),t.$connectionTypeSelect.on("select2:open",function(){$("body > .select2-container--dashboards.select2-container--open").addClass("select2--environment")}),this.subscriptionSelect=new SubscriptionSelect({el:t.$subscription,model:this.model,dialogContainer:this.dialogContainer,docDataModel:this.docDataModel,docViewModel:this.docViewModel,isLite:this.appModel.get("isLite")}),t.$maxRowsInput=t.$el.find("input."+t.MAXROWS_PROP),t.$pageSizeInput=t.$el.find("input."+t.PAGESIZE_PROP),t.$serverPagingCheck=t.$el.find('input[name="'+t.SERVER_PAGING_PROP+'"]'),navigator.userAgent.toLowerCase().match(/trident|firefox/)&&(t.subscriptionSz=20,t.$el.find(".data-div > div").css("min-height","20px")),t.$tabs.tabs({activate:$.proxy(t.onTabActivate,t)}),t.sections=[{$el:t.$el.find(".function"),$heading:"> legend",$content:"> fieldset > div",weight:2,isExpanded:!0,resize:function(){t.dataConfigQuery&&t.dataConfigQuery.onResize(),t.dataConfigAnalytic&&t.dataConfigAnalytic.$el.is(":visible")&&t.dataConfigAnalytic.onResize(),t.dataConfigUpdate&&t.dataConfigUpdate.$el.is(":visible")&&t.dataConfigUpdate.onResize(),t.dataConfigVirtual&&t.dataConfigVirtual.onResize(),t.dataConfigSQLQuery&&t.dataConfigSQLQuery.onResize()}},{$el:t.$el.find(".pivot"),$heading:"> legend",$content:"> fieldset > div",weight:1,isExpanded:!0,hidden:!0},{$el:t.$el.find(".update"),$heading:"> legend",$content:"> fieldset > div",weight:1,isExpanded:!1,hidden:!0},{$el:t.$subscription,$heading:"> legend",$content:"> fieldset > div",weight:0,fixed:80,isExpanded:!1},{$el:t.$el.find(".results"),$heading:"> legend",$content:"> fieldset > div",weight:2,isExpanded:!1,hidden:!0,resize:function(){t.resizeDatatable(),t.mappingView&&t.mappingView.onResize()}}],t.accordion=new AccordionView({el:t.$dataDiv.get(0),sections:t.sections,onUpdate:$.proxy(t.onAccordionUpdate,t)}),t.onModelDataSourceChange(),t.onModelDataTypeChange(),t.onModelHasUpdateChange(),t.onModelPivotTypeChange(),t.onModelSubscriptionTypeChange(),t.onModelMaxRowsChange(),t.onModelPageSizeChange(),t.onModelServerPagingChange(),t.onModelLayoutChange(),t.initializeEvents(),t.model.execute=$.noop,t.dataConnectionMiniMode&&t.$el.addClass("dataConnectionMiniMode"),e.initialTab&&(t.sections[4].hidden=!1,t.sections[4].isExpanded=!0,t.onAccordionUpdate(),t.$tabs.tabs("option","active",e.initialTab),t.onTabActivate()),"sql"===t.model.get("_dataSource")?(t.$pivotLabel.hide(),t.$updateLabel.hide(),t.model.set(t.DATA_TYPE_PROP,"query"),t.$dataTypeRadio.parentsUntil("fieldset").hide()):("sql"===t.model.get("_dataType")?(t.$pivotLabel.hide(),t.$updateLabel.hide()):(t.$pivotLabel.show(),t.$updateLabel.show()),t.$dataTypeRadio.parentsUntil("fieldset").show())},initializeEvents:function(){var n=this;n.listenTo(n.model,"change:"+this.CONNECTION_PROP,n.onModelConnectionChanged),n.$dataTypeRadio.change(function(){var e=n.$el.find('input:radio[name="_dataType"]:checked').val(),t=n.model.get(n.DATA_TYPE_PROP);n.model.set(n.DATA_TYPE_PROP,"streaming"===e?"analytic":e),t===n.model.get(n.DATA_TYPE_PROP)&&n.model.trigger("change:_dataType",n.model,e)}),n.$updateTypeRadio.change(function(){n.model.set(n.UPDATE_TYPE_PROP,this.value)}),n.model.get("_updateType")||n.model.set("_updateType","query",{silent:!0}),this.$updateTypeRadio.val([n.model.get("_updateType")]),n.$pivotCheckbox.change(function(){var e="query"===n.model.get(n.DATA_TYPE_PROP)?"server":"client";n.model.set(n.PIVOT_TYPE_PROP,this.checked?e:"")}),n.$updateCheckbox.change(function(){n.model.set(n.HAS_UPDATE_PROP,this.checked)}),n.$connectionTypeSelect.on("select2:select",function(){n.model.set("_dataSource",n.$connectionTypeSelect.val())}),n.$pivotTypeRadio.change(function(){n.model.set(n.PIVOT_TYPE_PROP,n.$el.find('input:radio[name="_pivotType"]:checked').val())}),n.listenTo(n.model,"change:_dataSource",function(){"sql"===n.model.get("_dataSource")?(n.$pivotLabel.hide(),n.$updateLabel.hide(),n.model.set(n.DATA_TYPE_PROP,"query"),n.$dataTypeRadio.parentsUntil("fieldset").hide()):(n.$pivotLabel.show(),n.$updateLabel.show(),n.$dataTypeRadio.parentsUntil("fieldset").show())}),n.listenTo(n.model,"change:"+n.DATA_TYPE_PROP,n.onModelDataTypeChange),n.listenTo(n.model,"change:"+n.HAS_UPDATE_PROP,n.onModelHasUpdateChange),n.listenTo(n.model,"change:"+n.UPDATE_TYPE_PROP,n.onUpdateTypeChange),n.listenTo(n.model,"change:"+n.PIVOT_TYPE_PROP,n.onModelPivotTypeChange),n.listenTo(n.model,"change:"+n.SUBCRIPTION_PROPERTY,n.onModelSubscriptionTypeChange),n.$maxRowsInput.on("input",_.debounce($.proxy(n.onInputMaxRowsChange,n),50)),n.listenTo(n.model,"change:"+n.MAXROWS_PROP,n.onModelMaxRowsChange),n.$pageSizeInput.on("input",_.debounce($.proxy(n.onInputPageSizeChange,n),50)),n.listenTo(n.model,"change:"+n.PAGESIZE_PROP,n.onModelPageSizeChange),n.$serverPagingCheck.on("change",$.proxy(n.onInputServerPagingChange,n)),n.listenTo(n.model,"change:"+n.SERVER_PAGING_PROP,n.onModelServerPagingChange),n.listenTo(n.model,"change:"+this.DATA_TYPE_PROP,n.validateUI),n.listenTo(n.model,"change:_breakdownCols",n.validateUI),n.listenTo(n.model,"change:_aggregateCols",n.validateUI),n.listenTo(n.model,"change:"+this.DATA_SOURCE_PROP,n.onModelDataSourceChange),n.listenTo(n.model,"change:"+n.LAYOUT_PROP,n.onModelLayoutChange),n.listenTo(n.model,"data",n.onModelData)},addDataTable:function(){var o=this;o.loadingDatagridModule?console.log("Datagrid module is already being loaded!"):o.dataTableDisplay?("builder"===o.model.get("_dataType")&&(o.dataTableDisplay.regenerateColumnsConfiguration=!0,o.dataTableDisplay.viewModel.set("ColumnsConfiguration",[])),o.dataTableDisplay.$el.show()):(o.loadingDatagridModule=!0,require(["Datagrid"],function(e){var i,t="Dark";o.loadingDatagridModule=!1,"kx-light"===$.cookie("dashboard-theme")&&(t="Light"),i=e.getSettingsModel({Basics:{Data:o.model,Filtering:"disabled",ShowPagingControl:!1,EnableGrouping:!1},FileExport:{ShowExportCsvButton:!1,ShowExportExcelButton:!1}}),o.dataTableDisplay=new e({dashboardViewModel:new Backbone.Model({DashboardTheme:t}),dataConfigDialogMode:!0,viewModel:new QuickBase.DocumentViewModel,dataModel:o.model,settingsModel:i,api:{showQueryStatus:$.proxy(o.showQueryStatus,o),hideQueryStatus:$.proxy(o.hideQueryStatus,o),subscribe:$.proxy(o.onDataGridSubscribe,o),unsubscribe:$.proxy(o.onDataGridUnsubscribe,o),page:$.proxy(o.onDataGridPage,o),getProperty:function(e){return i.get(e)},setProperty:function(e,t){var n={};i.set(e,t),n[e]=t,o.dataTableDisplay&&o.dataTableDisplay.onSettingsChange(n)},doActions:$.noop,loadSetting:$.noop,saveSetting:$.noop}}),o.$el.find(".dataTableTab").append(o.dataTableDisplay.el),o.dataTableDisplay.onSettingsChange(i.toFlat())},function(e){console.log("ComponentView:loadApp require error",e)}),_.delay(function(){o.loadingDatagridModule=!1},2e3))},addParameterFromDialog:function(e){this.dataConfigQuery&&this.dataConfigQuery.addParameterFromDialog(e)},clearData:function(){this.dataTableDisplay&&this.dataTableDisplay.$el.hide(),this.mappingView&&this.$mappingDiv.hide(),this.$rawDataOutput.text("")},execute:function(e){var t,n,i;this.clearData(),!this.isBlank()&&this.validateUI()&&(this.showUIMask(),i=n=void 0,(t=e&&0<=["query","sql"].indexOf(this.model.get(this.DATA_TYPE_PROP)))&&(n=this.model.get(this.QUERY_STR_PROP),i=this.model.get(this.PIVOT_TYPE_PROP),this.model.set(this.QUERY_STR_PROP,e,{silent:!0}),this.model.set(this.PIVOT_TYPE_PROP,"",{silent:!0})),this.throttleStop.flush(),this.hasSubscribed?(this.model.apply(),this.model.execute()):(this.model.subscribe(this.subscriptionKey,this),this.hasSubscribed=!0),this.model.dataMapper&&this.model.dataMapper.setSubscription(!0),t&&(this.model.set(this.QUERY_STR_PROP,n,{silent:!0}),this.model.set(this.PIVOT_TYPE_PROP,i,{silent:!0})))},setQueryTypeCookie:function(e){var t=new Date;t.setTime(t.getTime()+31536e6),$.cookie("KXQueryType",e,{expires:t})},verifyPermission:function(){return!!this.$connectionSelect[0].value||(console.warn("No Selected Connection. Do you have permission for the connection you're trying to run?"),!1)},focusEditor:function(){var e=this.model.get(this.DATA_TYPE_PROP);"query"===e&&this.dataConfigQuery?this.dataConfigQuery.focusEditor():"virtual"===e&&this.dataConfigVirtual?this.dataConfigVirtual.focusEditor():"sql"===e&&this.dataConfigSQLQuery&&this.dataConfigSQLQuery.focusEditor()},hasStreamingNode:function(){var e=this.model.get("_graphJSON");return!_.isEmpty(e)&&_.some(JSON.parse(e).nodes,function(e){return"stream"===e.group})},hideQueryStatus:function(e){this.$queryStatus.hide()},hideUIMask:function(){this.uiMaskCallback&&this.uiMaskCallback()},isBlank:function(){switch(this.model.get(this.DATA_TYPE_PROP)){case"query":case"sql":case"pivot":return!this.model.get(this.QUERY_STR_PROP);default:return!1}},onAccordionUpdate:function(e){e=_.map(e,function(e){return _.pick(e,"isExpanded","weight")});_.isEqual(this.model.get("_layout"),e)||this.model.set("_layout",e)},onCancelButtonClick:function(){this.$el.dialog("close"),this.remove()},onData:function(e,t,n,i){var o=this.$tabs.tabs("option","active");switch(this.sections[4].hidden=!1,this.sections[4].isExpanded=!0,this.onAccordionUpdate(),this.hideUIMask(),this.data=t,this.meta=e,this.updateColumnsProperty(e.columns),n?this.$el.find(".stacked-bar-graph").empty():i&&(this.renderPerformanceGrid(i),Log.logPerformanceMetrics(this.model.path,i)),this.addDataTable(t),this.throttleStop(),this.model.execute=_.noop,o){case 1:this.updateMappingView();break;case 2:this.updateRawView({meta:e,data:t})}},onExecuteButtonClick:function(){this.verifyPermission()&&this.execute()},onInputMaxRowsChange:function(){this.model.set(this.MAXROWS_PROP,this.$maxRowsInput.val())},onInputPageSizeChange:function(){this.model.set(this.PAGESIZE_PROP,this.$pageSizeInput.val())},onInputServerPagingChange:function(){this.model.set(this.SERVER_PAGING_PROP,this.$serverPagingCheck.prop("checked"))},onModelConnectionChanged:function(){this.$connectionSelect.isLoaded&&(this.$connectionSelect.val(this.model.get(this.CONNECTION_PROP)).trigger("change"),this.setSQLEditorVisiblity())},onModelLayoutChange:function(){var n=this,e=n.model.get(n.LAYOUT_PROP);_.each(e,function(e,t){_.extend(n.sections[t],e)}),n.sections[3].isExpanded=!0,this.accordion.updateLayout(!1)},onModelDataSourceChange:function(){"deltaclient"===this.model.get("_dataSource")&&this.model.set({_dataSource:"kdb"},{silent:!0}),this.sections[4].hidden=!0,this.$connectionTypeSelect.val(this.model.get("_dataSource")).trigger("change"),"sql"===this.model.get("_dataSource")?(this.$el.find(".configFieldsetLabels").hide(),this.$el.find(".configFieldsetLabels .query").click()):this.$el.find(".configFieldsetLabels").show(),this.dataConfigQuery,this.updateParameterButton(),this.populateConnectionsGroupList()},setSQLEditorVisiblity:function(){var t=this;QuickBase.DeltaClientLib.getQueryData("kdb",this.appModel.get("isLite")?this.$connectionSelect.val():void 0,"`e in key `.s",[],function(e){0<e.rows.length&&_.first(Object.values(e.rows[0]))?t.$el.find(".sql-editor_label").removeClass("hidden"):t.$el.find(".sql-editor_label").addClass("hidden")},function(){t.$el.find(".sql-editor_label").addClass("hidden")},100,!1)},updateQueryRadio:function(e){this.$queryRadio.show(),e&&(this.originalDataType=this.model.get(this.DATA_TYPE_PROP)),this.appModel.get("CanExecuteQueries")||"query"===this.model.get(this.DATA_TYPE_PROP)||"query"===this.originalDataType||this.$queryRadio.hide()},onModelDataTypeChange:function(){var e={};if("pivot"===this.model.get(this.DATA_TYPE_PROP))return e[this.DATA_TYPE_PROP]="query",e[this.PIVOT_TYPE_PROP]="server",void this.model.set(e);"server"===this.model.get(this.PIVOT_TYPE_PROP)&&"sql"===this.model.get(this.PIVOT_TYPE_PROP)&&"query"!==this.model.get(this.DATA_TYPE_PROP)&&"builder"!==this.model.get(this.DATA_TYPE_PROP)&&this.model.set(this.PIVOT_TYPE_PROP,"client"),_.includes(["analytic","streaming","virtual","builder"],this.model.get(this.DATA_TYPE_PROP))?(this.$el.find(".query-form").hide(),this.$el.find(".sql-query-form").hide()):"sql"===this.model.get(this.DATA_TYPE_PROP)?(this.$el.find(".sql-query-form").show(),this.$el.find(".query-form").hide()):(this.$el.find(".query-form").show(),this.$el.find(".sql-query-form").hide()),this.updateParameterButton(),this.updateQueryButtons(),this.updatePivotButton(),this.updateResultsButtons(),this.debounceUpdateForm()},onModelHasUpdateChange:function(){this.debounceUpdateForm()},onModelPivotTypeChange:function(){"server"===this.model.get(this.PIVOT_TYPE_PROP)&&"query"!==this.model.get(this.DATA_TYPE_PROP)&&"builder"!==this.model.get(this.DATA_TYPE_PROP)&&this.model.set(this.PIVOT_TYPE_PROP,"client"),this.debounceUpdateForm()},onModelSubscriptionTypeChange:function(){this.validateUI()&&this.model.stop&&this.model.stop(),this.debounceUpdateForm()},onModelMaxRowsChange:function(){this.$maxRowsInput.val(this.model.get(this.MAXROWS_PROP))},onModelPageSizeChange:function(){this.$pageSizeInput.val(this.model.get(this.PAGESIZE_PROP))},onModelServerPagingChange:function(){var e=this.model.get(this.SERVER_PAGING_PROP),e=void 0===e||(e||!1);"virtual"!==this.model.get(this.DATA_TYPE_PROP)&&(this.$serverPagingCheck.prop("checked",e),this.$maxRowsInput.parent().toggle(!e),this.$pageSizeInput.parent().toggle(e))},onResize:function(e,t){this.accordion.resize(),this.resizeDatatable()},onDataGridPage:function(e,t){if(!e||!e.subscribe||!e.unsubscribe)return!1;t=_.pick(t,"_pagingType","_pagingNum","_pageSize","_pageSort"),e.set(t)},onDataGridSubscribe:function(e,t){return!!(e&&e.subscribe&&e.unsubscribe)&&(this.dataGridSubscription?(this.dataGridSubscription.callback=t,!1):(this.dataGridSubscription={source:e,onData:t},this.dataGridSubscription.key="queryEditor_DataGrid",void e.subscribe(this.dataGridSubscription.key,this.dataGridSubscription)))},onDataGridUnsubscribe:function(e){if(!(e instanceof QuickBase.DocumentDataModel))return!1;this.dataGridSubscription&&(e.unsubscribe(this.dataGridSubscription.key),delete this.dataGridSubscription)},onTabActivate:function(){switch(this.$tabs.tabs("option","active")){case 0:this.resizeDatatable();break;case 1:this.updateMappingView();break;case 2:this.updateRawView(this.data)}},openConnectionManagement:function(){this.connectionManagementPanel=new ConnectionManagement({container:this.dialogContainer,launchObject:this.$connectionSelect.val(),docViewModel:this.docViewModel,appModel:this.appModel}),this.listenTo(this.connectionManagementPanel,"RefreshConnectionList",$.proxy(this.refreshConnectionsSelect,this)),this.listenToOnce(this.connectionManagementPanel,"onRemove",$.proxy(function(){this.stopListening(this.connectionManagementPanel),this.connectionManagementPanel=null},this))},openParameterDialog:function(){var t=this;t.parameterDialog?t.parameterDialog.dialog("open"):(t.parameterDialog=this.$el.find(".addParameterDialog").dialog({appendTo:t.dialogContainer,dialogClass:"quick-dash",modal:!0,width:300,title:"Add parameter to SQL query",buttons:{Add:function(){t.addParameterFromDialog($(this).find("input").val()),$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}}}),t.parameterDialog.find("input").on("keydown",function(e){13===e.which&&(t.addParameterFromDialog(t.parameterDialog.find("input").val()),t.parameterDialog.dialog("close"))}))},populateConnectionsList:function(t){var n,i,o=this,a="q",s=null,l=null;"kdb"===o.model.get("_dataSource")?a="q":"sql"===o.model.get("_dataSource")&&(a="jdbc:com.mysql.jdbc.Driver",s="jdbc:oracle.jdbc.OracleDriver",l="jdbc:com.microsoft.sqlserver.jdbc.SQLServerDriver"),o.appModel.get("connections").fetch({success:function(e){e=e.map(function(e){return e.attributes}),_.isUndefined(o.model.get(o.CONNECTION_PROP))&&e[0]&&o.model.set(o.CONNECTION_PROP,e[0].name,{silent:!0}),i=_.filter(e,function(e){return"DC"!==e.name&&e.type===a}),s&&(i=$.merge(i,_.filter(e,{type:s}))),l&&(i=$.merge(i,_.filter(e,{type:l}))),n=_.reduce(i,function(e,t){return e+'<option value="'+_.escape(t.name)+'"'+(t.name===o.model.get(o.CONNECTION_PROP)?" selected>":">")+t.name+"</option>"},""),o.$connectionSelect.append('<optgroup label="-Single Connections-">'),o.$connectionSelect.append(n),o.$connectionSelect.append("</optgroup>"),n=o.model.get(o.CONNECTION_PROP);e=_.find(e.concat(t||[]),{name:n});o.dataConnectionMiniMode?o.$connectionSelect.val(n).trigger("change"):e?o.$connectionSelect.val(e.name).trigger("change"):0<i.length?o.$connectionSelect.val(i[0].name).trigger("change"):o.$executeButton.button("option","disabled",!0),o.$connectionSelect.isLoaded=!0,o.populateServicesList()}})},populateConnectionsGroupList:function(){var n=this,e=0;this.connectionGroups?(n.$connectionSelect.empty(),"kdb"===n.model.get("_dataSource")?n.connectionGroups.fetch({success:function(e){var t;e=e.map(function(e){return e.attributes}),_.isUndefined(n.model.get(n.CONNECTION_PROP))&&e[0]&&n.model.set(n.CONNECTION_PROP,e[0].name,{silent:!0}),t=_.reduce(e,function(e,t){return e+'<option value="'+_.escape(t.name)+'"'+(t.name===n.model.get(n.CONNECTION_PROP)?" selected>":">")+t.name+"</option>"},""),n.$connectionSelect.html('<optgroup label="-Connection Groups-">'+t+"</optgroup>"),n.populateConnectionsList(e)},error:function(){_.delay(function(){e<3&&(e+=1,n.populateConnectionsGroupList())},1e3)}}):n.populateConnectionsList()):this.populateConnectionsList([])},populateServicesList:function(){var n=this;this.appModel.get("isLite")?n.setSelectedConnection():n.appModel.get("services").fetch({success:function(e){optionsHeader='<optgroup label="-Services-">',optionsfooter="</optgroup>",optionsHtml=e.reduce(function(e,t){return e+'<option value="'+_.escape(t.get("name"))+'"'+(t.get("name")===n.model.get(n.CONNECTION_PROP)?" selected>":">")+t.get("name")+"</option>"},""),n.$connectionSelect.append(optionsHeader),n.$connectionSelect.append(optionsHtml),n.$connectionSelect.append(optionsfooter),n.$executeButton.button("option","disabled")&&0<e.length&&(n.$executeButton.button("option","disabled",!1),n.$connectionSelect.val(e.models[0].get("name")).trigger("change")),n.setSelectedConnection()},error:function(e,t){QuickBase.Log.Error("Failed to fetch Services",t[0]),n.setSelectedConnection()}})},refreshConnectionsSelect:function(){this.$connectionSelect.html(""),this.$connectionSelect.empty(),this.populateConnectionsGroupList()},remove:function(){this.removeDataTable(),this.model.unsubscribe(this.subscriptionKey),this.hasSubscribed=!1,this.stopListening(this.model),this.model.destroy(),this.dataConfigQuery&&(this.dataConfigQuery.remove(),delete this.dataConfigQuery),this.dataConfigSQLQuery&&(this.dataConfigSQLQuery.remove(),delete this.dataConfigSQLQuery),this.dataConfigAnalytic&&(this.dataConfigAnalytic.remove(),delete this.dataConfigAnalytic),this.dataConfigStreaming&&(this.dataConfigStreaming.remove(),delete this.dataConfigStreaming),this.dataConfigPivot&&(this.dataConfigPivot.remove(),delete this.dataConfigPivot),this.dataConfigUpdate&&(this.dataConfigUpdate.remove(),delete this.dataConfigUpdate),this.dataConfigBuilder&&(this.dataConfigBuilder.remove(),delete this.dataConfigBuilder),Backbone.View.prototype.remove.call(this)},removeDataTable:function(){this.dataTableDisplay&&(this.dataTableDisplay.remove(),this.dataTableDisplay=null)},renderPerformanceGrid:function(e){var e=e.performance,t=e.onAgentNotify-e.apply,n=e.serverStart?e.serverStart-e.apply:0,i=e.serverStart&&e.serverEnd?e.serverEnd-e.serverStart:t,e=e.serverEnd?e.onAgentNotify-e.serverEnd:0,o=n/t,a=i/t,s=e/t;this.$el.find(".stacked-bar-graph").html(T.DataConfigForm_Perf({totalTime:t.toFixed(0),subscriptionPercent:100*o,executionPercent:100*a,dataModelPercent:100*s,subscriptionTime:n.toFixed(0),executionTime:i.toFixed(0),dataModelTime:e.toFixed(0)}))},resizeDatatable:function(){this.dataTableDisplay&&this.dataTableDisplay.onResize(),this.dataConfigBuilder&&this.dataConfigBuilder.onResize()},setSelectedConnection:function(){var e=this;e.$connectionSelect.select2({theme:"dashboards"}),e.$connectionSelect.on("select2:select",function(){e.model.set(e.CONNECTION_PROP,e.$connectionSelect.val())}),e.$connectionSelect.on("select2:open",function(){$("body > .select2-container--dashboards.select2-container--open").addClass("select2--environment")}),e.onModelConnectionChanged()},showUIMask:function(){var e=this;e.$uiMask||(e.$uiMask=$('<div class="ui-widget-overlay" style="z-index: 1111; display: none; opacity: 0.7; position: absolute;"></div>').appendTo(".data-dialog"),e.$uiMask.append(new LoadingScreen({loadingText:"Please wait, executing query"}).$el),e.uiMaskCallback=function(){e.$uiMask.stop(!0,!0).fadeOut(200),clearTimeout(e.uiMaskTimeout)}),e.$uiMask.fadeIn(1e3),clearTimeout(e.uiMaskTimeout),e.uiMaskTimeout=setTimeout(function(){e.showQueryStatus({message:"Request timed out, no response within 10 seconds",type:"Error"}),e.sections[4].isExpanded=!0,e.sections[4].hidden=!1,e.onAccordionUpdate(),e.model.stop&&e.model.stop(),e.uiMaskCallback()},1e4)},showQueryStatus:function(e){var t=this,n=e.message||e.error||"",e=e.type||"Error",i="NoResults"===e?"No Results":e;0===n.indexOf("0.0")&&(n=n.substring(4)),t.$queryStatus.removeClass("Error Warning Info Loading NoResults").addClass(e),t.$queryStatus.find(".statusTitle span").text(i+(n?": ":"")),t.$queryStatus.find(".statusText").html(n),t.$queryStatus.show(),t.fadeTimer&&clearTimeout(t.fadeTimer),"Info"===e&&(t.fadeTimer=_.delay(function(){t.$queryStatus.fadeOut("slow")},3e3))},updateForm:function(){var e,t,n,i=this.model.get(this.DATA_TYPE_PROP),o=this.model.get(this.PIVOT_TYPE_PROP),a=!!o,s="streaming"===this.model.get("_subscriptionType"),l=this.model.get(this.HAS_UPDATE_PROP);this.$dataTypeRadio.val(["analytic"===i&&s?"streaming":i]),this.$pivotTypeRadio.val([o]),a?this.$pivotCheckbox.prop("checked",!0):this.$pivotCheckbox.removeProp("checked"),this.$el.find('input:radio[name="_pivotType"].server').prop("disabled","query"!==this.model.get(this.DATA_TYPE_PROP)&&"builder"!==this.model.get(this.DATA_TYPE_PROP)),this.$pivotCheckbox.prop("disabled",!_.includes(["query","analytic","streaming","virtual","builder"],i)||l),this.sections[1].isExpanded=a,this.sections[1].hidden=!a,l?this.$updateCheckbox.prop("checked",!0):this.$updateCheckbox.removeProp("checked"),this.$updateCheckbox.prop("disabled",!_.includes(["query","analytic","streaming"],i)||a),this.sections[2].isExpanded=l,this.sections[2].hidden=!l,this.sections[3].isExpanded="static"!==this.model.get(this.SUBCRIPTION_PROPERTY)||l||"virtual"===this.model.get(this.DATA_TYPE_PROP),this.sections[3].isExpanded?(this.sections[3].fixed=80,this.sections[3].$el.find("fieldset").toggleClass("hide-border-color",!1)):(this.sections[3].fixed=this.subscriptionSz,this.sections[3].$el.find("fieldset").toggleClass("hide-border-color",!0)),"static"!==this.model.get(this.SUBCRIPTION_PROPERTY)||l||"virtual"===this.model.get(this.DATA_TYPE_PROP)||this.model.set("_subscriptionKey",""),this.onAccordionUpdate(),_.each([this.dataConfigAnalytic,this.dataConfigStreaming,this.dataConfigQuery,this.dataConfigPivot,this.dataConfigUpdate,this.dataConfigVirtual,this.dataConfigSQLQuery,this.dataConfigBuilder],function(e){e&&e.$el.hide()}),this.dataConnectionMiniMode||("analytic"!==i||s?"analytic"===i&&s?(this.dataConfigStreaming=this.updateFormComponent(this.dataConfigStreaming,DataConfigAnalytic,this.$el.find(".streaming-form").get(0)),(e=this.dataConfigStreaming.$tree.jstree("get_selected"))instanceof Array&&0<e.length&&this.model.set("_selectedAnalytic",e[0]),this.model.set("_analyticParams",this.model.get("_streamingParameters")),t=-1!=["static","polling"].indexOf(this.model.get(this.SUBCRIPTION_PROPERTY))&&!a&&!this.appModel.get("isLite"),n=this.model.get(this.SERVER_PAGING_PROP),this.$maxRowsInput.parent().toggle(!t||!n),this.$pageSizeInput.parent().toggle(t&&n),this.$serverPagingCheck.parent().toggle(t),this.dataConfigStreaming.onResize()):"query"===i?(this.dataConfigQuery=this.updateFormComponent(this.dataConfigQuery,DataConfigQuery_Query,this.$el.find(".query-form").get(0)),t=-1!=["static","polling"].indexOf(this.model.get(this.SUBCRIPTION_PROPERTY))&&!a&&!this.appModel.get("isLite"),n=this.model.get(this.SERVER_PAGING_PROP),this.$maxRowsInput.parent().toggle(!t||!n),this.$pageSizeInput.parent().toggle(t&&n),this.$serverPagingCheck.parent().toggle(t),this.stopListening(this.dataConfigQuery,"execute",this.execute),this.listenTo(this.dataConfigQuery,"execute",this.execute),this.dataConfigQuery.onResize()):"sql"===i?(this.dataConfigSQLQuery=this.updateFormComponent(this.dataConfigSQLQuery,DataConfigQuery_Query,this.$el.find(".sql-query-form").get(0)),t=-1!=["static","polling"].indexOf(this.model.get(this.SUBCRIPTION_PROPERTY))&&!a&&!this.appModel.get("isLite"),n=this.model.get(this.SERVER_PAGING_PROP),this.$maxRowsInput.parent().toggle(!t||!n),this.$pageSizeInput.parent().toggle(t&&n),this.$serverPagingCheck.parent().toggle(t),this.stopListening(this.dataConfigSQLQuery,"execute",this.execute),this.listenTo(this.dataConfigSQLQuery,"execute",this.execute),this.dataConfigSQLQuery.loadText("sql"),this.dataConfigSQLQuery.onResize()):"virtual"===i?(""===this.model.get("_virtualQueryString")&&this.model.set("_virtualQueryString",this.dataDialogView.generateSampleVirtualQuery(this.model.path)),this.dataConfigVirtual=this.updateFormComponent(this.dataConfigVirtual,DataConfigQuery_Virtual,this.$el.find(".virtual-query-form").get(0)),this.stopListening(this.dataConfigVirtual,"execute",this.execute),this.listenTo(this.dataConfigVirtual,"execute",this.execute),this.dataConfigVirtual.onResize()):"builder"===i&&(this.dataConfigBuilder=this.updateFormComponent(this.dataConfigBuilder,DataConfigQuery_Builder,this.$el.find(".builder-query-form").get(0)),t=-1!=["static","polling"].indexOf(this.model.get(this.SUBCRIPTION_PROPERTY))&&!a&&!this.appModel.get("isLite"),n=this.model.get(this.SERVER_PAGING_PROP),this.$maxRowsInput.parent().toggle(!t||!n),this.$pageSizeInput.parent().toggle(t&&n),this.$serverPagingCheck.parent().toggle(t),this.stopListening(this.dataConfigVirtual,"execute",this.execute),this.listenTo(this.dataConfigVirtual,"execute",this.execute),this.stopListening(this.dataConfigSQLQuery,"execute",this.execute),this.listenTo(this.dataConfigSQLQuery,"execute",this.execute),this.dataConfigBuilder.onResize()):(this.dataConfigAnalytic=this.updateFormComponent(this.dataConfigAnalytic,DataConfigAnalytic,this.$el.find(".analytic-form").get(0)),(e=this.dataConfigAnalytic.$tree.jstree("get_selected"))instanceof Array&&0<e.length&&this.model.set("_selectedAnalytic",e[0]),this.model.set("_analyticParams",this.model.get("_analyticParameters")),t=-1!=["static","polling"].indexOf(this.model.get(this.SUBCRIPTION_PROPERTY))&&!a&&!this.appModel.get("isLite"),n=this.model.get(this.SERVER_PAGING_PROP),this.$maxRowsInput.parent().toggle(!t||!n),this.$pageSizeInput.parent().toggle(t&&n),this.$serverPagingCheck.parent().toggle(t),this.dataConfigAnalytic.onResize()),a?this.dataConfigPivot=this.updateFormComponent(this.dataConfigPivot,DataConfigQuery_Pivot,this.$el.find(".pivot-form").get(0)):l&&(this.dataConfigUpdate=this.updateFormComponent(this.dataConfigUpdate,DataConfigQuery_Update,this.$el.find(".update-form").get(0)))),this.updateQueryRadio()},updateFormComponent:function(e,t,n){return e?("builder"===this.model.get("_dataType")&&e.render(),e.$el.show()):(["builder","analytic"].includes(this.model.get("_dataType"))?(this.$el.find(".query-form").toggle(!1),this.$el.find(".sql-query-form").toggle(!1)):("sql"===this.model.get("_dataType")?this.$el.find(".sql-query-form"):this.$el.find(".query-form")).toggle($(n).hasClass("sql-query-form")||$(n).hasClass("query-form")||$(n).hasClass("update-form")||$(n).hasClass("pivot-form")),(e=new t({model:this.model,docDataModel:this.docDataModel,docViewModel:this.docViewModel,el:n,dialogContainer:this.dialogContainer,appModel:this.appModel,execute:this.execute.bind(this),subscriptionSelect:this.subscriptionSelect})).$el.show()),e},updateQueryStatus:function(e,t){t?(this.showQueryStatus(t),"Error"===t.type&&(this.hideUIMask(),this.model.stop(),this.$rawDataOutput.text(""))):this.hideQueryStatus()},updateColumnsProperty:function(t){t.reset?this.columnInfo.reset(t.reset):(this.columnInfo.remove(_.map(t.remove,function(e){return e.id})),this.columnInfo.add(t.add),this.columnInfo.add(t.change,{merge:!0})),_.some(["add","remove","reset","change"],function(e){return void 0!==t[e]})&&(this.model.set("_columns",this.columnInfo.map(function(e){return e.id}),{silent:!0}),this.subscriptionSelect.onModelColumnsChange(),"builder"===this.model.get("_dataType")&&this.dataConfigBuilder.onModelColumnsChange())},updateResultsButtons:function(){var e=this.model.get(this.SERVER_PAGING_PROP),t="virtual"===this.model.get(this.DATA_TYPE_PROP);this.$maxRowsInput.parent().toggle(!t&&!e),this.$pageSizeInput.parent().toggle(!t&&e),this.$serverPagingCheck.parent().toggle(!t)},reduceData:function(){var n,i=this.data.rows?this.data.rows.length:0;return 20<i?(n={},_.each(this.data,function(e,t){n[t]=e}),n.rows=[],_.each(this.data.rows,function(e,t){t<10||i-10<t?n.rows.push(e):10===n.rows.length&&n.rows.push(".. .. .. ..")}),n):this.data},updateMappingView:function(){var e,t;this.mappingView&&(e=this.$mappingDiv.parent(),t=this.$mappingDiv.prop("class"),this.mappingView.remove(),this.$mappingDiv=$("<div />"),this.$mappingDiv.prop("id",this.domIds.mappingId),this.$mappingDiv.prop("class",t),e.append(this.$mappingDiv)),this.model.dataMapper||this.model.apply(),this.mappingView=new DataConfigMapping({el:this.$mappingDiv,dataMapper:this.model.dataMapper,dialogContainer:this.dialogContainer,docDataModel:this.docDataModel,docViewModel:this.docViewModel})},updateParameterButton:function(){"deltaclient"===this.model.get(this.DATA_SOURCE_PROP)&&this.model.set({_dataSource:"kdb"},{silent:!0}),"sql"===this.model.get(this.DATA_SOURCE_PROP)&&"query"===this.model.get(this.DATA_SOURCE_PROP)?this.$addParameterButton.show():this.$addParameterButton.hide()},updatePivotButton:function(){_.includes(["streaming"],this.model.get(this.DATA_TYPE_PROP))?(this.$pivotLabel.hide(),this.model.set(this.PIVOT_TYPE_PROP,"")):this.$pivotLabel.show()},updateRawView:function(){var e=_.isString(this.data)?this.data:JSON.stringify(this.meta)+JSON.stringify(this.reduceData());this.$rawDataOutput.text(e)},updateQueryButtons:function(){_.includes(["virtual","streaming"],this.model.get(this.DATA_TYPE_PROP))?this.$updateLabel.hide():this.$updateLabel.show()},validateUI:function(){var e=!0,t="";return"pivot"===this.model.get("_dataType")&&(this.model.get("_breakdownCols").length<1||0===this.model.get("_aggregateCols").length)&&(e=!1,t="Please ensure breakdown columns and aggregate columns are populated."),e?this.hideQueryStatus():this.showQueryStatus({type:"Error",message:t}),this.model.trigger("isValid",e),e}},{filterAttributes:function(e){var t={query:["_queryString","_queryParams","_subscriptionKey","_hasUpdateQuery","_updateQueryParams","_updateQueryString","_updateType","_updateAnalytic"],sql:["_queryString","_queryParams","_subscriptionKey","_hasUpdateQuery","_updateQueryParams","_updateQueryString","_updateType","_updateAnalytic"],analytic:["_selectedAnalytic","_analyticParams","_analyticParameters","_streamingParameters","_subscriptionKey","_isStreamingSubscription","_hasUpdateQuery","_updateQueryString","_updateType","_updateAnalytic"],pivot:["_aggregateCols","_aggregateFns","_aggregateLabels","_breakdownCols","_columnLabel","_pivotSource","_pivotType","_table","_queryString","_queryParams","_aggFn","_topX","_ordering","_from","_to"],virtual:["_subscriptionKey","_virtualParams","_virtualQueryString"],builder:["_selectedAnalytic","_analyticParams","_builderParams","_subscriptionKey","_isStreamingSubscription","_graphJSON","_subscriptionKey","_selectedNode"]},n=["_autoExec","_autoExecute","_columns","_dataType","_dataSource","_connection","_mappings","_maxRows","_forceReset","_subscriptionType","_subscriptionInterval","_layout"],n=_.union(n,t[e._dataType]);return"query"!=e._dataType&&"sql"!=e._dataType&&"analytic"!=e._dataType&&"builder"!=e._dataType||-1==["static","polling"].indexOf(e._subscriptionType)||e._pivotType||(n=n.concat(["_pageSize","_serverPaging"])),e._pivotType&&(n=_.union(n,t.pivot)),_.pick(e,n)}}),DataConnectionDialog=Backbone.View.extend({className:"dataConnection-dialog",isModelChanged:!1,initialize:function(e){var n=this;n.options=e,n.appModel=n.options.appModel,n.path=n.options.path,this.$dialog=n.$el.dialog(_.extend({appendTo:e.container,title:t("Data Connection "),dialogClass:"quick-dash dlgDataConnection",resizable:!0,height:125,width:250,modal:!0,autoOpen:!0,buttons:[{text:t("Apply"),disabled:!0,click:$.proxy(n.onSelectButtonClick,n),icons:{primary:"fa fa-check"}},{text:t("Close"),click:$.proxy(n.onCancelButtonClick,n),icons:{primary:"fa fa-times"}}],open:function(){n.changeApplyButtonStatus(),$('<i class="fa fa-server" />').insertBefore(n.$el.parent().find(".ui-dialog-title")),n.model=new(Backbone.Model.extend({apply:$.noop,getChildren:$.noop,subscribe:$.noop}))({_connection:n.path,_dataType:"query"}),n.model.on("change:_connection",function(){var e=n.model.get("_connection");e&&(0<=e.indexOf("--Connection Groups--")||0<=e.indexOf("--Single Connections--"))&&(e=""),n.path=e,n.changeApplyButtonStatus()}),n.configDialog=new DataConfigForm({dataConnectionMiniMode:!0,docViewModel:n.options.docViewModel,dialogContainer:n.options.dialogContainer,model:n.model,appModel:n.appModel}),n.$el.append(n.configDialog.$el),_.delay(function(){n.configDialog.$el.find(".toolbar").css("position","relative"),_.delay(function(){n.configDialog.$el.find(".toolbar").css("position","absolute"),_.delay(function(){n.configDialog.$el.find(".toolbar").css("position","relative")},10)},500)},200)},close:function(){n.remove()}},e))},changeApplyButtonStatus:function(){this.$el.next().find("button:nth-of-type(1)").button({disabled:!this.path})},onCancelButtonClick:function(){this.$el.dialog("close")},onSelectButtonClick:function(){var e=this.options.selectCallback;e&&e(this.path),this.onCancelButtonClick()},remove:function(){this.model&&this.model.off(),this.$dialog.dialog("destroy"),Backbone.View.prototype.remove.apply(this,arguments)}}),MenuLayoutCheckbox=Backbone.View.extend({className:"menuLayoutCheckbox",initialize:function(e){this.add_keyword="ADD",this.delimiter_keyword="->",this.remove_keyword="REMOVE",this.codeEditor=e.codeEditor,this.componentModel=e.componentModel,this.id=e.id,this.menuLayout=this.setLayout(e.menuLayout),this.parseHTML=e.parseHTML,this.setDefaults=e.setDefaults,this.widgetId=e.widgetId,this.setDefaultsOptions(),this.render()},applyLayout:function(){var t=this,n=this,e=this.menuLayout.classes.filter(function(e){return"checked"===e.checked});0<e.length&&_.each(e,function(e){n.applyOption(t.add_keyword+t.delimiter_keyword+e.class)})},applyOption:function(e){var t,n,i=e.split(this.delimiter_keyword),e="",o=this.menuLayout.classes.filter(function(e){return e.class===i[1]}),a=this.parseExtractCSS(),s=this.parseHTML();i[0]===this.add_keyword?$(s[1]).addClass(i[1]):i[0]===this.remove_keyword&&$(s[1]).removeClass(i[1]),t=(t=(t="\x3c!--".concat($(s[0])[0].data).concat("--\x3e")).concat($(s[1])[0].outerHTML)).concat("\x3c!--").concat($(s[2])[0].data).concat("--\x3e"),this.processHTML(t),n=i[0]===this.add_keyword?(e=decodeURI(o[0].css),(n=(n=(n=a[1].concat("\n")).concat(a[2])).concat(e)).concat(a[3])):(e=decodeURI(o[0].css),s=this.componentModel.get("Style.advanced"),(n=this.replaceDataWidgetId(s,'data-widgetid=""')).replace(e,"")),this.processCSS(n)},initialiseCheckboxEvents:function(){var t=this,e=this.$el.find('input[type="checkbox"]');_.each(e,function(e){$(e).off("change"),$(e).on("change",function(){var e=(e=$(this).attr("class")).replace("GENERATED->","");this.checked?t.applyOption(t.add_keyword+t.delimiter_keyword+e):t.applyOption(t.remove_keyword+t.delimiter_keyword+e)})})},inspectHTML:function(){var t,e=this.parseHTML();e&&(e=$(e[1]).attr("class"))&&(t=e.split(" "),this.menuLayout.classes.map(function(e){t.includes(e.class)?e.checked="checked":e.checked=""}),this.applyLayout())},parseExtractCSS:function(){return/(.*\[START\].*)[\s\S](.*[\s\S]*\})(.*[\s\S]\/\*.*\*\/)/.exec(this.componentModel.get("Style.advanced"))},processCSS:function(e){var e=this.replaceDataWidgetId(e,'data-widgetid="'+this.widgetId+'"'),t=this.componentModel.get("Style.advanced"),t=/(.*[\s\S]*(\/\*.*START\])).*[\s\S]*(\/\*.*END\] \*\/)(.*[\s\S]*)/.exec(t);t&&(e=t[1].replace(t[2],"")+e,e+=t[4]),this.componentModel.set("Style.advanced",e)},processHTML:function(e){var t=this.codeEditor.getValue(),t=/(.*[\s\S]*(\<\!.*START\])).*[\s\S]*(\<\!.*END\]--\>)(.*[\s\S]*)/.exec(t),t=t?(t[1]=t[1].replace(t[2],""),t[1]+e+t[4]):e;this.codeEditor.setValue(t)},replaceDataWidgetId:function(e,t){return e.replace(/data-widgetid=".*"/g,t)},render:function(){this.inspectHTML(),this.$el.html(T.MenuLayoutCheckbox({checkboxes:this.menuLayout.classes})),this.initialiseCheckboxEvents()},setDefaultsOptions:function(){var t=this;this.menuLayout.classes.map(function(e){!0===e.default&&t.setDefaults?e.checked="checked":e.checked=""}),this.applyLayout()},setLayout:function(e){var t=this;return e.filter(function(e){return e.id===t.id})[0]}}),MenuLayoutItem=Backbone.View.extend({className:"menuLayoutItem ui-widget-content",initialize:function(e){this.codeEditor=e.codeEditor,this.componentModel=e.componentModel,this.menuLayout=e.menuLayout,this.onPresetSelected=e.onPresetSelected,this.parseHTML=e.parseHTML,this.widgetId=e.widgetId,this.render()},applyId:function(e,t){return $(t[1]).attr("id",e),result=(result=(result="\x3c!--".concat($(t[0])[0].data).concat("--\x3e")).concat($(t[1])[0].outerHTML)).concat("\x3c!--").concat($(t[2])[0].data).concat("--\x3e")},applyLayout:function(e){this.previouslySelected(e)||(this.processCSS(),this.processHTML(e))},encodeId:function(e){return btoa(e)},previouslySelected:function(e){var t=this.codeEditor.getValue(),t=this.parseHTML(t);return t?$(t[1]).attr("id")===e:null},processCSS:function(){var e=decodeURI(this.menuLayout.css),t=this.componentModel.get("Style.advanced"),t=/(.*[\s\S]*(\/\*.*START\])).*[\s\S]*(\/\*.*END\] \*\/)(.*[\s\S]*)/.exec(t),e=e.replace(/data-widgetid=""/g,'data-widgetid="'+this.widgetId+'"');t&&(e=t[1].replace(t[2],"")+e,e+=t[4]),this.componentModel.set("Style.advanced",e)},processHTML:function(e){var t=this.codeEditor.getValue(),n=decodeURI(this.menuLayout.html),t=/(.*[\s\S]*(\<\!.*START\])).*[\s\S]*(\<\!.*END\]--\>)(.*[\s\S]*)/.exec(t),n=this.parseHTML(n);n=this.applyId(e,n),e=t?(t[1]=t[1].replace(t[2],""),t[1]+n+t[4]):n,this.codeEditor.setValue(e)},render:function(){var t=this;this.$el.html(T.MenuLayoutItem({description:this.menuLayout.description,id:this.menuLayout.id,image:this.menuLayout.image,label:this.menuLayout.label})),this.$el.on("click",function(){var e=t.encodeId(t.menuLayout.id);t.applyLayout(e),t.onPresetSelected(e)}),this.$el.on({mouseenter:function(){t.$el.addClass("ui-state-hover")},mouseleave:function(){t.$el.removeClass("ui-state-hover")}})}}),MenuLayoutList=Backbone.View.extend({className:"menuLayoutList ui-widget-content",initialize:function(e){this.codeEditor=e.codeEditor,this.menuCheckbox,this.options=e,this.render()},addMenuLayoutCheckbox:function(e,t){e=this.decodeId(e);this.menuCheckbox&&this.menuCheckbox.remove(),this.menuCheckbox=new MenuLayoutCheckbox({codeEditor:this.options.codeEditor,componentModel:this.options.componentModel,id:e,menuLayout:this.options.menuLayout,parseHTML:this.parseHTML.bind(this),setDefaults:t,widgetId:this.options.widgetId}),this.menuCheckbox.$el.appendTo(this.$el.find(".checkboxes"))},addMenuLayoutItem:function(){var t=this;_.each(this.options.menuLayout,function(e){new MenuLayoutItem({codeEditor:t.options.codeEditor,componentModel:t.options.componentModel,menuLayout:e,onPresetSelected:t.onPresetSelected.bind(t),parseHTML:t.parseHTML.bind(t),widgetId:t.options.widgetId}).$el.appendTo(t.$el.find(".presets"))})},decodeId:function(e){return atob(e)},findId:function(){var e=this.parseHTML();return!!e&&$(e[1]).attr("id")},onPresetSelected:function(e){this.addMenuLayoutCheckbox(e,!0)},parseHTML:function(e){e=e||this.codeEditor.getValue(),e=/.*[\s\S]*(\<\!.*START\].*-->.*[\s\S]*)/.exec(e);return e?this.stripHTML($.parseHTML(e[1])):null},render:function(){this.$el.html(T.MenuLayoutList({text:"Sample Layout Presets"})),this.addMenuLayoutItem();var e=this.findId();e&&this.addMenuLayoutCheckbox(e,!1)},stripHTML:function(e){for(var t=[],n=0;n<e.length;n++)"\n"!=e[n].data&&"\r\n"!=e[n].data&&t.push(e[n]);return t}}),bkExtend=function(){var e,t=arguments;for(e in(t=1==t.length?[this,t[0]]:t)[1])t[0][e]=t[1][e];return t[0]};function bkClass(){}bkClass.prototype.construct=function(){},bkClass.extend=function(e){function t(){if(arguments[0]!==bkClass)return this.construct.apply(this,arguments)}var n=new this(bkClass);return bkExtend(n,e),t.prototype=n,t.extend=this.extend,t};var bkElement=bkClass.extend({construct:function(e,t){return e=$BK(e="string"==typeof e?(t||document).createElement(e):e)},appendTo:function(e){return e.appendChild(this),this},appendBefore:function(e){return e.parentNode.insertBefore(this,e),this},addEvent:function(e,t){return bkLib.addEvent(this,e,t),this},setContent:function(e){return this.innerHTML=e,this},pos:function(){var e=curtop=0;obj=this;if(obj.offsetParent)for(;e+=obj.offsetLeft,curtop+=obj.offsetTop,obj=obj.offsetParent;);var t=!window.opera&&parseInt(this.getStyle("border-width")||this.style.border)||0;return[e+t,curtop+t+this.offsetHeight]},noSelect:function(){return bkLib.noSelect(this),this},parentTag:function(e){var t=this;do{if(t&&t.nodeName&&t.nodeName.toUpperCase()==e)return t}while(t=t.parentNode);return!1},hasClass:function(e){return this.className.match(new RegExp("(\\s|^)nicEdit-"+e+"(\\s|$)"))},addClass:function(e){return this.hasClass(e)||(this.className+=" nicEdit-"+e),this},removeClass:function(e){return this.hasClass(e)&&(this.className=this.className.replace(new RegExp("(\\s|^)nicEdit-"+e+"(\\s|$)")," ")),this},setStyle:function(e){var t,n=this.style;for(t in e)switch(t){case"float":n.cssFloat=n.styleFloat=e[t];break;case"opacity":n.opacity=e[t],n.filter="alpha(opacity="+Math.round(100*e[t])+")";break;case"className":this.className=e[t];break;default:n[t]=e[t]}return this},getStyle:function(e,t){t=t||document.defaultView;if(1==this.nodeType)return t&&t.getComputedStyle?t.getComputedStyle(this,null).getPropertyValue(e):this.currentStyle[bkLib.camelize(e)]},remove:function(){return this.parentNode.removeChild(this),this},setAttributes:function(e){for(var t in e)this[t]=e[t];return this}}),bkLib={isMSIE:-1!=navigator.appVersion.indexOf("MSIE"),addEvent:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)},toArray:function(e){for(var t=e.length,n=new Array(t);t--;)n[t]=e[t];return n},noSelect:function(e){e.setAttribute&&"input"!=e.nodeName.toLowerCase()&&"textarea"!=e.nodeName.toLowerCase()&&e.setAttribute("unselectable","on");for(var t=0;t<e.childNodes.length;t++)bkLib.noSelect(e.childNodes[t])},camelize:function(e){return e.replace(/\-(.)/g,function(e,t){return t.toUpperCase()})},inArray:function(e,t){return null!=bkLib.search(e,t)},search:function(e,t){for(var n=0;n<e.length;n++)if(e[n]==t)return n;return null},cancelEvent:function(e){return(e=e||window.event).preventDefault&&e.stopPropagation&&(e.preventDefault(),e.stopPropagation()),!1},domLoad:[],domLoaded:function(){if(!arguments.callee.done)for(arguments.callee.done=!0,i=0;i<bkLib.domLoad.length;i++)bkLib.domLoad[i]()},onDomLoaded:function(e){this.domLoad.push(e),document.addEventListener?document.addEventListener("DOMContentLoaded",bkLib.domLoaded,null):bkLib.isMSIE&&(document.write("<style>.nicEdit-main p { margin: 0; }</style><script id=__ie_onload defer "+("https:"==location.protocol?"src='javascript:void(0)'":"src=//0")+"><\/script>"),$BK("__ie_onload").onreadystatechange=function(){"complete"==this.readyState&&bkLib.domLoaded()}),window.onload=bkLib.domLoaded}};function $BK(e){return(e="string"==typeof e?document.getElementById(e):e)&&!e.appendTo?bkExtend(e,bkElement.prototype):e}var bkEvent={addEvent:function(e,t){return t&&(this.eventList=this.eventList||{},this.eventList[e]=this.eventList[e]||[],this.eventList[e].push(t)),this},fireEvent:function(){var e=bkLib.toArray(arguments),t=e.shift();if(this.eventList&&this.eventList[t])for(var n=0;n<this.eventList[t].length;n++)this.eventList[t][n].apply(this,e)}};function __(e){return e}Function.prototype.closure=function(){var e=this,t=bkLib.toArray(arguments),n=t.shift();return function(){if(void 0!==bkLib)return e.apply(n,t.concat(bkLib.toArray(arguments)))}},Function.prototype.closureListener=function(){var n=this,i=bkLib.toArray(arguments),o=i.shift();return function(e){var t;return t=(e=e||window.event).target||e.srcElement,n.apply(o,[e,t].concat(i))}};var nicEditorConfig=bkClass.extend({buttons:{bold:{name:__("Click to Bold"),command:"Bold",tags:["B","STRONG"],css:{"font-weight":"bold"},key:"b",content:'<i class="fa fa-fw fa-bold" />'},italic:{name:__("Click to Italic"),command:"Italic",tags:["EM","I"],css:{"font-style":"italic"},key:"i",content:'<i class="fa fa-fw fa-italic" />'},underline:{name:__("Click to Underline"),command:"Underline",tags:["U"],css:{"text-decoration":"underline"},key:"u",content:'<i class="fa fa-fw fa-underline" />'},left:{name:__("Left Align"),command:"justifyleft",noActive:!0,content:'<i class="fa fa-fw fa-align-left" />'},center:{name:__("Center Align"),command:"justifycenter",noActive:!0,content:'<i class="fa fa-fw fa-align-center" />'},right:{name:__("Right Align"),command:"justifyright",noActive:!0,content:'<i class="fa fa-fw fa-align-right" />'},justify:{name:__("Justify Align"),command:"justifyfull",noActive:!0,content:'<i class="fa fa-fw fa-align-justify" />'},ol:{name:__("Insert Ordered List"),command:"insertorderedlist",tags:["OL"],content:'<i class="fa fa-fw fa-list-ol" />'},ul:{name:__("Insert Unordered List"),command:"insertunorderedlist",tags:["UL"],content:'<i class="fa fa-fw fa-list-ul" />'},subscript:{name:__("Click to Subscript"),command:"subscript",tags:["SUB"],content:'<i class="fa fa-fw fa-subscript" />'},superscript:{name:__("Click to Superscript"),command:"superscript",tags:["SUP"],content:'<i class="fa fa-fw fa-superscript" />'},strikethrough:{name:__("Click to Strike Through"),command:"strikeThrough",css:{"text-decoration":"line-through"},content:'<i class="fa fa-fw fa-align-justify" />'},removeformat:{name:__("Remove Formatting"),command:"removeformat",noActive:!0},indent:{name:__("Indent Text"),command:"indent",noActive:!0,content:'<i class="fa fa-fw fa-indent" />'},outdent:{name:__("Remove Indent"),command:"outdent",noActive:!0,content:'<i class="fa fa-fw fa-flip-horizontal fa-indent" />'},hr:{name:__("Horizontal Rule"),command:"insertHorizontalRule",noActive:!0}},buttonList:["save","bold","italic","underline","left","center","right","justify","ol","ul","fontSize","fontFamily","fontFormat","indent","outdent","image","upload","link","unlink","forecolor","html","beautify"],iconList:{bgcolor:1,forecolor:2,bold:3,center:4,hr:5,indent:6,italic:7,justify:8,left:9,ol:10,outdent:11,removeformat:12,right:13,save:24,strikethrough:15,subscript:16,superscript:17,ul:18,underline:19,image:20,link:21,unlink:22,close:23,arrow:25,html:26,beautify:27}}),nicEditors={nicPlugins:[],editors:[],registerPlugin:function(e,t){this.nicPlugins.push({p:e,o:t})},allTextAreas:function(e){for(var t=document.getElementsByTagName("textarea"),n=0;n<t.length;n++)nicEditors.editors.push(new nicEditor(e).panelInstance(t[n]));return nicEditors.editors},findEditor:function(e){for(var t=nicEditors.editors,n=0;n<t.length;n++)if(t[n].instanceById(e))return t[n].instanceById(e)}},nicEditor=bkClass.extend({construct:function(e){this.options=new nicEditorConfig,bkExtend(this.options,e),this.nicInstances=new Array,this.loadedPlugins=new Array;for(var t=nicEditors.nicPlugins,n=0;n<t.length;n++)this.loadedPlugins.push(new t[n].p(this,t[n].o));nicEditors.editors.push(this),bkLib.addEvent(document.body,"mousedown",this.selectCheck.closureListener(this))},panelInstance:function(e,t){e=this.checkReplace($BK(e));var n=new bkElement("DIV").appendBefore(e);return this.setPanel(n),this.addInstance(e,t)},checkReplace:function(e){var t=nicEditors.findEditor(e);return t&&(t.removeInstance(e),t.removePanel()),e},addInstance:function(e,t){return e=new((e=this.checkReplace($BK(e))).contentEditable||window.opera?nicEditorInstance:nicEditorIFrameInstance)(e,t,this),this.nicInstances.push(e),this},removeInstance:function(e){e=$BK(e);for(var t=this.nicInstances,n=0;n<t.length;n++)t[n].e==e&&(t[n].remove(),this.nicInstances.splice(n,1))},removePanel:function(e){this.nicPanel&&(this.nicPanel.remove(),this.nicPanel=null)},instanceById:function(e){e=$BK(e);for(var t=this.nicInstances,n=0;n<t.length;n++)if(t[n].e==e)return t[n]},setPanel:function(e){return this.nicPanel=new nicEditorPanel($BK(e),this.options,this),this.fireEvent("panel",this.nicPanel),this},nicCommand:function(e,t){this.selectedInstance&&this.selectedInstance.nicCommand(e,t)},getIcon:function(e,t){this.options.iconList[e],t.iconFiles&&t.iconFiles[e];return{}},selectCheck:function(e,t){do{if(t.className&&"function"==typeof t.className.indexOf&&-1!=t.className.indexOf("nicEdit"))return!1}while(t=t.parentNode);return this.fireEvent("blur",this.selectedInstance,t),this.lastSelectedInstance=this.selectedInstance,this.selectedInstance=null,!1}}),nicEditor=nicEditor.extend(bkEvent),nicEditorInstance=bkClass.extend({isSelected:!1,construct:function(e,t,n){this.ne=n,this.elm=this.e=e,this.options=t||{},newX=parseInt(e.getStyle("width"))||e.clientWidth,newY=parseInt(e.getStyle("height"))||e.clientHeight,this.initialHeight=newY-8;var i,n="textarea"==e.nodeName.toLowerCase();(n||this.options.hasPanel)&&((t={border:"1px solid #ccc",borderTop:0,overflowY:"auto",overflowX:"hidden"})[(i=bkLib.isMSIE&&!(void 0!==document.body.style.maxHeight&&"CSS1Compat"==document.compatMode))?"height":"maxHeight"]=this.ne.options.maxHeight?this.ne.options.maxHeight+"px":null,this.editorContain=new bkElement("DIV").setStyle(t).appendBefore(e),t=new bkElement("DIV").setStyle({margin:"4px",minHeight:newY+"px"}).addClass("main").appendTo(this.editorContain),e.setStyle({display:"none"}),t.innerHTML=e.innerHTML,n&&(t.setContent(e.value),(n=(this.copyElm=e).parentTag("FORM"))&&bkLib.addEvent(n,"submit",this.saveContent.closure(this))),t.setStyle(i?{height:newY+"px"}:{overflow:"hidden"}),this.elm=t),this.ne.addEvent("blur",this.blur.closure(this)),this.init(),this.blur()},init:function(){this.elm.setAttribute("contentEditable","true"),""==this.getContent()&&this.setContent("<br />"),this.instanceDoc=document.defaultView,this.elm.addEvent("mousedown",this.selected.closureListener(this)).addEvent("keypress",this.keyDown.closureListener(this)).addEvent("focus",this.selected.closure(this)).addEvent("blur",this.blur.closure(this)).addEvent("keyup",this.selected.closure(this)),this.ne.fireEvent("add",this)},remove:function(){this.saveContent(),(this.copyElm||this.options.hasPanel)&&(this.editorContain.remove(),this.e.setStyle({display:"block"}),this.ne.removePanel()),this.disable(),this.ne.fireEvent("remove",this)},disable:function(){this.elm.setAttribute("contentEditable","false")},getSel:function(){return window.getSelection?window.getSelection():document.selection},getRng:function(){var e=this.getSel();if(e&&0!==e.rangeCount)return 0<e.rangeCount?e.getRangeAt(0):e.createRange()},selRng:function(e,t){window.getSelection?(t.removeAllRanges(),t.addRange(e)):e.select()},selElm:function(){var e=this.getRng();if(e){if(e.startContainer){var t=e.startContainer;if(1==e.cloneContents().childNodes.length)for(var n=0;n<t.childNodes.length;n++){var i=t.childNodes[n].ownerDocument.createRange();if(i.selectNode(t.childNodes[n]),1!=e.compareBoundaryPoints(Range.START_TO_START,i)&&-1!=e.compareBoundaryPoints(Range.END_TO_END,i))return $BK(t.childNodes[n])}return $BK(t)}return $BK("Control"==this.getSel().type?e.item(0):e.parentElement())}},saveRng:function(){this.savedRange=this.getRng(),this.savedSel=this.getSel()},restoreRng:function(){this.savedRange&&this.selRng(this.savedRange,this.savedSel)},keyDown:function(e,t){e.ctrlKey&&this.ne.fireEvent("key",this,e)},selected:function(e,t){return(t=t||this.selElm)||(t=this.selElm()),e.ctrlKey||((e=this.ne.selectedInstance)!=this&&(e&&this.ne.fireEvent("blur",e,t),(this.ne.selectedInstance=this).ne.fireEvent("focus",e,t)),this.ne.fireEvent("selected",e,t),this.isFocused=!0,this.elm.addClass("selected")),!1},blur:function(){this.isFocused=!1,this.elm.removeClass("selected")},saveContent:function(){(this.copyElm||this.options.hasPanel)&&(this.ne.fireEvent("save",this),this.copyElm?this.copyElm.value=this.getContent():this.e.innerHTML=this.getContent())},getElm:function(){return this.elm},getContent:function(){return this.content=this.getElm().innerHTML,this.ne.fireEvent("get",this),this.content},setContent:function(e){this.content=e,this.ne.fireEvent("set",this),this.elm.innerHTML=this.content},nicCommand:function(e,t){document.execCommand(e,!1,t)}}),nicEditorIFrameInstance=nicEditorInstance.extend({savedStyles:[],init:function(){var e=this.elm.innerHTML.replace(/^\s+|\s+$/g,"");this.elm.innerHTML="",this.initialContent=e=e||"<br />",this.elmFrame=new bkElement("iframe").setAttributes({src:"javascript:;",frameBorder:0,allowTransparency:"true",scrolling:"no"}).setStyle({height:"100px",width:"100%"}).addClass("frame").appendTo(this.elm),this.copyElm&&this.elmFrame.setStyle({width:this.elm.offsetWidth-4+"px"});for(itm in["font-size","font-family","font-weight","color"])this.savedStyles[bkLib.camelize(itm)]=this.elm.getStyle(itm);setTimeout(this.initFrame.closure(this),50)},disable:function(){this.elm.innerHTML=this.getContent()},initFrame:function(){var e=$BK(this.elmFrame.contentWindow.document),t=(e.designMode="on",e.open(),this.ne.options.externalCSS);e.write("<html><head>"+(t?'<link href="'+t+'" rel="stylesheet" type="text/css" />':"")+'</head><body id="nicEditContent" style="margin: 0 !important; background-color: transparent !important;">'+this.initialContent+"</body></html>"),e.close(),this.frameDoc=e,this.frameWin=$BK(this.elmFrame.contentWindow),this.frameContent=$BK(this.frameWin.document.body).setStyle(this.savedStyles),this.instanceDoc=this.frameWin.document.defaultView,this.heightUpdate(),this.frameDoc.addEvent("mousedown",this.selected.closureListener(this)).addEvent("keyup",this.heightUpdate.closureListener(this)).addEvent("keydown",this.keyDown.closureListener(this)).addEvent("keyup",this.selected.closure(this)),this.ne.fireEvent("add",this)},getElm:function(){return this.frameContent},setContent:function(e){this.content=e,this.ne.fireEvent("set",this),this.frameContent.innerHTML=this.content,this.heightUpdate()},getSel:function(){return this.frameWin?this.frameWin.getSelection():this.frameDoc.selection},heightUpdate:function(){this.elmFrame.style.height=Math.max(this.frameContent.offsetHeight,this.initialHeight)+"px"},nicCommand:function(e,t){this.frameDoc.execCommand(e,!1,t),setTimeout(this.heightUpdate.closure(this),100)}}),nicEditorPanel=bkClass.extend({construct:function(e,t,n){this.elm=e,this.options=t,this.ne=n,this.panelButtons=new Array,this.buttonList=bkExtend([],this.ne.options.buttonList),this.panelContain=new bkElement("DIV").addClass("panelContain"),this.panelElm=new bkElement("DIV").addClass("panel").appendTo(this.panelContain),this.panelContain.appendTo(e);var i=this.ne.options;for(button in i.buttons)this.addButton(button,i,!0);this.reorder(),e.noSelect()},addButton:function(buttonName,options,noOrder){var button=options.buttons[buttonName],type=button.type?eval("(typeof("+button.type+') == "undefined") ? null : '+button.type+";"):nicEditorButton,hasButton=bkLib.inArray(this.buttonList,buttonName);type&&(hasButton||this.ne.options.fullPanel)&&(this.panelButtons.push(new type(this.panelElm,buttonName,options,this.ne)),hasButton||this.buttonList.push(buttonName))},findButton:function(e){for(var t=0;t<this.panelButtons.length;t++)if(this.panelButtons[t].name==e)return this.panelButtons[t]},reorder:function(){for(var e=this.buttonList,t=0;t<e.length;t++){var n=this.findButton(e[t]);n&&this.panelElm.appendChild(n.margin)}},remove:function(){this.elm.remove()}}),nicEditorButton=bkClass.extend({construct:function(e,t,n,i){this.options=n.buttons[t],this.name=t,this.ne=i,this.elm=e,this.margin=new bkElement("DIV").setStyle({float:"left",margin:"1px"}).appendTo(e),this.contain=new bkElement("DIV").setStyle({width:"24px",height:"24px"}).addClass("buttonContain").appendTo(this.margin),this.border=new bkElement("DIV").setStyle({}).appendTo(this.contain),this.options.content?(this.button=new bkElement("DIV").appendTo(this.border).setStyle({width:"22px",height:"22px",overflow:"hidden",zoom:1,cursor:"pointer"}).addClass("button"),this.button.innerHTML=this.options.content):this.button=new bkElement("DIV").setStyle({width:"22px",height:"22px",overflow:"hidden",zoom:1,cursor:"pointer"}).addClass("button").setStyle(this.ne.getIcon(t,n)).appendTo(this.border),this.button.addEvent("mouseover",this.hoverOn.closure(this)).addEvent("mouseout",this.hoverOff.closure(this)).addEvent("mousedown",this.mouseClick.closure(this)).noSelect(),window.opera||(this.button.onmousedown=this.button.onclick=bkLib.cancelEvent),i.addEvent("selected",this.enable.closure(this)).addEvent("blur",this.disable.closure(this)).addEvent("key",this.key.closure(this)),this.disable(),this.init()},init:function(){},hide:function(){this.contain.setStyle({display:"none"})},updateState:function(){this.isDisabled?this.setBg():this.isHover?this.setBg("hover"):this.isActive?this.setBg("active"):this.setBg()},setBg:function(e){this.border.removeClass("button-active").removeClass("button-hover").addClass("button-"+e)},checkNodes:function(e){var t=e;do{if(this.options.tags&&bkLib.inArray(this.options.tags,t.nodeName))return this.activate(),!0}while(t=t.parentNode&&"nicEdit"!=t.className);for(t=$BK(e);3==t.nodeType;)t=$BK(t.parentNode);if(this.options.css)for(itm in this.options.css)if(t.getStyle(itm,this.ne.selectedInstance.instanceDoc)==this.options.css[itm])return this.activate(),!0;return this.deactivate(),!1},activate:function(){this.isDisabled||(this.isActive=!0,this.updateState(),this.ne.fireEvent("buttonActivate",this))},deactivate:function(){this.isActive=!1,this.updateState(),this.isDisabled||this.ne.fireEvent("buttonDeactivate",this)},enable:function(e,t){this.isDisabled=!1,this.contain.setStyle({opacity:1}).addClass("buttonEnabled"),this.updateState(),this.checkNodes(t)},disable:function(e,t){this.isDisabled=!0,this.contain.setStyle({opacity:.6}).removeClass("buttonEnabled"),this.updateState()},toggleActive:function(){this.isActive?this.deactivate():this.activate()},hoverOn:function(){this.isDisabled||(this.isHover=!0,this.updateState(),this.ne.fireEvent("buttonOver",this))},hoverOff:function(){this.isHover=!1,this.updateState(),this.ne.fireEvent("buttonOut",this)},mouseClick:function(){this.options.command&&(this.ne.nicCommand(this.options.command,this.options.commandArgs),this.options.noActive||this.toggleActive()),this.ne.fireEvent("buttonClick",this)},key:function(e,t){this.options.key&&t.ctrlKey&&String.fromCharCode(t.keyCode||t.charCode).toLowerCase()==this.options.key&&(this.mouseClick(),t.preventDefault&&t.preventDefault())}}),nicPlugin=bkClass.extend({construct:function(e,t){this.options=t,this.ne=e,this.ne.addEvent("panel",this.loadPanel.closure(this)),this.init()},loadPanel:function(e){for(var t in this.options.buttons)e.addButton(t,this.options);e.reorder()},init:function(){}}),nicPaneOptions={},nicEditorPane=bkClass.extend({construct:function(e,t,n,i){this.ne=t,this.elm=e,this.pos=e.pos(),this.contain=new bkElement("div").setStyle({zIndex:"99999",overflow:"hidden",position:"absolute",left:this.pos[0]+"px",top:this.pos[1]+"px"}),this.pane=new bkElement("div").setStyle({fontSize:"12px",border:"1px solid #ccc",overflow:"hidden",padding:"4px",textAlign:"left",backgroundColor:"#ffffc9"}).addClass("pane").setStyle(n).appendTo(this.contain),i&&!i.options.noClose&&(this.close=new bkElement("div").setStyle({float:"right",height:"16px",width:"16px",cursor:"pointer"}).setStyle(this.ne.getIcon("close",nicPaneOptions)).addEvent("mousedown",i.removePane.closure(this)).appendTo(this.pane)),this.contain.noSelect().appendTo(document.body),this.position(),this.init()},init:function(){},position:function(){var e;this.ne.nicPanel&&(e=(e=this.ne.nicPanel.elm).pos()[0]+parseInt(e.getStyle("width"))-(parseInt(this.pane.getStyle("width"))+8))<this.pos[0]&&this.contain.setStyle({left:e+"px"})},toggle:function(){this.isVisible=!this.isVisible,this.contain.setStyle({display:this.isVisible?"block":"none"})},remove:function(){this.contain&&(this.contain.remove(),this.contain=null)},append:function(e){e.appendTo(this.pane)},setContent:function(e){this.pane.setContent(e)}}),nicEditorAdvancedButton=nicEditorButton.extend({init:function(){this.ne.addEvent("selected",this.removePane.closure(this)).addEvent("blur",this.removePane.closure(this))},mouseClick:function(){this.isDisabled||(this.pane&&this.pane.pane?this.removePane():(this.pane=new nicEditorPane(this.contain,this.ne,{width:this.width||"270px",backgroundColor:"#303030",color:"#fff"},this),this.addPane(),this.ne.selectedInstance.saveRng()))},addForm:function(e,t){var n=this;for(itm in this.form=new bkElement("form").addEvent("submit",this.submit.closureListener(this)),$(this.pane.pane).addClass("quick-dash rich-text-editor-dialog"),this.pane.append(this.form),this.inputs={},e){var i=e[itm],o="",a=(o=(o=t?t.getAttribute(itm):o)||(i.value||""),e[itm].type);if("title"==a)new bkElement("div").setContent(i.txt).setStyle({fontSize:"14px",fontWeight:"bold",padding:"0px",margin:"2px 0"}).appendTo(this.form);else{var s=new bkElement("div").setStyle({overflow:"hidden",clear:"both"}).appendTo(this.form);switch(i.txt&&new bkElement("label").setAttributes({for:itm}).setContent(i.txt).setStyle({margin:"2px 4px",fontSize:"13px",width:"50px",lineHeight:"20px",textAlign:"right",float:"left"}).appendTo(s),a){case"text":this.inputs[itm]=new bkElement("input").setAttributes({id:itm,value:o,type:"text"}).setStyle({margin:"2px 0",fontSize:"13px",float:"left",height:"20px",border:"none",overflow:"hidden"}).setStyle(i.style).appendTo(s);break;case"select":for(opt in this.inputs[itm]=new bkElement("select").setAttributes({id:itm}).setStyle({border:"none",float:"left",margin:"2px 0"}).appendTo(s),i.options)new bkElement("option").setAttributes({value:opt,selected:opt==o?"selected":""}).setContent(i.options[opt]).appendTo(this.inputs[itm]);break;case"content":this.inputs[itm]=new bkElement("textarea").setAttributes({id:itm}).setStyle({border:"1px solid #ccc",float:"left"}).setStyle(i.style).appendTo(s),this.inputs[itm].value=o;break;case"imageupload":var l=$('<div><input class="file-input" type="file"  accept="image/*" style="display: none;"/><div class="upload-btn" style="height: 25px;">Upload Image</div><span class="file-name"></span></div>');this.inputs[itm]=new bkElement(l).appendTo(s),l.find(".upload-btn").button({icons:{primary:"fa fa-upload"},text:!0}).click(function(){l.find(".file-input").click()}),l.find(".file-input").on("change",function(e){var t;0<e.target.files.length&&((t=new FileReader).onload=function(e){n.imgSrc=e.target.result,l.find(".file-name").text(l.find(".file-input").val().replace(/C:\\fakepath\\/i,""))},t.readAsDataURL(e.target.files[0]))})}}}new bkElement("input").setAttributes({type:"submit"}).appendTo(this.form),this.form.onsubmit=bkLib.cancelEvent},submit:function(){},findElm:function(e,t,n){for(var i=this.ne.selectedInstance.getElm().getElementsByTagName(e),o=0;o<i.length;o++)if(i[o].getAttribute(t)==n)return $BK(i[o])},removePane:function(){this.pane&&(this.pane.remove(),this.pane=null,this.ne.selectedInstance.restoreRng())}}),nicButtonTips=bkClass.extend({construct:function(e){(this.ne=e).addEvent("buttonOver",this.show.closure(this)).addEvent("buttonOut",this.hide.closure(this))},show:function(e){this.timer=setTimeout(this.create.closure(this,e),400)},create:function(e){this.timer=null,this.pane||(this.pane=new nicEditorPane(e.button,this.ne,{fontSize:"12px",marginTop:"5px"}),this.pane.setContent(e.options.name))},hide:function(e){this.timer&&clearTimeout(this.timer),this.pane&&(this.pane=this.pane.remove())}}),nicSelectOptions=(nicEditors.registerPlugin(nicButtonTips),{buttons:{fontSize:{name:__("Select Font Size"),type:"nicEditorFontSizeSelect",command:"fontsize"},fontFamily:{name:__("Select Font Family"),type:"nicEditorFontFamilySelect",command:"fontname"},fontFormat:{name:__("Select Font Format"),type:"nicEditorFontFormatSelect",command:"formatBlock"}}}),nicEditorSelect=bkClass.extend({construct:function(e,t,n,i){this.options=n.buttons[t],this.elm=e,this.ne=i,this.name=t,this.selOptions=new Array,this.margin=new bkElement("div").setStyle({float:"left",margin:"1px 1px 0 1px"}).appendTo(this.elm),this.contain=new bkElement("div").setStyle({width:"90px",padding:"4px",height:"16px",cursor:"pointer",overflow:"hidden"}).addClass("selectContain").addEvent("click",this.toggle.closure(this)).appendTo(this.margin),this.items=new bkElement("div").setStyle({overflow:"hidden",zoom:1,border:"transparent",paddingLeft:"3px"}).appendTo(this.contain),this.control=new bkElement("i").setStyle({overflow:"hidden",marginTop:"3px",float:"right",height:"18px",width:"16px"}).addClass("selectControl fa fa-fw fa-caret-down").appendTo(this.items),this.txt=new bkElement("div").setStyle({overflow:"hidden",float:"left",width:"66px",height:"14px",marginTop:"1px",fontFamily:"sans-serif",textAlign:"center",fontSize:"12px"}).addClass("selectTxt").appendTo(this.items),window.opera||(this.contain.onmousedown=this.control.onmousedown=this.txt.onmousedown=bkLib.cancelEvent),this.margin.noSelect(),this.ne.addEvent("selected",this.enable.closure(this)).addEvent("blur",this.disable.closure(this)),this.disable(),this.init()},disable:function(){this.isDisabled=!0,this.close(),this.contain.setStyle({opacity:.6})},enable:function(e){this.isDisabled=!1,this.close(),this.contain.setStyle({opacity:1})},setDisplay:function(e){this.txt.setContent(e)},toggle:function(){this.isDisabled||(this.pane?this.close():this.open())},open:function(){this.pane=new nicEditorPane(this.items,this.ne,{width:"88px",padding:"0px",borderTop:0,borderLeft:"1px solid #ccc",borderRight:"1px solid #ccc",borderBottom:"0px",backgroundColor:"#fff"});for(var e=0;e<this.selOptions.length;e++){var t=this.selOptions[e],n=new bkElement("div").setStyle({overflow:"hidden",borderBottom:"1px solid #ccc",width:"88px",textAlign:"left",cursor:"pointer"}),i=new bkElement("div").setStyle({padding:"0px 4px"}).setContent(t[1]).appendTo(n).noSelect();i.addEvent("click",this.update.closure(this,t[0])).addEvent("mouseover",this.over.closure(this,i)).addEvent("mouseout",this.out.closure(this,i)).setAttributes("id",t[0]),this.pane.append(n),window.opera||(i.onmousedown=bkLib.cancelEvent)}},close:function(){this.pane&&(this.pane=this.pane.remove())},over:function(e){e.setStyle({backgroundColor:"#ccc"})},out:function(e){e.setStyle({backgroundColor:"#fff"})},add:function(e,t){this.selOptions.push(new Array(e,t))},update:function(e){this.ne.nicCommand(this.options.command,e),this.close()}}),nicEditorFontSizeSelect=nicEditorSelect.extend({sel:{1:"1&nbsp;(8pt)",2:"2&nbsp;(10pt)",3:"3&nbsp;(12pt)",4:"4&nbsp;(14pt)",5:"5&nbsp;(18pt)",6:"6&nbsp;(24pt)"},init:function(){for(itm in this.setDisplay("Font&nbsp;Size..."),this.sel)this.add(itm,'<font size="'+itm+'">'+this.sel[itm]+"</font>")}}),nicEditorFontFamilySelect=nicEditorSelect.extend({sel:{arial:"Arial","comic sans ms":"Comic Sans","courier new":"Courier New",georgia:"Georgia",helvetica:"Helvetica",impact:"Impact","times new roman":"Times","trebuchet ms":"Trebuchet",verdana:"Verdana"},init:function(){for(itm in this.setDisplay("Font&nbsp;Family..."),this.sel)this.add(itm,'<font face="'+itm+'">'+this.sel[itm]+"</font>")}}),nicEditorFontFormatSelect=nicEditorSelect.extend({sel:{p:"Paragraph",pre:"Pre",h6:"Heading&nbsp;6",h5:"Heading&nbsp;5",h4:"Heading&nbsp;4",h3:"Heading&nbsp;3",h2:"Heading&nbsp;2",h1:"Heading&nbsp;1"},init:function(){for(itm in this.setDisplay("Font&nbsp;Format..."),this.sel){var e=itm.toUpperCase();this.add("<"+e+">","<"+itm+' style="padding: 0px; margin: 0px;">'+this.sel[itm]+"</"+e+">")}}}),nicLinkOptions=(nicEditors.registerPlugin(nicPlugin,nicSelectOptions),{buttons:{link:{name:"Add Link",type:"nicLinkButton",tags:["A"],content:'<i class="fa fa-fw fa-link"/>'},unlink:{name:"Remove Link",command:"unlink",noActive:!0,content:'<i class="fa fa-fw fa-unlink"/>'}}}),nicLinkButton=nicEditorAdvancedButton.extend({addPane:function(){this.ln=this.ne.selectedInstance.selElm().parentTag("A"),this.addForm({"":{type:"title",txt:"Add/Edit Link"},href:{type:"text",txt:"URL",value:"http://",style:{width:"150px"}},title:{type:"text",txt:"Title"},target:{type:"select",txt:"Open In",options:{"":"Current Window",_blank:"New Window"},style:{width:"100px"}}},this.ln)},submit:function(e){var t=this.inputs.href.value;if("http://"==t||""==t)return alert("You must enter a URL to Create a Link"),!1;this.removePane(),this.ln||(this.ne.nicCommand("createlink",t="javascript:nicTemp();"),this.ln=this.findElm("A","href",t)),this.ln&&this.ln.setAttributes({href:this.inputs.href.value,title:this.inputs.title.value,target:this.inputs.target.options[this.inputs.target.selectedIndex].value})}}),nicColorOptions=(nicEditors.registerPlugin(nicPlugin,nicLinkOptions),{buttons:{forecolor:{name:__("Change Text Color"),type:"nicEditorColorButton",noClose:!0,content:'<i class="fa fa-fw fa-font" />'},bgcolor:{name:__("Change Background Color"),type:"nicEditorBgColorButton",noClose:!0,content:'<i class="fa fa-fa fa-eyedropper"></i>'}}}),nicEditorColorButton=nicEditorAdvancedButton.extend({addPane:function(){var e,t={0:"00",1:"33",2:"66",3:"99",4:"CC",5:"FF"},n=new bkElement("DIV").setStyle({width:"270px"});for(e in t)for(var i in t)for(var o in t){var o="#"+t[e]+t[o]+t[i],a=new bkElement("DIV").setStyle({cursor:"pointer",height:"15px",float:"left"}).appendTo(n),s=new bkElement("DIV").setStyle({border:"2px solid "+o}).appendTo(a),o=new bkElement("DIV").setStyle({backgroundColor:o,overflow:"hidden",width:"11px",height:"11px"}).addEvent("click",this.colorSelect.closure(this,o)).addEvent("mouseover",this.on.closure(this,s)).addEvent("mouseout",this.off.closure(this,s,o)).appendTo(s);window.opera||(a.onmousedown=o.onmousedown=bkLib.cancelEvent)}this.pane.append(n.noSelect())},colorSelect:function(e){this.ne.nicCommand("foreColor",e),this.removePane()},on:function(e){e.setStyle({border:"2px solid #000"})},off:function(e,t){e.setStyle({border:"2px solid "+t})}}),nicEditorBgColorButton=nicEditorColorButton.extend({colorSelect:function(e){this.ne.nicCommand("hiliteColor",e),this.removePane()}}),nicImageOptions=(nicEditors.registerPlugin(nicPlugin,nicColorOptions),{buttons:{image:{name:"Add Image",type:"nicImageButton",tags:["IMG"],content:'<i class="fa fa-fw fa-picture-o" />'}}}),nicImageButton=nicEditorAdvancedButton.extend({addPane:function(){this.im=this.ne.selectedInstance.selElm().parentTag("IMG"),this.addForm({"":{type:"title",txt:"Add/Edit Image"},width:{type:"text",txt:"Width",value:"",style:{width:"100px"}},height:{type:"text",txt:"Height",value:"",style:{width:"100px"}},alt:{type:"text",txt:"Alt Text",style:{width:"100px"}},align:{type:"select",txt:"Align",options:{none:"Default",left:"Left",right:"Right"}},imageupload:{type:"imageupload",txt:"Source",style:{width:"100px",height:"25px;"}}},this.im)},submit:function(e){var t;if(this.removePane(),this.im||(this.ne.nicCommand("insertImage",t="javascript:nicImTemp();"),this.im=this.findElm("IMG","src",t)),this.im){if(this.imgSrc)this.im.setAttributes({src:this.imgSrc,alt:this.inputs.alt.value,align:this.inputs.align.value});else if("javascript:nicImTemp();"!==this.im.src.length)this.im.setAttributes({alt:this.inputs.alt.value,align:this.inputs.align.value});else if(!this.imgSrc||0==this.imgSrc.length)return alert("You must upload an image to insert"),!1;0<this.inputs.width.value&&this.im.setAttributes({width:this.inputs.width.value}),0<this.inputs.height.value&&this.im.setAttributes({height:this.inputs.height.value}),this.imgSrc=null}}}),nicSaveOptions=(nicEditors.registerPlugin(nicPlugin,nicImageOptions),{buttons:{save:{name:__("Save this content"),type:"nicEditorSaveButton"}}}),nicEditorSaveButton=nicEditorButton.extend({init:function(){this.ne.options.onSave||this.margin.setStyle({display:"none"})},mouseClick:function(){var e=this.ne.options.onSave,t=this.ne.selectedInstance;e(t.getContent(),t.elm.id,t)}}),nicHTMLOptions=(nicEditors.registerPlugin(nicPlugin,nicSaveOptions),{buttons:{html:{name:__("Edit raw HTML"),type:"nicEditorHTMLButton",content:'<i class="fa fa-fw fa-code" />'}}}),nicEditorHTMLButton=nicEditorButton.extend({init:function(){var e;this.ne.options.onCode||this.margin.setStyle({display:"none"}),this.ne.options.htmlButtonDesc&&(this.button.innerHTML=this.options.content=this.ne.options.htmlButtonDesc,e={fontFamily:"sans-serif",textAlign:"center",fontSize:"12px",width:"Basic mode"===this.options.content?"80px":"120px"},this.button.setStyle(_.extend({},e,{marginTop:"3px"})),this.contain.setStyle(e))},disable:function(){this.isDisabled||this.contain.setStyle({opacity:1})},mouseClick:function(){(0,this.ne.options.onCode)(this)}}),nicBeautifyOptions=(nicEditors.registerPlugin(nicPlugin,nicHTMLOptions),{buttons:{beautify:{name:__("Beautify HTML"),type:"beautifyButton",content:'<i class="fa fa-bath"></i>'}}}),beautifyButton=nicEditorButton.extend({init:function(){this.ne.options.onBeautify||this.margin.setStyle({display:"none"})},disable:function(){this.contain.setStyle({opacity:1})},mouseClick:function(){(0,this.ne.options.onBeautify)(this)}}),TemplateDialog=(nicEditors.registerPlugin(nicPlugin,nicBeautifyOptions),V5a=Backbone.View,__extends(W5a,V5a),W5a.prototype.onResize=function(){MonacoHelpers.adjustAfterResize(this.editor)},W5a.prototype.remove=function(){return this.unregisterHandlebarIntellisense&&this.unregisterHandlebarIntellisense.dispose(),this.editor&&(this.editor=null),this.editor=this.$beautify=this.$dialog=this.$selectable=this.options=null,Backbone.View.prototype.remove.call(this)},W5a.prototype.checkForAdvancedHelpers=function(e){W5a.NONEACH_HELPER_RX.test(e)?this.$basicMode.hide():this.$basicMode.show()},W5a.prototype.checkForErrors=function(e){try{Handlebars.compile(e)({}),this.$error.hide()}catch(e){this.$error.show(),this.$error.find("div")[0].innerText=e.message}},W5a.prototype.descriptify=function(e){return e=e&&(e=e.replace(/<script class="handlebars-helpers" type="handlebars-helpers">/gi,"")).replace(/<\/script>/gi,"")},W5a.prototype.initHorizontalResize=function(){try{this.$sidebar.resizable("destroy")}catch(e){}this.$sidebar.resizable({handles:"e",minWidth:220,maxWidth:300}).on("resize",this.onHorizontalResize.bind(this))},W5a.prototype.insertItem=function(e){function o(e,t){return e.replace(W5a.VS_HBAR_RX,"{{"+_.repeat("../",t)+"$1}}")}var a=this,s=e.parents[e.parents.length-2],l=[],r=new RegExp("{{\\s*#each\\s*"+s.substring(1)+"\\s*}}");if(this.isInCodeMode){var e=this.descriptify(this.wrapInHandlebars(e.id)),t=this.codeEditor.getModel().findMatches(W5a.EACH_HELPERS_RX.source,!0,!0,!1,null,!0),i=this.codeEditor.getPosition();_.each(t,function(e,t){var n=e.range.getEndPosition();i.lineNumber<n.lineNumber||i.lineNumber===n.lineNumber&&i.column<n.column||(W5a.EACH_END_RX.test(e.matches[0])?l.pop():l.push(r.test(e.matches[0])))}),_.every(l,function(e){return!e})&&_.includes(s,"@")?e="{{#each "+s.substring(1)+"}}<div>"+e+"</div>{{/each}}":l.length&&!_.includes(s,"@")&&(e=o(e,l.length)),this.codeEditor.trigger("keyboard","type",{text:e})}else{var c=this.editorField;if(c&&this.pendingContent){for(var d,u=nicEditors.findEditor(this.INSTANCE_ID),t=u.savedRange.endOffset+this.pendingContent.length-(c.data?c.data.length:0),n=(c.nodeValue?c.nodeValue=this.pendingContent:0===(e=this.editorRng.endOffset)?c.prepend(this.pendingContent):(e=c.childNodes[e-1])?e.before(this.pendingContent):c.append(this.pendingContent),this.debouncedUpdateSidebar(u.elm.innerText),_.each(Array.from(u.elm.childNodes),function(e){if(e instanceof HTMLElement&&"SCRIPT"===e.tagName)W5a.EACH_END_RX.test(e.innerText)?l.pop():r.test(e.innerText)?l.push(!0):W5a.EACH_START_RX.test(e.innerText)&&l.push(!1);else if(e===c||_.includes(Array.from(e.childNodes),c)||_.includes(Array.from(c.childNodes),e)){if(l.length&&!_.includes(s,"@"))return void(3===c.nodeType?c.nodeValue=o(c.nodeValue,l.length):c.innerText=o(c.innerText,l.length));var t,n,i;if(_.includes(s,"@")&&_.every(l,function(e){return!e}))return n=t=void 0,i="",e instanceof HTMLElement?n=(t=e).outerHTML:(t=d,n="<div>"+_.trim(e.textContent)+"</div>",i="\n"),n=a.scriptify(i+"{{#each "+s.substring(1)+"}}"+o(n,1+l.length)+"{{/each}}"),t?(t.insertAdjacentHTML("afterend",n),c=t.nextSibling.nextSibling,i&&(c=c.nextSibling)):(u.elm.insertAdjacentHTML("afterbegin",n),c=u.elm.childNodes[2]),3===c.childNodes[0].nodeType&&(c=c.childNodes[0]),void u.elm.removeChild(e)}e instanceof HTMLElement&&(d=e)}),c),p=c,h=[];n!==u.elm;)n=p.parentNode,h.push(Array.prototype.indexOf.call(n.childNodes,p)),p=n;var e=_.some(n.childNodes,function(e){return"handlebars-helpers"===e.type}),m=document.createRange();if(h.length){for(var g=e?n.childNodes:_.filter(n.childNodes,function(e){return"handlebars-helpers"!==e.type}),n=g=e||g.length===n.childNodes.length?g:g[0].childNodes,f=h.length-1;0<=f;f--)n=(c=n[h[f]]).childNodes;t=1<c.childNodes.length?c.childNodes.length:t}else{e=_.find(c.childNodes,function(e){return"handlebars-helpers"!==e.type});e&&(c=e.childNodes.length?e.childNodes[0]:e)}c.data&&c.data!==this.pendingContent&&(t+=c.data.length-this.pendingContent.length),m.setStart(c,t),m.setEnd(c,t),u.selRng(m,u.getSel()),this.pendingContent="",this.editorField=null,this.editorRng=null}}},W5a.prototype.onHorizontalResize=function(){var e=this.$sidebar.width();this.$textEditor.css({width:"calc(100% - "+e+"px)",left:e+"px"})},W5a.prototype.jstreeSearch=function(e){this.$tree.jstree("show_all"),this.$tree.jstree().search(e)},W5a.prototype.initCodeEditor=function(i){var o=this;MonacoHelpers.require({language:"handlebars"},function(e){var t=e.monaco,n=e.docs,e=e.disposable,n=(o.docs=n,o.unregisterHandlebarIntellisense=e,o.$el.find(".code")[0]),e=(o.codeEditor||(o.codeEditor=t.editor.create(n,{language:"handlebars",automaticLayout:!0,theme:"kx-light"!==$.cookie("dashboard-theme")?"vs-dark":"vs",contextmenu:!1,fixedOverflowWidgets:!0,fontSize:12,minimap:{enabled:!1},scrollBeyondLastLine:!1,wordWrap:"on",dragAndDrop:!1})),o.codeEditor.getAction("editor.action.formatDocument").run(),i||o.editor.instanceById(o.INSTANCE_ID).getContent());o.checkForAdvancedHelpers(e),o.codeEditor.setValue(o.descriptify(e)),o.codeEditor.getModel().onDidChangeContent(function(){var e=o.codeEditor.getModel().getValue();o.disableTree||o.debouncedUpdateSidebar(e),o.debouncedCheckForErrors(e),o.debouncedCheckForAdvancedHelpers(e)})})},W5a.prototype.initHandlebarHelperPicker=function(){var t=this,e=["each","eq","gt","lt","if","toFixed","addCommas","toPrecision"],e=e.concat(Object.keys(_.omit(Handlebars.helpers,["blockHelperMissing","t","helperMissing","valueProps","lookup","log","type-cast","unless"].concat(e))).sort());_.each(e,function(e){t.$el.find(".gok-handlebarselect").append("<option value="+e+">"+e+"</option>")}),this.$helperSelect=this.$el.find(".gok-handlebarselect").select2({minimumResultsForSearch:5,theme:"dashboards",width:"100px"}),this.$el.find(".add-helper").button({icons:{primary:"fa fa-plus"}}).click(function(){var e=t.$helperSelect.val(),e=t.getHandlebarHelperShell(e);t.codeEditor.setValue(t.codeEditor.getValue()+"\n"+e)})},W5a.prototype.getHandlebarHelperShell=function(e){var t=this.docs[e];if(!t||!t.comment)return"{{"+e+"}}";var n=t.comment.match(/```handlebars\n((.|\n)+)(```)/);return n&&n[0]?n[0].replace(/ \* /g,"").replace("```handlebars","").replace("```","").trim():t.comment.match(/\@block/)?"{{#"+e+"}} {{/"+e+"}}":"{{"+e+"}}"},W5a.prototype.onButtonClick=function(){var e=this.isInCodeMode?this.codeEditor.getValue():this.editor.instanceById(this.INSTANCE_ID).getContent();e=this.descriptify(e),this.options.allowUnsafeContent||(e=this.options.sanitizeTemplate?this.options.sanitizeTemplate(e):DOMPurify.sanitize(e,{ADD_ATTR:["target"]})),this.options.applyCallback&&this.options.applyCallback(e)},W5a.prototype.renderPreview=function(e){this.$preview.empty(),this.$preview.append("<div>"+e+"</div>")},W5a.prototype.requiresBrackets=function(e){return W5a.VSRx.test(e)||/\s/.test(e)},W5a.prototype.scriptify=function(e){return e=e.replace(W5a.EACH_HELPERS_RX,function(e){return'<script class="handlebars-helpers" type="handlebars-helpers">'+e+"<\/script>"})},W5a.prototype.trimVSChars=function(e){return W5a.VSRx.test(e)?e.substring(1,e.length-1):e},W5a.prototype.updateSidebar=function(n){var i=this,o=[],e=(_.each([/{{2,3}(#?\w+\s+)?\s*([\w\.]+)[^{}]*}{2,3}/gm,/{{2,3}[^{}]*\[(\$[\w\s\.]+\$)\][^{}]*}{2,3}/gm],function(e){for(;null!==(t=e.exec(n));){var t=i.$tree.jstree().get_node(t[2]||t[1]);t&&("activeKey"!==t.type&&(t.oldType=t.type,i.$tree.jstree().set_type(t,"activeKey")),o.push(t))}}),_.remove(this.activeKeys,function(e){return!_.includes(o,e)}));_.each(e,function(e){return i.$tree.jstree().set_type(e,e.oldType)}),this.activeKeys=o},W5a.prototype.updateTheme=function(){var e=$("#appdiv .toolbar").hasClass("kx-light")?"kx-light":"kx-darkroom",t=$(document).find(".vakata-context.jstree-contextmenu");t&&(t.removeClass("kx-light kx-darkroom"),t.addClass(e))},W5a.prototype.wrapInHandlebars=function(e){return this.requiresBrackets(e)?"{{["+e+"]}}":"{{"+e+"}}"},W5a.DIALOG_HEIGHT=540,W5a.VSRx=/\$[^$]*\$/i,W5a.BLOCK_HELPERS_RX=/{{(\s*#|\s*\/)[^}]*}}/gi,W5a.EACH_HELPERS_RX=/{{(\s*#|\s*\/)each[^}]*}}/gi,W5a.EACH_START_RX=/{{\s*#each\s*(\w*)\s*}}/,W5a.EACH_END_RX=/{{\/\s*each\s*}}/,W5a.NONEACH_HELPER_RX=/{{(\s*#|\s*\/)(?!each)[^{}]*}}/i,W5a.VS_HBAR_RX=/{{(?:..\/)*(\[\$([\w\.])+\$\])}}/g,W5a),V5a;function W5a(e){var s=V5a.call(this,_.extend({},e,{className:"template-dialog"}))||this,n=(s.INSTANCE_ID="ffsEdit",s.options=e,s.keys=e.keys,s.valueData=e.valueData,s.docViewModel=e.docViewModel,s.disableTree=e.disableTree,s.$el.html(T.TemplateDialog({uid:s.INSTANCE_ID,background:e.background})),s.$textEditor=s.$el.find(".template-editor"),s.$editor=s.$el.find(".editor"),s.$code=s.$el.find(".code"),s.$error=s.$el.find(".handlebar-errors"),s.$tree=s.$el.find(".tree"),s.$search=s.$el.find(".topnav"),s.$clearSearch=s.$el.find(".clearSearch"),s.$sidebar=s.$el.find(".sidebar"),s.$basicMode=s.$el.find(".basic-mode"),s.$addHelper=s.$el.find(".add-helper"),s.$beautify=s.$el.find(".beautify"),s.$basicToolbar=s.$el.find("#htmlxEdit"),s.$advancedToolbar=s.$el.find("#advanced-toolbar"),s.disableTree&&(s.$textEditor.addClass("full-width"),s.$sidebar.hide()),s.debouncedUpdateSidebar=_.debounce(s.updateSidebar.bind(s),200),s.debouncedCheckForAdvancedHelpers=_.debounce(s.checkForAdvancedHelpers.bind(s),200),s.debouncedCheckForErrors=_.debounce(s.checkForErrors.bind(s),200),_.debounce(s.jstreeSearch.bind(s),250));return s.$search.keyup(function(e){e=e.target.value;e?s.$clearSearch.show():s.$clearSearch.hide(),n(e)}),s.$clearSearch.click(function(){s.$search.find("input").val("").trigger("keyup")}),s.$basicMode.button({icons:{primary:"fa fa-arrow-left"}}).click(function(){s.htmlButton.ne.options.onCode()}),s.$beautify.button({icons:{primary:"fa fa-bath"}}).click(function(){s.codeEditor.getAction("editor.action.formatDocument").run()}),$.ui.dialog.prototype._focusTabbable=$.noop.bind(s),s.$dialog=s.$el.dialog({appendTo:e.container,dialogClass:"template-editor-dialog",title:"Template Editor",resizable:!0,height:W5a.DIALOG_HEIGHT,width:850,minWidth:710,modal:!0,autoOpen:!0,buttons:[{text:t("OK"),click:function(){s.onButtonClick(),s.$el.dialog("close")},icons:{primary:"fa fa-check"}},{text:t("Apply"),click:s.onButtonClick.bind(s),icons:{primary:"fa fa-check-square-o"}},{text:t("Cancel"),click:function(){s.$el.dialog("close")},icons:{primary:"fa fa-times"}}],close:function(){s.remove()},open:function(){$('<i class="fa fa-code" />').insertBefore(s.$el.parent().find(".ui-dialog-title"));function e(e){s.$basicToolbar.toggle(),s.$advancedToolbar.toggle(),s.$editor.toggle(),s.$code.toggle(),s.isInCodeMode=!s.isInCodeMode,s.isInCodeMode?s.initCodeEditor(e):(s.options.allowUnsafeContent||(e=s.options.sanitizeTemplate?s.options.sanitizeTemplate(e):DOMPurify.sanitize(e,{ADD_ATTR:["target"]})),s.editor.instanceById(s.INSTANCE_ID).setContent(s.scriptify(e)),$(s.editor.instanceById(s.INSTANCE_ID).elm).focus())}var c,t,n,i,o,a;s.editor=new nicEditor({buttonList:["bold","italic","underline","left","center","right","justify","ol","ul","indent","outdent","forecolor","fontSize","html"],htmlButtonDesc:'<i class="fa fa-fw fa-code"></i> Advanced mode',onCode:function(){e(s.codeEditor&&s.isInCodeMode?s.codeEditor.getValue():null)}}),s.editor.setPanel("htmlxEdit"),s.editor.addInstance(s.INSTANCE_ID),W5a.NONEACH_HELPER_RX.test(s.options.text)?e(s.options.text):(t=s.scriptify(s.options.text),s.editor.instanceById(s.INSTANCE_ID).setContent(t),s.debouncedCheckForErrors(t),$(s.editor.instanceById(s.INSTANCE_ID).elm).focus()),s.htmlButton=_.find(s.editor.nicPanel.panelButtons,function(e){return"html"===e.name}),s.disableTree||(c=function(e,l,r){return void 0===l&&(l=!1),void 0===r&&(r=""),_.map(e,function(e,t){var n,i,o=_.some(e.attributes,function(e){return e instanceof QuickBase.DocumentViewModel}),a=!o&&e instanceof QuickBase.DocumentViewModel,s=o||!a&&e instanceof Object;return s?(n=t,i=r+(l?t+".":""),i=c(o?_.omit(e.attributes,".settings"):e,!0,i)):n=a?"$"+r+t+"$":r+e,{id:n,text:t,state:{selected:!1},children:s?i:[],type:s?"folder":a?"viewstate":"key"}})},t=s.keys.length?c({columns:_.keyBy(s.keys)}):[],n=c({viewstates:s.docViewModel}),i=_.reduce(s.valueData,function(e,t,n){return e[n="array"===t.type?"@"+n:n]=t.items,e},{}),i=_.isEmpty(s.valueData)?[]:c(i),o=_.union(t,i,n),a=function(e){return _.map(e.sort(function(e,t){return Math.min(1,t.children.length)-Math.min(1,e.children.length)||s.trimVSChars(e.id).localeCompare(s.trimVSChars(t.id))}),function(e){return _.reduce(e,function(e,t,n){return"children"===n&&t.length?e[n]=a(t):e[n]=t,e},{})})},o.length&&(require(["jstree"],function(){s.$tree.jstree({core:{data:a(o),multiple:!1},conditionalselect:function(e){return 0===e.children.length},contextmenu:{items:function(t){return"folder"===t.type?{}:{add:{label:"Add to editor",action:function(e){s.pendingContent||(s.$tree.jstree().deselect_node(t),s.$tree.jstree().select_node(t)),s.insertItem(t)}}}}},types:{activeKey:{icon:"fa fa-check-circle"},key:{icon:"fa fa-circle"},viewstate:{icon:"fa fa-eye"},folder:{icon:"fa fa-folder"}},search:{show_only_matches:!0,show_only_matches_children:!0},dnd:{is_draggable:function(e,t){return t.preventDefault(),!1}},plugins:["conditionalselect","contextmenu","search","types","dnd"]}),s.$tree.on("show_contextmenu.jstree",s.updateTheme.bind(s)),s.$tree.on("search.jstree",function(e,t){0===t.nodes.length&&s.$tree.jstree("hide_all")}),s.$tree.on("dblclick.jstree",function(e){var t=s.$tree.jstree().get_selected()[0],t=s.$tree.jstree().get_node(t);!t||t.a_attr.id!==e.target.id&&t.a_attr.id!==e.target.parentNode.id||s.insertItem(t)}),s.$tree.on("select_node.jstree",function(e,t){var n,i,o,a;s.isInCodeMode||(t=t.selected[0],n=nicEditors.findEditor(s.INSTANCE_ID),i="",$(n.elm).focus(),o=n.getRng(),a=n.selElm()||n.elm,n.saveRng(),t&&(i=s.wrapInHandlebars(t),a.nodeValue?s.pendingContent=a.nodeValue.substring(0,o.startOffset)+i+a.nodeValue.substring(o.endOffset,a.nodeValue.length):s.pendingContent=i,s.editorField=a,s.editorRng=o))}),s.$tree.on("ready.jstree",function(){s.updateSidebar(s.options.text);var e=s.$tree.jstree("get_json");0<e.length&&s.$tree.jstree("open_node",e[0])})}),s.initHorizontalResize())),s.editor.instanceById(s.INSTANCE_ID).elm.addEventListener("input",function(e){s.disableTree||s.debouncedUpdateSidebar(e.target.innerText),s.debouncedCheckForErrors(e.target.innerHTML)}),s.initHandlebarHelperPicker()}}),s}var fontAwesome={"Web Application Icons":["adjust","anchor","archive","area-chart","arrows","arrows-h","arrows-v","asterisk","at","automobile","balance-scale","ban","bank","bar-chart","bar-chart-o","barcode","bars","battery-0","battery-1","battery-2","battery-3","battery-4","battery-empty","battery-full","battery-half","battery-quarter","battery-three-quarters","bed","beer","bell","bell-o","bell-slash","bell-slash-o","bicycle","binoculars","birthday-cake","bluetooth","bluetooth-b","bolt","bomb","book","bookmark","bookmark-o","briefcase","bug","building","building-o","bullhorn","bullseye","bus","cab","calculator","calendar","calendar-check-o","calendar-minus-o","calendar-o","calendar-plus-o","calendar-times-o","camera","camera-retro","car","caret-square-o-down","caret-square-o-left","caret-square-o-right","caret-square-o-up","cart-arrow-down","cart-plus","cc","certificate","check","check-circle","check-circle-o","check-square","check-square-o","child","circle","circle-o","circle-o-notch","circle-thin","clock-o","clone","close","cloud","cloud-download","cloud-upload","code","code-fork","coffee","cog","cogs","comment","comment-o","commenting","commenting-o","comments","comments-o","compass","copyright","creative-commons","credit-card","credit-card-alt","crop","crosshairs","cube","cubes","cutlery","dashboard","database","desktop","diamond","dot-circle-o","download","edit","ellipsis-h","ellipsis-v","envelope","envelope-o","envelope-square","eraser","exchange","exclamation","exclamation-circle","exclamation-triangle","external-link","external-link-square","eye","eye-slash","eyedropper","fax","feed","female","fighter-jet","file-archive-o","file-audio-o","file-code-o","file-excel-o","file-image-o","file-movie-o","file-pdf-o","file-photo-o","file-picture-o","file-powerpoint-o","file-sound-o","file-video-o","file-word-o","file-zip-o","film","filter","fire","fire-extinguisher","flag","flag-checkered","flag-o","flash","flask","folder","folder-o","folder-open","folder-open-o","frown-o","futbol-o","gamepad","gavel","gear","gears","gift","glass","globe","graduation-cap","group","hand-grab-o","hand-lizard-o","hand-paper-o","hand-peace-o","hand-pointer-o","hand-rock-o","hand-scissors-o","hand-spock-o","hand-stop-o","hashtag","hdd-o","headphones","heart","heart-o","heartbeat","history","home","hotel","hourglass","hourglass-1","hourglass-2","hourglass-3","hourglass-end","hourglass-half","hourglass-o","hourglass-start","i-cursor","image","inbox","industry","info","info-circle","institution","key","keyboard-o","language","laptop","leaf","legal","lemon-o","level-down","level-up","life-bouy","life-buoy","life-ring","life-saver","lightbulb-o","line-chart","location-arrow","lock","magic","magnet","mail-forward","mail-reply","mail-reply-all","male","map","map-marker","map-o","map-pin","map-signs","meh-o","microphone","microphone-slash","minus","minus-circle","minus-square","minus-square-o","mobile","mobile-phone","money","moon-o","mortar-board","motorcycle","mouse-pointer","music","navicon","newspaper-o","object-group","object-ungroup","paint-brush","paper-plane","paper-plane-o","paw","pencil","pencil-square","pencil-square-o","percent","phone","phone-square","photo","picture-o","pie-chart","plane","plug","plus","plus-circle","plus-square","plus-square-o","power-off","print","puzzle-piece","qrcode","question","question-circle","quote-left","quote-right","random","recycle","refresh","registered","remove","reorder","reply","reply-all","retweet","road","rocket","rss","rss-square","search","search-minus","search-plus","send","send-o","server","share","share-alt","share-alt-square","share-square","share-square-o","shield","ship","shopping-bag","shopping-basket","shopping-cart","sign-in","sign-out","signal","sitemap","sliders","smile-o","soccer-ball-o","sort","sort-alpha-asc","sort-alpha-desc","sort-amount-asc","sort-amount-desc","sort-asc","sort-desc","sort-down","sort-numeric-asc","sort-numeric-desc","sort-up","space-shuttle","spinner","spoon","square","square-o","star","star-half","star-half-empty","star-half-full","star-half-o","star-o","sticky-note","sticky-note-o","street-view","suitcase","sun-o","support","tablet","tachometer","tag","tags","tasks","taxi","television","terminal","thumb-tack","thumbs-down","thumbs-o-down","thumbs-o-up","thumbs-up","ticket","times","times-circle","times-circle-o","tint","toggle-down","toggle-left","toggle-off","toggle-on","toggle-right","toggle-up","trademark","trash","trash-o","tree","trophy","truck","tty","tv","umbrella","university","unlock","unlock-alt","unsorted","upload","user","user-plus","user-secret","user-times","users","video-camera","volume-down","volume-off","volume-up","warning","wheelchair","wifi","wrench"],"Hand Icons":["hand-grab-o","hand-lizard-o","hand-o-down","hand-o-left","hand-o-right","hand-o-up","hand-paper-o","hand-peace-o","hand-pointer-o","hand-rock-o","hand-scissors-o","hand-spock-o","hand-stop-o","thumbs-down","thumbs-o-down","thumbs-o-up","thumbs-up"],"Transportation Icons":["ambulance","automobile","bicycle","bus","cab","car","fighter-jet","motorcycle","plane","rocket","ship","space-shuttle","subway","taxi","train","truck","wheelchair"],"Gender Icons":["genderless","intersex","mars","mars-double","mars-stroke","mars-stroke-h","mars-stroke-v","mercury","neuter","transgender","transgender-alt","venus","venus-double","venus-mars"],"File Type Icons":["file","file-archive-o","file-audio-o","file-code-o","file-excel-o","file-image-o","file-movie-o","file-o","file-pdf-o","file-photo-o","file-picture-o","file-powerpoint-o","file-sound-o","file-text","file-text-o","file-video-o","file-word-o","file-zip-o"],"Spinner Icons":["info-circle","circle-o-notch","cog","gear","refresh","spinner"],"Form Control Icons":["check-square","check-square-o","circle","circle-o","dot-circle-o","minus-square","minus-square-o","plus-square","plus-square-o","square","square-o"],"Payment Icons":["cc-amex","cc-diners-club","cc-discover","cc-jcb","cc-mastercard","cc-paypal","cc-stripe","cc-visa","credit-card","credit-card-alt","google-wallet","paypal"],"Chart Icons":["area-chart","bar-chart","bar-chart-o","line-chart","pie-chart"],"Currency Icons":["bitcoin","btc","cny","dollar","eur","euro","gbp","gg","gg-circle","ils","inr","jpy","krw","money","rmb","rouble","rub","ruble","rupee","shekel","sheqel","try","turkish-lira","usd","won","yen"],"Text Editor Icons":["align-center","align-justify","align-left","align-right","bold","chain","chain-broken","clipboard","columns","copy","cut","dedent","eraser","file","file-o","file-text","file-text-o","files-o","floppy-o","font","header","indent","italic","link","list","list-alt","list-ol","list-ul","outdent","paperclip","paragraph","paste","repeat","rotate-left","rotate-right","save","scissors","strikethrough","subscript","superscript","table","text-height","text-width","th","th-large","th-list","underline","undo","unlink"],"Directional Icons":["angle-double-down","angle-double-left","angle-double-right","angle-double-up","angle-down","angle-left","angle-right","angle-up","arrow-circle-down","arrow-circle-left","arrow-circle-o-down","arrow-circle-o-left","arrow-circle-o-right","arrow-circle-o-up","arrow-circle-right","arrow-circle-up","arrow-down","arrow-left","arrow-right","arrow-up","arrows","arrows-alt","arrows-h","arrows-v","caret-down","caret-left","caret-right","caret-square-o-down","caret-square-o-left","caret-square-o-right","caret-square-o-up","caret-up","chevron-circle-down","chevron-circle-left","chevron-circle-right","chevron-circle-up","chevron-down","chevron-left","chevron-right","chevron-up","exchange","hand-o-down","hand-o-left","hand-o-right","hand-o-up","long-arrow-down","long-arrow-left","long-arrow-right","long-arrow-up","toggle-down","toggle-left","toggle-right","toggle-up"],"Video Player Icons":["arrows-alt","backward","compress","eject","expand","fast-backward","fast-forward","forward","pause","pause-circle","pause-circle-o","play","play-circle","play-circle-o","random","step-backward","step-forward","stop","stop-circle","stop-circle-o","youtube-play"],"Brand Icons":["warning","500px","adn","amazon","android","angellist","apple","behance","behance-square","bitbucket","bitbucket-square","bitcoin","black-tie","bluetooth","bluetooth-b","btc","buysellads","cc-amex","cc-diners-club","cc-discover","cc-jcb","cc-mastercard","cc-paypal","cc-stripe","cc-visa","chrome","codepen","codiepie","connectdevelop","contao","css3","dashcube","delicious","deviantart","digg","dribbble","dropbox","drupal","edge","empire","expeditedssl","facebook","facebook-f","facebook-official","facebook-square","firefox","flickr","fonticons","fort-awesome","forumbee","foursquare","ge","get-pocket","gg","gg-circle","git","git-square","github","github-alt","github-square","gittip","google","google-plus","google-plus-square","google-wallet","gratipay","hacker-news","houzz","html5","instagram","internet-explorer","ioxhost","joomla","jsfiddle","lastfm","lastfm-square","leanpub","linkedin","linkedin-square","linux","maxcdn","meanpath","medium","mixcloud","modx","odnoklassniki","odnoklassniki-square","opencart","openid","opera","optin-monster","pagelines","paypal","pied-piper","pied-piper-alt","pinterest","pinterest-p","pinterest-square","product-hunt","qq","ra","rebel","reddit","reddit-alien","reddit-square","renren","safari","scribd","sellsy","share-alt","share-alt-square","shirtsinbulk","simplybuilt","skyatlas","skype","slack","slideshare","soundcloud","spotify","stack-exchange","stack-overflow","steam","steam-square","stumbleupon","stumbleupon-circle","tencent-weibo","trello","tripadvisor","tumblr","tumblr-square","twitch","twitter","twitter-square","usb","viacoin","vimeo","vimeo-square","vine","vk","wechat","weibo","weixin","whatsapp","wikipedia-w","windows","wordpress","xing","xing-square","y-combinator","y-combinator-square","yahoo","yc","yc-square","yelp","youtube","youtube-play","youtube-square"],"Medical Icons":["ambulance","h-square","heart","heart-o","heartbeat","hospital-o","medkit","plus-square","stethoscope","user-md","wheelchair"]},googleFont={Action:["3d-rotation","accessibility","account-balance","account-balance-wallet","account-box","account-circle","add-shopping-cart","alarm","alarm-add","alarm-off","alarm-on","all-out","android","announcement","aspect-ratio","assessment","assignment","assignment-ind","assignment-late","assignment-return","assignment-returned","assignment-turned-in","autorenew","backup","book","bookmark","bookmark-border","bug-report","build","cached","camera-enhance","card-giftcard","card-membership","card-travel","change-history","check-circle","chrome-reader-mode","class","code","compare-arrows","copyright","credit-card","dashboard","date-range","delete","delete-forever","description","dns","done","done-all","donut-large","donut-small","eject","euro-symbol","event","event-seat","exit-to-app","explore","extension","face","favorite","favorite-border","feedback","find-in-page","find-replace","fingerprint","flight-land","flight-takeoff","flip-to-back","flip-to-front","g-translate","gavel","get-app","gif","grade","group-work","help","help-outline","highlight-off","history","home","hourglass-empty","hourglass-full","http","https","important-devices","info","info-outline","input","invert-colors","label","label-outline","language","launch","lightbulb-outline","line-style","line-weight","list","lock","lock-open","lock-outline","loyalty","markunread-mailbox","motorcycle","note-add","offline-pin","opacity","open-in-browser","open-in-new","open-with","pan-tool","pageview","payment","perm-camera-mic","perm-contact-calendar","perm-data-setting","perm-device-information","perm-identity","perm-media","perm-phone-msg","perm-scan-wifi","pets","picture-in-picture","play-for-work","polymer","power-settings-new","print","query-builder","question-answer","receipt","record-voice-over","redeem","reorder","report-problem","restore","restore-page","room","rounded-corner","rowing","schedule","search","settings","settings-applications","settings-backup-restore","settings-bluetooth","settings-brightness","settings-cell","settings-ethernet","settings-input-antenna","settings-input-component","settings-input-composite","settings-input-hdmi","settings-input-svideo","settings-overscan","settings-phone","settings-power","settings-remote","settings-voice","shop","shop-two","shopping-basket","shopping-cart","speaker-notes","spellcheck","stars","store","subject","supervisor-account","swap-horiz","swap-vert","swap-vertical-circle","system-update-alt","tab","tab-unselected","theaters","thumb-down","thumb-up","thumbs-up-down","toc","today","toll","touch-app","track-changes","translate","trending-down","trending-flat","trending-up","turned-in","turned-in-not","verified-user","view-agenda","view-array","view-carousel","view-column","view-day","view-headline","view-list","view-module","view-quilt","view-stream","view-week","visibility","visibility-off","work","youtube-searched-for","zoom-in","zoom-out"],Alert:["add-alert","error","error-outline","warning"],AV:["add-to-queue","airplay","album","art-track","av-timer","branding-watermark","call-to-action","closed-caption","equalizer","explicit","fast-forward","fast-rewind","featured-play-list","featured-video","fiber-dvr","fiber-manual-record","fiber-new","fiber-pin","fiber-smart-record","forward-10","forward-30","forward-5","games","hd","hearing","high-quality","library-add","library-books","library-music","loop","mic","mic-none","mic-off","movie","new-releases","not-interested","note","pause","pause-circle-filled","pause-circle-outline","play-arrow","play-circle-filled","play-circle-outline","playlist-add","queue","queue-music","radio","recent-actors","remove-from-queue","repeat","repeat-one","replay","replay-10","replay-30","replay-5","shuffle","skip-next","skip-previous","slow-motion-video","snooze","sort-by-alpha","stop","subscriptions","subtitles","surround-sound","video-call","video-label","video-library","videocam","videocam-off","volume-down","volume-mute","volume-off","volume-up","web"],Communication:["business","call","call-end","call-made","call-merge","call-missed","call-received","call-split","chat","chat-bubble","chat-bubble-outline","clear-all","comment","contact-mail","contact-phone","contacts","dialer-sip","dialpad","email","forum","import-export","invert-colors-off","live-help","location-off","location-on","message","no-sim","phone","phonelink-erase","phonelink-lock","phonelink-ring","phonelink-setup","portable-wifi-off","present-to-all","ring-volume","rss-feed","screen-share","speaker-phone","stay-current-landscape","stay-current-portrait","stay-primary-landscape","stay-primary-portrait","stop-screen-share","swap-calls","textsms","voicemail","vpn-key"],Content:["add","add-box","add-circle","add-circle-outline","archive","backspace","block","clear","content-copy","content-cut","content-paste","create","delete-sweep","drafts","filter-list","flag","font-download","forward","gesture","inbox","link","low-priority","mail","markunread","redo","remove","remove-circle","remove-circle-outline","reply","reply-all","report","save","select-all","send","sort","text-format","unarchive","undo","weekend"],Device:["access-alarm","access-alarms","access-time","add-alarm","airplanemode-active","airplanemode-inactive","battery-alert","battery-charging-full","battery-full","battery-std","battery-unknown","bluetooth","bluetooth-connected","bluetooth-disabled","bluetooth-searching","brightness-auto","brightness-high","brightness-low","brightness-medium","data-usage","developer-mode","devices","dvr","gps-fixed","gps-not-fixed","gps-off","graphic-eq","location-disabled","location-searching","network-cell","network-wifi","nfc","screen-lock-landscape","screen-lock-portrait","screen-lock-rotation","screen-rotation","sd-storage","settings-system-daydream","signal-cellular-4-bar","signal-cellular-connected-no-internet-4-bar","signal-cellular-no-sim","signal-cellular-null","signal-cellular-off","signal-wifi-4-bar","signal-wifi-4-bar-lock","signal-wifi-off","storage","usb","wallpaper","widgets","wifi-lock","wifi-tethering"],Editor:["attach-file","attach-money","border-all","border-bottom","border-clear","border-color","border-horizontal","border-inner","border-left","border-outer","border-right","border-style","border-top","border-vertical","bubble-chart","format-align-center","format-align-justify","format-align-left","format-align-right","format-bold","format-clear","format-color-fill","format-color-reset","format-color-text","format-indent-decrease","format-indent-increase","format-italic","format-line-spacing","format-list-bulleted","format-list-numbered","format-paint","format-quote","format-size","format-strikethrough","format-textdirection-l-to-r","format-textdirection-r-to-l","format-underlined","functions","insert-chart","insert-comment","insert-drive-file","insert-emoticon","insert-invitation","insert-link","insert-photo","linear_scale","merge-type","mode-comment","mode-edit","monetization-on","money-off","multiline-chart","pie-chart","pie-chart-outlined","publish","show-chart","space-bar","strikethrough-s","text-fields","title","vertical-align-bottom","vertical-align-center","vertical-align-top","wrap-text"],File:["attachment","cloud","cloud-circle","cloud-done","cloud-download","cloud-off","cloud-queue","cloud-upload","file-download","file-upload","folder","folder-open","folder-shared"],Hardware:["cast","cast-connected","computer","desktop-mac","desktop-windows","developer-board","device-hub","devices-other","dock","gamepad","headset","headset-mic","keyboard","keyboard-arrow-down","keyboard-arrow-left","keyboard-arrow-right","keyboard-arrow-up","keyboard-backspace","keyboard-capslock","keyboard-hide","keyboard-return","keyboard-tab","keyboard-voice","laptop","laptop-chromebook","laptop-mac","laptop-windows","memory","mouse","phone-android","phone-iphone","phonelink","phonelink-off","power-input","router","scanner","security","sim-card","smartphone","speaker","speaker-group","tablet","tablet-android","tablet-mac","toys","tv","videogame-asset","watch"],Image:["add-to-photos","adjust","assistant","assistant-photo","audiotrack","blur-circular","blur-linear","blur-off","blur-on","brightness-1","brightness-2","brightness-3","brightness-4","brightness-5","brightness-6","brightness-7","broken-image","brush","burst-mode","camera","camera-alt","camera-front","camera-rear","camera-roll","center-focus-strong","center-focus-weak","collections","collections-bookmark","color-lens","colorize","compare","control-point","control-point-duplicate","crop","crop-16-9","crop-3-2","crop-5-4","crop-7-5","crop-din","crop-free","crop-landscape","crop-original","crop-portrait","crop-square","dehaze","details","edit","exposure","exposure-neg-1","exposure-neg-2","exposure-plus-1","exposure-plus-2","exposure-zero","filter","filter-1","filter-2","filter-3","filter-4","filter-5","filter-6","filter-7","filter-8","filter-9","filter-9-plus","filter-b-and-w","filter-center-focus","filter-drama","filter-frames","filter-hdr","filter-none","filter-tilt-shift","filter-vintage","flare","flash-auto","flash-off","flash-on","flip","gradient","grain","grid-off","grid-on","hdr-off","hdr-on","hdr-strong","hdr-weak","healing","image","image-aspect-ratio","iso","landscape","leak-add","leak-remove","lens","linked-camera","looks","looks-3","looks-4","looks-5","looks-6","looks-one","looks-two","loupe","monochrome-photos","movie-creation","music-note","nature","nature-people","navigate-before","navigate-next","palette","panorama","panorama-fish-eye","panorama-horizontal","panorama-vertical","panorama-wide-angle","photo","photo-album","photo-camera","photo-library","photo-size-select-actual","photo-size-select-large","photo-size-select-small","picture-as-pdf","portrait","remove-red-eye","rotate-90-degrees-ccw","rotate-left","rotate-right","slideshow","straighten","style","switch-camera","switch-video","tag-faces","texture","timelapse","timer","timer-10","timer-3","timer-off","tonality","transform","tune","view-comfy","view-compact","vignette","wb-auto","wb-cloudy","wb-incandescent","wb-iridescent","wb-sunny"],Maps:["beenhere","directions","directions-bike","directions-boat","directions-bus","directions-car","directions-railway","directions-run","directions-subway","directions-transit","directions-walk","edit-location","ev-station","flight","hotel","layers","layers-clear","local-activity","local-airport","local-atm","local-bar","local-cafe","local-car-wash","local-convenience-store","local-dining","local-drink","local-florist","local-gas-station","local-grocery-store","local-hospital","local-hotel","local-laundry-service","local-library","local-mall","local-movies","local-offer","local-parking","local-pharmacy","local-phone","local-pizza","local-play","local-post-office","local-printshop","local-see","local-shipping","local-taxi","map","my-location","navigation","person-pin","pin-drop","place","rate-review","restaurant","restaurant-menu","satellite","store-mall-directory","streetview","subway","terrain","traffic","train","tram","transfer-within-a-station","zoom-out-map"],Navigation:["apps","arrow-back","arrow-drop-down","arrow-drop-down-circle","arrow-drop-up","arrow-forward","cancel","check","chevron-left","chevron-right","close","expand-less","expand-more","first-page","fullscreen","fullscreen-exit","last-page","menu","more-horiz","more-vert","refresh"],Notification:["adb","airline-seat-flat","airline-seat-flat-angled","airline-seat-individual-suite","airline-seat-legroom-extra","airline-seat-legroom-normal","airline-seat-legroom-reduced","airline-seat-recline-extra","airline-seat-recline-normal","bluetooth-audio","confirmation-number","disc-full","do-not-disturb","do-not-disturb-alt","do-not-disturb-off","do-not-disturb-on","drive-eta","event-available","event-busy","event-note","folder-special","live-tv","mms","more","network-locked","ondemand-video","personal-video","phone-bluetooth-speaker","phone-forwarded","phone-in-talk","phone-locked","phone-missed","phone-paused","power","priority-high","sd-card","sim-card-alert","sms","sms-failed","sync","sync-disabled","sync-problem","system-update","tap-and-play","time-to-leave","vibration","voice-chat","vpn-lock","wc","wifi"],Social:["cake","domain","group","group-add","location-city","mood","mood-bad","notifications","notifications-active","notifications-none","notifications-off","notifications-paused","pages","party-mode","people","people-outline","person","person-add","person-outline","plus-one","poll","public","school","sentiment-dissatisfied","sentiment-neutral","sentiment-satisfied","sentiment-very-dissatisfied","share","whatshot"],Toggle:["check-box","check-box-outline-blank","indeterminate-check-box","radio-button-checked","radio-button-unchecked","star","star-border","star-half"]},IconDropDownDialog=Backbone.View.extend({className:"icon-dialog",initialize:function(e){var s=this;s.options=e,s.path=void 0,s.search="",s.animationTimeElapsed=0,s.columns=6,s.minimumWidgetSize={w:170,h:40},s.isFAOnly=e.isFAOnly,s.panelInfos=[],s.debouncedLayout=_.debounce(s.updateLayout,100),s.debouncedAnimLayout=_.debounce(function(){s.updateLayout(!0)},170),s.throttleLayout=_.throttle(s.updateLayout,100),s.ANIMATION_TIME=300,s.renderFrameCounter=0,s.$el.dialog(_.extend({appendTo:e.container,dialogClass:"quick-dash dd-Panel",title:t("Please select an image ..."),resizable:!0,height:600,width:950,minWidth:400,modal:!0,autoOpen:!0,close:function(){_.isFunction(s.options.closing)&&s.options.closing(),s.remove()},open:function(){$('<i class="fa fa-image" />').insertBefore(s.$el.parent().find(".ui-dialog-title")),s.$el.html(T.IconDialog()),s.$grid=s.$el.find(".grid"),s.$searchInput=s.$el.find(".search input");var o={row:0,column:0,position:null,size:null,targetPosition:null,targetSize:null,visible:!0},e="Web Application Icons",t=_.clone(fontAwesome),e=(t[e]=_.clone(t[e]),t[e].splice(0,0,"blank"),[t]),a=[{type:"fa",subtype:"fa-fw"}];s.isFAOnly||(e.push(googleFont),a.push({type:"mi",subtype:""})),_.each(e,function(e,i){_.each(e,function(e,t){var n=_.extend({heading:!0,$el:$("<h3>"+t+"</h3>")},o);s.panelInfos.push(n),s.$grid.append(n.$el),_.each(e,function(e){n=_.extend({icon:e,$el:$(T.IconDialogItem(_.extend({icon:e},a[i])))},o),s.panelInfos.push(n),s.$grid.append(n.$el)})})}),s.$el.find(".grid > a").on("click",function(e){var t=s.options.selectCallback;t&&t("fa-blank"==(t=$(e.target||e.toElement).find("i").attr("class").split(" ").pop())?"":t),s.$el.dialog("close")}),s.$searchInput.on("input",function(){s.search=$(this).val(),s.debouncedAnimLayout()}),s.updateLayout(!1),_.defer(function(){s.$searchInput.focus()})},resize:function(){s.debouncedLayout(!1)}},e))},onCancelButtonClick:function(){this.$el.dialog("close")},onSelectButtonClick:function(){this.options.model.tooltips=this.result,this.options.editor.setValue(this.options.model),this.onCancelButtonClick()},remove:function(){_.each(this.panelInfos,function(e){e.$el.off(),e.$el.remove(),e.$el=null}),this.panelInfos=[],Backbone.View.prototype.remove.call(this)},renderFrame:function(){var i,e=new Date,t=e-this.lastFrame,n=this;this.lastFrame=e,this.animationTimeElapsed+=t,this.renderFrameCounter+=1,this.animationTimeElapsed>=this.ANIMATION_TIME?(1<this.renderFrameCounter&&console.log("FPS: "+this.renderFrameCounter/this.ANIMATION_TIME*1e3),this.renderFrameCounter=0,_.each(n.panelInfos,function(e){e!==this.draggingPanelInfo&&(e.$el.css({top:e.targetY+"px",left:e.targetX.toFixed(3)+"%"}),e.X=e.targetX,e.Y=e.targetY)})):(i=this.animationTimeElapsed/this.ANIMATION_TIME,_.each(n.panelInfos,function(e){var t,n;e!==this.draggingPanelInfo&&(t=e.X+(e.targetX-e.X)*i,n=e.Y+(e.targetY-e.Y)*i,e.$el.css({top:n+"px",left:t.toFixed(3)+"%"}))}),window.requestAnimationFrame(function(){n.renderFrame()}))},setRowsAndColumns:function(){var e,t,n,i=0;if(0!==this.panelInfos.length)for(this.columns=Math.max(1,Math.floor(this.$grid.width()/this.minimumWidgetSize.w)),this.rows=Math.ceil(this.panelInfos.length/this.columns),n=0;;n+=1){1;{for(e=0;e<this.columns&&i!==this.panelInfos.length;e+=1)if((t=this.panelInfos[i]).visible=""===this.search||t.icon&&0<=t.icon.indexOf(this.search),t.visible){if(t.heading&&0!==e&&(e=0,n+=1),t.column=e,t.row=n,i+=1,t.heading)break}else--e,i+=1;if(i===this.panelInfos.length)break}}},updateLayout:function(e){var t=this,n=e?{"transition-property":"top, left","transition-duration":"0.3s"}:{"transition-property":"none"};t.setRowsAndColumns(),_.each(t.panelInfos,function(e){e.$el.css(_.extend({top:e.row*t.minimumWidgetSize.h+"px",left:(e.column*(100/t.columns)).toFixed(3)+"%",width:e.heading?"99%":(100/t.columns).toFixed(3)+"%",display:e.visible?"block":"none"},n))})}}),JsonDialog=(i7a=Backbone.View,__extends(j7a,i7a),j7a.prototype.disposeEditor=function(){this.editor&&(this.editor.dispose(),this.editor=null),this.editorModel&&(this.editorModel.dispose(),this.editorModel=null),this.jsonDefaults&&this.defaultDiagnostics&&(this.jsonDefaults.setDiagnosticsOptions(this.defaultDiagnostics),this.jsonDefaults=null,this.defaultDiagnostics=null)},j7a.prototype.initEditor=function(){var o=this;MonacoHelpers.require({language:"json"},function(e){var t=e.monaco,e=(e.docs,e.disposable,"internal://server/"+_.uniqueId("jsonModelURI")),n=t.Uri.parse(e),i=o.options.value,i=(o.editorModel=t.editor.createModel(i,"json",n),_.result(o.options.editorOptions,"jsonSchema"));i&&(o.jsonDefaults=t.languages.json.jsonDefaults,o.defaultDiagnostics=o.jsonDefaults.diagnosticsOptions,t.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,schemas:[{fileMatch:[e],schema:i}]})),o.editor=t.editor.create(o.$el.find(".json-editor")[0],_.assign({},MonacoHelpers.DEFAULT_OPTIONS(),{model:o.editorModel}))})},j7a.prototype.onApplyButtonClick=function(){var e=this.editor.getValue();this.options.applyCallback&&this.options.applyCallback(e)},j7a.prototype.remove=function(){return this.disposeEditor(),Backbone.View.prototype.remove.call(this)},j7a),i7a;function j7a(e){var t=i7a.call(this,_.extend({},e,{className:"json-dialog"}))||this;return t.DIALOG_HEIGHT=540,t.options=e,t.$el.html(T.JsonDialog({})),t.$dialog=t.$el.dialog({appendTo:t.options.container,closeOnEscape:!0,title:"Json Editor",resizable:!0,height:t.DIALOG_HEIGHT,width:800,minWidth:710,modal:!0,autoOpen:!0,buttons:[{text:"Apply",click:t.onApplyButtonClick.bind(t),icons:{primary:"fa fa-check"}},{text:"Close",click:function(){t.$el.dialog("close")},icons:{primary:"fa fa-times"}}],close:function(){t.remove()},open:function(){t.$el.parent().find(".ui-dialog-title").before('<i class="fa fa-code" />').append($("<span>",{style:"font-weight:normal; padding-left:2em",text:"hit CTRL + SPACE to activate IntelliSense"})),t.initEditor()}}),t}var RichTextEditorDialog=Backbone.View.extend({DIALOG_HEIGHT:540,INSTANCE_ID:"ffsEdit",appModel:null,className:"rich-text-editor-dialog",dataView:null,propertiesView:null,isInCodeMode:!1,initialize:function(e){var n=this;n.options=e,n.$el.html(T.RichTextEditorDialog({uid:n.INSTANCE_ID,background:e.background})),n.$editor=n.$el.find(".editor"),n.$code=n.$el.find(".code"),$.ui.dialog.prototype._focusTabbable=$.noop,n.$dialog=n.$el.dialog({appendTo:e.container,dialogClass:"rich-text-dialog",title:t("Text Editor"),resizable:!0,height:n.DIALOG_HEIGHT,width:800,minWidth:710,modal:!0,autoOpen:!0,buttons:[{text:t("Apply"),click:$.proxy(n.onApplyButtonClick,n),icons:{primary:"fa fa-check"}},{text:t("Close"),click:function(){n.$el.dialog("close")},icons:{primary:"fa fa-times"}}],close:function(){n.remove()},open:function(){$('<i class="fa fa-font" />').insertBefore(n.$el.parent().find(".ui-dialog-title")),n.editor=new nicEditor({onBeautify:function(){n.isInCodeMode&&n.codeEditor.getAction("editor.action.formatDocument").run()},onCode:function(){var e;n.$editor.toggle(),n.$code.toggle(),n.isInCodeMode=!n.isInCodeMode,n.isInCodeMode?n.initCodeEditor():(e=n.codeEditor.getValue(),n.options.allowUnsafeContent||(e=DOMPurify.sanitize(e,{ADD_ATTR:["target"]})),n.editor.instanceById(n.INSTANCE_ID).setContent(e))}}),n.editor.setPanel("htmlxEdit"),n.editor.addInstance(n.INSTANCE_ID),n.editor.instanceById(n.INSTANCE_ID).setContent(n.options.text),$(n.editor.instanceById(n.INSTANCE_ID).elm).focus()}})},initCodeEditor:function(){var n=this;MonacoHelpers.require({language:"html"},function(e){var e=e.monaco,t=n.$el.find(".code")[0];n.codeEditor||(n.codeEditor=e.editor.create(t,{language:"html",automaticLayout:!0,theme:"kx-light"!==$.cookie("dashboard-theme")?"vs-dark":"vs",contextmenu:!1,fixedOverflowWidgets:!0,fontSize:12,minimap:{enabled:!1},scrollBeyondLastLine:!1,wordWrap:"on",dragAndDrop:!1})),n.codeEditor.getAction("editor.action.formatDocument").run(),n.codeEditor.setValue(n.editor.instanceById(n.INSTANCE_ID).getContent())})},onApplyButtonClick:function(){var e=this.isInCodeMode?this.codeEditor.getValue():this.editor.instanceById(this.INSTANCE_ID).getContent();this.options.allowUnsafeContent||(e=DOMPurify.sanitize(e,{ADD_ATTR:["target"]})),this.options.applyCallback&&this.options.applyCallback(e),this.$dialog.dialog("close")},remove:function(){this.editor&&(this.editor.removeInstance(this.INSTANCE_ID),this.editor=null),this.codeEditor&&(this.codeEditor=null),Backbone.View.prototype.remove.call(this)}}),PropertiesPanelApi=(E7a=CustomEvents,__extends(F7a,E7a),F7a.prototype.getParameter=function(e){return"model"===e?this.appModel.get("documents").get(this.viewModel.get("selectedDocumentId")):this[e]},F7a.prototype.getWidget=function(){return this.widgetModel},F7a.prototype.setWidget=function(e){this.widgetModel=e,this.componentModel=e.get("component").get("options")},F7a.prototype.setDocument=function(e){e&&(this.docViewModel=e.get("viewState"),this.docDataModel=e.get("data"))},F7a.prototype.showBulkColumnEditor=function(e){this.dlgBulkColumnEditor=this.dlgBulkColumnEditor||new BulkColumnEditorDialog({container:this.dialogContainer}),this.dlgBulkColumnEditor.setEditor(e),this.dlgBulkColumnEditor.open()},F7a.prototype.showCleanUpDialog=function(e){new CleanUpDialog({documentGraphVisual:e,dialogContainer:this.dialogContainer})},F7a.prototype.showColorPickerDialog=function(t,n){new ColorPickerDialog({container:this.dialogContainer,values:t.getAttribute("gradient"),noColor:t.getAttribute("noColor"),target:t,editor:n,path:$(t).val(),selected:t.value,selectCallback:function(e){$(t).val()!==e&&(n.value=e,n.onInput(e.slice()),$(t).val(e))}})},F7a.prototype.showColSelectorDialog=function(e,t,n,i,o){new ColSelectorDialog({container:this.dialogContainer,values:e||[],target:n,isUserDefined:!!i,selected:t,selectCallback:o})},F7a.prototype.showCssDialog=function(e,t){this.cssDialog&&(this.cssDialog.remove(),this.cssDialog=null),this.cssDialog=new CssDialog({applyCallback:t,container:this.dialogContainer,viewModel:this.viewModel,styles:e}),this.listenTo(this.cssDialog,"startInspecting",function(){this.trigger("startInspecting")}),this.listenTo(this.cssDialog,"stopInspecting",function(){this.trigger("stopInspecting")})},F7a.prototype.showDataConnectionDialog=function(e,t){new DataConnectionDialog({appModel:this.appModel,docViewModel:this.docViewModel,container:this.dialogContainer,path:e,selectCallback:t})},F7a.prototype.showDataDialog=function(e,t,n){this.docDataModel=this.docDataModel||this.appModel.get("documents").get(this.viewModel.get("selectedDocumentId")).get("data"),this.docDataModel.cid!==this.appModel.get("documents").get(this.viewModel.get("selectedDocumentId")).get("data").cid&&(this.docDataModel=this.appModel.get("documents").get(this.viewModel.get("selectedDocumentId")).get("data")),new DataDialog({appModel:this.appModel,dialogContainer:this.dialogContainer,docViewModel:this.docViewModel,model:this.docDataModel,initialTab:n,path:e,isTableEditProperties:!1,selectCallback:t})},F7a.prototype.showTemplateDialog=function(e,t,n,i){var o=this,a=(this.htmlDialog&&(this.htmlDialog.remove(),this.htmlDialog=null),[]),s="possibleColumns",s=(this.componentModel&&!e.disableTree?("string"==typeof e.columnsFieldName?s=e.columnsFieldName:e.columnsFieldName instanceof Array&&_.each(e.columnsFieldName,function(e){a=_.union(a,o.componentModel.get(e))}),this.componentModel.get(s)?a=this.componentModel.get(s):"ChartJS"===this.componentModel.parent.get("key")&&_.each(this.componentModel.get("Layers"),function(e){a=_.union(a,e.Basics.Data.dataSet.columns.models.map(function(e){return e.get("id")}))}),"ChartGL"===this.componentModel.parent.get("key")&&_.each(this.componentModel.get("Layers"),function(e){a=_.without(_.union(a,e.possibleColorColumns),"None")}),a=_.filter(a,function(e){return!_.isEmpty(e)}),e.templateItems&&("ChartGL"===this.componentModel.parent.get("key")||"ChartJS"===this.componentModel.parent.get("key")||"PieJS"===this.componentModel.parent.get("key")||"Chart3D"===this.componentModel.parent.get("key")?_.each(e.templateItems,function(e){var t="cols";"ChartGL"===o.componentModel.parent.get("key")&&(t="data"),e.items[t]=_.keyBy(a)}):"Datagrid"!==this.componentModel.parent.get("key")&&"Datatable"!==this.componentModel.parent.get("key")||_.each(e.templateItems,function(e){_.extend(e.items,_.keyBy(a))}),a=[])):e.disableTree&&(a=[],delete e.templateItems),this.componentModel?this.componentModel.get("format").tileTransparentBackground?"transparent":this.componentModel.get("format").tileBackgroundColor:"#ffffff"),l=this.componentModel&&!0===this.componentModel.get("Basics.AllowUnsafeContent");this.htmlDialog=new TemplateDialog({docViewModel:this.docViewModel,container:this.dialogContainer,keys:a,valueData:e.templateItems,disableTree:e.disableTree,text:t,background:s,allowUnsafeContent:l,sanitizeTemplate:this.sanitizeTemplate.bind(this),applyCallback:i})},F7a.prototype.showHtmlDialog=function(e){this.htmlDialog&&(this.htmlDialog.remove(),this.htmlDialog=null),this.htmlDialog=new RichTextEditorDialog({container:this.dialogContainer,text:this.componentModel.get("Basics").HtmlText,background:this.componentModel.get("format").tileTransparentBackground?"transparent":this.componentModel.get("format").tileBackgroundColor,allowUnsafeContent:!0===this.componentModel.get("Basics.AllowUnsafeContent"),applyCallback:e})},F7a.prototype.showIconDropDownDialog=function(e,t){var n=this;this.iconDialogLoading||(this.iconDialogLoading=!0,new IconDropDownDialog({container:this.dialogContainer,isFAOnly:e,selectCallback:t,closing:function(){return n.iconDialogLoading=!1}}))},F7a.prototype.showJsonDialog=function(e,t,n){new JsonDialog({editorOptions:e.schema.options,container:this.dialogContainer,value:t,applyCallback:n})},F7a.prototype.showPopupEditor=function(e){this.trigger("showPopupEditor",e)},F7a.prototype.showViewStateDialog=function(t,n){var i=this;new ViewStateDialog({dialogContainer:this.dialogContainer,docDataModel:this.docDataModel,model:this.docViewModel,path:t,selectCallback:function(e){e!==t&&(e=i.docViewModel.getByPath(e))&&_.isFunction(n)&&n(e)}})},F7a.prototype.sanitizeTemplate=function(e){var t=["target"],n="dashreplace-",i=["style","table","thead","tbody","tfoot","tr","th","td","comment"];if(this.componentModel&&!0===this.componentModel.get("Basics.AllowUnsafeContent"))return e;l=e;function o(e){return DOMPurify.sanitize(e,{ADD_TAGS:_.map(i,function(e){return n+e}),ADD_ATTR:t})}var a,s,l,e=/(\<.*\[START\].*--\>.*[\s\S]*).*(\<.*\[END\]--\>)/g.exec(l),r=(e&&(a=e[1],s=e[2],l=(l=l.replace(e[1],"<comment>")).replace(e[2],"</comment>")),_.each(i,function(e){e=new RegExp("(</?)("+e+")(/>)?","g");l=l.replace(e,"$1"+n+"$2$3")}),/".*?"/g),c=/{{.+?}}/g,d=/(dashreplace[0-9]+=)?{{.+?}}/g,u="dashreplace",p=0,h=(l=l.replace(/<.+?>/g,function(e){return e.replace(r,function(e){return e.replace(c,function(e){return u+p+++"="+e})}).replace(d,function(e,t){return t?e:u+p+++'="'+e+'"'})}),t=t.concat(_.times(p,function(e){return u+e})),o(o(l)));return _.each(i,function(e){e=new RegExp("(</?)"+n+"("+e+")(/>)?","g");h=h.replace(e,"$1$2$3")}),h=(h=a&&s?(h=h.replace("<comment>",a)).replace("</comment>",s):h).replace(/(dashreplace[0-9]+=)"({{.+?}})"/g,function(e,t,n){return n}).replace(/(dashreplace[0-9]+=)({{.+?}})/g,function(e,t,n){return n})},F7a),E7a;function F7a(e){var t=E7a.call(this)||this;return t.appModel=e.appModel,t.dialogContainer=e.dialogContainer,t.docDataModel=e.docDataModel,t.docViewModel=e.docViewModel,t.viewModel=e.viewModel,t}var CopyPasteHelpers=(o8a.getComponentViewStates=function(e,n){void 0===n&&(n=!0);function i(t){t&&(t instanceof QuickBase.Component?(n&&(t.get("components").each(function(e){i(e)}),t.get("widgets").each(function(e){i(e.get("component"))})),i(t.get("options"))):_.isArray(t)?_.each(t,function(e){i(e)}):t.attributes?t.path?t.get("_dataSource")||_.includes(o,t.path)||(o.push(t.path),"dict"===t.get("_type")&&_.each(t.get("_default"),function(e){e instanceof QuickBase.DocumentViewModel&&o.push(e.path)})):i(t.attributes):!_.isObject(t)||t instanceof Backbone.View||("viewstate"===t._dashboardsType?_.includes(o,t.value)||o.push(t.value):_.each(_.keys(t),function(e){i(t[e])})))}var o=[];return i(e),o},o8a.mergeViewStates=function(e,a){var s;e&&a&&(_.each(e,function(e,t){if(!a.get("viewState").getByPath(t)){var n=t.split("/"),i=null,t=void 0;if(n.length<=1)s=n[0],i=new QuickBase.DocumentViewModel(e,null);else{for(var i=a.get("viewState"),o=0;o<n.length-1;o+=1)i.set(n[o],i.get(n[o])||new QuickBase.DocumentViewModel(null,null)),i=i.get(n[o]),s=0===o?n[o]:n.slice(0,o).join("/"),i.path=s;s=n.join("/"),t=new QuickBase.DocumentViewModel(e,null),i.set(n[n.length-1],t),t.path=s}a.get("viewState").getByPath(s)||(i.path=s,a.get("viewState").set(s,i))}}),a.get("viewState").postInitialize())},o8a.getMappingDataSources=function(n,e){var i=[];return e.get("data").getTreeList().forEach(function(t){t.get("_mappings")&&_.each(t.get("_mappings").mappings,function(e){_.includes(n,e.value)&&(i[t.path]=t.toJSON())})}),i},o8a.mergeDataSources=function(e,l){var r;e&&(r=l.get("data"),_.each(e,function(e,t){for(var n,i=_.filter(t.split("/"),function(e){return e&&0<e.length}),o=r,a="",s=0;s<i.length;s+=1)a=(a+=0===s?"":"/")+i[s],n=new QuickBase.DocumentDataModel(s!==i.length-1?{}:e,r,a,l.get("viewState"),s!==i.length-1),o=l.get("data").getByPath(a)?l.get("data").getByPath(a):(o.set(i[s],n),n.viewState=l.attributes.viewState,n)}))},o8a.getComponentDataSources=function(e,n,i,o){void 0===o&&(o=!0);var a,s={},l={},r=function(e){return e._cpKey||(_.isObject(e)||_.isArray(e))&&(Object.defineProperty(e,"_cpKey",{enumerable:!1,writable:!0}),e._cpKey=_.uniqueId("_cpKey_")),e._cpKey||null},c=function(t){!t||(a=r(t))&&l[a]||(a&&(l[a]=!0),!o&&(t instanceof QuickBase.WidgetCollection||t instanceof QuickBase.ComponentCollection)||(_.isArray(t)?_.each(t,function(e){c(e)}):t.attributes?(t.attributes._dataType&&_.includes(["analytic","pivot","query","virtual","builder"],t.attributes._dataType)&&(_.each(t.getViewStateDict(),function(e){_.includes(n,e.path)||(n.push(e.path),"dict"===e.get("_type")&&_.each(e.get("_default"),function(e){e instanceof QuickBase.DocumentViewModel&&n.push(e.path)}))}),"virtual"===t.attributes._dataType&&_.each(t.get("_virtualParams"),function(e){var t;"datasource"===e.type&&(t=i.getByPath(e.value))&&(_.each(t.getViewStateDict(),function(e){_.includes(n,e.path)||n.push(e.path)}),s[e.value]=t.toJSON())}),s[t.path]=t.toJSON()),c(t.attributes)):!_.isObject(t)||t instanceof Backbone.View||("data"===t._dashboardsType?s[t.value]||c(i.getByPath(t.value)):_.each(_.keys(t),function(e){c(t[e])}))))};return c(e),s},o8a);function o8a(e){}!function(b){"use strict";var s=0,e='<div class="ui-colorpicker ui-colorpicker-dialog ui-dialog ui-widget ui-widget-content ui-corner-all" style="display: none;"></div>',t='<div class="ui-colorpicker ui-colorpicker-inline ui-dialog ui-widget ui-widget-content ui-corner-all"></div>',n='<div class="ui-colorpicker ui-colorpicker-inline"></div>',l=function(e){var t=Math.round(e).toString(16);if(t.length===1)t="0"+t;return t.toLowerCase()},a=function(e){var t,n;n=/^#?([a-fA-F0-9]{1,6})$/.exec(e);if(n){t=parseInt(n[1],16);return new b.colorpicker.Color((t>>16&255)/255,(t>>8&255)/255,(t&255)/255)}return new b.colorpicker.Color},r=function(e,t){var n,i,o,a,s,l,r,c,d,u,p,h,m,g;e.sort(function(e,t){if(e.pos[1]===t.pos[1])return e.pos[0]-t.pos[0];return e.pos[1]-t.pos[1]});a=0;s=0;b.each(e,function(e,t){a=Math.max(a,t.pos[0]+t.pos[2]);s=Math.max(s,t.pos[1]+t.pos[3])});n=[];for(i=0;i<a;++i)n.push([]);r=[];l=[];b.each(e,function(e,t){for(i=0;i<t.pos[2];i+=1)l[t.pos[0]+i]=true;for(o=0;o<t.pos[3];o+=1)r[t.pos[1]+o]=true});u="";d=e[c=0];for(o=0;o<s;++o){u+="<tr>";i=0;while(i<a)if(typeof d!=="undefined"&&i===d.pos[0]&&o===d.pos[1]){u+=t(d,i,o);for(h=0;h<d.pos[3];h+=1)for(p=0;p<d.pos[2];p+=1)n[i+p][o+h]=true;i+=d.pos[2];d=e[++c]}else{m=0;g=false;while(i<a&&n[i][o]===undefined&&(d===undefined||o<d.pos[1]||o===d.pos[1]&&i<d.pos[0])){if(l[i]===true)m+=1;g=true;i+=1}if(m>0)u+='<td colspan="'+m+'"></td>';else if(!g)i+=1}u+="</tr>"}return'<table cellspacing="0" cellpadding="0" border="0"><tbody>'+u+"</tbody></table>"};b.colorpicker=new function(){this.regional={"":{ok:"OK",cancel:"Cancel",none:"None",button:"Color",title:"Pick a color",transparent:"Transparent",hsvH:"H",hsvS:"S",hsvV:"V",rgbR:"R",rgbG:"G",rgbB:"B",labL:"L",labA:"a",labB:"b",hslH:"H",hslS:"S",hslL:"L",cmykC:"C",cmykM:"M",cmykY:"Y",cmykK:"K",alphaA:"A"}};this.swatchesNames={html:"HTML"};this.swatches={html:[{name:"black",r:0,g:0,b:0},{name:"dimgray",r:.4117647058823529,g:.4117647058823529,b:.4117647058823529},{name:"gray",r:.5019607843137255,g:.5019607843137255,b:.5019607843137255},{name:"darkgray",r:.6627450980392157,g:.6627450980392157,b:.6627450980392157},{name:"silver",r:.7529411764705882,g:.7529411764705882,b:.7529411764705882},{name:"lightgrey",r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},{name:"gainsboro",r:.8627450980392157,g:.8627450980392157,b:.8627450980392157},{name:"whitesmoke",r:.9607843137254902,g:.9607843137254902,b:.9607843137254902},{name:"white",r:1,g:1,b:1},{name:"rosybrown",r:.7372549019607844,g:.5607843137254902,b:.5607843137254902},{name:"indianred",r:.803921568627451,g:.3607843137254902,b:.3607843137254902},{name:"brown",r:.6470588235294118,g:.16470588235294117,b:.16470588235294117},{name:"firebrick",r:.6980392156862745,g:.13333333333333333,b:.13333333333333333},{name:"lightcoral",r:.9411764705882353,g:.5019607843137255,b:.5019607843137255},{name:"maroon",r:.5019607843137255,g:0,b:0},{name:"darkred",r:.5450980392156862,g:0,b:0},{name:"red",r:1,g:0,b:0},{name:"snow",r:1,g:.9803921568627451,b:.9803921568627451},{name:"salmon",r:.9803921568627451,g:.5019607843137255,b:.4470588235294118},{name:"mistyrose",r:1,g:.8941176470588236,b:.8823529411764706},{name:"tomato",r:1,g:.38823529411764707,b:.2784313725490196},{name:"darksalmon",r:.9137254901960784,g:.5882352941176471,b:.47843137254901963},{name:"orangered",r:1,g:.27058823529411763,b:0},{name:"coral",r:1,g:.4980392156862745,b:.3137254901960784},{name:"lightsalmon",r:1,g:.6274509803921569,b:.47843137254901963},{name:"sienna",r:.6274509803921569,g:.3215686274509804,b:.17647058823529413},{name:"seashell",r:1,g:.9607843137254902,b:.9333333333333333},{name:"chocolate",r:.8235294117647058,g:.4117647058823529,b:.11764705882352941},{name:"saddlebrown",r:.5450980392156862,g:.27058823529411763,b:.07450980392156863},{name:"sandybrown",r:.9568627450980393,g:.6431372549019608,b:.3764705882352941},{name:"peachpuff",r:1,g:.8549019607843137,b:.7254901960784313},{name:"peru",r:.803921568627451,g:.5215686274509804,b:.24705882352941178},{name:"linen",r:.9803921568627451,g:.9411764705882353,b:.9019607843137255},{name:"darkorange",r:1,g:.5490196078431373,b:0},{name:"bisque",r:1,g:.8941176470588236,b:.7686274509803922},{name:"burlywood",r:.8705882352941177,g:.7215686274509804,b:.5294117647058824},{name:"tan",r:.8235294117647058,g:.7058823529411765,b:.5490196078431373},{name:"antiquewhite",r:.9803921568627451,g:.9215686274509803,b:.8431372549019608},{name:"navajowhite",r:1,g:.8705882352941177,b:.6784313725490196},{name:"blanchedalmond",r:1,g:.9215686274509803,b:.803921568627451},{name:"papayawhip",r:1,g:.9372549019607843,b:.8352941176470589},{name:"orange",r:1,g:.6470588235294118,b:0},{name:"moccasin",r:1,g:.8941176470588236,b:.7098039215686275},{name:"wheat",r:.9607843137254902,g:.8705882352941177,b:.7019607843137254},{name:"oldlace",r:.9921568627450981,g:.9607843137254902,b:.9019607843137255},{name:"floralwhite",r:1,g:.9803921568627451,b:.9411764705882353},{name:"goldenrod",r:.8549019607843137,g:.6470588235294118,b:.12549019607843137},{name:"darkgoldenrod",r:.7215686274509804,g:.5254901960784314,b:.043137254901960784},{name:"cornsilk",r:1,g:.9725490196078431,b:.8627450980392157},{name:"gold",r:1,g:.8431372549019608,b:0},{name:"palegoldenrod",r:.9333333333333333,g:.9098039215686274,b:.6666666666666666},{name:"khaki",r:.9411764705882353,g:.9019607843137255,b:.5490196078431373},{name:"lemonchiffon",r:1,g:.9803921568627451,b:.803921568627451},{name:"darkkhaki",r:.7411764705882353,g:.7176470588235294,b:.4196078431372549},{name:"beige",r:.9607843137254902,g:.9607843137254902,b:.8627450980392157},{name:"lightgoldenrodyellow",r:.9803921568627451,g:.9803921568627451,b:.8235294117647058},{name:"olive",r:.5019607843137255,g:.5019607843137255,b:0},{name:"yellow",r:1,g:1,b:0},{name:"lightyellow",r:1,g:1,b:.8784313725490196},{name:"ivory",r:1,g:1,b:.9411764705882353},{name:"olivedrab",r:.4196078431372549,g:.5568627450980392,b:.13725490196078433},{name:"yellowgreen",r:.6039215686274509,g:.803921568627451,b:.19607843137254902},{name:"darkolivegreen",r:.3333333333333333,g:.4196078431372549,b:.1843137254901961},{name:"greenyellow",r:.6784313725490196,g:1,b:.1843137254901961},{name:"lawngreen",r:.48627450980392156,g:.9882352941176471,b:0},{name:"chartreuse",r:.4980392156862745,g:1,b:0},{name:"darkseagreen",r:.5607843137254902,g:.7372549019607844,b:.5607843137254902},{name:"forestgreen",r:.13333333333333333,g:.5450980392156862,b:.13333333333333333},{name:"limegreen",r:.19607843137254902,g:.803921568627451,b:.19607843137254902},{name:"lightgreen",r:.5647058823529412,g:.9333333333333333,b:.5647058823529412},{name:"palegreen",r:.596078431372549,g:.984313725490196,b:.596078431372549},{name:"darkgreen",r:0,g:.39215686274509803,b:0},{name:"green",r:0,g:.5019607843137255,b:0},{name:"lime",r:0,g:1,b:0},{name:"honeydew",r:.9411764705882353,g:1,b:.9411764705882353},{name:"mediumseagreen",r:.23529411764705882,g:.7019607843137254,b:.44313725490196076},{name:"seagreen",r:.1803921568627451,g:.5450980392156862,b:.3411764705882353},{name:"springgreen",r:0,g:1,b:.4980392156862745},{name:"mintcream",r:.9607843137254902,g:1,b:.9803921568627451},{name:"mediumspringgreen",r:0,g:.9803921568627451,b:.6039215686274509},{name:"mediumaquamarine",r:.4,g:.803921568627451,b:.6666666666666666},{name:"aquamarine",r:.4980392156862745,g:1,b:.8313725490196079},{name:"turquoise",r:.25098039215686274,g:.8784313725490196,b:.8156862745098039},{name:"lightseagreen",r:.12549019607843137,g:.6980392156862745,b:.6666666666666666},{name:"mediumturquoise",r:.2823529411764706,g:.8196078431372549,b:.8},{name:"darkslategray",r:.1843137254901961,g:.30980392156862746,b:.30980392156862746},{name:"paleturquoise",r:.6862745098039216,g:.9333333333333333,b:.9333333333333333},{name:"teal",r:0,g:.5019607843137255,b:.5019607843137255},{name:"darkcyan",r:0,g:.5450980392156862,b:.5450980392156862},{name:"darkturquoise",r:0,g:.807843137254902,b:.8196078431372549},{name:"aqua",r:0,g:1,b:1},{name:"cyan",r:0,g:1,b:1},{name:"lightcyan",r:.8784313725490196,g:1,b:1},{name:"azure",r:.9411764705882353,g:1,b:1},{name:"cadetblue",r:.37254901960784315,g:.6196078431372549,b:.6274509803921569},{name:"powderblue",r:.6901960784313725,g:.8784313725490196,b:.9019607843137255},{name:"lightblue",r:.6784313725490196,g:.8470588235294118,b:.9019607843137255},{name:"deepskyblue",r:0,g:.7490196078431373,b:1},{name:"skyblue",r:.5294117647058824,g:.807843137254902,b:.9215686274509803},{name:"lightskyblue",r:.5294117647058824,g:.807843137254902,b:.9803921568627451},{name:"steelblue",r:.27450980392156865,g:.5098039215686274,b:.7058823529411765},{name:"aliceblue",r:.9411764705882353,g:.9725490196078431,b:1},{name:"dodgerblue",r:.11764705882352941,g:.5647058823529412,b:1},{name:"slategray",r:.4392156862745098,g:.5019607843137255,b:.5647058823529412},{name:"lightslategray",r:.4666666666666667,g:.5333333333333333,b:.6},{name:"lightsteelblue",r:.6901960784313725,g:.7686274509803922,b:.8705882352941177},{name:"cornflowerblue",r:.39215686274509803,g:.5843137254901961,b:.9294117647058824},{name:"royalblue",r:.2549019607843137,g:.4117647058823529,b:.8823529411764706},{name:"midnightblue",r:.09803921568627451,g:.09803921568627451,b:.4392156862745098},{name:"lavender",r:.9019607843137255,g:.9019607843137255,b:.9803921568627451},{name:"navy",r:0,g:0,b:.5019607843137255},{name:"darkblue",r:0,g:0,b:.5450980392156862},{name:"mediumblue",r:0,g:0,b:.803921568627451},{name:"blue",r:0,g:0,b:1},{name:"ghostwhite",r:.9725490196078431,g:.9725490196078431,b:1},{name:"darkslateblue",r:.2823529411764706,g:.23921568627450981,b:.5450980392156862},{name:"slateblue",r:.41568627450980394,g:.35294117647058826,b:.803921568627451},{name:"mediumslateblue",r:.4823529411764706,g:.40784313725490196,b:.9333333333333333},{name:"mediumpurple",r:.5764705882352941,g:.4392156862745098,b:.8588235294117647},{name:"blueviolet",r:.5411764705882353,g:.16862745098039217,b:.8862745098039215},{name:"indigo",r:.29411764705882354,g:0,b:.5098039215686274},{name:"darkorchid",r:.6,g:.19607843137254902,b:.8},{name:"darkviolet",r:.5803921568627451,g:0,b:.8274509803921568},{name:"mediumorchid",r:.7294117647058823,g:.3333333333333333,b:.8274509803921568},{name:"thistle",r:.8470588235294118,g:.7490196078431373,b:.8470588235294118},{name:"plum",r:.8666666666666667,g:.6274509803921569,b:.8666666666666667},{name:"violet",r:.9333333333333333,g:.5098039215686274,b:.9333333333333333},{name:"purple",r:.5019607843137255,g:0,b:.5019607843137255},{name:"darkmagenta",r:.5450980392156862,g:0,b:.5450980392156862},{name:"magenta",r:1,g:0,b:1},{name:"fuchsia",r:1,g:0,b:1},{name:"orchid",r:.8549019607843137,g:.4392156862745098,b:.8392156862745098},{name:"mediumvioletred",r:.7803921568627451,g:.08235294117647059,b:.5215686274509804},{name:"deeppink",r:1,g:.0784313725490196,b:.5764705882352941},{name:"hotpink",r:1,g:.4117647058823529,b:.7058823529411765},{name:"palevioletred",r:.8588235294117647,g:.4392156862745098,b:.5764705882352941},{name:"lavenderblush",r:1,g:.9411764705882353,b:.9607843137254902},{name:"crimson",r:.8627450980392157,g:.0784313725490196,b:.23529411764705882},{name:"pink",r:1,g:.7529411764705882,b:.796078431372549},{name:"lightpink",r:1,g:.7137254901960784,b:.7568627450980392}]};this.writers={"#HEX":function(e,t){return t._formatColor("#rxgxbx",e)},"#HEX3":function(e,t){var n=b.colorpicker.writers.HEX3(e);return n===false?false:"#"+n},HEX:function(e,t){return t._formatColor("rxgxbx",e)},HEX3:function(e,t){var n=e.getRGB(),i=Math.round(n.r*255),o=Math.round(n.g*255),a=Math.round(n.b*255);if(i>>>4===(i&=15)&&o>>>4===(o&=15)&&a>>>4===(a&=15))return i.toString(16)+o.toString(16)+a.toString(16);return false},"#HEXA":function(e,t){return t._formatColor("#rxgxbxax",e)},"#HEXA4":function(e,t){var n=b.colorpicker.writers.HEXA4(e,t);return n===false?false:"#"+n},HEXA:function(e,t){return t._formatColor("rxgxbxax",e)},HEXA4:function(e,t){var n=Math.round(e.getAlpha()*255);if(n>>>4===(n&=15))return b.colorpicker.writers.HEX3(e,t)+n.toString(16);return false},RGB:function(e,t){return e.getAlpha()>=1?t._formatColor("rgb(rd,gd,bd)",e):false},RGBA:function(e,t){return t._formatColor("rgba(rd,gd,bd,af)",e)},"RGB%":function(e,t){return e.getAlpha()>=1?t._formatColor("rgb(rp%,gp%,bp%)",e):false},"RGBA%":function(e,t){return t._formatColor("rgba(rp%,gp%,bp%,af)",e)},HSL:function(e,t){return e.getAlpha()>=1?t._formatColor("hsl(hd,sd,vd)",e):false},HSLA:function(e,t){return t._formatColor("hsla(hd,sd,vd,af)",e)},"HSL%":function(e,t){return e.getAlpha()>=1?t._formatColor("hsl(hp%,sp%,vp%)",e):false},"HSLA%":function(e,t){return t._formatColor("hsla(hp%,sp%,vp%,af)",e)},NAME:function(e,t){return t._closestName(e)},EXACT:function(e,t){return t._exactName(e)}};this.parsers={"":function(e){if(e==="")return new b.colorpicker.Color},NAME:function(e,t){var n=t._getSwatch(b.trim(e));if(n)return new b.colorpicker.Color(n.r,n.g,n.b)},RGBA:function(e){var t=/^rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(e);if(t)return new b.colorpicker.Color(t[1]/255,t[2]/255,t[3]/255,parseFloat(t[4]))},"RGBA%":function(e){var t=/^rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(e);if(t)return new b.colorpicker.Color(t[1]/100,t[2]/100,t[3]/100,t[4]/100)},HSLA:function(e){var t=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(e);if(t)return(new b.colorpicker.Color).setHSL(t[1]/255,t[2]/255,t[3]/255).setAlpha(parseFloat(t[4]))},"HSLA%":function(e){var t=/^hsla?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(e);if(t)return(new b.colorpicker.Color).setHSL(t[1]/100,t[2]/100,t[3]/100).setAlpha(t[4]/100)},"#HEX":function(e){var t=/^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/.exec(e);if(t)return new b.colorpicker.Color(parseInt(t[1],16)/255,parseInt(t[2],16)/255,parseInt(t[3],16)/255)},"#HEX3":function(e){var t=/^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/.exec(e);if(t)return new b.colorpicker.Color(parseInt(String(t[1])+t[1],16)/255,parseInt(String(t[2])+t[2],16)/255,parseInt(String(t[3])+t[3],16)/255)},HEX:function(e){var t=/^([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/.exec(e);if(t)return new b.colorpicker.Color(parseInt(t[1],16)/255,parseInt(t[2],16)/255,parseInt(t[3],16)/255)},HEX3:function(e){var t=/^([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/.exec(e);if(t)return new b.colorpicker.Color(parseInt(String(t[1])+t[1],16)/255,parseInt(String(t[2])+t[2],16)/255,parseInt(String(t[3])+t[3],16)/255)},"#HEXA":function(e){var t=/^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/.exec(e);if(t)return new b.colorpicker.Color(parseInt(t[1],16)/255,parseInt(t[2],16)/255,parseInt(t[3],16)/255,parseInt(t[4],16)/255)},"#HEXA4":function(e){var t=/^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/.exec(e);if(t)return new b.colorpicker.Color(parseInt(String(t[1])+t[1],16)/255,parseInt(String(t[2])+t[2],16)/255,parseInt(String(t[3])+t[3],16)/255,parseInt(String(t[4])+t[4],16)/255)},HEXA:function(e){var t=/^([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/.exec(e);if(t)return new b.colorpicker.Color(parseInt(t[1],16)/255,parseInt(t[2],16)/255,parseInt(t[3],16)/255,parseInt(t[4],16)/255)},HEXA4:function(e){var t=/^([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/.exec(e);if(t)return new b.colorpicker.Color(parseInt(String(t[1])+t[1],16)/255,parseInt(String(t[2])+t[2],16)/255,parseInt(String(t[3])+t[3],16)/255,parseInt(String(t[4])+t[4],16)/255)}};this.partslists={full:["header","map","bar","hex","hsv","rgb","alpha","lab","cmyk","preview","swatches","footer"],popup:["map","bar","hex","hsv","rgb","alpha","preview","footer"],draggable:["header","map","bar","hex","hsv","rgb","alpha","preview","footer"],inline:["map","bar","hex","hsv","rgb","alpha","preview"]};this.limits={websafe:function(e){e.limit(6)},nibble:function(e){e.limit(16)},binary:function(e){e.limit(2)},name:function(e,t){var n=t._getSwatch(t._closestName(e));e.setRGB(n.r,n.g,n.b)}};this.parts={header:function(n){var e=this,i=null,o=function(){var e=n.options.title||n._getRegional("title"),t='<span class="ui-dialog-title">'+e+"</span>";if(!n.inline&&n.options.showCloseButton)t+='<a href="#" class="ui-dialog-titlebar-close ui-corner-all" role="button">'+'<span class="ui-icon ui-icon-closethick">close</span></a>';return'<div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix">'+t+"</div>"};this.init=function(){i=b(o()).prependTo(n.dialog);var e=b(".ui-dialog-titlebar-close",i);n._hoverable(e);n._focusable(e);e.click(function(e){e.preventDefault();n.close(n.options.revert)});if(!n.inline&&n.options.draggable){var t={handle:i};if(n.options.containment)t.containment=n.options.containment;n.dialog.draggable(t)}}},map:function(o){var a=this,s=null,l,r,c,d={},u,p,h,e;u=function(e){if(!o.opened)return;var t=d.p.offset(),n=e.pageX-t.left,i=e.pageY-t.top;if(n>=0&&n<r&&i>=0&&i<c){e.stopImmediatePropagation();e.preventDefault();s.unbind("mousedown",u);b(document).bind("mouseup",p);b(document).bind("mousemove",h);h(e)}};p=function(e){e.stopImmediatePropagation();e.preventDefault();b(document).unbind("mouseup",p);b(document).unbind("mousemove",h);s.bind("mousedown",u);o._callback("stop")};h=function(e){e.stopImmediatePropagation();e.preventDefault();if(e.pageX===a.x&&e.pageY===a.y)return;a.x=e.pageX;a.y=e.pageY;var t=d.p.offset(),n=e.pageX-t.left,i=e.pageY-t.top;n=Math.max(0,Math.min(n/r,1));i=Math.max(0,Math.min(i/c,1));switch(o.mode){case"h":o.color.setHSV(null,n,1-i);break;case"s":case"a":o.color.setHSV(n,null,1-i);break;case"v":o.color.setHSV(n,1-i,null);break;case"r":o.color.setRGB(null,1-i,n);break;case"g":o.color.setRGB(1-i,null,n);break;case"b":o.color.setRGB(n,1-i,null);break}o._change(false)};e=function(){var e='<div class="ui-colorpicker-map ui-colorpicker-map-'+(o.options.part.map.size||256)+' ui-colorpicker-border">'+'<span class="ui-colorpicker-map-layer-1">&nbsp;</span>'+'<span class="ui-colorpicker-map-layer-2">&nbsp;</span>'+(o.options.alpha?'<span class="ui-colorpicker-map-layer-alpha">&nbsp;</span>':"")+'<span class="ui-colorpicker-map-layer-pointer"><span class="ui-colorpicker-map-pointer"></span></span></div>';return e};this.init=function(){s=b(e()).appendTo(b(".ui-colorpicker-map-container",o.dialog));s.bind("mousedown",u);d[1]=b(".ui-colorpicker-map-layer-1",s);d[2]=b(".ui-colorpicker-map-layer-2",s);d.a=b(".ui-colorpicker-map-layer-alpha",s);d.p=b(".ui-colorpicker-map-layer-pointer",s);r=d.p.width();c=d.p.height();l=b(".ui-colorpicker-map-pointer",s)};this.update=function(){var e=(o.options.part.map.size||256)*65/64;switch(o.mode){case"h":d[1].css({"background-position":"0 0",opacity:""}).show();d[2].hide();break;case"s":case"a":d[1].css({"background-position":"0 "+-e+"px",opacity:""}).show();d[2].css({"background-position":"0 "+-e*2+"px",opacity:""}).show();break;case"v":s.css("background-color","black");d[1].css({"background-position":"0 "+-e*3+"px",opacity:""}).show();d[2].hide();break;case"r":d[1].css({"background-position":"0 "+-e*4+"px",opacity:""}).show();d[2].css({"background-position":"0 "+-e*5+"px",opacity:""}).show();break;case"g":d[1].css({"background-position":"0 "+-e*6+"px",opacity:""}).show();d[2].css({"background-position":"0 "+-e*7+"px",opacity:""}).show();break;case"b":d[1].css({"background-position":"0 "+-e*8+"px",opacity:""}).show();d[2].css({"background-position":"0 "+-e*9+"px",opacity:""}).show();break}a.repaint()};this.repaint=function(){var e=0,t=0;switch(o.mode){case"h":var n=o.color.getHSV();e=n.s*r;t=(1-n.v)*r;s.css("background-color",o.color.copy().setHSV(null,1,1).toCSS());break;case"s":case"a":var n=o.color.getHSV();e=n.h*r;t=(1-n.v)*r;d[2].css("opacity",1-n.s);break;case"v":var n=o.color.getHSV();e=n.h*r;t=(1-n.s)*r;d[1].css("opacity",n.v);break;case"r":var i=o.color.getRGB();e=i.b*r;t=(1-i.g)*r;d[2].css("opacity",i.r);break;case"g":var i=o.color.getRGB();e=i.b*r;t=(1-i.r)*r;d[2].css("opacity",i.g);break;case"b":var i=o.color.getRGB();e=i.r*r;t=(1-i.g)*r;d[2].css("opacity",i.b);break}if(o.options.alpha)d.a.css("opacity",1-o.color.getAlpha());l.css({left:e-7,top:t-7})}},bar:function(o){var i=this,a=null,s,l,r,c={},d,u,p,e;d=function(e){if(!o.opened)return;var t=c.p.offset(),n=e.pageX-t.left,i=e.pageY-t.top;if(n>=0&&n<l&&i>=0&&i<r){e.stopImmediatePropagation();e.preventDefault();a.unbind("mousedown",d);b(document).bind("mouseup",u);b(document).bind("mousemove",p);p(e)}};u=function(e){e.stopImmediatePropagation();e.preventDefault();b(document).unbind("mouseup",u);b(document).unbind("mousemove",p);a.bind("mousedown",d);o._callback("stop")};p=function(e){e.stopImmediatePropagation();e.preventDefault();if(e.pageY===i.y)return;i.y=e.pageY;var t=c.p.offset(),n=e.pageY-t.top;n=Math.max(0,Math.min(n/r,1));switch(o.mode){case"h":o.color.setHSV(1-n,null,null);break;case"s":o.color.setHSV(null,1-n,null);break;case"v":o.color.setHSV(null,null,1-n);break;case"r":o.color.setRGB(1-n,null,null);break;case"g":o.color.setRGB(null,1-n,null);break;case"b":o.color.setRGB(null,null,1-n);break;case"a":o.color.setAlpha(1-n);break}o._change(false)};e=function(){var e='<div class="ui-colorpicker-bar ui-colorpicker-bar-'+(o.options.part.bar.size||256)+'  ui-colorpicker-border">'+'<span class="ui-colorpicker-bar-layer-1">&nbsp;</span>'+'<span class="ui-colorpicker-bar-layer-2">&nbsp;</span>'+'<span class="ui-colorpicker-bar-layer-3">&nbsp;</span>'+'<span class="ui-colorpicker-bar-layer-4">&nbsp;</span>';if(o.options.alpha)e+='<span class="ui-colorpicker-bar-layer-alpha">&nbsp;</span>'+'<span class="ui-colorpicker-bar-layer-alphabar">&nbsp;</span>';e+='<span class="ui-colorpicker-bar-layer-pointer"><span class="ui-colorpicker-bar-pointer"></span></span></div>';return e};this.init=function(){a=b(e()).appendTo(b(".ui-colorpicker-bar-container",o.dialog));a.bind("mousedown",d);c[1]=b(".ui-colorpicker-bar-layer-1",a);c[2]=b(".ui-colorpicker-bar-layer-2",a);c[3]=b(".ui-colorpicker-bar-layer-3",a);c[4]=b(".ui-colorpicker-bar-layer-4",a);c.a=b(".ui-colorpicker-bar-layer-alpha",a);c.ab=b(".ui-colorpicker-bar-layer-alphabar",a);c.p=b(".ui-colorpicker-bar-layer-pointer",a);l=c.p.width();r=c.p.height();s=b(".ui-colorpicker-bar-pointer",a)};this.update=function(){var e=(o.options.part.bar.size||256)*65/64;switch(o.mode){case"h":case"s":case"v":case"r":case"g":case"b":c.a.show();c.ab.hide();break;case"a":c.a.hide();c.ab.show();break}switch(o.mode){case"h":c[1].css({"background-position":"0 0",opacity:""}).show();c[2].hide();c[3].hide();c[4].hide();break;case"s":c[1].css({"background-position":"0 "+-e+"px",opacity:""}).show();c[2].css({"background-position":"0 "+-e*2+"px",opacity:""}).show();c[3].hide();c[4].hide();break;case"v":c[1].css({"background-position":"0 "+-e*2+"px",opacity:""}).show();c[2].hide();c[3].hide();c[4].hide();break;case"r":c[1].css({"background-position":"0 "+-e*6+"px",opacity:""}).show();c[2].css({"background-position":"0 "+-e*5+"px",opacity:""}).show();c[3].css({"background-position":"0 "+-e*3+"px",opacity:""}).show();c[4].css({"background-position":"0 "+-e*4+"px",opacity:""}).show();break;case"g":c[1].css({"background-position":"0 "+-e*10+"px",opacity:""}).show();c[2].css({"background-position":"0 "+-e*9+"px",opacity:""}).show();c[3].css({"background-position":"0 "+-e*7+"px",opacity:""}).show();c[4].css({"background-position":"0 "+-e*8+"px",opacity:""}).show();break;case"b":c[1].css({"background-position":"0 "+-e*14+"px",opacity:""}).show();c[2].css({"background-position":"0 "+-e*13+"px",opacity:""}).show();c[3].css({"background-position":"0 "+-e*11+"px",opacity:""}).show();c[4].css({"background-position":"0 "+-e*12+"px",opacity:""}).show();break;case"a":c[1].hide();c[2].hide();c[3].hide();c[4].hide();break}i.repaint()};this.repaint=function(){var e=0;switch(o.mode){case"h":e=(1-o.color.getHSV().h)*r;break;case"s":var t=o.color.getHSV();e=(1-t.s)*r;c[2].css("opacity",1-t.v);a.css("background-color",o.color.copy().setHSV(null,1,null).toCSS());break;case"v":e=(1-o.color.getHSV().v)*r;a.css("background-color",o.color.copy().setHSV(null,null,1).toCSS());break;case"r":var n=o.color.getRGB();e=(1-n.r)*r;c[2].css("opacity",Math.max(0,n.b-n.g));c[3].css("opacity",Math.max(0,n.g-n.b));c[4].css("opacity",Math.min(n.b,n.g));break;case"g":var n=o.color.getRGB();e=(1-n.g)*r;c[2].css("opacity",Math.max(0,n.b-n.r));c[3].css("opacity",Math.max(0,n.r-n.b));c[4].css("opacity",Math.min(n.r,n.b));break;case"b":var n=o.color.getRGB();e=(1-n.b)*r;c[2].css("opacity",Math.max(0,n.r-n.g));c[3].css("opacity",Math.max(0,n.g-n.r));c[4].css("opacity",Math.min(n.r,n.g));break;case"a":e=(1-o.color.getAlpha())*r;a.css("background-color",o.color.copy().toCSS());break}if(o.mode!=="a")c.a.css("opacity",1-o.color.getAlpha());s.css("top",e-3)}},preview:function(e){var t=this,n=null,i,o,a,s,l,r;r=function(){return'<div class="ui-colorpicker-preview ui-colorpicker-border">'+'<div class="ui-colorpicker-preview-initial"><div class="ui-colorpicker-preview-initial-alpha"></div></div>'+'<div class="ui-colorpicker-preview-current"><div class="ui-colorpicker-preview-current-alpha"></div></div>'+"</div>"};this.init=function(){n=b(r()).appendTo(b(".ui-colorpicker-preview-container",e.dialog));b(".ui-colorpicker-preview-initial",n).click(function(){e.color=e.currentColor.copy();e._change()});o=b(".ui-colorpicker-preview-initial",n);a=b(".ui-colorpicker-preview-initial-alpha",n);s=b(".ui-colorpicker-preview-current",n);l=b(".ui-colorpicker-preview-current-alpha",n);i=b(".ui-colorpicker-preview-initial-alpha, .ui-colorpicker-preview-current-alpha",n)};this.update=function(){i[e.options.alpha?"show":"hide"]();this.repaint()};this.repaint=function(){o.css("background-color",e.currentColor.set?e.currentColor.toCSS():"").attr("title",e.currentColor.set?e.currentColor.toCSS():"");a.css("opacity",1-e.currentColor.getAlpha());s.css("background-color",e.color.set?e.color.toCSS():"").attr("title",e.color.set?e.color.toCSS():"");l.css("opacity",1-e.color.getAlpha())}},hsv:function(t){var e=this,n=null,i={},o;o=function(){var e="";if(t.options.hsv)e+='<div class="ui-colorpicker-hsv-h"><input class="ui-colorpicker-mode" type="radio" value="h"/><label>'+t._getRegional("hsvH")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="360" size="10"/><span class="ui-colorpicker-unit">&deg;</span></div>'+'<div class="ui-colorpicker-hsv-s"><input class="ui-colorpicker-mode" type="radio" value="s"/><label>'+t._getRegional("hsvS")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100" size="10"/><span class="ui-colorpicker-unit">%</span></div>'+'<div class="ui-colorpicker-hsv-v"><input class="ui-colorpicker-mode" type="radio" value="v"/><label>'+t._getRegional("hsvV")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100" size="10"/><span class="ui-colorpicker-unit">%</span></div>';return'<div class="ui-colorpicker-hsv">'+e+"</div>"};this.init=function(){n=b(o()).appendTo(b(".ui-colorpicker-hsv-container",t.dialog));b(".ui-colorpicker-mode",n).click(function(){t.mode=b(this).val();t._updateAllParts()});i.h=b(".ui-colorpicker-hsv-h .ui-colorpicker-number",n);i.s=b(".ui-colorpicker-hsv-s .ui-colorpicker-number",n);i.v=b(".ui-colorpicker-hsv-v .ui-colorpicker-number",n);b(".ui-colorpicker-number",n).bind("change keyup",function(){t.color.setHSV(i.h.val()/360,i.s.val()/100,i.v.val()/100);t._change()})};this.repaint=function(){var e=t.color.getHSV();i.h.val(Math.round(e.h*360));i.s.val(Math.round(e.s*100));i.v.val(Math.round(e.v*100))};this.update=function(){b(".ui-colorpicker-mode",n).each(function(){var e=b(this);e.attr("checked",e.val()===t.mode)});this.repaint()}},rgb:function(t){var e=this,n=null,i={},o;o=function(){var e="";if(t.options.rgb)e+='<div class="ui-colorpicker-rgb-r"><input class="ui-colorpicker-mode" type="radio" value="r"/><label>'+t._getRegional("rgbR")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div>'+'<div class="ui-colorpicker-rgb-g"><input class="ui-colorpicker-mode" type="radio" value="g"/><label>'+t._getRegional("rgbG")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div>'+'<div class="ui-colorpicker-rgb-b"><input class="ui-colorpicker-mode" type="radio" value="b"/><label>'+t._getRegional("rgbB")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div>';return'<div class="ui-colorpicker-rgb">'+e+"</div>"};this.init=function(){n=b(o()).appendTo(b(".ui-colorpicker-rgb-container",t.dialog));b(".ui-colorpicker-mode",n).click(function(){t.mode=b(this).val();t._updateAllParts()});i.r=b(".ui-colorpicker-rgb-r .ui-colorpicker-number",n);i.g=b(".ui-colorpicker-rgb-g .ui-colorpicker-number",n);i.b=b(".ui-colorpicker-rgb-b .ui-colorpicker-number",n);b(".ui-colorpicker-number",n).bind("change keyup",function(){var e=b(".ui-colorpicker-rgb-r .ui-colorpicker-number",n).val();t.color.setRGB(i.r.val()/255,i.g.val()/255,i.b.val()/255);t._change()})};this.repaint=function(){var e=t.color.getRGB();i.r.val(Math.round(e.r*255));i.g.val(Math.round(e.g*255));i.b.val(Math.round(e.b*255))};this.update=function(){b(".ui-colorpicker-mode",n).each(function(){var e=b(this);e.attr("checked",e.val()===t.mode)});this.repaint()}},lab:function(t){var e=this,n=null,i={},o=function(){var e="";if(t.options.hsv)e+='<div class="ui-colorpicker-lab-l"><label>'+t._getRegional("labL")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/></div>'+'<div class="ui-colorpicker-lab-a"><label>'+t._getRegional("labA")+'</label><input class="ui-colorpicker-number" type="number" min="-128" max="127"/></div>'+'<div class="ui-colorpicker-lab-b"><label>'+t._getRegional("labB")+'</label><input class="ui-colorpicker-number" type="number" min="-128" max="127"/></div>';return'<div class="ui-colorpicker-lab">'+e+"</div>"};this.init=function(){var e=0;n=b(o()).appendTo(b(".ui-colorpicker-lab-container",t.dialog));i.l=b(".ui-colorpicker-lab-l .ui-colorpicker-number",n);i.a=b(".ui-colorpicker-lab-a .ui-colorpicker-number",n);i.b=b(".ui-colorpicker-lab-b .ui-colorpicker-number",n);b(".ui-colorpicker-number",n).bind("change keyup",function(e){t.color.setLAB(parseInt(i.l.val(),10)/100,(parseInt(i.a.val(),10)+128)/255,(parseInt(i.b.val(),10)+128)/255);t._change()})};this.repaint=function(){var e=t.color.getLAB();i.l.val(Math.round(e.l*100));i.a.val(Math.round(e.a*255)-128);i.b.val(Math.round(e.b*255)-128)};this.update=this.repaint},cmyk:function(t){var e=this,n=null,i={},o=function(){var e="";if(t.options.hsv)e+='<div class="ui-colorpicker-cmyk-c"><label>'+t._getRegional("cmykC")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'+'<div class="ui-colorpicker-cmyk-m"><label>'+t._getRegional("cmykM")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'+'<div class="ui-colorpicker-cmyk-y"><label>'+t._getRegional("cmykY")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'+'<div class="ui-colorpicker-cmyk-k"><label>'+t._getRegional("cmykK")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>';return'<div class="ui-colorpicker-cmyk">'+e+"</div>"};this.init=function(){n=b(o()).appendTo(b(".ui-colorpicker-cmyk-container",t.dialog));i.c=b(".ui-colorpicker-cmyk-c .ui-colorpicker-number",n);i.m=b(".ui-colorpicker-cmyk-m .ui-colorpicker-number",n);i.y=b(".ui-colorpicker-cmyk-y .ui-colorpicker-number",n);i.k=b(".ui-colorpicker-cmyk-k .ui-colorpicker-number",n);b(".ui-colorpicker-number",n).bind("change keyup",function(e){t.color.setCMYK(parseInt(i.c.val(),10)/100,parseInt(i.m.val(),10)/100,parseInt(i.y.val(),10)/100,parseInt(i.k.val(),10)/100);t._change()})};this.repaint=function(){var e=t.color.getCMYK();i.c.val(Math.round(e.c*100));i.m.val(Math.round(e.m*100));i.y.val(Math.round(e.y*100));i.k.val(Math.round(e.k*100))};this.update=this.repaint},alpha:function(t){var e=this,n=null,i,o=function(){var e="";if(t.options.alpha)e+='<div class="ui-colorpicker-a"><input class="ui-colorpicker-mode" name="mode" type="radio" value="a"/><label>'+t._getRegional("alphaA")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>';return'<div class="ui-colorpicker-alpha">'+e+"</div>"};this.init=function(){n=b(o()).appendTo(b(".ui-colorpicker-alpha-container",t.dialog));b(".ui-colorpicker-mode",n).click(function(){t.mode=b(this).val();t._updateAllParts()});i=b(".ui-colorpicker-a .ui-colorpicker-number",n);b(".ui-colorpicker-number",n).bind("change keyup",function(){t.color.setAlpha(i.val()/100);t._change()})};this.update=function(){b(".ui-colorpicker-mode",n).each(function(){b(this).attr("checked",b(this).val()===t.mode)});this.repaint()};this.repaint=function(){i.val(Math.round(t.color.getAlpha()*100))}},hex:function(t){var e=this,n=null,i={},o;o=function(){var e="";if(t.options.alpha)e+='<input class="ui-colorpicker-hex-alpha" type="text" maxlength="2" size="2"/>';e+='<input class="ui-colorpicker-hex-input" type="text" maxlength="6" size="6"/>';return'<div class="ui-colorpicker-hex"><label>#</label>'+e+"</div>"};this.init=function(){n=b(o()).appendTo(b(".ui-colorpicker-hex-container",t.dialog));i.color=b(".ui-colorpicker-hex-input",n);i.alpha=b(".ui-colorpicker-hex-alpha",n);i.color.bind("change keydown keyup",function(e,t,n){if(/[^a-fA-F0-9]/.test(i.color.val()))i.color.val(i.color.val().replace(/[^a-fA-F0-9]/,""))});i.color.bind("change keyup",function(){t.color=a(i.color.val()).setAlpha(t.color.getAlpha());t._change()});i.alpha.bind("change keydown keyup",function(){if(/[^a-fA-F0-9]/.test(i.alpha))i.alpha.val(i.alpha.val().replace(/[^a-fA-F0-9]/,""))});i.alpha.bind("change keyup",function(){t.color.setAlpha(parseInt(i.alpha.val(),16)/255);t._change()})};this.repaint=function(){if(!i.color.is(":focus"))i.color.val(t.color.toHex(true));if(!i.alpha.is(":focus"))i.alpha.val(l(t.color.getAlpha()*255))};this.update=this.repaint},swatches:function(t){var e=this,n=function(){var o="";t._eachSwatch(function(e,t){var n=new b.colorpicker.Color(t.r,t.g,t.b),i=n.toCSS();o+='<div class="ui-colorpicker-swatch" style="background-color:'+i+'" title="'+e+'"></div>'});return'<div class="ui-colorpicker-swatches ui-colorpicker-border" style="width:'+t.options.swatchesWidth+'px">'+o+"</div>"};this.init=function(){var e=b(n());b(".ui-colorpicker-swatches-container",t.dialog).html(e);b(".ui-colorpicker-swatch",e).click(function(){t.color=t._parseColor(b(this).css("background-color"))||new b.colorpicker.Color;t._change()})}},footer:function(t){var e=this,n=null,i="ui-colorpicker-special-transparent-"+s,o="ui-colorpicker-special-none-"+s,a=function(){var e="";if(t.options.alpha||!t.inline&&t.options.showNoneButton){e+='<div class="ui-colorpicker-buttonset">';if(t.options.alpha)e+='<input type="radio" name="ui-colorpicker-special" id="'+i+'" class="ui-colorpicker-special-transparent"/><label for="'+i+'">'+t._getRegional("transparent")+"</label>";if(!t.inline&&t.options.showNoneButton)e+='<input type="radio" name="ui-colorpicker-special" id="'+o+'" class="ui-colorpicker-special-none"><label for="'+o+'">'+t._getRegional("none")+"</label>";e+="</div>"}if(!t.inline){e+='<div class="ui-dialog-buttonset">';if(t.options.showCancelButton)e+='<button class="ui-colorpicker-cancel">'+t._getRegional("cancel")+"</button>";e+='<button class="ui-colorpicker-ok">'+t._getRegional("ok")+"</button>";e+="</div>"}return'<div class="ui-dialog-buttonpane ui-widget-content">'+e+"</div>"};this.init=function(){n=b(a()).appendTo(t.dialog);b(".ui-colorpicker-ok",n).button().click(function(){t.close()});b(".ui-colorpicker-cancel",n).button().click(function(){t.close(true)});b(".ui-colorpicker-buttonset",n).buttonset();b(".ui-colorpicker-special-color",n).click(function(){t._change()});b("#"+o,n).click(function(){t.color.set=false;t._change()});b("#"+i,n).click(function(){t.color.setAlpha(0);t._change()})};this.repaint=function(){if(!t.color.set)b(".ui-colorpicker-special-none",n).attr("checked",true).button("refresh");else if(t.color.getAlpha()===0)b(".ui-colorpicker-special-transparent",n).attr("checked",true).button("refresh");else b("input",n).attr("checked",false).button("refresh");b(".ui-colorpicker-cancel",n).button(t.changed?"enable":"disable")};this.update=function(){}}};this.Color=function(){var o={rgb:{r:0,g:0,b:0},hsv:{h:0,s:0,v:0},hsl:{h:0,s:0,l:0},lab:{l:0,a:0,b:0},cmyk:{c:0,m:0,y:0,k:1}},t=1,a=[.9504285,1,1.0889],e=arguments,s=function(e){if(isNaN(e)||e===null)return 0;if(typeof e=="string")e=parseInt(e,10);return Math.max(0,Math.min(e,1))},n=function(e){var e=Math.round(e),t="0123456789abcdef",n=e%16,i=(e-n)/16,o=t.charAt(i)+t.charAt(n);return o},i=function(e){var t=e.r>.04045?Math.pow((e.r+.055)/1.055,2.4):e.r/12.92,n=e.g>.04045?Math.pow((e.g+.055)/1.055,2.4):e.g/12.92,i=e.b>.04045?Math.pow((e.b+.055)/1.055,2.4):e.b/12.92;return{x:t*.4124+n*.3576+i*.1805,y:t*.2126+n*.7152+i*.0722,z:t*.0193+n*.1192+i*.9505}},l=function(e){var t={r:e.x*3.2406+e.y*-1.5372+e.z*-.4986,g:e.x*-.9689+e.y*1.8758+e.z*.0415,b:e.x*.0557+e.y*-.204+e.z*1.057};t.r=t.r>.0031308?1.055*Math.pow(t.r,1/2.4)-.055:12.92*t.r;t.g=t.g>.0031308?1.055*Math.pow(t.g,1/2.4)-.055:12.92*t.g;t.b=t.b>.0031308?1.055*Math.pow(t.b,1/2.4)-.055:12.92*t.b;return t},r=function(e){var t=Math.min(e.r,e.g,e.b),n=Math.max(e.r,e.g,e.b),i=n-t,o,a,s,l={h:0,s:0,v:n};if(i===0){l.h=0;l.s=0}else{l.s=i/n;o=((n-e.r)/6+i/2)/i;a=((n-e.g)/6+i/2)/i;s=((n-e.b)/6+i/2)/i;if(e.r===n)l.h=s-a;else if(e.g===n)l.h=1/3+o-s;else if(e.b===n)l.h=2/3+a-o;if(l.h<0)l.h+=1;else if(l.h>1)l.h-=1}return l},c=function(e){var t={r:0,g:0,b:0},n,i,o,a,s;if(e.s===0)t.r=t.g=t.b=e.v;else{n=e.h===1?0:e.h*6;i=Math.floor(n);o=e.v*(1-e.s);a=e.v*(1-e.s*(n-i));s=e.v*(1-e.s*(1-(n-i)));if(i===0){t.r=e.v;t.g=s;t.b=o}else if(i===1){t.r=a;t.g=e.v;t.b=o}else if(i===2){t.r=o;t.g=e.v;t.b=s}else if(i===3){t.r=o;t.g=a;t.b=e.v}else if(i===4){t.r=s;t.g=o;t.b=e.v}else{t.r=e.v;t.g=o;t.b=a}}return t},d=function(e){var t=Math.min(e.r,e.g,e.b),n=Math.max(e.r,e.g,e.b),i=n-t,o,a,s,l={h:0,s:0,l:(n+t)/2};if(i===0){l.h=0;l.s=0}else{l.s=l.l<.5?i/(n+t):i/(2-n-t);o=((n-e.r)/6+i/2)/i;a=((n-e.g)/6+i/2)/i;s=((n-e.b)/6+i/2)/i;if(e.r===n)l.h=s-a;else if(e.g===n)l.h=1/3+o-s;else if(e.b===n)l.h=2/3+a-o;if(l.h<0)l.h+=1;else if(l.h>1)l.h-=1}return l},u=function(e){var t,n,i=function(e,t,n){if(n<0)n+=1;if(n>1)n-=1;if(6*n<1)return e+(t-e)*6*n;if(2*n<1)return t;if(3*n<2)return e+(t-e)*(2/3-n)*6;return e};if(e.s===0)return{r:e.l,g:e.l,b:e.l};n=e.l<.5?e.l*(1+e.s):e.l+e.s-e.s*e.l;t=2*e.l-n;return{r:i(t,n,e.h+1/3),g:i(t,n,e.h),b:i(t,n,e.h-1/3)}},p=function(e){var t=e.x/a[0],n=e.y/a[1],i=e.z/a[2];t=t>.008856?Math.pow(t,1/3):7.787*t+16/116;n=n>.008856?Math.pow(n,1/3):7.787*n+16/116;i=i>.008856?Math.pow(i,1/3):7.787*i+16/116;return{l:(116*n-16)/100,a:(500*(t-n)+128)/255,b:(200*(n-i)+128)/255}},h=function(e){var t={l:e.l*100,a:e.a*255-128,b:e.b*255-128},n={x:0,y:(t.l+16)/116,z:0};n.x=t.a/500+n.y;n.z=n.y-t.b/200;n.x=Math.pow(n.x,3)>.008856?Math.pow(n.x,3):(n.x-16/116)/7.787;n.y=Math.pow(n.y,3)>.008856?Math.pow(n.y,3):(n.y-16/116)/7.787;n.z=Math.pow(n.z,3)>.008856?Math.pow(n.z,3):(n.z-16/116)/7.787;n.x*=a[0];n.y*=a[1];n.z*=a[2];return n},m=function(e){return{c:1-e.r,m:1-e.g,y:1-e.b}},g=function(e){return{r:1-e.c,g:1-e.m,b:1-e.y}},f=function(e){var t=1;if(e.c<t)t=e.c;if(e.m<t)t=e.m;if(e.y<t)t=e.y;if(t===1)return{c:0,m:0,y:0,k:1};return{c:(e.c-t)/(1-t),m:(e.m-t)/(1-t),y:(e.y-t)/(1-t),k:t}},v=function(e){return{c:e.c*(1-e.k)+e.k,m:e.m*(1-e.k)+e.k,y:e.y*(1-e.k)+e.k}};this.set=false;this.setAlpha=function(e){if(e!==null)t=s(e);this.set=true;return this};this.getAlpha=function(){return t};this.setRGB=function(e,t,n){o={rgb:this.getRGB()};if(e!==null)o.rgb.r=s(e);if(t!==null)o.rgb.g=s(t);if(n!==null)o.rgb.b=s(n);this.set=true;return this};this.setHSV=function(e,t,n){o={hsv:this.getHSV()};if(e!==null)o.hsv.h=s(e);if(t!==null)o.hsv.s=s(t);if(n!==null)o.hsv.v=s(n);this.set=true;return this};this.setHSL=function(e,t,n){o={hsl:this.getHSL()};if(e!==null)o.hsl.h=s(e);if(t!==null)o.hsl.s=s(t);if(n!==null)o.hsl.l=s(n);this.set=true;return this};this.setLAB=function(e,t,n){o={lab:this.getLAB()};if(e!==null)o.lab.l=s(e);if(t!==null)o.lab.a=s(t);if(n!==null)o.lab.b=s(n);this.set=true;return this};this.setCMYK=function(e,t,n,i){o={cmyk:this.getCMYK()};if(e!==null)o.cmyk.c=s(e);if(t!==null)o.cmyk.m=s(t);if(n!==null)o.cmyk.y=s(n);if(i!==null)o.cmyk.k=s(i);this.set=true;return this};this.getRGB=function(){if(!o.rgb){o.rgb=o.lab?l(h(o.lab)):o.hsv?c(o.hsv):o.hsl?u(o.hsl):o.cmyk?g(v(o.cmyk)):{r:0,g:0,b:0};o.rgb.r=s(o.rgb.r);o.rgb.g=s(o.rgb.g);o.rgb.b=s(o.rgb.b)}return b.extend({},o.rgb)};this.getHSV=function(){if(!o.hsv){o.hsv=o.lab?r(this.getRGB()):o.rgb?r(o.rgb):o.hsl?r(this.getRGB()):o.cmyk?r(this.getRGB()):{h:0,s:0,v:0};o.hsv.h=s(o.hsv.h);o.hsv.s=s(o.hsv.s);o.hsv.v=s(o.hsv.v)}return b.extend({},o.hsv)};this.getHSL=function(){if(!o.hsl){o.hsl=o.rgb?d(o.rgb):o.hsv?d(this.getRGB()):o.cmyk?d(this.getRGB()):o.hsv?d(this.getRGB()):{h:0,s:0,l:0};o.hsl.h=s(o.hsl.h);o.hsl.s=s(o.hsl.s);o.hsl.l=s(o.hsl.l)}return b.extend({},o.hsl)};this.getCMYK=function(){if(!o.cmyk){o.cmyk=o.rgb?f(m(o.rgb)):o.hsv?f(m(this.getRGB())):o.hsl?f(m(this.getRGB())):o.lab?f(m(this.getRGB())):{c:0,m:0,y:0,k:1};o.cmyk.c=s(o.cmyk.c);o.cmyk.m=s(o.cmyk.m);o.cmyk.y=s(o.cmyk.y);o.cmyk.k=s(o.cmyk.k)}return b.extend({},o.cmyk)};this.getLAB=function(){if(!o.lab){o.lab=o.rgb?p(i(o.rgb)):o.hsv?p(i(this.getRGB())):o.hsl?p(i(this.getRGB())):o.cmyk?p(i(this.getRGB())):{l:0,a:0,b:0};o.lab.l=s(o.lab.l);o.lab.a=s(o.lab.a);o.lab.b=s(o.lab.b)}return b.extend({},o.lab)};this.getChannels=function(){return{r:this.getRGB().r,g:this.getRGB().g,b:this.getRGB().b,a:this.getAlpha(),h:this.getHSV().h,s:this.getHSV().s,v:this.getHSV().v,c:this.getCMYK().c,m:this.getCMYK().m,y:this.getCMYK().y,k:this.getCMYK().k,L:this.getLAB().l,A:this.getLAB().a,B:this.getLAB().b}};this.getSpaces=function(){return b.extend(true,{},o)};this.distance=function(e){var t="lab",n="get"+t.toUpperCase(),i=this[n](),o=e[n](),a=0,s;for(s in i)a+=Math.pow(i[s]-o[s],2);return a};this.equals=function(e){if(e){var t=this.getRGB(),n=e.getRGB();return this.set===e.set&&this.getAlpha()===e.getAlpha()&&t.r===n.r&&t.g===n.g&&t.b===n.b}return false};this.limit=function(e){e-=1;var t=this.getRGB();this.setRGB(Math.round(t.r*e)/e,Math.round(t.g*e)/e,Math.round(t.b*e)/e)};this.toHex=function(){var e=this.getRGB();return n(e.r*255)+n(e.g*255)+n(e.b*255)};this.toCSS=function(){return"#"+this.toHex()};this.copy=function(){var e=new b.colorpicker.Color(this.getSpaces(),this.getAlpha());e.set=this.set;return e};if(e.length===2){o=e[0];this.setAlpha(e[1]===0?0:e[1]||1);this.set=true}if(e.length>2){this.setRGB(e[0],e[1],e[2]);this.setAlpha(e[3]===0?0:e[3]||1);this.set=true}}},b.widget("vanderlee.colorpicker",{options:{alpha:false,altAlpha:true,altField:"",altOnChange:true,altProperties:"background-color",autoOpen:false,buttonClass:null,buttonColorize:false,buttonImage:"images/ui-colorpicker.png",buttonImageOnly:false,buttonText:null,closeOnEscape:true,closeOnOutside:true,color:"#00FF00",colorFormat:"HEX",draggable:true,containment:null,duration:"fast",hideOn:"button",hsv:true,inline:true,inlineFrame:true,layout:{map:[0,0,1,5],bar:[1,0,1,5],preview:[2,0,1,1],hsv:[2,1,1,1],rgb:[2,2,1,1],alpha:[2,3,1,1],hex:[2,4,1,1],lab:[3,1,1,1],cmyk:[3,2,1,2],swatches:[4,0,1,5]},limit:"",modal:false,mode:"h",okOnEnter:false,parts:"",part:{map:{size:256},bar:{size:256}},position:null,regional:"",revert:false,rgb:true,showAnim:"fadeIn",showCancelButton:true,showNoneButton:false,showCloseButton:true,showOn:"focus click alt",showOptions:{},swatches:null,swatchesWidth:84,title:null,cancel:null,close:null,init:null,ok:null,open:null,select:null,stop:null},_create:function(){var t=this,e;++s;t.widgetEventPrefix="colorpicker";t.opened=false;t.generated=false;t.inline=false;t.changed=false;t.dialog=null;t.button=null;t.image=null;t.overlay=null;t.events={window_resize:null,document_keydown:null,document_click_html:null};t.mode=t.options.mode;if(t.element.is("input")||t.options.inline===false){t._setColor(t.element.is("input")?t.element.val():t.options.color);t._callback("init");if(/\bfocus|all|both\b/.test(t.options.showOn))t.element.bind("focus",function(){t.open()});if(/\bfocus|all|both\b/.test(t.options.hideOn))t.element.bind("focusout",function(e){t.close()});if(/\bclick|all|both\b/.test(t.options.showOn))t.element.bind("click",function(e){if(t.opened&&/\bclick|all|both\b/.test(t.options.hideOn))t.close();else t.open()});if(/\bbutton|all|both\b/.test(t.options.showOn)){if(t.options.buttonImage!==""){e=t.options.buttonText||t._getRegional("button");t.image=b("<img/>").attr({src:t.options.buttonImage,alt:e,title:e});if(t.options.buttonClass)t.image.attr("class",t.options.buttonClass);t._setImageBackground()}if(t.options.buttonImageOnly&&t.image)t.button=t.image;else{t.button=b('<button type="button"></button>').html(t.image||t.options.buttonText).button();t.image=t.image?b("img",t.button).first():null}t.button.insertAfter(t.element).click(function(){if(t.opened&&/\bbutton|all|both\b/.test(t.options.hideOn))t.close();else t.open()})}if(/\balt|all|both\b/.test(t.options.showOn))b(t.options.altField).bind("click",function(){if(t.opened&&/\balt|all|both\b/.test(t.options.hideOn))t.close();else t.open()});if(t.options.autoOpen)t.open()}else{t.inline=true;t._generate();t.opened=true}return this},_setOption:function(e,t){switch(e){case"disabled":if(t)this.dialog.addClass("ui-colorpicker-disabled");else this.dialog.removeClass("ui-colorpicker-disabled");break;case"swatches":this.options.swatches=t;this.parts.swatches.init();break}b.Widget.prototype._setOption.apply(this,arguments)},_setImageBackground:function(){if(this.image&&this.options.buttonColorize)this.image.css("background-color",this.color.set?this._formatColor("RGBA",this.color):"")},_setAltField:function(){if(this.options.altOnChange&&this.options.altField&&this.options.altProperties){var e,t,n=this.options.altProperties.split(",");for(e=0;e<=n.length;++e){t=b.trim(n[e]);switch(t){case"color":case"fill":case"stroke":case"background-color":case"backgroundColor":case"outline-color":case"border-color":b(this.options.altField).css(t,this.color.set?this.color.toCSS():"");break}}if(this.options.altAlpha)b(this.options.altField).css("opacity",this.color.set?this.color.getAlpha():"")}},_setColor:function(e){this.color=this._parseColor(e)||new b.colorpicker.Color;this.currentColor=this.color.copy();this._setImageBackground();this._setAltField()},setColor:function(e){this._setColor(e);this._change()},getColor:function(e){return this._formatColor(e||this.options.colorFormat,this.color)},_generateInline:function(){var e=this;b(e.element).html(e.options.inlineFrame?t:n);e.dialog=b(".ui-colorpicker",e.element)},_generatePopup:function(){var i=this;i.dialog=b(e).appendTo("body");if(i.events.document_click_html===null)b(document).delegate("html","touchstart click",i.events.document_click_html=function(e){if(!i.opened||e.target===i.element[0]||i.overlay)return;if(i.dialog.is(e.target)||i.dialog.has(e.target).length>0){i.element.blur();return}var t,n=b(e.target).parents();n.push(e.target);for(t=0;t<=n.length;++t){if(i.button!==null&&n[t]===i.button[0])return;if(/\balt|all|both\b/.test(i.options.showOn)&&b(i.options.altField).is(n[t]))return}if(!i.options.closeOnOutside)return;i.close(i.options.revert)});if(i.events.document_keydown===null)b(document).bind("keydown",i.events.document_keydown=function(e){if(i.opened&&e.keyCode===27&&i.options.closeOnEscape)i.close(i.options.revert);if(i.opened&&e.keyCode===13&&i.options.okOnEnter)i.close()});i.element.keydown(function(e){if(e.keyCode===9)i.close()}).keyup(function(e){var t=i._parseColor(i.element.val());if(t&&!i.color.equals(t)){i.color=t;i._change()}})},_generate:function(){var n=this,e,t,i,o,a,s;n._setColor(n.inline||!n.element.is("input")?n.options.color:n.element.val());n[n.inline?"_generateInline":"_generatePopup"]();if(typeof n.options.parts==="string")if(b.colorpicker.partslists[n.options.parts])i=b.colorpicker.partslists[n.options.parts];else i=b.colorpicker.partslists[n.inline?"inline":"popup"];else i=n.options.parts;n.parts={};b.each(i,function(e,t){if(b.colorpicker.parts[t])n.parts[t]=new b.colorpicker.parts[t](n)});if(!n.generated){o=[];b.each(n.options.layout,function(e,t){if(n.parts[e])o.push({part:e,pos:t})});a=b(r(o,function(e,t,n){s=["ui-colorpicker-"+e.part+"-container"];if(t>0)s.push("ui-colorpicker-padding-left");if(n>0)s.push("ui-colorpicker-padding-top");return'<td  class="'+s.join(" ")+'"'+(e.pos[2]>1?' colspan="'+e.pos[2]+'"':"")+(e.pos[3]>1?' rowspan="'+e.pos[3]+'"':"")+' valign="top"></td>'})).appendTo(n.dialog);if(n.options.inlineFrame)a.addClass("ui-dialog-content ui-widget-content");n._initAllParts();n._updateAllParts();n.generated=true}},_effectGeneric:function(e,t,n,i,o){var a=this;if(b.effects&&b.effects[a.options.showAnim])e[t](a.options.showAnim,a.options.showOptions,a.options.duration,o);else{e[a.options.showAnim==="slideDown"?n:a.options.showAnim==="fadeIn"?i:t](a.options.showAnim?a.options.duration:null,o);if(!a.options.showAnim||!a.options.duration)o()}},_effectShow:function(e,t){this._effectGeneric(e,"show","slideDown","fadeIn",t)},_effectHide:function(e,t){this._effectGeneric(e,"hide","slideUp","fadeOut",t)},open:function(){var e=this,t,n,i,o,a,s,l,r,c,d;if(!e.opened){e._generate();if(e.element.is(":hidden"))c=b("<div/>").insertBefore(e.element);else c=e.element;if(e.element.is(":hidden"))c.remove();r=0;b(e.element[0]).parents().each(function(){var e=b(this).css("z-index");if((typeof e==="number"||typeof e==="string")&&e!==""&&!isNaN(e)){if(e>r){r=parseInt(e,10);return false}}else b(this).siblings().each(function(){var e=b(this).css("z-index");if((typeof e==="number"||typeof e==="string")&&e!==""&&!isNaN(e))if(e>r)r=parseInt(e,10)})});r+=2;e.dialog.css("z-index",r);if(e.options.modal){e.overlay=b('<div class="ui-widget-overlay"></div>').appendTo("body").css("z-index",r-1);if(e.events.window_resize!==null)b(window).unbind("resize",e.events.window_resize);e.events.window_resize=function(){if(e.overlay){e.overlay.width(b(document).width());e.overlay.height(b(document).height())}},b(window).bind("resize",e.events.window_resize);e.events.window_resize()}e._effectShow(this.dialog);if(e.options.position){d=b.extend({},e.options.position);if(d.of==="element")d.of=c}else d={my:"left top",at:"left bottom",of:c,collision:"flip"};e.dialog.position(d);e.opened=true;e._callback("open",true);b(function(){e._repaintAllParts()})}},close:function(e){var t=this;if(!t.opened)return;if(e){t.color=t.currentColor.copy();t._change();t._callback("cancel",true)}else{t.currentColor=t.color.copy();t._callback("ok",true)}t.changed=false;if(t.overlay){b(window).unbind("resize",t.events.window_resize);t.overlay.remove()}t._effectHide(t.dialog,function(){t.dialog.remove();t.dialog=null;t.generated=false;t.opened=false;t._callback("close",true)})},destroy:function(){if(that.events.document_click_html!==null)b(document).undelegate("html","touchstart click",that.events.document_click_html);if(that.events.document_keydown!==null)b(document).unbind("keydown",that.events.document_keydown);if(that.events.resizeOverlay!==null)b(window).unbind("resize",that.events.resizeOverlay);this.element.unbind();if(this.overlay)this.overlay.remove();if(this.dialog!==null)this.dialog.remove();if(this.image!==null)this.image.remove();if(this.button!==null)this.button.remove()},_callback:function(e,t){var n=this,i,o;if(n.color.set){i={formatted:n._formatColor(n.options.colorFormat,n.color),colorPicker:n};o=n.color.getLAB();o.a=o.a*2-1;o.b=o.b*2-1;if(t===true){i.a=n.color.getAlpha();i.rgb=n.color.getRGB();i.hsv=n.color.getHSV();i.cmyk=n.color.getCMYK();i.hsl=n.color.getHSL();i.lab=o}return n._trigger(e,null,i)}else return n._trigger(e,null,{formatted:"",colorPicker:n})},_initAllParts:function(){b.each(this.parts,function(e,t){if(t.init)t.init()})},_updateAllParts:function(){b.each(this.parts,function(e,t){if(t.update)t.update()})},_repaintAllParts:function(){b.each(this.parts,function(e,t){if(t.repaint)t.repaint()})},_change:function(e){this.changed=true;e=typeof e!=="undefined"?!!e:true;if(this.color.set&&this.options.limit&&b.colorpicker.limits[this.options.limit])b.colorpicker.limits[this.options.limit](this.color,this);if(!this.inline){if(!this.color.set){if(this.element.val()!=="")this.element.val("").change()}else if(!this.color.equals(this._parseColor(this.element.val())))this.element.val(this._formatColor(this.options.colorFormat,this.color)).change();this._setImageBackground();this._setAltField()}this.options.color=this.color.set?this.color.toCSS():"";if(this.opened)this._repaintAllParts();this._callback("select");if(e)this._callback("stop")},_hoverable:function(e){e.hover(function(){e.addClass("ui-state-hover")},function(){e.removeClass("ui-state-hover")})},_focusable:function(e){e.focus(function(){e.addClass("ui-state-focus")}).blur(function(){e.removeClass("ui-state-focus")})},_getRegional:function(e){return b.colorpicker.regional[this.options.regional][e]!==undefined?b.colorpicker.regional[this.options.regional][e]:b.colorpicker.regional[""][e]},_getSwatches:function(){if(typeof this.options.swatches==="string")return b.colorpicker.swatches[this.options.swatches];if(b.isPlainObject(this.options.swatches))return this.options.swatches;return b.colorpicker.swatches.html},_eachSwatch:function(n){var i=this._getSwatches(),o;b.each(i,function(e,t){o=b.isArray(i)?t.name:e;return n(o,t)})},_getSwatch:function(n){var i=false;this._eachSwatch(function(e,t){if(e.toLowerCase()==n.toLowerCase()){i=t;return false}});return i},_parseFormat:function(e,t){var n=this,i={x:function(){return"([0-9a-fA-F]{2})"},d:function(){return"([12]?[0-9]{1,2})"},f:function(){return"([0-9]*\\.?[0-9]*)"},p:function(){return"([0-9]*\\.?[0-9]*)"}},o={x:function(e){return parseInt(e,16)},d:function(e){return e/255},f:function(e){return e},p:function(e){return e*.01}},a={r:"setRGB",g:"setRGB",b:"setRGB",h:"setHSV",s:"setHSV",v:"setHSV",c:"setCMYK",m:"setCMYK",y:"setCMYK",k:"setCMYK",L:"setLAB",A:"setLAB",B:"setLAB"},s={setRGB:["r","g","b"],setHSV:["h","s","v"],setCMYK:["c","m","y","k"],setLAB:["L","A","B"]},l=[],r=[],c=null,d,u;u=e.replace(/[()\\^$.|?*+[\]]/g,function(e){return"\\"+e});u=u.replace(/\\?[argbhsvcmykLAB][xdfp]/g,function(e){if(e.match(/^\\/))return e.slice(1);var t=e.charAt(0),n=e.charAt(1);l.push(t);r.push(o[n]);if(a[t])c=a[t];return i[n]()});if(c){var p=t.match(new RegExp(u));if(p){var h=[],m;p.shift();b.each(s[c],function(e,t){m=b.inArray(t,l);h[e]=r[m](p[m])});d=new b.colorpicker.Color;d[c].apply(d,h)}}return d},_parseColor:function(n){var i=this,o;var e=b.isArray(i.options.colorFormat)?i.options.colorFormat:[i.options.colorFormat];b.each(e,function(e,t){if(b.colorpicker.parsers[t])o=b.colorpicker.parsers[t](n,i);else o=i._parseFormat(t,n);if(o)return false});if(!o)b.each(b.colorpicker.parsers,function(e,t){o=t(n,i);if(o)return false});if(o)return o;return false},_exactName:function(n){var i=false;this._eachSwatch(function(e,t){if(n.equals(new b.colorpicker.Color(t.r,t.g,t.b))){i=e;return false}});return i},_closestName:function(n){var e=n.getRGB(),i=null,o=false,a;this._eachSwatch(function(e,t){a=n.distance(new b.colorpicker.Color(t.r,t.g,t.b));if(a<i||i===null){o=e;if(a<=1e-20)return false;i=a}});return o},_formatColor:function(e,n){var i=this,o=null,a={x:function(e){return l(e*255)},d:function(e){return Math.round(e*255)},f:function(e){return e},p:function(e){return e*100}},s=n.getChannels();if(!b.isArray(e))e=[e];b.each(e,function(e,t){if(b.colorpicker.writers[t]){o=b.colorpicker.writers[t](n,i);return o===false}else{o=t.replace(/\\?[argbhsvcmykLAB][xdfp]/g,function(e){if(e.match(/^\\/))return e.slice(1);return a[e.charAt(1)](s[e.charAt(0)])});return false}});return o}}),b.vanderlee.colorpicker}(jQuery);var ScreenItem=Backbone.View.extend({$defaultThumb:null,$input:null,$thumbImage:null,$removeScreenButton:null,$makeDefaultScreenButton:null,$screenName:null,appModel:null,className:"screen-item",screensCollection:null,tagName:"li",viewModel:null,initialize:function(e){this.appModel=e.appModel,this.viewModel=e.viewModel,this.screensCollection=e.screensCollection,this.render(),this.initializeEvents(),this.onThumbChanged(),this.onScreensCollectionChanged(),this.onIsDefaultChanged()},initializeEvents:function(){this.listenTo(this.model,"change:thumb",this.onThumbChanged),this.listenTo(this.model,"change:name",this.onNameChanged),this.listenTo(this.model,"change:isDefault",this.onIsDefaultChanged),this.$el.find(".camera").on("click",$.proxy(this.onCameraClick,this)),this.$el.click($.proxy(this.onItemSelected,this)),this.$duplicateScreenButton.on("click",$.proxy(this.onDuplicateScreenButtonClicked,this)),this.$makeDefaultScreenButton.on("click",$.proxy(this.onMakeDefaultScreenButtonClicked,this)),this.$removeScreenButton.on("click",$.proxy(this.onRemoveScreenButtonClicked,this)),this.$screenName.on("click",$.proxy(this.showInput,this)),this.listenTo(this.screensCollection,"reset add remove",this.onScreensCollectionChanged)},hideInput:function(){this.$input&&(this.$input.off(),this.$input.remove(),this.$input=null)},navigateToScreen:function(e){var t=this.viewModel.get("selectedDocumentId");this.appModel.get("router").navigate(t+"/"+e,{trigger:!0})},onCameraClick:function(){this.trigger("cameraClick",this)},onDuplicateScreenButtonClicked:function(e){var t,n=this.model.clone(),i=1,o=!0;for(e.preventDefault(),e.stopPropagation(),(e=(t=n.get("name")).match(/^(.+ copy)( \(\d+\))?$/))?t=e[1]:t+=" copy";o;)this.screensCollection.some(function(e){return e.get("name")===(1<i?t+" ("+i+")":t)})?i+=1:(o=!1,1<i&&(t+=" ("+i+")"));n.set({name:t,isDefault:!1}),this.screensCollection.commandAdd(n),this.navigateToScreen(n.id)},onIsDefaultChanged:function(){this.model.get("isDefault")?(this.$makeDefaultScreenButton.addClass("is-default"),this.$makeDefaultScreenButton.attr("title",t("Default Screen"))):(this.$makeDefaultScreenButton.removeClass("is-default"),this.$makeDefaultScreenButton.attr("title",t("Set as Default Screen")))},onItemSelected:function(){this.navigateToScreen(this.model.id)},onNameChanged:function(){this.$screenName.text(this.model.get("name"))},onMakeDefaultScreenButtonClicked:function(e){var t,n=[];this.model.get("isDefault")||(n.push({id:this.model.id,isDefault:!0}),(t=this.screensCollection.find(function(e){return e.get("isDefault")&&e.id!==this.model.id}.bind(this)))&&n.push({id:t.id,isDefault:!1}),this.screensCollection.commandSet(n))},onRemoveScreenButtonClicked:function(e){e.preventDefault(),e.stopPropagation(),1<this.screensCollection.length&&this.screensCollection.commandRemove(this.model)},onScreensCollectionChanged:function(){this.screensCollection.length<=1?this.$removeScreenButton.addClass("last-one"):this.$removeScreenButton.removeClass("last-one")},onThumbChanged:function(){this.model.get("thumb")?(this.$thumbImage.attr("src",this.model.get("thumb")),this.$defaultThumb.hide(),this.$thumbImage.show()):(this.$thumbImage.hide(),this.$defaultThumb.show())},render:function(){this.$el.html(T.ScreenItem(this.model.toJSON())),this.$defaultThumb=this.$el.find(".default-thumb"),this.$duplicateScreenButton=this.$el.find(".duplicate-screen-btn"),this.$makeDefaultScreenButton=this.$el.find(".make-default-screen-btn"),this.$removeScreenButton=this.$el.find(".remove-screen-btn"),this.$screenName=this.$el.find(".screen-name"),this.$thumbImage=this.$el.find(".screen-thumb")},showInput:function(e){var t,n,i=this;e&&(e.preventDefault(),e.stopPropagation()),e=this.$screenName.position(),t=this.$screenName.width(),n=this.$screenName.height(),this.$input=$(document.createElement("input")),this.$input.addClass("name-input"),this.$input.css({left:e.left+parseInt(this.$screenName.css("padding-left"),10),top:e.top+parseInt(this.$screenName.css("padding-top"),10),width:t,height:n}),this.$input.val(this.model.get("name")),this.$input.appendTo(this.$screenName.parent()),this.$input.focus(),this.$input.select(),this.$input.on("keydown",function(e){13===e.keyCode?(i.model.commandSet({name:i.$input.val()}),i.hideInput(),e.preventDefault(),e.stopPropagation()):27===e.keyCode&&(i.hideInput(),e.preventDefault(),e.stopPropagation())}),this.$input.on("focusout",function(e){i.hideInput()})},remove:function(){this.$el.find("fa-camera").off(),this.$el.off(),this.$duplicateScreenButton.off(),this.$makeDefaultScreenButton.off(),this.$removeScreenButton.off(),this.$screenName.off(),Backbone.View.prototype.remove.call(this)}}),ScreenList=Backbone.View.extend({$addScreenButton:null,$list:null,$listScrollWrap:null,$screenList:null,$screenListHeader:null,addScreenButton:null,appModel:null,viewModel:null,selectedScreen:null,screens:null,addScreenItem:function(e,t){e=new ScreenItem({model:e,screensCollection:this.model.get("screens"),appModel:this.appModel,viewModel:this.viewModel});return!_.isUndefined(t)&&t<this.screens.length?0===t?e.$el.prependTo(this.$list):e.$el.insertBefore(this.$list.find("li").eq(t)):e.$el.appendTo(this.$list),this.listenTo(e,"cameraClick",this.onScreenCameraClick),this.screens.push(e),e},initialize:function(e){this.appModel=e.appModel,this.viewModel=e.viewModel,this.screens=[],this.render(),this.initializeEvents()},initializeEvents:function(){this.listenTo(this.model.get("screens"),"add",this.onScreenAdded),this.listenTo(this.model.get("screens"),"remove",this.onScreenRemoved),this.listenTo(this.viewModel,"change:selectedScreenId",$.proxy(this.onScreenSelected,this))},onAddScreenButtonClick:function(e){for(var t,n=this.model,i=this.model.get("screens"),o=0,a=!1;!a;)t="Screen "+(o+=1),i.some(function(e){return e.get("name")===t})||(a=!0);n=new QuickBase.Screen({name:t,colCount:n.get("colCount"),floatable:n.get("floatable"),relativeHeight:n.get("relativeHeight"),rowCount:n.get("rowCount"),rowHeight:n.get("rowHeight")},{},i),i.commandAdd(n),e.preventDefault()},onResize:function(){},onScreenAdded:function(e,t,n){this.addScreenItem(e,n.at),Log.Info("screen added",e)},onScreenCameraClick:function(e){this.viewModel.trigger("screenshot")},onScreenRemoved:function(e){this.removeScreenItem(e),Log.Info("screen removed",e),this.viewModel.get("selectedScreenId")===e.id&&(e=this.model.get("screens").first(),this.viewModel.set("selectedScreenId",e.id))},onScreenSelected:function(){var e,t=this.viewModel.get("selectedScreenId");this.selectedScreen&&this.selectedScreen.$el.removeClass("selected"),(e=_.find(this.screens,function(e){return e.model.id===t}))&&(this.selectedScreen=e,this.selectedScreen.$el.addClass("selected"))},removeScreenItem:function(t){var e=_.find(this.screens,function(e){return e.model===t});e?(this.screens=_.without(this.screens,e),e.remove()):Log.Info("screen not found")},render:function(){var t=this;return this.$el.html(T.ScreenList()),this.$list=this.$el.find("ul"),this.$listScrollWrap=this.$el.find(".list-scroll-wrap"),this.$screenList=this.$el.find(".screen-list"),this.$screenListHeader=this.$el.find(".screen-list-header"),this.$addScreenButton=this.$el.find(".add-screen-button"),this.$addScreenButton.button({icons:{primary:"fa fa-plus"}}).click($.proxy(this.onAddScreenButtonClick,this)),this.viewModel.get("selectedScreenId"),this.model.get("screens").each(function(e){t.addScreenItem(e)}),0<this.model.get("screens").length&&this.onScreenSelected(),this},remove:function(){this.stopListening(),this.$el.remove()}}),DashboardPermission=Backbone.View.extend({className:"permision-row",tagName:"tr",initialize:function(e){var t=this;t.$el.html(T.DashboardPermission(e.details)),e.details.read?t.$el.find(".permissionRead input").prop("checked","checked"):t.$el.find(".permissionRead input").removeProp("checked"),e.details.write?t.$el.find(".permissionWrite input").prop("checked","checked"):t.$el.find(".permissionWrite input").removeProp("checked"),t.$el.find(".permissionWrite input").on("change",function(){!0===t.$el.find(".permissionWrite input").prop("checked")&&t.$el.find(".permissionRead input").prop("checked",!0),t.trigger("ApplyChanges")}),t.$el.find(".permissionRead input").on("change",function(){!1===t.$el.find(".permissionRead input").prop("checked")&&t.$el.find(".permissionWrite input").removeProp("checked",!0),t.trigger("ApplyChanges")}),t.$el.css({height:"25px;"})}}),DashboardPermissions=Backbone.View.extend({$permissionsList:null,$permissionsTable:null,initialize:function(e){var n=this;n.$el.html(T.DashboardPermissions()),n.$permissionsList=n.$el.find(".permissions-list"),n.$permissionsTable=n.$el.find("table tbody"),n.model.get("permissionEntity")&&n.model.get("permissionEntity").permissions&&_.each(n.model.get("permissionEntity").permissions,function(e,t){t={name:t,read:e[0],write:e[1]},e=new DashboardPermission({details:t});e.on("ApplyChanges",$.proxy(n.applyChanges,n)),n.$permissionsTable.append(e.$el)})},applyChanges:function(){var i={};_.each(this.$el.find("tr"),function(e){var t=$(e).find("td.permissionName").text(),n=$(e).find("td.permissionRead input").prop("checked"),e=$(e).find("td.permissionWrite input").prop("checked");0<t.length&&(i[t]=[n,e])}),this.model.get("permissionEntity").permissions=i},openDialog:function(){var n=this;n.$dialog.dialog("open"),n.$permissionsTable.find("tr").remove(),n.model.get("permissionEntity")&&n.model.get("permissionEntity").permissions&&_.each(n.model.get("permissionEntity").permissions,function(e,t){t={name:t,read:e[0],write:e[1]},e=new DashboardPermission({details:t});n.$permissionsTable.append(e.$el)})},updatePermissions:function(e){var n=this;_.each(e,function(e,t){n.model.get("permissionEntity").permissions[t]=e})}}),DashbordDefinition=(Rsa={type:"object",title:"Properties",_transform:function(e,t,n,i){_.set(t,"properties.Basics.properties.RowCount.options.hidden",!_.get(e,"Basics.FillHeight")),_.set(t,"properties.Basics.properties.RowHeight.options.hidden",!!_.get(e,"Basics.FillHeight")),i(void 0,t)},properties:{Basics:{type:"object",title:"Basics",options:{collapsed:!1},properties:{Name:{title:"Name",type:"string",propertyOrder:10,readOnly:!0,default:""},Link:{title:"Link",type:"string",options:{readonly:!0},propertyOrder:15,default:""},EnableShareDashboard:{title:'Enable "Share Dashboard"',type:"boolean",propertyOrder:20,format:"checkbox",default:!1},SaveViewerState:{title:"Save Viewer State",type:"string",propertyOrder:22,enum:["disabled","enabled","enabled_auto"],default:"enabled",options:{enum_titles:["Disabled","Enabled","Enabled (Autosave)"]}},UnsavedViewerPrompt:{title:"Unsaved Viewer Prompt",type:"boolean",propertyOrder:25,format:"checkbox",default:!1},FillHeight:{title:"Fill Height",type:"boolean",propertyOrder:30,format:"checkbox",default:!0},Floatable:{title:"Floatable",type:"boolean",propertyOrder:35,format:"checkbox",default:!1},ColCount:{title:"Column Count",type:"number",propertyOrder:40,minimum:1,default:12},RowHeight:{title:"Row Height",type:"number",propertyOrder:45,default:25,options:{hidden:!0}},RowCount:{title:"Row Count",type:"number",propertyOrder:50,minimum:1,default:24}}},Style:{type:"object",title:"Style",options:{collapsed:!0},properties:{DashboardTheme:{title:"Dashboard Theme",type:"string",enum:["Dark","Light"],default:"Dark"},ThemeSwitchable:{title:"Theme Switchable",type:"boolean",format:"checkbox",default:!0},WidgetsSpacing:{title:"Widgets Spacing",type:"number",minimum:0,default:0},WidgetShadow:{title:"Widget Shadow",type:"boolean",format:"checkbox",default:!1},BackgroundColor:{title:"Background Color",options:{noColor:!1},type:"gradient",default:"#000000"},TransparentBackground:{title:"Transparent Background",type:"boolean",format:"checkbox",default:!0},BorderSize:{title:"Border Size",type:"number",minimum:0,default:0},BorderColor:{title:"Border Color",options:{noColor:!1},type:"gradient",default:"#000000"},BorderRounding:{title:"Border Rounding",type:"number",minimum:0,default:0},BorderSpacing:{title:"Border Spacing",type:"number",minimum:0,default:0},WorksheetPadding:{title:"Worksheet Padding",type:"number",minimum:0,default:10},ShowDataLoadingIndicators:{title:"Show Data Loading Indicators",type:"boolean",format:"checkbox",default:!0},AdvancedCss:{type:"css",title:"Advanced CSS",default:""},cssClasses:{type:"string",title:"CSS Classes",default:""}}},Popups:{type:"popups",title:"Popups",options:{collapsed:!0,editPopupButton:!0},items:{type:"object",id:"id",options:{collapsed:!0},title:"Popup",headerTemplate:"{{#if self.dialogTitle}}{{valueProp self.dialogTitle }}{{else}}Popup {{ i1 }}{{/if}}",properties:{visible:{type:"booleanViewState",title:"Visible",format:"checkbox",default:!1},dialogTitle:{type:"stringViewState",title:"Dialog Title",default:""},dialogHeight:{type:"numberViewState",format:"number",title:"Dialog Height",default:0},dialogWidth:{type:"numberViewState",format:"number",title:"Dialog Width",default:0},modal:{type:"booleanViewState",title:"Modal",format:"checkbox",default:!1},dialogTop:{type:"stringViewState",title:"Dialog Top",default:""},dialogLeft:{type:"stringViewState",title:"Dialog Left",default:""},resizable:{type:"booleanViewState",title:"Resizable",format:"checkbox",default:!1},Actions:{type:"actions",title:"Actions on Close",excludedFields:["url","nav","query"],fields:{map:{Current:{propertyOrder:10,default:"",type:"stringViewState",options:{custom_class_name:"mapping-current"}},Target:{default:"",propertyOrder:11,type:"stringViewState",options:{custom_class_name:"mapping-target"}}}}},id:{type:"stringViewState",title:"id",options:{hidden:!0},default:""}}}},Shortcuts:{type:"array",title:"Shortcuts",options:{collapsed:!0},items:{type:"object",id:"id",options:{collapsed:!0},title:"Shortcut",headerTemplate:"{{#if self.dialogTitle}}{{valueProp self.dialogTitle }}{{else}}Shortcut {{ i1 }}{{/if}}",properties:{Data:{type:"data",title:"Data Source",default:"",format:"data"},Key:{type:"string",title:"Key",default:""}}}}}},Qsa=_.reduce(["Basics","Style"],function(e,t){return e[t]=_.mapValues(Rsa.properties[t].properties,"default"),e},{}),Ssa={name:"Basics.Name",saveViewerState:"Basics.SaveViewerState",enableShareDashboard:"Basics.EnableShareDashboard",unsavedViewerPrompt:"Basics.UnsavedViewerPrompt",relativeHeight:"Basics.FillHeight",floatable:"Basics.Floatable",colCount:"Basics.ColCount",rowHeight:"Basics.RowHeight",rowCount:"Basics.RowCount",dashboardTheme:"Style.DashboardTheme",themeSwitchable:"Style.ThemeSwitchable",widgetsSpacing:"Style.WidgetsSpacing",borderShadow:"Style.WidgetShadow",borderBackground:"Style.BackgroundColor",transparentBackground:"Style.TransparentBackground",borderWidth:"Style.BorderSize",borderColor:"Style.BorderColor",borderRounding:"Style.BorderRounding",borderSpacing:"Style.BorderSpacing",worksheetPadding:"Style.WorksheetPadding",showLoadingIndicators:"Style.ShowDataLoadingIndicators",advancedCss:"Style.AdvancedCss",cssClasses:"Style.cssClasses"},{createConfigFromDashboardModel:function(i){var o=$.extend(!0,{},Qsa);return i&&_.each(Ssa,function(e,t){var n=i.get(t);_.includes(["borderBackground","borderColor"],t)&&_.isString(n)&&n.indexOf("#")<0&&(n="#"+n),_.set(o,e,n)}),o},createModelConfig:function(n){return _.mapValues(Ssa,function(e,t){e=_.get(n,e);return e=_.includes(["borderBackground","borderColor"],t)&&_.isString(e)?e.replace("#",""):e})},SCHEMA:Rsa}),Qsa,Rsa,Ssa,CleanUpDialog=(jta=Backbone.View,__extends(kta,jta),kta.prototype.getItemConfig=function(e,t,n,i,o,a){return{id:e,text:t,a_attr:{title:n},type:i,children:o,state:a}},kta.prototype.getModelFromPath=function(e,t){var n,i=t.indexOf("/");return 0<t.length?-1!==i?(n=e.get(t.substring(0,i)),this.getModelFromPath(n,t.substring(i+1))):e.get(t):e},kta.prototype.getNodeMetaFromId=function(e){e=e.split(":");return{type:e[0],name:e[1]}},kta.prototype.getTreeReference=function(){return this.$tree.jstree(!0)},kta.prototype.initializeTree=function(e){var i=this;this.$tree.jstree({core:{data:e,multiple:!0,check_callback:!0},checkbox:{whole_node:!1,tie_selection:!1},types:{datasource:{icon:"fa fa-database"},folder:{icon:"fa fa-folder"},viewstate:{icon:"fa fa-eye"}},plugins:["types","checkbox"]}),this.$tree.on("dblclick.jstree",function(e){var t;e.target.className.includes("jstree-checkbox")||(e=i.getTreeReference().get_selected()[0])&&e.length&&(t=(e=i.getNodeMetaFromId(e)).type,e=e.name,"ds"===t?i.documentGraphVisual.onDataSourceSelect(e):"vs"===t&&i.documentGraphVisual.onViewStateSelect(e))}),this.$tree.on("uncheck_node.jstree check_node.jstree",function(e){var t=i.getTreeReference().get_checked(!1);i.$delete.button(t.length?"enable":"disable")}),this.$tree.on("delete_node.jstree",function(e,t){var n=t.instance._model.data[t.node.id].text.split("/"),t=i.getNodeMetaFromId(t.node.id).type,t=i.getModelFromPath("ds"===t?i.dataModel:i.viewModel,_.initial(n));t.unset(_.last(n)),t.trigger("materialChange")})},kta.prototype.onDelete=function(){var t=this.getTreeReference(),e=t.get_checked(!1);e.length&&t.delete_node(_.without(e,"datasources","viewstates")),_.each(t.get_json(),function(e){e.children.length||t.delete_node(e.id)}),this.$delete.button("disable"),this.documentGraphVisual.deleteNodes(e)},kta),jta;function kta(e){var i=jta.call(this)||this;return i.$el.html(T.CleanUpDialog({})),i.$tree=i.$el.find(".tree"),i.documentGraphVisual=e.documentGraphVisual,i.dataModel=i.documentGraphVisual.documentGraph.dataSources,i.viewModel=i.documentGraphVisual.documentGraph.viewState,i.$el.dialog({appendTo:e.dialogContainer,dialogClass:"clean-up-dialog",height:600,width:400,modal:!0,autoOpen:!0,title:"Clean Up Isolated Objects",buttons:[{text:t("Delete Selected"),click:function(){return i.onDelete()},class:"delete",disabled:!0,icons:{primary:"fa fa-trash"}},{text:t("Close"),click:function(){i.$el.dialog("close")},icons:{primary:"fa fa-times"}}],open:function(){$('<i class="fa fa-magic"></i>').insertBefore(i.$el.parent().find(".ui-dialog-title"));var e=i.documentGraphVisual.documentGraph.getIsolatedDataSources(),t=i.documentGraphVisual.documentGraph.getIsolatedViewStates(),n=[i.getItemConfig("datasources","Data Sources","","folder",[],{opened:!0,hidden:_.isEmpty(e)}),i.getItemConfig("viewstates","View States","","folder",[],{opened:!0,hidden:_.isEmpty(t)})];_.each(e,function(e){n[0].children.push(i.getItemConfig("ds:"+e.path,e.path,"Double-click to inspect","datasource"))}),_.each(t,function(e){n[1].children.push(i.getItemConfig("vs:"+e.path,e.path,"Double-click to inspect","viewstate"))}),i.$delete=i.$el.closest(".ui-dialog").find(".delete"),require(["jstree"],i.initializeTree.bind(i,n))},close:function(){i.documentGraphVisual.refreshCleanUpButton()}}),i}var DocumentGraphVisual=(Xta.prototype.displayGraph=function(l){var r=this;require(["vis"],function(e){function n(){r.hierarchical?a.layout.hierarchical={enabled:!0,nodeSpacing:400,treeSpacing:200,blockShifting:!0,edgeMinimization:!0,parentCentralization:!0,levelSeparation:150,direction:"UD",sortMethod:"directed"}:(a.layout.hierarchical=!1,a.physics=!0,delete a.edges),s.show(),r.network=new e.Network(r.$overlay[0],r.data,a),r.network.on("doubleClick",function(e){var t;e.nodes[0]&&(t=e.nodes[0].split(":")[0],e=e.nodes[0].split(":")[1],_.includes(["ds","dsa","vds"],t)?r.onDataSourceSelect(e):_.includes(["dsm","vdsm","vdsa"],t)?r.onDataSourceSelect(e,null,1):"vs"===t&&r.onViewStateSelect(e))}),r.network.on("afterDrawing",function(){s.hide(),r.drawGraph(t)})}var t=r.getTheme(),i="kx-light"===t?"#606060":"white",o=(r.nodesView=new e.DataView(new e.DataSet(_.map(r.nodes,function(e){return e=e,_.extend({group:r.determineDataSourceType(e.model),borderWidthSelected:1,color:{border:"#999",highlight:{background:"#FFFF7A",border:"#1795D3"}},font:r.getFontSettings(),labelHighlightBold:!1,shape:"box",shapeProperties:{borderRadius:3}},e)})),{filter:function(e){return!r.searchStr||e.searched}}),r.data={nodes:r.nodesView,edges:new e.DataSet(_.reduce(r.edges,function(e,t,n){return e.concat(_.map(t,function(e){return{id:n+"->"+e,labelHighlightBold:!1,width:1,selectionWidth:function(e){return e},shadow:!1,from:n,to:e,arrows:{to:!0}}}))},[]))},r.data.nodes.getDataSet()),a=(_.each(r.data.nodes.getIds(),function(e){var t=r.data.nodes.get(e),n=t.model.attributes?t.model.attributes._subscriptionType:"";r.nodeSettings.push({id:e,counter:"streaming"===n?t.model.getExecutionRate().toFixed():1,metrics:t.model.performance?r.getPerformanceSummary(t):"",color:"#2bac76",strokeStyle:"#2bac76"}),t.model.agent&&t.model.agent.subscriberCount()&&o.update({id:e,title:r.getNodeDescription(t)})}),{groups:{vs:r.getIconSettings("",i),ds:r.getIconSettings("",i),dsa:r.getIconSettings("",i),dsm:r.getIconSettings("","#48c2fa"),vds:r.getIconSettings("",i),vdsa:r.getIconSettings("",i),vdsm:r.getIconSettings("","#48c2fa")},layout:{improvedLayout:!0},interaction:{dragNodes:!0,selectConnectedEdges:!1},physics:!0}),s=(a.groups=_.extend(a.groups,_.reduce(r.componentDefs,function(e,t,n){return t.get("listViewThumb").includes("svg")?e[t.get("appKey")]={shape:"image",size:25,image:"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(t.get("listViewThumb").replace("<svg",function(e,t,n){return n.includes("xmlns")?"<svg":"<svg xmlns='http://www.w3.org/2000/svg'"}).replace(/#ffffff/gi,i))}:e[t.get("appKey")]=r.getIconSettings(t.get("unicodeThumb")||"",i),e},{})),r.$graph=$('<div class="document-graph" />'),r.$graph.addClass(t),r.$graph.html(T.DocumentGraph({hierarchical:r.hierarchical})),r.$cleanUp=r.$graph.find(".clean-up"),r.$cleanUp.button({icons:{primary:"fa fa-magic"},label:"Clean Up"}),r.$cleanUp.on("click",function(){return r.onCleanUpClick(r)}),r.refreshCleanUpButton(),r.$search=r.$graph.find(".searchInput"),r.$search.on("keyup",function(e){r.searchStr=e.target.value.toLowerCase(),r.$clearSearch.css("visibility",""!==r.searchStr?"visible":"hidden"),r.debouncedSearch(r.searchStr)}),r.$clearSearch=r.$graph.find(".clearSearch"),r.$clearSearch.on("click",function(){r.$search.val("").trigger("keyup")}),r.$contentPanel=$(l),r.$contentPanel.append(r.$graph),r.$contentPanel.removeClass(r.getDocumentTheme()),r.$close=r.$graph.find(".close"),r.$options=r.$graph.find(".options"),r.$overlay=r.$graph.find(".overlay"),r.$graph.find(".loading"));r.$close.click(r.remove.bind(r)),r.$options.on("change",function(e){var t=r.$options.find("input[name='hierarchical']:checked").val();r.hierarchical="hierarchical"===t,r.network.destroy(),n()}),n()}.bind(this))},Xta.prototype.deleteNodes=function(e){this.nodes=_.omit(this.nodes,e),this.nodesView.getDataSet().remove(e)},Xta.prototype.remove=function(){this.$close&&this.$close.off(),this.$options&&this.$options.off(),this.$graph&&this.$graph.remove(),this.network&&this.network.destroy(),this.documentGraph.unsubscribeAll(),_.isFunction(this.onClose)&&this.onClose(),this.$contentPanel.addClass(this.getDocumentTheme())},Xta.prototype.determineDataSourceType=function(e){if(e.get("_viewType"))return"vs";if(e instanceof QuickBase.Component)return e.get("key");return"virtual"===e.get("_dataType")?e.isMapping()?"vdsm":e.agent.subscriberCount()?"vdsa":"vds":e.isMapping()?"dsm":e.agent.subscriberCount()?"dsa":"ds"},Xta.prototype.drawGraph=function(b){var y=this;_.each(this.nodesView.getIds(),function(e){var t=y.nodesView.get(e),n=t.model,i=n.path,o=y.$graph.find("canvas")[0].getContext("2d"),a=(o.font="12px Arial",y.network.getPositions([e])),s="kx-light"===b?"white":"black";if(a[e]&&!_.isEmpty(y.nodeSettings)){var l=_.find(y.nodeSettings,{id:e}),r=l.metrics,c=-1!==e.indexOf("vds")||-1!==e.indexOf("vs")?10:13,d=-1!==e.indexOf("vds")?13:-1!==e.indexOf("vs")?5:10,u=n.attributes?n.attributes._subscriptionType:"",p="streaming"===u||l.counter<100?l.counter:"99+";if(o.lineWidth=3,_.includes(["ds","dsa","vds","dsm","vdsm","vdsa"],t.group)&&(o.beginPath(),o.arc(a[e].x+c,a[e].y-d,5,0,2*Math.PI),n.agent&&n.agent.subscriberCount()||i in y.activeViewStateToSubscriptions?(o.fillStyle=l.color,o.strokeStyle=l.strokeStyle):(o.fillStyle="kx-light"===b?"white":"#282828",o.strokeStyle="#999999"),o.fill(),o.stroke()),n.agent&&n.agent.subscriberCount()||i in y.activeViewStateToSubscriptions){t=a[e].x+c-6,d=a[e].y+6,l="streaming"===u?o.measureText(p+"pm").width:Math.max(12,o.measureText(p).width+4);if(o.beginPath(),o.fillStyle="#c9675b",o.save(),o.translate(t,d),o.moveTo(l/2,0),o.arcTo(l,0,l,12,Math.min(6,5)),o.arcTo(l,12,0,12,Math.min(l/2,5)),o.arcTo(0,12,0,0,Math.min(6,5)),o.arcTo(0,0,5,0,Math.min(l/2,5)),o.lineTo(l/2,0),o.restore(),o.fill(),o.fillStyle="white",o.textAlign="left","streaming"===u&&(o.font="7px Arial",o.fillText(" pm",t+o.measureText(p).width+8,d+7.7)),o.font="10px Arial",o.fillText(p,3+t,d+7),n.performance&&!isNaN(r.totalTime)){o.fillStyle=s;for(var h=a[e].x-20,m=a[e].y+35,g=["#e37466","#7bb6be","#fcba02"],f=[100*r.subscriptionPercent,100*r.executionPercent,100*r.dataModelPercent],v=0;v<g.length;v++)o.beginPath(),o.fillStyle=g[v],o.rect(h,m,f[v]/2.5,5),o.closePath(),o.fill(),h+=f[v]/2.5}}}})},Xta.prototype.getFontSettings=function(e){return{color:e?"#00AEFF":"kx-light"===this.getTheme()?"black":"white",face:"FontAwesome, Arial",multi:"markdown",size:12}},Xta.prototype.getIconSettings=function(e,t){return{shape:"icon",icon:{face:"FontAwesome",code:e,size:30,color:t}}},Xta.prototype.getNodeDescription=function(e){var t,n,i,o=$('<div class="document-graph" />'),a=void 0;if(e.model instanceof QuickBase.DocumentDataModel&&e.model.agent.subscriberCount())return(i=e.model.agent.getSubscribers().filter(function(e){return!_.includes(e.substring(0,3),"ds")})).length&&(a=i.length+" subscriber",1<i.length&&(a+="s")),_.isEmpty(this.nodeSettings)||(t=(n=_.find(this.nodeSettings,{id:e.id})).metrics,n="streaming"===(e=e.model.attributes?e.model.attributes._subscriptionType:"")?"Execution rate per minute: "+n.counter:"Total executions: "+n.counter,e=!isNaN(t.totalTime)&&"streaming"!==e,o.html(T.DocumentGraphTooltip({bool:e,executions:n,label:a,subscribers:i,totalTime:t.totalTime.toFixed(0),subscriptionPercent:100*t.subscriptionPercent,executionPercent:100*t.executionPercent,dataModelPercent:100*t.dataModelPercent,subscriptionTime:t.subscriptionTime.toFixed(0),executionTime:t.executionTime.toFixed(0),dataModelTime:t.dataModelTime.toFixed(0)}))),o.html()},Xta.prototype.getPerformanceSummary=function(e){var e=e.model.performance.perf,t=e.paramChange||e.apply,n=(e.serverStart<t&&(t=e.apply),e.onAgentNotify-t),t=e.serverStart?e.serverStart-t:0,i=e.serverStart&&e.serverEnd?e.serverEnd-e.serverStart:n,e=e.serverEnd?e.onAgentNotify-e.serverEnd:0;return{totalTime:n,subscriptionTime:t,executionTime:i,dataModelTime:e,subscriptionPercent:t/n,executionPercent:i/n,dataModelPercent:e/n}},Xta.prototype.getTheme=function(){for(var e="dashboard-theme=",t=decodeURIComponent(document.cookie).split(";"),n=0;n<t.length;n++){for(var i=t[n];" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(e))return i.substring(e.length,i.length)}return""},Xta.prototype.getDocumentTheme=function(){return"kx-"+("Light"===this.dashboardTheme?"light":"darkroom")},Xta.prototype.onNodeUpdate=function(n){var i=this;return function(){var e,t;_.isEmpty(i.nodeSettings)||(e=_.find(i.nodeSettings,{id:n}),"streaming"===((t=i.data.nodes._data._data[n]).model.attributes?t.model.attributes._subscriptionType:"")?e.counter=t.model.getExecutionRate().toFixed():e.counter++,e.color="kx-light"===i.getTheme()?"white":"#282828",e.strokeStyle="#7fb4f5",setTimeout(function(){e.color="#2bac76",e.strokeStyle="#2bac76",t.model.agent&&t.model.agent.subscriberCount()&&i.nodesView.getDataSet().update({id:n,title:i.getNodeDescription(t)})},300),i.nodesView.getDataSet().update({id:n}))}},Xta.prototype.onSearch=function(){var t=this,n=_.filter(_.keys(this.nodes),function(e){return e.toLowerCase().includes(t.searchStr)}),i=(this.documentGraph.onSearch(n),this.nodesView.getDataSet());_.each(_.keys(this.nodes),function(e){i.update({id:e,searched:t.nodes[e].searched,font:t.getFontSettings(t.searchStr&&n.includes(e))})}),this.nodesView.refresh()},Xta.prototype.refreshCleanUpButton=function(){_.isEmpty(this.documentGraph.getIsolatedDataSources())&&_.isEmpty(this.documentGraph.getIsolatedViewStates())&&this.$cleanUp.button("disable")},Xta);function Xta(e,t,n,i,o,a,s,l,r,c){this.nodes={},this.edges={},this.data={},this.nodeSettings=[],this.activeViewStateToSubscriptions={},this.searchStr="",this.onCleanUpClick=r,this.onViewStateSelect=a,this.onDataSourceSelect=s,this.onClose=c,this.componentDefs=i,this.dashboardTheme=o,this.documentGraph=new QuickBase.DocumentGraph(e,t,n,l,this.onNodeUpdate.bind(this)),this.nodes=this.documentGraph.nodes,this.edges=this.documentGraph.edges,this.activeViewStateToSubscriptions=this.documentGraph.activeViewStateToSubscriptions,this.debouncedSearch=_.debounce(this.onSearch.bind(this),300)}var PropertiesPanelDocument=Backbone.View.extend({$documentProperties:null,$propertyEditor:null,$connectionsBtn:null,$documentGraphBtn:null,className:"document-properties",initialize:function(e){this.api=e.api,this.appModel=e.appModel,this.dialogContainer=e.dialogContainer,this.viewModel=e.viewModel,(e=this.viewModel.get("selectedDocumentId"))&&(this.appModel.get("documents").get(e)?this.onDocumentChanged():this.listenToOnce(this.appModel.get("documents"),"reset",this.onDocumentChanged)),this.listenTo(this.viewModel,"change:selectedDocumentId",this.onDocumentChanged),this.initEvents()},initEvents:function(){var n=this;this.$el.on("click",'[name="root[Basics][Link]"]',function(){this.select()}),this.$el.on("dblclick",'[name="root[Basics][Link]"]',function(){e=location.href,t=e.indexOf("edit");var e,t=(e=e.substr(0,t)+"#"+n.model.id).match(/^((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w]+@)[A-Za-z0-9\.\-]+)((?:\/[\+~%\/\.\w\-_]*)?\??(?:[\-\+=&;%@\.\w_]*)#?(?:[\.\!\/\\\w]*))?)$/)?e:"";window.open(t,"_blank")})},initializeEvents:function(){var e=this;this.listenTo(this.model,"change",function(){this.editor&&this.editor.setValue(_.extend(this.editor.getValue(),DashbordDefinition.createConfigFromDashboardModel(e.model)))}),this.listenTo(this.model,"detail-downloaded",this.onDocumentChanged),this.listenTo(this.model.get("popups"),"add remove change",this.onPopupsChange),this.listenTo(this.model.get("popups"),"remove",this.onPopupRemoved),this.listenTo(this.model.get("Shortcuts"),"add remove change",this.onShortcutsChange)},applyDashboardTheme:function(e){this.model.set("dashboardTheme",e),this.viewModel.set("DashboardTheme",e)},onDocumentChanged:function(){var e;this.remove(),(e=this.viewModel.get("selectedDocumentId"))&&(this.model=this.appModel.get("documents").get(e),this.model&&(this.render(),this.initializeEvents(),this.applyDashboardTheme(this.model.get("dashboardTheme"))))},onPopupsChange:function(){this.editor&&this.editor.setValueByPath(this.model.get("popups").toJSON(),"root.Popups")},onPopupRemoved:function(){this.popupView&&!_.includes(this.model.get("popups").pluck("id"),this.popupView.model.get("id"))&&(this.popupView.remove(),this.popupView=null)},onShortcutsChange:function(){this.editor&&this.editor.setValueByPath(this.model.get("Shortcuts").toJSON(),"root.Shortcuts")},remove:function(){this.model&&this.stopListening(this.model),this.documentGraph&&this.documentGraph.remove(),this.editor&&this.editor.remove()},render:function(){var e=this;e.$el.html(T.PropertiesPanelDocument()),e.$documentProperties=e.$el.find(".document-properties"),e.$propertyEditor=e.$el.find(".property-editor"),e.$connectionsBtn=e.$el.find(".connectionMgmtBtn"),e.$documentGraphBtn=e.$el.find(".documentGraphBtn"),e.model.get("dashboardTheme")&&_.delay(function(){e.applyDashboardTheme(e.model.get("dashboardTheme"))},1e3),e.$el.find(".connectionMgmtBtn").button({icons:{primary:"fa fa-cogs"}}).click($.proxy(e.openConnectionsDialog,e)),e.$el.find(".documentGraphBtn").button({icons:{primary:"fa fa-sitemap"}}).click($.proxy(e.openDocumentGraph,e)),e.renderPropertyEditor()},renderPropertyEditor:function(){var e,a=this,t=a.model.get("popups").toJSON(),n=a.model.get("shortcuts")||[],i=this.model.get("screens"),s=QuickBase.NotificationManager;s.setDocumentDataModel(a.appModel.get("documents").get(a.viewModel.get("selectedDocumentId")).get("data")),a.stopListening(a.model,"basePanelLayoutChanged",a.onBasePanelLayoutChanged),a.editor&&a.editor.remove(),i&&i.length&&(i=s.CONFIG.upgradeConfig(a.model.get("notifications")),e=$.extend(!0,{},DashbordDefinition.SCHEMA,s.CONFIG.SCHEMA,{properties:_.omit({Permissions:{type:"backbone",options:{collapsed:!0,parameters:["model"],view:DashboardPermissions}},Screens:{type:"backbone",options:{collapsed:!0,parameters:["appModel","model","viewModel"],view:ScreenList}}},a.appModel.get("isLite")?["Permissions"]:[])}),i=$.extend(!0,{},i,DashbordDefinition.createConfigFromDashboardModel(a.model)),_.set(i,"Popups",_.map(t,function(e){return e.Actions=e.Actions||[],e.dialogTop=e.dialogTop||"",e.dialogLeft=e.dialogLeft||"",_.omit(e,"widgets")})),_.set(i,"Shortcuts",n),_.set(i,"Permissions",{}),_.set(i,"Screens",[]),_.set(i,"Basics.Link","../"+(a.appModel.get("saml")?"?auth=saml#":"#")+a.model.id),a.editor=new PropertyEditor(e,i,null,a.$propertyEditor[0],a.api),a.editor.subscribe(function(e){var n,t,i,o;e===PropertyEditor.ChangeType.Value&&(e=a.editor.getValue(),i=t=o=void 0,e=$.extend(!0,{},e),o=_.pick(e,"Notifications"),s.setOptions(o),a.model.set("notifications",o),n=_.pick(e,"Popups"),a.model.get("popups").length===n.Popups.length&&!a.model.get("popups").some(function(e,t){return e.changedAttributes(n.Popups[t])})||a.model.get("popups").commandSet(n.Popups),a.model.set("shortcuts",e.Shortcuts),i=_.omit(e,"Notifications","Popups","Shortcuts"),t=DashbordDefinition.createModelConfig(i),a.model.get("dashboardTheme")!==t.dashboardTheme&&a.applyDashboardTheme(t.dashboardTheme),a.model.changedAttributes(t)&&a.model.commandSet(t),a.editor.reloadHeaderTemplates())}),a.listenTo(a.model,"basePanelLayoutChanged",a.onBasePanelLayoutChanged))},openConnectionsDialog:function(){new ConnectionManagement({container:this.dialogContainer,docViewModel:this.model.get("viewState"),appModel:this.appModel})},openDocumentGraph:function(){var e=this.viewModel.get("selectedDocumentId"),e=this.appModel.get("documents").get(e);try{this.documentGraph||(this.documentGraph=new DocumentGraphVisual(e.get("viewState"),e.get("data"),e.getComponents(),this.appModel.get("components").models,e.get("dashboardTheme"),this.api.showViewStateDialog.bind(this.api),this.api.showDataDialog.bind(this.api),e.get("data").getByPath.bind(e.get("data")),this.api.showCleanUpDialog.bind(this.api),function(){this.documentGraph=null}.bind(this)),this.documentGraph.displayGraph("body > div > .content-panel"))}catch(e){}},showPopupEditor:function(e){e=this.model.get("popups").get(e);this.popupView&&this.popupView.remove(),this.popupView=new QuickBase.PopupView({viewModel:this.viewModel,appModel:this.appModel,model:e,isEditing:!0}),this.popupView.toggleDialog(!0)},onBasePanelLayoutChanged:function(){var e;this.editor&&(e=this.editor.getValue(),_.set(e,"Basics.ColCount",this.model.get("colCount")),_.set(e,"Basics.RowCount",this.model.get("rowCount")),_.set(e,"Basics.RowHeight",this.model.get("rowHeight")),_.set(e,"Basics.FillHeight",this.model.get("relativeHeight")),_.set(e,"Basics.Floatable",this.model.get("floatable")),this.editor.setValue(e))}}),PropertiesPanel=Backbone.View.extend({KEYCODE_C:67,KEYCODE_V:86,$pinButton:null,$documentPanel:null,$propertiesPanel:null,$expandBtn:null,documentProperties:null,prevComponentModel:null,copiedJson:{},clipboardCopied:{},initialize:function(e){this.options=e,this.appModel=e.appModel,this.dialogContainer=e.dialogContainer,this.viewModel=e.viewModel,this.$el.html(T.PropertiesPanel()),this.$panelHeader=this.$el.find(".panel-header"),this.$properties=this.$el.find(".panel-content"),this.$properties.hide(),this.$propertiesPanel=this.$el,this.$documentPanel=this.$el.find(".panel-document"),this.$pinButton=this.$(".pin-button"),this.$expandBtn=this.$(".expand-button"),this.$lblWidgetName=this.$(".lblWidgetName"),this.$dashboardHelp=this.$(".dashboardHelp"),this.$searchInput=this.$(".searchInput"),this.$searchIcon=this.$(".searchIcon"),this.api=new PropertiesPanelApi({appModel:this.appModel,dialogContainer:this.dialogContainer,viewModel:this.viewModel}),this.api.setDocument(this.appModel.get("documents").get(this.viewModel.get("selectedDocumentId"))),this.documentProperties=new PropertiesPanelDocument({el:this.$documentPanel,api:this.api,appModel:this.appModel,dialogContainer:this.dialogContainer,viewModel:this.viewModel}),this.copiedJson=null,this.render(),this.debouncedSubComponentSelected=_.debounce(this.onSubComponentSelected,100),this.initializeEvents(),this.onPropertiesPinnedChanged()},initializeEvents:function(){var t=this;this.listenTo(this.viewModel,"change:selectedDocumentId",this.onViewModelSelectedDocumentChanged),this.listenTo(this.viewModel,"change:selectedWidget",this.onViewModelSelectedWidgetChanged),this.listenTo(this.viewModel,"change:selectedWidgetId",this.onViewModelSelectedWidgetIdChanged),this.listenTo(this.viewModel,"change:selectedSubComponent",this.debouncedSubComponentSelected),this.listenTo(this.appModel,"change:propertiesPinned",this.onPropertiesPinnedChanged),this.listenTo(this.api,"showPopupEditor",function(e){this.documentProperties.showPopupEditor(e)}),this.listenTo(t.api,"startInspecting",function(){this.trigger("startInspecting")}),this.listenTo(t.api,"stopInspecting",function(){this.trigger("stopInspecting")}),this.$pinButton.on("click",function(){t.appModel.set("propertiesPinned",!t.appModel.get("propertiesPinned"))}),this.$expandBtn.on("click",function(){t.appModel.set("propertiesPinned",!t.appModel.get("propertiesPinned"))}),this.$searchInput.on("keyup",function(e){27===e.keyCode&&(e.preventDefault(),t.$searchInput.val(""),t.editor&&t.editor.filter(null))}),this.$searchInput.on("input",function(){t.editor&&t.editor.filter(this.value)}),this.$searchInput.on("blur",function(){this.value||t.togglePropertySearch()}),this.$el.on("paste",$.proxy(this.onPaste,this)),$(window).on("keydown",$.proxy(this.onKeyDown,this))},getArgs:function(e,t,n){var t=_.clone(t.attributes),i="",n=n?e.get("appArgs").json:t;return t.Basics&&t.Basics.Data&&(i=t.Basics.Data),e.get("appArgs")[i+"Args"]&&(n=e.get("appArgs")[i+"Args"]),_.omit(n,"version")},getSchema:function(e,t){return e.get("appArgs").schema},handleLinkButton:function(t,i){var o,n=[],e=this.appModel.get("documents").get(this.viewModel.get("selectedDocumentId"));this.appModel.get("documents").each(function(e){n.push({title:e.get("name"),value:e.id})}),_.isEqual([],n)?t.possible_dashboards=[{title:"none",value:"none"}]:(n.unshift({title:"none",value:"none"}),t.possible_dashboards=n),t.possible_viewstates=[],_.each(e.get("viewState").getViewStateList(),function(e){t.possible_viewstates.push(e.path)}),t.possible_viewstates.sort(),o=i.get("ViewState"),this.listenTo(i,"change:ViewState",function(e,t,n){o.target_screen!==t.target_screen&&"none"!==t.target_screen&&(i.get("ViewState").target_dashboard="none"),o=t})},onPropertiesPinnedChanged:function(){this.appModel.get("propertiesPinned")?(this.$pinButton.find("i").removeClass("fa-caret-left").addClass("fa-caret-right"),this.$propertiesPanel.removeClass("unpinned")):(this.$pinButton.find("i").removeClass("fa-caret-right").addClass("fa-caret-left"),this.$propertiesPanel.addClass("unpinned"))},onViewModelSelectedDocumentChanged:function(){var e=this,t=e.appModel.get("documents").get(e.viewModel.get("selectedDocumentId"));t&&this.listenToOnce(t,"view-state-init",function(){e.api.setDocument(t)})},onViewModelSelectedWidgetChanged:function(e,t,n){var i=this.viewModel.get("selectedWidget");i?(this.viewModel.set("selectedWidgetId",i.id,{silent:!0}),this.showWidgetProperties(i,n.reset),this.$el.removeClass("doc")):(this.viewModel.set("selectedWidgetId",null,{silent:!0}),this.showWidgetProperties(null,n.reset),this.$el.addClass("doc"))},reloadHeaderTemplates:function(){this.editor.reloadHeaderTemplates()},showWidgetProperties:function(e,n){var i,o,a,s=this;if(this.prevComponentModel&&(this.stopListening(this.prevComponentModel),this.prevComponentModel=null),this.dontRemoveSubComponent)this.dontRemoveSubComponent=!1;else if(this.viewModel.get("selectedSubComponent"))return void this.viewModel.set({selectedSubComponent:null});if(s.editor&&(s.$el.find(".btnBulkEditor").off(),s.$el.find(".btnReset").off(),s.editor.remove(),s.editor=null,s.$panelHeader.removeClass("search-open")),e&&(o=e.get("component")),!(o=(a=this.viewModel.get("selectedSubComponent"))?a:o))return this.$searchIcon.off("click"),this.$lblWidgetName.text(t("dashboard")),this.$documentPanel.show(),this.$properties.hide(),void(this.componentItem=null);this.$documentPanel.hide(),this.$properties.show(),o&&(s.componentModel=a=o.get("options"),s.api.setWidget(e),s.componentItem=o,e=(e=s.appModel.get("components").get(o.get("definitionId")))||s.appModel.get("components").find({appKey:o.get("key")}),s.componentOptions=o.get("options"),window.ops=s.componentOptions,this.$lblWidgetName.text(e.get("componentName")),this.$dashboardHelp.off("click"),this.$dashboardHelp.click($.proxy(this.onDashboardHelp,this)),this.$searchIcon.off("click"),this.$searchIcon.click($.proxy(this.togglePropertySearch,this)),e.get("appArgs")&&(n=s.getArgs(e,s.componentOptions,n),i=s.getSchema(e,n.Basics?n.Basics.Data:null),!a.get("Basics")||"GeoMap"!==a.get("Basics").ComponentName&&"ContextMenu"!==a.get("Basics").ComponentName||s.handleLinkButton(n,a),s.stopListening(a,"change",s.onComponentModelChanged),s.listenTo(a,"change",s.onComponentModelChanged),s.stopListening(a,"quickStart",s.onComponentQuickStart),s.listenTo(a,"quickStart",s.onComponentQuickStart),s.stopListening(a,"transform",s.quickStartTransform),s.listenTo(a,"transform",s.quickStartTransform),s.prevComponentDefinition=e,s.prevComponentModel=a,s.editor=new PropertyEditor(i,n,s.componentOptions.expanded,s.$properties[0],s.api,o.get("hasOnSettingsChange")),s.editor.subscribe(this.onEditorChange.bind(this))))},onComponentQuickStart:function(e){this.editor.focusItemByPath("root."+e)},quickStartTransform:function(e,t){this.editor.setValueByPath(e,"root."+t)},onComponentModelChanged:function(e,t){e=_.clone(e.attributes);this.editor&&this.editor.setValue(_.omit(e,"version"))},onDashboardHelp:function(){var e,t;this.componentItem&&(e=/\s/g,t={radarchartbeta:"radar",layoutpanel:"layout",bipartitechart:"bipartite",reportmanagement:"reportmanager"}[e=this.appModel.get("components").get(this.componentItem.get("definitionId")).get("componentName").toLowerCase().replace(e,"")]),new QuickBase.HelpDialog({appModel:this.appModel,container:this.dialogContainer,viewMode:this.viewModel,tag:t||e})},togglePropertySearch:function(){this.$panelHeader.toggleClass("search-open"),this.$panelHeader.hasClass("search-open")?(this.editor&&this.editor.filter(this.$searchInput[0].value),_.defer(function(){this.$searchInput.focus()}.bind(this))):this.editor&&this.editor.filter("")},onEditorChange:function(e){e===PropertyEditor.ChangeType.Expanded?this.componentOptions.expanded=this.editor.getExpanded():(e=this.editor.getValue(),e=_.extend({},e),this.componentOptions.commandSet(this.componentOptions.changedAttributes(e)),this.reloadHeaderTemplates(),this.args=this.getArgs(this.prevComponentDefinition,this.componentOptions,!1))},createClipboardEvent:function(){try{var t=new ClipboardEvent("paste");navigator.clipboard.readText().then(function(e){this.clipboardCopied=e.toString(),this.$el[0].dispatchEvent(t)}.bind(this)).catch(function(e){QuickBase.Log.Info("Please enable Clipboard Access to copy and paste via Property Panel Icons")})}catch(e){this.showModal()}},showModal:function(){new QuickBase.ErrorDialog.ShowError("Pasting is unavailable via this action currently, but you can still use: CTRL-V for paste")},onKeyDown:function(e){if(112===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.onDashboardHelp()),this.editor&&this.editor.getFocusedPath()){var t,n=e.keyCode;if(e.ctrlKey||e.metaKey)switch(n){case this.KEYCODE_V:this.pastePath=this.editor.getFocusedPath(),this.clipboardCopied=null,e.originalEvent?(this.$el.attr("contenteditable",!0),this.$el.focus()):window.Promise?this.createClipboardEvent():this.showModal();break;case this.KEYCODE_C:this.copiedJson=this.editor.copy(),this.copiedJson&&(t=QuickBase.ComponentOptions.setDataProperties(this.getCopyJSON(this.copiedJson)),this.copy(JSON.stringify(t),!1))}}},getCopyJSON:function(e){var t,n,i={},o=this.appModel.get("documents").get(this.viewModel.get("selectedDocumentId"));return i._property=this.copiedJson,n=CopyPasteHelpers.getComponentViewStates(this.copiedJson),i._dataSources=_.extend(CopyPasteHelpers.getComponentDataSources(e,n,o.get("data")),CopyPasteHelpers.getMappingDataSources(n,o)),i._viewState={},_.each(n,function(e){(t=o.get("viewState").getByPath(e))&&(i._viewState[e]=t.toJSON(),"dict"===t.get("_type")&&(i._viewState[e]._default=_.mapValues(t.get("_default"),function(e){var t;return e instanceof Backbone.Model?(_.includes(n,e.path)||i._viewState[e.path]||(t=o.get("viewState").getByPath(e.path))&&(i._viewState[e.path]=t.toJSON()),"<%"+e.path+"%>"):e})))}),i},copy:function(e,t){var n,i;if(navigator.clipboard)navigator.clipboard.writeText(e).then(function(){$("window").focus()},function(e){$("window").focus()});else{(n=$(document.createElement("textarea"))).css({position:"absolute",width:0,height:0,top:0,left:0}),n[0].value=e,n.appendTo(this.$el),n[0].focus(),n[0].select();try{document.execCommand("SelectAll")&&(i=document.execCommand("copy",!1,null))}catch(e){console.log(e)}n.remove(),$("window").focus(),t&&t(i)}},onPaste:function(e){if(this.pastePath){var t,n,i,o,a=void 0,s=void 0;if(this.editor.canPaste(this.pastePath)){if(e.stopPropagation(),e.preventDefault(),this.$el.removeAttr("contenteditable"),a=e.originalEvent.clipboardData||window.clipboardData,!this.clipboardCopied&&!a)return void QuickBase.Log.Info("Please copy a property section prior to pasting");if(this.clipboardCopied)s=this.clipboardCopied;else if(!(s=a.getData("Text")))return;if(!s)return;e=this.appModel.get("documents").get(this.viewModel.get("selectedDocumentId"));try{(o=JSON.parse(s))._property&&(CopyPasteHelpers.mergeViewStates(o._viewState,e),n={},i={},_.each(o._dataSources,function(e,t){"virtual"===e._dataType?i[t]=e:n[t]=e}),CopyPasteHelpers.mergeDataSources(n,e),CopyPasteHelpers.mergeDataSources(i,e),(t=this.convertToModel(JSON.parse(s)))&&this.editor.pasteProperties(t._property,this.pastePath))}catch(e){console.log("cannot get pasted data",e)}}this.pastedEditor=null}},convertToModel:function(n){var i=this,o=i.appModel.get("documents").get(i.viewModel.get("selectedDocumentId"));return n instanceof Object&&_.each(n,function(e,t){e instanceof Object&&e._dashboardsType?"viewstate"===e._dashboardsType?n[t]=o.get("viewState").getByPath(e.value):"data"===e._dashboardsType&&(n[t]=o.get("data").getByPath(e.value)):i.convertToModel(e)}),n},onSubComponentSelected:function(){this.viewModel.get("selectedSubComponent")&&(this.dontRemoveSubComponent=!0),this.onViewModelSelectedWidgetChanged(null,null,{reset:!1})},remove:function(){this.$pinButton.off(),this.$expandBtn.off(),this.$searchInput.off(),this.$searchInput.off(),this.$el.off(),Backbone.View.prototype.remove.apply(this,arguments)}}),ComponentListView=Backbone.View.extend({tagName:"div",attributes:{draggable:!0},initialize:function(e){var n=this;n.options=e,n.$el.html(T.ComponentListView(n.model.toJSON())),n.el.setAttribute("title",t(n.model.get("componentName"))+" - "+t(n.model.get("componentDescription"))),e.dblclick&&n.$el.dblclick(function(){e.dblclick(n.model)}),n.proxiedOnDragEnd=$.proxy(this.onDragEnd,this),n.proxiedOnDragStart=$.proxy(this.onDragStart,this),n.initializeEvents()},initializeEvents:function(){this.el.addEventListener("dragend",this.proxiedOnDragEnd,!1),this.el.addEventListener("dragstart",this.proxiedOnDragStart,!1)},onDragEnd:function(e){this.options.onDragEnd&&this.options.onDragEnd()},onDragStart:function(e){var e=e.dataTransfer,t=this.model.id.toString();e.effectAllowed="copy",e.setData("text",t),this.options.onDragStart&&this.options.onDragStart(t)},remove:function(){this.el.removeEventListener("dragend",this.proxiedOnDragEnd),this.el.removeEventListener("dragstart",this.proxiedOnDragStart),Backbone.View.prototype.remove.call(this)}}),ComponentDialog=Backbone.View.extend({$img:null,$fileInput:null,$uploadBtn:null,appModel:null,className:"component-dialog",dataView:null,propertiesView:null,isModelChanged:!1,initialize:function(e){var n,i,o,a=this;this.appModel=e.appModel,this.updateFn=e.updateFn,i=[{text:t("Save"),click:$.proxy(a.onSaveButtonClick,a),icons:{primary:"fa fa-floppy-o"}},{text:t("Cancel"),click:$.proxy(a.onCancelButtonClick,a),icons:{primary:"fa fa-times"}}],o=(e.model?"Edit":"Add")+" Widget",e.model?(this.editModel=new Backbone.Model(e.model.attributes),i.splice(1,0,{text:t("Delete"),click:$.proxy(a.onDeleteButtonClick,a),icons:{primary:"fa fa-trash-o"}})):(n=QuickBase.Helpers.getGUID(),this.editModel=new Backbone.Model({id:n,componentName:t("my component"),componentDescription:t("A description of my component"),appKey:"",listViewThumb:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAyCAYAAACXpx/YAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QTMzQURFOTkxOEY2MTFFNUFDMEJBRDUyMDNDODMyQkMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QTMzQURFOUExOEY2MTFFNUFDMEJBRDUyMDNDODMyQkMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpBMzNBREU5NzE4RjYxMUU1QUMwQkFENTIwM0M4MzJCQyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBMzNBREU5ODE4RjYxMUU1QUMwQkFENTIwM0M4MzJCQyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pnt3JAMAABOnSURBVHja7FxpdBzVlb61dFV19d6tVrd2ybJWLxLeMGAgGAM2sTMD5kDOTAJkYRlmCXNmmJksJ2TCARKSyY+cnGGGGUMyYcZkbBaDccY2tsEsNtjyImwtXmTt6pa61Yt6qequrpp3qyVhvKnbBNkRfj7tLlVX1at637vf/e597xWlaRpMR6l7bLv+jdXNKTaDzWiA6kIR/EkK3BYBMurU90GOERZXWZ+dW2JawjI0p2S0TFxWkpKiRZ0i628bjA9GpUy/aKC6Nx8NddW5BX/fqOwXWEpJpDJQ4uBh48EAJNIq0FT2mlirwAAYmew2lhq3CHcv8YKqqrDp0AhUOgXgWBrG5AxQ5LwxKQNGloJURoUG8ixvd4zqJ1uMLJTaeTg+nICW3ghwDD3lMx388bLPtd1ZuEQFgRYMDEjhBNTOMsPNjW5QpgbZ7TDz91Ok3TSV/EUam6YE/NLPrXQb9YNSigq3zS+AaFKJEDCG/BH5+Ggsvf+YP/GyrKhHM6TyiZo0/V4omKmFvdQ3IKUz8MJ7fVBBrIQnVpImVkGdv1OkDSwTFnnWrmqnQzRp4ZPbaGl20WBzmgy2WW5jPU1Rawjg/0Ss/dHXDo08Jxg+sS6F1KnpPSZb8DITn1yY5QrAFyik4XVgkdYYAlahVdBBPhfKBFOlQtXS+m/a1AyBlpoh2+lM9mATzxgfuLHk6XZfbH1SUccYKlvJSESCuKQBTWcBZRnKZuToZpWcbDOyvWTfEGEFSSLUTn4bB526AnCuhSEOMZxIw8GeMPzF8iowEN+lnkMbEJdIk2MZuEijwtNSaSXhFTWCEaV3LoXsFGkha8kEOK+Va3hkRcUmr42vwXtYWO1IhuOp/nBc6RgISQf7Q1LLYEhuldOZbgQcz8Hj6MsUcPZyuRH0x51DMVj3bj84zTwB89MoojVaBZb/Sy/5MQcLPhdTGIj1/eeO409tb/UlRI7R6yi0m6Cq0KpvJwlgyxudf1XjEWtiREhhxzPxtNEqGGsqCqiaqyqta5ANYpIS90XktlMjiffJ37uMBmZfJKEMGVgVNO0KwBcsvlASghH5LMGFf3usvJOmKTFfcBnCCCJ50v/Y1vb4+n0jz3IcD3EVJpV078gYYDSRICpZyxS6sGpt3ORxv3qGrzcLrKlONCxuLLEsJtT96DWzHaOkc35wzBd/dSQiv0lcjB9pPENpVwA+IwyC2UQJN5XbzhI3SIOkYZ0sMUUtD4RJOAWxZEr+t7c7v/H2x0PrDZyR+FpKvwICnMmkdQA1vf4MtHQFt3x5YfE9U93n6fdHhJzzhnrX6hvqnKuDsbR/3Tu9jxI6f8lIWOIKwOcInY4RwXVwIAYEzEnPhvR5Y52zEKkVt3MpFKFlltZg/a62B366Y2R9uZgB3gC638UrZ5QUDATlye6CWuyN/b0b7lpS/FhDuWtuMpXJqR5kF2X8WI+N8xSYmCaOyrwk0HAF4LNBAQjGJDASuypzGCEzjqVEGtBr4SqByl3M8CQU2nmob8P2Vv9viy0ccMT25XHuRTDNWoLsS6Atj1cOhKaV5LNbWh995lvXb6UpmlHzcKro54lYTO9uG/ptQpJASdNXAD53QxFfTEIXhsQtiprNaCRTChSYudqcO4quujV48UPfs0fDNFh4DcY0A6F6Rbc4nkUBxYHhjBiaE3g42B3esadtcONNTeX35GrFEx1q/8nA3r5Ass3CsZdFJHVJM1kKMSNMIcaJuMFtZTxeRUsYIgDPKbaATRR0/yulVCi08ZU55x0o0OPpUUkdZlgGFCobyCjoy40sfKma+HmF0H6jC2LxJBTZ+Ulhh2CLHP0/clq9J1/2ae8L/85hYsn5bP5Sf6YALJOGtRnBUuQQbl1bZFlALM1gFZiuAgv3BgF5IJt6VMEXlcDMswQoPWQRPTa+OtfMEnYgTKA0ekyzomPyURQ82FEwgdVYYobqAhE6BseI0mVh+9FRuHVeoR5/I3tgjCxllACmPA3E0nNhaRRuJF5OtQ9EttmJZGd0iU6d1QEmbh81AEXNMICxoZLpDKrktd9eXvVUscNYi0l8ajzbtKDK8aPW7tB31+/tfwGfvjuYwHSj3iEKrXypTTQUqWo+CpqCRVX2tVsODb0h8gzYieV6zJzucSeyW2hlGPNaTUbYfSwII7EUUdYaNFfa3V8m5yDIuRQcWDjiGzt8uDd6gmXp86pvTJGSPqMPVCiZz9/Cp00FoEXKaQW+dk3pQ4+vbdxY7hJrdYqWsxSNDeky855bm4uev7bW9c/IbqFEGvpJXMwRoJwmrlbkWS4f0YNqe2WT9+7ZReZFfsIGmOhAP3lmH0FLMuh1GKDlVBi2HhmGYrtwD+7LPRsHcPDU6FtRKa3JpBOf/kkp2W8TR0OFywgVTh6SkgzHh6Mzx4Kt5OEaq+yLfnBH4y+RoKRzhDroM1E1P7B81g9jSSX2k80dP5tXZgWJdID6YksTNng+vR6tXeAY46/ubf7f773UetfJ4fiBIit3zmPT5Ni6IjPMKxLh+lrn6jULi+9KptS83E4sLr+9uMKqDy2eHkIhI+DHQjoQMreWofQQkJlJFO0xG+Chm2c9KXA0h1Z7XlAIfkTcwIM3V/9EU9Wj88rtW17b12+f7bV8VVXzrxcb3mM3Vv3sa81vv9Ey8C+HukZ/Q/Z1I2PgSBYCgEoZOxcBVFg+1/ONP11S9gxL04Z0Rs3ReikIjsmRQFRqNQusLhInG5jwcSSW1sHMaNM/SDFtANvM3PzmSucKKQerGB/RoR++tWZDYEz+/fdK59QX2oQ5spI/wticSI/Ef1u+edOsHw0vKPn7wVDio0BEai2wCl0lDmP8lqYi9yyPpabAwi9z24Q6dAO5gjvh6/2hZMdgKOnDzBk1XjHWW+Wxks00qHBpyrQBvKy24HaTwNAXst4zQSaWQJSzsJYaD3k+kwbQwzAdaLPLbF+ulcFytDS87jW1BcRPanreOXURnQgV9EAw3ioTJqD5rOrGfR4SKhi5S5vsmDaAr6l1zctXNeqC6g8sNM/MI2PJtdNdiCVODsdaZHK/FA4fEl9yc70HfGHpkk8YmDaAg/F0AVJZSoEZVZBd0Ic7RLbr6monEVgMfNwX0cXi5TB0OG0Ak1Ano2kw4woOaCRlRdl1xNfrCyeJErdiiDXJFPjQ2AEymgoqlR1MoWciwEpK7pmB+GZz3pqWPhFMxgdHk7DyqlIIxWSQCFU5zfzcMrdp1bJ6TxMOYPUH43s6ByPrY4lUcMYB/OZHp95c3lz+cL7WoV3mZo8ultCysGpOYWEwKvVjsoRnqab5la7H51c61wgcy542RffPhsPJx17cdfxvDveGNk3Hk00bW+xv796652j/+2Zh6kFwnIGB4QbOjcURpcu5YAfkDQz1lasrvt9Qal9UWmD+6b3La/curi28g6ZpFkMlpGj84JAnCc3K/3rNnJebK12rMxl15liwL5JM//x3795X7Lxta1mRszpF4uEz044IKsdSMByKD2zd2/bEyYHQ0fvXLH2l2GVxKxn1sgUZ7212ke3OcrflTj0VquLkvnMrcwzDSIdg/uGOec+Fx5Lzya7AjLBgVJcjodjJ1985fMPxHv+LaUWRyYMCWjR+G1gaguFY/6bdR57afaBzYUe3/98H4tR7g8F4C8tc/lNUs8kZWo+3p8qXo1WXu01F1zV47p0xFjxhoYTSBjtODX195/5jTzqtpls1iq4vLbAmDx/v35OU0zu7hkKjNzZVgkwZYXaxA6wiT/2xTD7PRy/gIzWUO1eSzV/MGIAnhBNHLDYSS3YMDEc6dhzogrU3zoGBQBS8TjOYBAPIKgtpioNTvghLDi+jYOYtLUkrGlQUmCpmlAV/SkgR8cQZWDAZOf0bKRwtPJxQoDuYAq/DiNTt8jjEkoyqzjiA0do5ljbMGBWdwyPr47cOVwEkiI8aiUo4KF9t5FjbZ2FoZAzMOVPjn8ulYGcORKXwjLXgM5MFCELniAKShtadwuwQlHtsc0wCe1G5Ykz2I0ukFRxwV1Lo9sjfgsAbJpWv+gfw7QgUDhem87weRn/D4fhxANfMBlhfOUA+cU3UR3sERtUzAgqJgeu8lusvSrETHx9Pyv4Tvb4X3z90cpuiUScbKgszu/Z3ehY3VjTVVXhvLy9yrTKLAne+cCZXcH3BSFefL7hjfk3Zn/OcQcw1nNMHKPoDW2FB+cwFGDM8JoGDAz0xoDkjAYYaBx3AyLNcdbH9aiXP9sew68OjPZt7h4KPaJraNzw6BrTBoE8X8o+OdbefGvowEBp7bue+9uaV1859uqbCuzKVyuQ9aIV0Tzpk5vnN++6TkvH3Nr/f/vsffPO2jSzD0FOpfuyAPf6ob097/yuPfGXBzPLBSJ04e9GAY6hhGXh7IRgEI+BiEsxgMeOr4otd5oYSl3l2PuPAOLHurQNd//fD59+6k7R9n8Cx4xRKZ1c5MFlhh590Wjn08lv7V7+68+B/GYX8l5hg3N7jjxw/MSx90B/OwM59na+++c6hv8Xbv5Cvx3thKA3WbWn57lut/TPHB6f1WYQUROIp2HMsAB+diEA8haAyMBqLfOrYuKRAc7X7ZrORpeNSbiaMDReMJELrXv/owXAslR4IxKCmxHHOqanoM5FK2/tCmW37Tz3YUFXUVF/pbZLzoGtkn0AkcdBtE1WKEmF4xAQ9Q4Ffnuzz26pKvT8GioaMvrBcm+zY2MFShEn2Hel5/GjX4K9N/OcuoqcP4OoSN+CC6329SeJfk0AzLNjE7Hg+dQaR4CzKq2s9a/KJjgSOgpff7XqpKyD3WWx2eK1lEBaOSlAokkY97ToMlQX3uH8MxtLEFVgs8ht7Op6or/RszCvMIwCf9I91ftwfApGEegajWZ86G47Gn9h7uHOQgPx3Lru5wcBmmzielFKBUHTPuweO/ZwGbbORx8l/iZkD8LL64pyyPahEjbxh1pyKgqVyOr/4t+XU6K4QAS0la/p7N945EQYzUeQrm4on1S5a6YmhMWBYAUoKRF3gDQbiu0fCiZDDKjpyHQCQFQ2cRnboziWVOuWPRmLk4ZK6pfqD4XWdPf7/HgklmjlGKye9OWky8scIxp24MtLrME9fODZdFXUMjOZ0XIKERysXVa2xmTkhmU94pOHrFjjRLvIgCuykWEspDAySti8IjEF3IAEtfg2iiVR2aiu+h4P8RyLkwANRyee2mwjAuQisbH0HukaOd/aN6kkaFFZXlZt16iZCC12G1OcP7VXkxF6KsFV9VUk2VTvNy1mmDWADTeWEEnG79ILZnq/nm7zCZlta612992jfb0Se/RQYfSNx6PWFwekqBAfNTAKE31r2RSu8wDFi7pPqKUgQZ7qo2u1vqnBlr0f+U5X0p+ZgGQjwtMoCAkzTlybJMm0Aex3ilMcohPbKCi1L68tdC/KNT5HOl9QXrbKYhFl9I9EutKpPYu2syHHbBX2K60RCYmI+VXOtu7mi0FqqKLnPg44lU9ENu9uDeJ8T86BxjvWfLK0EC3f5JAinz4JzGPIjoQ3Uljm/ZeIZKiblBzBajsPCm+68ruYf/3VTy0OigT4rseALRPRkyuwSJ3gcJti456Q+Oe7+2+b9mIQ9jJLJvU6iJcKNlYUhtPqJwRA9O6YLxswXD2AmM7Vi5DQVfD7/psER50Kb1dyECQFFX/aRm2XhUpPbF1ffd7Bz8FdDwdjHpy8CQ+tMpdIkXKPAYxfB6zTB3ctq4Ib55U9fM6fslnz8Pca5sYTcaxcNKbzHCbc6wQhUJg0sTX2xAI4nU1NTNAFyOBh9/b2W9q0kjlxZXe79qtdtv8VpNbsQLPTLymmx5bkUuEU08CsWVn3nld3t38ZEx8QLeUjMqo/B4qnjeWNuaUPJM9fNLftOvmodMR0MxiIbdncQQWc44xk0qCw0waJKG1BfpAXguYzk4DGYySL+Ug6GY5u2fdC6SZLT3hsX1V9P4saVLodlmafAPps3GGiGocYXkWdfXTQBOlbjsAgFhOZBB5jKHoOLv9B3ZlQK0umMfdXSmg1FTssKDJsuZl6frKj4op6zVyrSNPQEklDhEoH+Iq/wn5LSCdA8iS9jCck3Go5t6PUFNvQMjfI3La6v43nDYpHnl7gc1gXeAns1UasOzIihrZJ4dHjHh22/3tfepwOMwMsarSdWdBqX07D2S41PVnmsK8aki/OVuDKysdwV/8XDK86pjjGrFo7GYcO2oM4qDHMF4CmtGpMJFEXLBKDW4dFoqz84ti6WSMC1TTXuYCQ6a9UNCwsH/KOpD1raDg+NJHwYi2bVMw0mPf4cp2FGhdICc8Nnuifyj6hnJSGlx1fyn13MJiMQFwNt7Scu6dTfyx7gMxMMGJKwJATiiXXKaRZV8Ug8IY+gmsU8L47/suMmg/tcJg6uqrRPxqcK+f1Ud+/3Z3mtLzhs1jojj0Iu67/x+NzA0Fc/MjhZ8HzxLa5PumlJPRRYeNj5URtol+j1ln9UAJ/Pwica+XyzNk5/WwayQTIp73lpy/sLrmqsuo5Y4srqMs91doupzmIS7XgtnsOJAuMditbfkal/9CyUll0uahZ5M2bB6AtoC7yX6xc3YqXgGw7pObMrAH8ORYNPFilO0Dax1EQymdq+9YMj2+srPWA1G4ujyVRpTam7cSAQKZ0/u7SK5bjCWCzpcNhEMxF5AnETHDmXkWQ5tqf11Ibh0djUE/MpnDLMQmRMApfdCNM9QfT/BRgAj7qO9qX403UAAAAASUVORK5CYII="})),this.editModel.schema={componentName:{title:t("Name"),type:"Text",validators:["required"]},componentDescription:{title:t("Description"),type:"Text"},appKey:{title:t("Url"),type:"Text",validators:["required"]}},this.$dialog=a.$el.dialog(_.extend({appendTo:e.container,title:o,dialogClass:"quick-dash edit-component-dialog",resizable:!1,height:"auto",width:"auto",modal:!0,autoOpen:!0,buttons:i,drag:function(){a.form&&a.form.validate()},open:function(){$('<i class="fa fa-plus" />').insertBefore(a.$el.parent().find(".ui-dialog-title")),a.form=new BBForm({model:a.editModel}).render(),a.$el.html(T.ComponentDialog(a.editModel.toJSON())),a.$el.find(".form").append(a.form.el),a.initializeEvents(),a.$fileInput=a.$el.find(".file-input"),a.$uploadBtn=a.$el.find(".upload-btn"),a.$img=a.$el.find("img"),a.$fileInput.on("change",$.proxy(a.onFileInput,a)),a.$uploadBtn.button({icons:{primary:"fa fa-upload"},text:!0}).click($.proxy(a.onUploadClick,a))},close:function(){a.remove()}},this.options))},initializeEvents:function(){this.listenTo(this.editModel,"change",this.onModelCopyChanged)},onCancelButtonClick:function(){this.$el.dialog("close"),this.remove()},onDeleteButtonClick:function(){var e=this;QuickBase.DeltaClientLib.deleteComponent(e.editModel.get("id"),function(){e.updateFn(),e.onCancelButtonClick()},function(e){alert("Todo set component error"+JSON.stringify(e))})},onFileInput:function(e){var t,n=this;0<e.target.files.length&&((t=new FileReader).onload=function(e){e=e.target.result;n.$img.attr("src",e),n.editModel.set("listViewThumb",e)},t.readAsDataURL(e.target.files[0]))},onModelCopyChanged:function(e){this.isModelChanged||(this.isModelChanged=!0,this.setSaveEnabled(this.isModelChanged))},onSaveButtonClick:function(){var e=this;e.editModel&&!e.form.validate()&&_.defer(function(){e.isModelChanged=!1,e.setSaveEnabled(e.isModelChanged),e.form.commit(),QuickBase.DeltaClientLib.setComponent(e.editModel.get("id"),e.editModel.get("componentName"),e.editModel.get("componentDescription"),e.editModel.toJSON(),function(){e.updateFn(),e.onCancelButtonClick()},function(e){alert("Todo set component error"+JSON.stringify(e))}),Log.Info("Save Component",JSON.stringify(e.editModel))})},onUploadClick:function(){this.$fileInput.click()},remove:function(){this.editModel&&(this.stopListening(this.editModel),this.editModel=null),QuickBase.ErrorTooltip.clearAll(),Backbone.View.prototype.remove.call(this)},setSaveEnabled:function(e){this.$el.next().find("button:nth-of-type(1)").button({disabled:!e})}}),ComponentsPanel=Backbone.View.extend({ITEM_HEIGHT:34,componentViews:null,sortedComponents:null,viewModel:null,initialize:function(e){this.componentViews={},this.options=e,this.sortedComponents=[],this.dialogContainer=e.dialogContainer,this.viewModel=e.viewModel,this.$el.html(T.ComponentsPanel({isLite:e.isLite})),this.$pinButton=this.$(".pin-button"),this.$componentsList=this.$el.find(".components-list"),this.$componentsListClone={},this.$clearSearch=this.$el.find(".fa-times"),this.$scrollUp=this.$el.find(".scroll-up"),this.$scrollDown=this.$el.find(".scroll-down"),this.$searchInput=this.$el.find(".search-box input"),this.$addLink=this.$el.find("a.add"),this.initializeEvents(),this.onModelReset(this.model),String.prototype.includes||(String.prototype.includes=function(){"use strict";return-1!==String.prototype.indexOf.apply(this,arguments)})},initializeEvents:function(){var t=this;this.listenTo(this.model,"add",this.onModelAdd),this.listenTo(this.model,"remove",this.onModelRemove),this.listenTo(this.model,"reset",this.onModelReset),this.listenTo(this.viewModel,"change:componentsPinned",this.onComponentsPinnedChanged),this.$addLink.click(function(){t.onComponentEdit()}),this.$clearSearch.on("click",function(){t.$searchInput.val(""),t.filter(t.$searchInput.val()),t.$searchInput.blur()}),this.$componentsList.on("scroll",function(){t.$scrollUp.toggle(0!==t.$componentsList.scrollTop()),t.$scrollDown.toggle(t.$componentsList.scrollTop()+t.$componentsList.innerHeight()<t.$componentsList[0].scrollHeight)}),this.$pinButton.on("click",function(){t.viewModel.set("componentsPinned",!t.viewModel.get("componentsPinned"))}),this.$scrollDown.on("click",function(){t.onScrollDown()}),this.$scrollUp.on("click",function(){t.onScrollUp()}),this.$searchInput.on("input",function(){t.filter(t.$searchInput.val())}),this.$searchInput.on("keydown",function(e){27===e.keyCode&&(t.$searchInput.val(""),t.filter(null),_.delay(function(){t.$searchInput.blur()},100))})},applyHighlight:function(e,t){e.html(t)},detachAll:function(){var e;for(key in this.componentViews)this.componentViews.hasOwnProperty(key)&&(_.isUndefined(this.componentViews[key].options.sort)?(e=this.sortedComponents.length,this.sortedComponents[+e]=this.componentViews[key].$el.detach()):this.sortedComponents[this.componentViews[key].options.sort]=this.componentViews[key].$el.detach())},highlight:function(e,o){var a=this,s=e.item.$el,l=e.matches;this.unhighlight(s);try{_.each(["name","description"],function(e){var t=s.find("."+e),n=t.text(),i=new RegExp("("+o+")","gi"),n=n.replace(i,"<mark>$1</mark>");a.applyHighlight(t,n),!n.includes("<mark>")&&"description"!=e&&l.length&&_.each(l,function(e){n=a.highlightFuzzyMatches(n,e)})})}catch(e){}},highlightFuzzyMatches:function(e,t){for(var n,i,o=t.indices,a=(t.value,e),s=o.length-1;0<=s;s--)t.key.includes("componentDescription")||(i=o[s][0],n=o[s][1]+"<mark>".length+1,a=(a=a.substr(0,i)+"<mark>"+a.substr(i)).substr(0,n)+"</mark>"+a.substr(n));return a||e},highlightTags:function(e,t){_.each(e.find(".ui-widget-content"),function(e){-1<$(e).html().toLowerCase().indexOf(t.toLowerCase())?$(e).addClass("marked"):$(e).removeClass("marked")})},unhighlight:function(e){e.find("mark").contents().unwrap()},filter:function(t){if(t){this.detachAll();var e=_.map(this.componentViews,function(e,t){return e}),e=new Fuse(e,{distance:100,includeMatches:!0,includeScore:!0,keys:["model.attributes.componentName","model.attributes.componentDescription"],location:0,maxPatternLength:32,minMatchCharLength:2,shouldSort:!0,threshold:.6}),n=t.toLowerCase(),e=e.search(t.toLowerCase()),i=_.map(e,function(e){return e.item.el}),i=_.flatten(_.map(i,_.bind(function(t){return _.filter(this.sortedComponents,function(e){return e[0]===t})},this)));_.each(i,_.bind(function(e){this.$componentsList.append(e)},this)),_.each(e,_.bind(function(e){this.highlight(e,t),e.item.$el.removeClass("showTags"),_.some(e.item.model.get("tags"),function(e){return-1<e.indexOf(n)})&&(e.item.$el.addClass("showTags"),this.highlightTags(e.item.$el,t))},this))}else{for(key in this.componentViews)this.componentViews.hasOwnProperty(key)&&(this.unhighlight(this.componentViews[key].$el),this.componentViews[key].$el.removeClass("showTags"));_.each(this.sortedComponents,_.bind(function(e){this.$componentsList.append(e)},this))}},onComponentEdit:function(e){var t=this;new ComponentDialog({container:t.dialogContainer,updateFn:function(){t.updateUserComponents()},model:e})},onComponentsPinnedChanged:function(){var e=this;this.viewModel.get("componentsPinned")?(this.$pinButton.find("i").removeClass("fa-caret-right").addClass("fa-caret-left"),this.$el.removeClass("unpinned"),_.delay(function(){e.$searchInput.focus()},100)):(this.$pinButton.find("i").removeClass("fa-caret-left").addClass("fa-caret-right"),this.$el.addClass("unpinned"))},onModelAdd:function(e){var t,n=this;/^data/gi.test(e.get("listViewThumb"))&&e.set("listViewThumb",'<img src="'+e.get("listViewThumb")+'" />'),t=new ComponentListView({model:e,dblclick:e.get("user")?function(e){n.onComponentEdit(e)}:void 0,onDragEnd:this.options.onDragEnd,onDragStart:this.options.onDragStart,sort:e.get("index")}),this.componentViews[e.id]=t,this.$componentsList.append(t.el)},onModelRemove:function(e){var t=this.componentViews[e.id];t&&(t.remove(),delete this.componentViews[e.id])},onModelReset:function(e,t){var n=this,i=0;t&&t.previousModels&&_.each(t.previousModels,function(e){n.onModelRemove(e)}),e.each(function(e){e.get("hidden")||(e.set("index",i++),n.onModelAdd(e))})},onScrollDown:function(){this.$componentsList.scrollTop(this.$componentsList.scrollTop()+this.ITEM_HEIGHT)},onScrollUp:function(){this.$componentsList.scrollTop(this.$componentsList.scrollTop()-this.ITEM_HEIGHT)},updateUserComponents:function(){var t=this;QuickBase.DeltaClientLib.getComponents(function(e){t.model.remove(t.model.where({user:!0})),_.each(e,function(e){e=$.parseJSON(e.dataJSON);e.user=!0,t.model.add(e)})},function(e){Log.Error("DeltaClientLib.getComponents: Error",e)})}}),AppRouter=Backbone.Router.extend({createNewDashboardIfNotFound:!1,model:null,previousRoutes:null,viewModel:null,app:null,routes:{":dashboardId(/)(:screenId)":"onDashboard"},initialize:function(e){this.model=e.model,this.viewModel=e.viewModel,this.dialogContainer=e.dialogContainer,this.createNewDashboardIfNotFound=e.createNewDashboardIfNotFound,this.app=e.app,this.previousRoutes=[],this.initializeEvents()},initializeEvents:function(){this.on("route",function(){this.previousRoutes.push(Backbone.history.fragment)})},getViewstateFromQueryString:function(e){e=/(^|&)viewstate=([^&;]+?)(&|;|$)/.exec(e);return e?JSON.parse(decodeURIComponent(e[2])):null},navigateToDash:function(e,t,n){var i,o=this,a=this.viewModel.get("selectedDocumentId"),s=this.model.get("documents").get(e);!s&&this.createNewDashboardIfNotFound?this.app.createDashboard(e,new URL(document.location.href).searchParams.get("title")).then(function(e){o.navigateToDash(e,t,n)}).catch(function(){Log.Error("dashboard NOT found (???)"),o.navigate(o.model.get("documents").first().id,{trigger:!0})}):s?(i=this.getViewstateFromQueryString(n),this.viewModel.set("incomingViewState",i,{silent:!0}),a===e&&i&&this.viewModel.trigger("processIncomingViewState",s),this.viewModel.set({selectedDocumentId:e,selectedScreenId:t})):(Log.Error("dashboard NOT found (?)"),a?Log.Error("dashboard doesn't exist or user doesnt have required permissions. (2)"):0<this.model.get("documents").length?this.navigate(this.model.get("documents").first().id,{trigger:!0}):(Log.Error("dashboard doesn't exist or user doesnt have required permissions. (1)"),$(document).find(".loadingScreen").css({display:"none"}),this.dialog=$("<div>The Selected dashboard does not exist or user does not have required permissions or no dashboards are permissioned to this user.</div>").dialog({autoOpen:!0,height:350,width:350,modal:!0,title:"Error loading Dashboard"})))},onDashboard:function(t,n,i){var e=this.viewModel.get("selectedDocumentId"),o=this.model.get("documents").get(e);if(o){var a=[];if(_.each(QuickBase.ComponentView.getInstances(),function(e){e=e.beforeRemove();e&&e.callback&&a.push(e)}),t!==e&&(o.get("wasChanged")||!_.isEmpty(a)))return void new QuickBase.AreYouSureDialog({components:a,container:this.dialogContainer,dashChanged:o.get("wasChanged"),model:o,userClass:"quick-dash"}).on("close",function(e){"cancel"===e?(this.previousRoutes.pop(),this.navigate(_.last(this.previousRoutes),{replace:!0}),this.onNavCancel&&(this.onNavCancel(),this.onNavCancel=null)):(this.navigateToDash(t,n,i),this.previousRoutes=[Backbone.history.fragment])}.bind(this))}this.navigateToDash(t,n,i)}}),ContentPanel=Backbone.View.extend({$contentPanel:null,$el:null,appModel:null,contentToolbar:null,currentWidgetCopy:null,documentView:null,viewModel:null,CSS_COPIED:"copied",CSS_NOT_COPIED:"not-copied",KEYCODE_C:67,KEYCODE_DEL:46,KEYCODE_V:86,KEYCODE_X:88,initialize:function(e){this.appModel=e.appModel,this.viewModel=e.viewModel,this.$el.toggleClass("open",this.appModel.get("showBreadcrumbs")),this.listenTo(this.viewModel,"change:isInspecting",this.onIsInspectingChanged),this.listenTo(this.viewModel,"change:selectedDocumentId",this.onSelectedDocumentChanged),this.listenTo(this.viewModel,"change:selectedScreenId",this.onSelectedScreenChanged),this.listenTo(this.appModel,"change:propertiesPinned",this.onPropertiesPinnedChanged),this.listenTo(this.viewModel,"change:componentsPinned",this.onComponentsPinnedChanged),this.listenTo(this.appModel,"change:showBreadcrumbs",this.onResize),this.listenTo(this.viewModel,"processIncomingViewState",function(e){this.processIncomingViewState(e)}),this.$el.on("keydown",this.onKeyDown.bind(this)),this.listenTo(this.viewModel,"change:selectedWidget",function(e){e._previousAttributes.selectedWidget&&(e=(e=e._previousAttributes.selectedWidgetView.$el.parent()).data("widgetid")?e:e.parent()).removeClass(this.CSS_COPIED),_.defer(function(){$(".content-panel:visible:last").focus()})}.bind(this)),this.showLoadingScreen(t("loading dashboard")+"...")},downloadDash:function(e){var n=this;e.fetch({success:function(e){var t;n.hideLoadingScreen(),e.get("screens").length<=0&&(t=new QuickBase.Screen({},{},e.get("screens")),e.get("screens").add(t),n.viewModel.set("selectedScreenId",t.id)),e.trigger("view-state-init"),e.trigger("detail-downloaded"),e.set("wasChanged",!1),n.resetDocumentView(e),n.processIncomingViewState(e)},error:function(){n.hideLoadingScreen(),alert(t("connection error while downloading dashboard"))},silent:!0})},generateThumb:function(){this.documentView.screenView.regenerateThumb()},hideLoadingScreen:function(){this.$loadingScreen&&(this.$loadingScreen.$el.fadeOut(function(){$(this).remove()}),this.$loadingScreen=null)},onKeyDown:function(e){var i=this,o=e.keyCode;if($(e.target).hasClass("content-panel")){if(!this.appModel.get("userName"))return!1;if(o===this.KEYCODE_DEL)this.removeSelectedWidget();else if(e.ctrlKey||e.metaKey)switch(o){case this.KEYCODE_V:this.viewModel.get("buildMode")&&($(document).one("paste",$.proxy(this.onPaste,this)),this.$el.attr("contenteditable",!0),this.$el.focus());break;case this.KEYCODE_C:case this.KEYCODE_X:this._copying||(this._copying=!0,this.onCopy(),this._copy&&this.copy(this._copy,function(e){var t,n=i.viewModel.get("selectedWidgetView");n&&!(t=n.$el.parent()).data("widgetid")&&(t=t.parent()),e?o===i.KEYCODE_X?i.removeSelectedWidget():t&&t.addClass(i.CSS_COPIED):t&&(t.addClass(i.CSS_NOT_COPIED),setTimeout(function(){t.removeClass(i.CSS_NOT_COPIED)},1e3)),i.$el.focus(),i._copying=!1}))}}},onCopy:function(){var t,n,e,i={},o=this,a=this.viewModel.get("selectedWidget");a&&((e=this.viewModel.get("selectedWidgetView"))&&e.$el&&(0===(e=e.$el).height()&&(e=e.closest("[data-widgetid]")),i._widgetSize=[e.width(),e.height()]),i._widget=a.toJSON(),n=CopyPasteHelpers.getComponentViewStates(a.attributes.component),i._dataSources=_.extend(CopyPasteHelpers.getComponentDataSources(a.attributes.component,n,o.documentView.model.get("data")),CopyPasteHelpers.getMappingDataSources(n,o.documentView.model)),i._viewState={},_.each(n,function(e){(t=o.documentView.model.get("viewState").getByPath(e))&&(i._viewState[e]=t.toJSON(),"dict"===t.get("_type")&&(i._viewState[e]._default=_.mapValues(t.get("_default"),function(e){var t;return e instanceof Backbone.Model?(_.includes(n,e.path)||i._viewState[e.path]||(t=o.documentView.model.get("viewState").getByPath(e.path))&&(i._viewState[e.path]=t.toJSON()),"<%"+e.path+"%>"):e})))}),this._copy=JSON.stringify(i))},onPaste:function(e){var t,n;if(e.stopPropagation(),e.preventDefault(),this.$el.removeAttr("contenteditable"),(e=e.originalEvent.clipboardData||window.clipboardData)&&(t=e.getData("Text"))){try{if(!(t=JSON.parse(t))._widget)return;this.appModel.set("copiedWidgetSize",t._widgetSize),n=t._widget,CopyPasteHelpers.mergeViewStates(t._viewState,this.documentView.model);var i={},o={};if(_.each(t._dataSources,function(e,t){"virtual"===e._dataType?o[t]=e:i[t]=e}),CopyPasteHelpers.mergeDataSources(i,this.documentView.model),CopyPasteHelpers.mergeDataSources(o,this.documentView.model),this.documentView.applyDataSources(),!n.component||!n.id||!n.layout)return void(n=null)}catch(e){return void console.log("something is wrong with the widget",e)}this.documentView&&n&&this.documentView.pasteWidget(new QuickBase.Widget(n))}},copy:function(e,t){var n,i;if(navigator.clipboard)navigator.clipboard.writeText(e).then(function(){$("window").focus(),t&&t(!0)},function(e){$("window").focus(),t&&t(!1)});else{(n=$(document.createElement("textarea"))).css({position:"absolute",width:0,height:0,top:0,left:0}),n[0].value=e,n.appendTo(this.$el),n[0].focus(),n[0].select();try{document.execCommand("SelectAll")&&(i=document.execCommand("copy",!1,null))}catch(e){console.log(e)}n.remove(),$("window").focus(),t&&t(i)}},processIncomingViewState:function(n){var e=this,t=this.viewModel.get("incomingViewState");t&&(_.each(t,function(e,t){".settings"!==t&&(t=n.get("viewState").getByPath(t))&&t.set("value",e)}),_.delay(function(){e.viewModel.unset("incomingViewState")},500))},resetDocumentView:function(e){this.documentView&&(this.documentView.remove(),this.documentView=null),this.documentView=new QuickBase.DocumentView({appModel:this.appModel,model:e,viewModel:this.viewModel}),this.$el.append(this.documentView.$el)},onIsInspectingChanged:function(){this.$el.toggleClass("inspecting",this.viewModel.get("isInspecting"))},onComponentsPinnedChanged:function(){var e=this;this.viewModel.get("componentsPinned")?(this.$el.removeClass("components-unpinned"),this.onResize()):(this.$el.addClass("components-unpinned"),_.defer(function(){e.onResize()}))},onPropertiesPinnedChanged:function(){var e=this;this.appModel.get("propertiesPinned")?(this.$el.removeClass("unpinned"),this.onResize()):(this.$el.addClass("unpinned"),_.defer(function(){e.onResize()}))},onResize:function(){this.$el.toggleClass("open",this.appModel.get("showBreadcrumbs")),this.documentView&&this.documentView.onResize()},onSelectedDocumentChanged:function(){var e;this.currentWidgetCopy=null,(e=this.viewModel.get("selectedDocumentId"))&&((e=this.appModel.get("documents").get(e))?(this.showLoadingScreen(t("loading")+" "+e.get("name")+"..."),this.documentView&&this.documentView.remove(),this.downloadDash(e)):this.viewModel.set("selectedDocumentId",null))},removeSelectedWidget:function(){var e=this.viewModel.get("selectedWidget");e&&e.trigger("removeWidget")},showLoadingScreen:function(e){this.$loadingScreen||(this.$loadingScreen=new LoadingScreen({loadingText:e}),this.$loadingScreen.$el.appendTo($("body")))}}),AppModel=(JBa=Backbone.Model,__extends(KBa,JBa),KBa.prototype.defaults=function(){return{api:null,CanExecuteQueries:!0,components:null,deltaClient:null,documents:null,language:"en",publisherUrl:null,smartDrop:!0,websiteUrl:null,userName:null,paths:null,propertiesPinned:!0,isHelpDialogTabbed:!0,showBreadcrumbs:"false"!==$.cookie("dashboard-breadcrumbs")}},KBa),JBa;function KBa(e){var t,n=JBa.call(this,e)||this,i=[];for(t in e.versions)e.versions.hasOwnProperty(t)&&i.push({key:t,value:e.versions[t]});return n.set({api:e.api,components:new QuickBase.ComponentDefinitionCollection,documents:e.documents,PackageName:e.PackageName,paths:_.sortBy(i,"key"),publisherUrl:e.publisherUrl,websiteUrl:e.websiteUrl}),n.listenTo(n,"change:showBreadcrumbs",function(){return $.cookie("dashboard-breadcrumbs",n.get("showBreadcrumbs"),{expires:90})}),n}var DocumentImporter=function(e,t){this.appModel=e,this.viewModel=t},Notificator=(_.extend(DocumentImporter.prototype,Backbone.Events,{doImport:function(e,t){function i(){0===--n&&_.isFunction(t)&&t()}var n=e.length;_.each(e,_.bind(function(e){var t=e.data.id,n=this.appModel.get("documents").get(t);n&&"replace"===e.data.action?(this.appModel.get("documents").remove(t),this.appModel.get("documents").add(e.data),(n=this.appModel.get("documents").get(t)).save(n.attributes,{success:function(){i()},error:function(e){QuickBase.Log.Error(e),i()}},this)):"add"===e.data.action?(this.appModel.get("documents").add(e.data),(n=this.appModel.get("documents").get(t)).save(n.attributes,{success:function(){i()},error:function(e){QuickBase.Log.Error(e),i()}})):i()},this))},importCheck:function(o,a){var s=this,l=[],r=_.cloneDeep(o),c=function(){var e,n,i;0===r.length?s.doImport(l,a):(n=r.splice(0,1)[0],s.appModel.get("documents").get(n.data.id)?e=new MessageDialog({title:t("Confirm Replace"),dialogClass:"replace-dash-dialog",message:t('Dashboard "'+n.data.name+'" with id "'+n.data.id+'" already exists!<br><br>"Are you sure you would like to replace this dashboard?<br><br>'),check:t(" Apply this action to all existing Dashboards"),buttons:[{text:t("Replace"),click:function(){e.close(),e.$el.find('input[type="checkbox"]').is(":checked")?(_.each(o,function(e){i=s.appModel.get("documents").get(e.data.id),e.data.action=i?"replace":"action"}),l=l.concat(o),r=[]):(n.data.action="replace",l.push(n)),c()}},{text:t("Skip"),click:function(){e.close(),e.$el.find('input[type="checkbox"]').is(":checked")?r=[]:(n.data.action="skip",l.push(n)),c()}},{text:t("Cancel"),click:function(){e.close()}}]}):(n.data.action="add",l.push(n),c()))};c()},importFiles:function(l,r,c){var d,u=this,l=l||[],p=[];_.each(l,function(s){var e=new FileReader;e.onload=function(e){try{var t=e.target.result,n=void 0,i=void 0,o=void 0;"text/xml"===s.type?(a=$.parseXML(t),o=(i=$(a)).find("data"),(n=JSON.parse(o.text().replace(/&gt;/g,">").replace(/&gt;/g,"<").replace(/&amp;/g,"&"))).id=i.find("name").text()):n=JSON.parse(t),s.data=n,p.push(s),d=d||n.id,l.length===p.length&&u.importCheck(p,function(){_.isFunction(r)&&r(d)})}catch(e){var a="Import Error: parsing "+s.name;QuickBase.Log.Error(a),_.isFunction(c)&&c(a)}},e.readAsText(s)})}}),Backbone.View.extend({className:"notificator",initialize:function(e){this.appModel=e.appModel,this.render()},notify:function(e,t){this.$title.text(e),this.$items.append(t),this.$panel.fadeIn("slow")},onClose:function(){var e=this;this.$panel.fadeOut("slow",function(){e.$items.html("")})},render:function(){return this.$el.addClass(this.className),this.$el.html(T.Notificator()),this.$title=this.$(".title"),this.$items=this.$(".items"),this.$panel=this.$(".panel"),this.$close=this.$(".close-button"),this.$close.button({text:!1,icons:{primary:"fa fa-times"}}).click($.proxy(this.onClose,this)),this.$panel.hide(),this}})),FailedLoginsNotification=Backbone.View.extend({className:"failed-logins",initialize:function(e){this.appModel=e.appModel,this.render()},render:function(){var e=this.model.toJSON();return _.each(e.rows,function(e){var t=Tools.convertKDBTemporalToMoment(e.time);e.time=t.format("YYYY-MM-DD HH:mm:ss"),e.timeSort=t.valueOf()}),e.rows=_.sortBy(e.rows,"timeSort").reverse(),$(this.$el).css("max-height",$(".quick-base").height()/2),this.$el.addClass(this.className),this.$el.html(T.FailedLoginsNotification(e)),this}}),BreadcrumbsWrapper=Backbone.View.extend({initialize:function(e){var o=this;this.appModel=e.appModel,this.viewModel=e.viewModel,this.componentDefinition=Breadcrumbs.getComponentDefinition({websiteUrl:this.appModel.get("websiteUrl"),settingsModel:new Backbone.Model}),this.app=new Breadcrumbs({el:this.$el,websiteUrl:this.appModel.get("websiteUrl"),settingsModel:this.componentDefinition,api:{setProperty:function(e,t){var n,i=[];t?("Basic.Path"===e&&(i=t.split(",")),(n=o.currentPath?o.currentPath.items[i.length-1]:n)&&o.appModel.set("pendingSelectionWidgetId",n.widgetId)):(o.viewModel.set("selectedWidget",null),o.viewModel.set("selectedWidgetView",null,{silent:!0}))}},disableSortable:!0}),this.listenTo(this.viewModel,"change:selectedWidget",this.onSelectedWidgetChanged),this.listenTo(this.viewModel,"change:componentsPinned",this.onComponentsPinnedChanged),this.onSelectedWidgetChanged()},findWidget:function(e,t,n){if(n=n||{value:"",items:[]},e.includes(t)||t.get("component")&&e.includes(t.get("component")))return component=this.appModel.get("components").get(t.get("component").get("definitionId"))||this.appModel.get("components").find({appKey:t.get("component").get("key")}),n.value+=component.get("componentName"),n.items.push(t),n;for(var i=0;i<e.length;i+=1){var o=e.at(i),a=null,s=null;if(o.get("component")?(s=o.get("id"),o=o.get("component")):s=$("#"+o.get("containerId")).attr("data-widgetId"),(!(a=o.get("widgets"))||a.length<=0)&&(a=o.get("components")||a),o.widgetId=s,a){s={value:"",items:[]},o=(s.value+=this.appModel.get("components").find({appKey:o.get("key")}).get("componentName")+",",s.items.push(o),this.findWidget(a,t));if(o&&o.value)return n.value+=s.value+o.value,n.items=n.items.concat(s.items.concat(o.items)),n}}},findWidgetFromPopups:function(e,t){var n,i=this;return e.each(function(e){if(n=i.findWidget(e.get("widgets"),t))return!1}),n},onComponentsPinnedChanged:function(e,t){this.$el.parent().toggleClass("left-open",t)},onSelectedWidgetChanged:function(){var e,t,n=this.viewModel.get("selectedWidget");n?(t=(e=this.appModel.get("documents").get(this.viewModel.get("selectedDocumentId"))).get("screens").get(this.viewModel.get("selectedScreenId")),(t=(t=this.findWidget(t.get("widgets"),n))||this.findWidgetFromPopups(e.get("popups"),n))&&t.value&&(this.currentPath=t,this.app.onSettingsChange({"Basic.Breakdown":t.value.split(","),"Basic.Path":t.value.split(",")}))):(this.currentPath=null,this.app.onSettingsChange({"Basic.Breakdown":[],"Basic.Path":[]}))}}),Tools=QuickBase.Tools,App=Backbone.View.extend({DOCUMENT_TITLE:{SEPARATOR:" - ",SUFFIX:"Dashboards"},THEMES:[{id:"kx-darkroom",name:"Dark"},{id:"kx-light",name:"Light"}],$documentDialogPanel:null,$dropzone:null,$environmentDialogPanel:null,$propertiesPanelDiv:null,componentsPanel:null,contentPanel:null,DeltaClientLogin:!1,dropzoneAdded:!1,environmentTheme:null,observer:null,propertiesPanel:null,toolbar:null,viewModel:null,appid:"dashboards",initialize:function(t){var n,a=this,i=[32,99,1001,1002,1003,1006,1010];-1!=document.location.href.indexOf("auth=saml")&&(this.saml=!0),QuickBase.Helpers.preventBackspaceBack(),QuickBase.DocumentCollection.requiredAccessLevel="update",n=-1!==document.location.pathname.indexOf(".")?document.location.pathname.substr(0,document.location.pathname.lastIndexOf("/")+1):document.location.pathname,t.isLite?(QuickBase.Document.prototype.sync=QuickBase.DashClientLib.documentSync,QuickBase.DocumentCollection.prototype.sync=QuickBase.DashClientLib.documentCollectionSync,QuickBase.Connection.prototype.sync=QuickBase.DashClientLib.connectionSync,QuickBase.ConnectionCollection.prototype.sync=QuickBase.DashClientLib.connectionCollectionSync,_.extend(QuickBase.DocumentDataModel.prototype,QuickBase.DashClientLib),QuickBase.DeltaClientLib.PIVOT_SOURCE_CODE=QuickBase.DashClientLib.PIVOT_SOURCE_CODE):(QuickBase.Document.prototype.sync=QuickBase.DeltaClientLib.documentSync,QuickBase.DocumentCollection.prototype.sync=QuickBase.DeltaClientLib.documentCollectionSync,QuickBase.Connection.prototype.sync=QuickBase.DeltaClientLib.connectionSync,QuickBase.ConnectionCollection.prototype.sync=QuickBase.DeltaClientLib.connectionCollectionSync,QuickBase.ConnectionGroup.prototype.sync=QuickBase.DeltaClientLib.connectionGroupSync,QuickBase.ConnectionGroupCollection.prototype.sync=QuickBase.DeltaClientLib.connectionGroupCollectionSync,QuickBase.Service.prototype.sync=QuickBase.DeltaClientLib.servicesSync,QuickBase.ServiceCollection.prototype.sync=QuickBase.DeltaClientLib.servicesCollectionSync),this.model=new AppModel(_.extend(t,{api:"//"+document.location.host+n+"api/",websiteUrl:"//"+document.location.host+n,saml:this.saml,documents:QuickBase.DocumentCollection.singleton||new QuickBase.DocumentCollection,components:t.isLite?_.filter(t.components,function(e){return-1==i.indexOf(e.id)}):t.components,connections:new QuickBase.ConnectionCollection,connectionGroups:t.isLite?null:new QuickBase.ConnectionGroupCollection,services:t.isLite?null:new QuickBase.ServiceCollection,DocsUrl:t.isLite?"https://code.kx.com/dashboards":void 0})),t.isLite&&(QuickBase.DocumentDataModel.connections=this.model.get("connections"),this.$el.addClass("is-lite")),this.viewModel=new QuickBase.AppViewModel(_.pick(t,"buildMode")),this.documentImporter=new DocumentImporter(this.model,this.viewModel),this.model.documentImporter=this.documentImporter,"FSBL"in window&&this.finsembleInitEvents(),this.$el.addClass("quick-dash quick-base main-app buildMode"),n=function(e){a.$el.html(T.app()),a.$notificationsDiv=a.$(".notifications-div"),a.notificator=new Notificator({el:a.$notificationsDiv}),a.$documentDialogPanel=a.$el.find("> .dialog-panel .document"),a.$environmentDialogPanel=a.$el.find("> .dialog-panel .environment"),$.extend($.ui.dialog.prototype.options,{appendTo:a.$documentDialogPanel}),a.toolbar=new MainToolbar({el:a.$el.find("> .toolbar"),appModel:a.model,dialogContainer:a.$environmentDialogPanel,themes:a.THEMES,viewModel:a.viewModel}),a.componentsPanel=new ComponentsPanel({el:a.$el.find("> .components-panel"),dialogContainer:a.$environmentDialogPanel,model:a.model.get("components"),onDragEnd:function(){$(".ui-dialog-content:visible>.content-panel").removeClass("outlined"),a.contentPanel.$el.removeClass("outlined"),a.model.unset("draggedComponentId")},onDragStart:function(e){var t=$(".ui-dialog-content:visible>.content-panel");(t.length?t:a.contentPanel.$el).addClass("outlined"),a.model.set("draggedComponentId",e)},viewModel:a.viewModel,isLite:a.model.get("isLite")}),a.propertiesPanel=new PropertiesPanel({el:a.$el.find("> .properties-panel"),appModel:a.model,dialogContainer:a.$environmentDialogPanel,viewModel:a.viewModel}),a.listenTo(a.viewModel,"screenshot",function(){a.contentPanel.generateThumb()}),a.contentPanel=new ContentPanel({el:a.$el.find("> .content-panel"),appModel:a.model,deltaClient:a.deltaClient,viewModel:a.viewModel,websiteUrl:a.model.get("websiteUrl")}),a.$breadcrumbs=a.$el.find("> .breadcrumbs-div"),a.$breadcrumbs.hide(),a.onDashboardThemeChanged(),a.setThemeFromCookie(),a.model.get("hideToolbar")&&a.onHideToolbarChange(),a.viewModel.get("buildMode")||a.onBuildModeChange(null,!1),"MutationObserver"in window&&(a.observer=new MutationObserver(function(e){for(var t=0;t<e.length;t++){var n=e[t].addedNodes;if(n)for(var i=0;i<n.length;i++){var o=n[i];"ui-datepicker-div"===o.id?a.$documentDialogPanel[0].appendChild(o):_.isString(o.className)&&-1!==o.className.indexOf("select2-container")&&(-1!==o.className.indexOf("select2-container--document-selector")||-1!==o.className.indexOf("select2-container--dashboards-properties")||-1!==o.className.indexOf("select2--environment")?a.$environmentDialogPanel:a.$documentDialogPanel)[0].appendChild(o)}}}),a.observer.observe(document.querySelector("body"),{attributes:!1,childList:!0,characterData:!1})),a.model.get("components").reset(t.components),t.deltaToken=t.deltaToken||$.cookie("deltaToken"),a.model.get("isLite")?(QuickBase.DashClient.client=t.dashClient||new QuickBase.DashClient(t),QuickBase.DeltaClientLib=QuickBase.DashClient):a.saml?a.initializeDeltaClient(null,null,function(e){alert(e)},null,!0):t&&t.delta?(a.model.set({userName:t.delta.username,DeltaClientHost:t.delta.options.host,DeltaClientPort:t.delta.options.port,DeltaClientSecure:t.delta.options.secure,DeltaClientFromUrl:t.delta.options.fromURL}),QuickBase.DeltaClientLib.initializeDeltaClientCopy(t.delta.client,a.model.get("DeltaClientHost"),a.model.get("DeltaClientPort"),a.model.get("DeltaClientSecure"),a.model.get("DeltaClientFromUrl"),t.delta.username,t.delta.password,null,function(e){alert(e)},a.appid)):t.deltaToken||t.credentials?($(QuickBase.DeltaClientLib).one("DeltaClientLogin",function(e){a.model.set("userName",QuickBase.DeltaClientLib.deltaClient.user()),t.deltaToken&&$.cookie("deltaToken",t.deltaToken,{expires:30,path:"/"})}),a.initializeDeltaClient(t.credentials?t.credentials.username:null,t.credentials?t.credentials.password:null,null,t.deltaToken)):a.showLogin(),a.initializeEvents(),a.fixSelect2DialogIssue(),a.model.get("isLite")&&t.dashClient&&($(t.dashClient).trigger("DeltaClientConnect"),$(t.dashClient).trigger("DeltaClientLogin"))};try{QuickBase.InitializeQuickbase(n)}catch(e){Log.Error("error loading quickbase",e),window.t=function(e){return e},n()}},initializeEvents:function(){var o=this,a=this.model.get("isLite")?QuickBase.DashClient.client:QuickBase.DeltaClientLib;$(window).resize($.proxy(this.onResize,this)),this.listenTo(this.toolbar,"themeChange",this.setThemeFromCookie),this.listenTo(this.model.get("documents"),"remove",this.onDocumentRemoved),$(a).one("DeltaClientConnect",function(){o.contentPanel.hideLoadingScreen(),$(a).on("DeltaClientConnect",function(){o.contentPanel.hideLoadingScreen();var e=o.getCurrentDocument();e&&e.get("data").getTreeList().forEach(function(e){e.stop(),e.start()})})}),$(a).on("DeltaClientDisconnect",function(e,n){var i=o.getCurrentDocument();n=n?_.startCase(n)+": ":"",o.contentPanel.showLoadingScreen(n+t("reconnecting...")),i&&o.getCurrentDocument().get("data").getTreeList().forEach(function(e){e.stop()})}),$(a).one("DeltaClientLogin",$.proxy(this.onDeltaClientLogin,this)),this.listenTo(this.viewModel,"change:buildMode",this.onBuildModeChange),this.listenTo(this.model,"change:hideToolbar",this.onHideToolbarChange),this.listenTo(this.viewModel,"change:DashboardTheme",this.onDashboardThemeChanged),this.listenTo(this.viewModel,"change:selectedDocumentId",this.onSelectedDocumentChanged),this.listenTo(this.model,"change:showBreadcrumbs",this.onShowBreadcrumbs),this.$el.on("dragenter",_.bind(this.onDragEnter,this)),"FSBL"in window||(window.onbeforeunload=function(e){var t=o.getCurrentDocument(),n="There are unsaved changes in this dashboard.",i=!1;if(t&&(t.get("data").getTreeList().forEach(function(e){e.stop()}),(t.get("wasChanged")||_.some(QuickBase.ComponentView.getInstances(),function(e){return e.beforeRemove()}))&&(i=!0)),i)return(e||window.event).returnValue=n;a&&a.ws&&a.ws.close()})},initializeDeltaClient:function(n,i,o,a,s,e){var l=this;QuickBase.DeltaClientLib.initializeDeltaClient(l.model.get("DeltaClientHost"),l.model.get("DeltaClientPort"),l.model.get("DeltaClientSecure"),l.model.get("DeltaClientFromUrl"),n,i,null,function(e){var t;_.isFunction(o)?o(e):(t=_.isString(e)?e.toLowerCase():null,"loginRequired"===e?l.showLogin():"userSessionLimit"===e?l.showForceLoginPrompt(function(){l.initializeDeltaClient(n,i,o,a,s,!0)}):(t&&_.some(["login","token","session","websocket"]),l.showLogin(e)))},a,l.appid,!0,!!s,!!e)},initializeDropzone:function(){this.$dropzone=$("<form />"),this.$dropzone.addClass("simpleDropzone"),this.$dropzone.appendTo(this.$el),this.dropzone=new DropzoneView({el:this.$dropzone,documentImporter:this.model.documentImporter,router:this.router}),this.dropzoneAdded=!0},createDashboard:function(e,t){return this.toolbar.createDashboard(e,t)},finsembleInitEvents:function(){function t(){return QuickBase.DeltaClientLib.deltaClient}this.listenTo(this.model.get("documents"),"update",function(){var e=this.model.get("documents").map(function(e){return _.pick(e.toJSON(),["name","id"])});window.finApi.applyUserConfig(window.finApi.generateConfig(e,!0))}),this.listenTo(this.viewModel,"change:selectedDocumentId",function(){var e=this.viewModel.get("selectedDocumentId");e&&(e=this.model.get("documents").get(e),window.finApi.deltaClientGetter=t,window.finApi.initApi(e,this.viewModel))})},fixSelect2DialogIssue:function(){var t;$.ui&&$.ui.dialog&&$.ui.dialog.prototype._allowInteraction&&(t=$.ui.dialog.prototype._allowInteraction,$.ui.dialog.prototype._allowInteraction=function(e){return!!$(e.target).closest(".select2-dropdown").length||t.apply(this,arguments)})},getAPIPrefix:function(){return"file:"===location.protocol||"FSBL"in window?"http://localhost:10001/api/":"/api/"},getCurrentDocument:function(){var t=this.viewModel.get("selectedDocumentId");return this.model.get("documents").find(function(e){return e.id===t})},onBuildModeChange:function(e,t){this.$el.toggleClass("buildMode",t),this.contentPanel.onResize(),BBForm.ErrorTooltip.clearAll()},onDashboardThemeChanged:function(){var t=this.viewModel.get("DashboardTheme")||$.cookie("dashboard-theme")||this.THEMES[0].id;_.each([this.contentPanel.$el,this.$documentDialogPanel],function(e){if(e&&(e.removeClass("Dark Light kx-darkroom kx-light"),"None"!==t))switch(e.addClass(t),t){case"Dark":e.addClass("kx-darkroom"),$("#appdiv").css("background","#222222");break;case"Light":e.addClass("kx-light"),$("#appdiv").css("background","#f0f0f0")}})},onDocumentsFetched:function(e){var t,n;Log.Log("Dash Documents Complete"),this.model.get("isFinsembleLiteAuth")?window.finApi.applyUserConfig(window.finApi.generateConfig(JSON.stringify(e))):(this.router=new AppRouter({dialogContainer:this.$environmentDialogPanel,model:this.model,viewModel:this.viewModel,createNewDashboardIfNotFound:this.model.get("createNewDashboardIfNotFound"),app:this}),this.model.set("router",this.router),(e=this.model.get("pushStateBase"))&&((t=document.createElement("base")).setAttribute("href",e+"edit/"),document.getElementsByTagName("head")[0].appendChild(t)),Backbone.history.start(e?{pushState:!!e,root:e+"edit/"}:void 0),Backbone.history.fragment.length<=0&&((t=this.viewModel.get("selectedDocumentId"))||0<(e=this.model.get("documents").getSortedDocuments()).length&&(t=e[0].id),t?this.router.navigate(t,{trigger:!0}):(Log.Error("this user doesn't have any dashboards"),(n=new QuickBase.Document({name:"My New Dashboard (1)",creationDate:(new Date).toUTCString()})).save(null,{success:function(e,t){this.model.get("documents").add(n),this.viewModel.set("selectedDocumentId",n.id)}.bind(this),error:function(e,t){MainToolbar.ShowError_unableToCreateNewDashboard(t),$(document).find(".loadingScreen").css({display:"none"})}}))),this.onShowBreadcrumbs())},onDeltaClientLogin:function(){var e;Log.Log("Dash Documents Fetch"),this.model.get("documents").fetch({success:$.proxy(this.onDocumentsFetched,this),error:function(){alert("document fetch error")},reset:!0}),this.model.get("isLite")?this.model.set("userName","User"):(this.model.set("userName",QuickBase.DeltaClientLib.username),this.componentsPanel.updateUserComponents(),this.onPopulateDeltaClientInformation(),QuickBase.DeltaClientLib.showLastLoginAttempts&&this.onShowLastLoginAttempts(),e="true"==QuickBase.DeltaClientLib.getDashboardProperty("hideQueryEditor"),this.model.set("CanExecuteQueries",!e))},onDragEnter:function(e){document.getElementById("appdiv");this.dropzoneAdded||this.initializeDropzone(),_.includes(e.originalEvent.dataTransfer.types,"Files")&&(void 0===e.originalEvent.dataTransfer.items||_.some(e.originalEvent.dataTransfer.items,function(e){return _.includes(["application/json","text/xml"],e.type)}))&&(this.$el.addClass("dragging"),e.preventDefault())},onHideToolbarChange:function(){var e=this.model.get("hideToolbar");this.$el.toggleClass("hideToolbar",!!e),this.toolbar.toggleTitle(e),this.onResize({target:window})},onPopulateDeltaClientInformation:function(){var t=this;QuickBase.DeltaClientLib.getAPIQueryData("kdb",void 0,".ui.controlDetails",[],function(e){t.model.set("dashboardControlDetails",e.rows.reduce(function(e,t){return e[t.Property]=_.isArray(t.Value)?t.Value.join(""):t.Value,e},{}))},function(e){console.log("Error Fetching Delta Client Information:",e)},100,!1)},onDocumentRemoved:function(e){var e=e.id;this.viewModel.get("selectedDocumentId")===e&&((e=this.model.get("documents").first())?(e=e.id,this.viewModel.set("selectedDocumentId",e)):this.viewModel.set("selectedDocumentId",null))},onResize:function(e){e.target===window&&(this.contentPanel.onResize(),this.toolbar.onResize())},onSelectedDocumentChanged:function(){var e=this.model.get("documents").get(this.viewModel.get("selectedDocumentId")),t=this.model.get("documents").get(this.viewModel.previous("selectedDocumentId"));t&&this.stopListening(t),t=e?e.get("name")+this.DOCUMENT_TITLE.SEPARATOR+this.DOCUMENT_TITLE.SUFFIX:this.DOCUMENT_TITLE.SUFFIX,$(document).attr("title",t),this.listenTo(e,"change:name",this.onSelectedDocumentChanged)},onShowBreadcrumbs:function(){this.model.get("showBreadcrumbs")?(this.$breadcrumbs.show(),this.breadcrumbs=new BreadcrumbsWrapper({appModel:this.model,viewModel:this.viewModel}),this.breadcrumbs.$el.appendTo(this.$breadcrumbs)):this.breadcrumbs&&(this.$breadcrumbs.hide(),this.breadcrumbs.remove())},onShowLastLoginAttempts:function(){var e,t=QuickBase.DeltaClientLib.showLastLoginAttempts,n="",i=this;if("failures"===t||"true"===t)e=".session.getFailedLoginsUI",n="Unsuccessful login attempts:";else{if("all"!==t)return;e=".session.getLoginsUI",n="Last 10 login attempts:"}QuickBase.DeltaClientLib.getAPIQueryData("kdb",void 0,e,[],function(e){var e=_.filter(e.rows,function(e){return e.machineID&&0<e.machineID.length});0<e.length&&(e=new FailedLoginsNotification({appModel:i.model,model:new Backbone.Model({rows:e})}),i.notificator.notify(n,e.$el))},function(e){console.log("show last login attempts error:",e)},100,!1)},remove:function(){this.observer.disconnect(),Backbone.View.prototype.remove.call(this)},setThemeFromCookie:function(){var t=this,n=_.map(this.THEMES,function(e){return e.id}).join(" ").concat(" Dark Light");this.environmentTheme=$.cookie("dashboard-theme")||this.THEMES[0].id,_.each([this.toolbar.$el,this.componentsPanel.$el,this.propertiesPanel.$el,this.$environmentDialogPanel,this.$notificationsDiv,this.$breadcrumbs],function(e){e&&e.removeClass(n).addClass(t.environmentTheme)}),_.includes(t.THEMES,this.environmentTheme)&&require(["css!"+this.environmentTheme])},showForceLoginPrompt:function(e){QuickBase.ConfirmDialog.ShowConfirm({dialogTitle:"Session Limit exceeded",renderTemplate:function(){return t("User session limit has been reached, terminate oldest open session?")},callback:e,cancelBtnCallback:this.showLogin.bind(this),container:this.$environmentDialogPanel})},showLogin:function(e){var o=this;new QuickBase.LoginDialog({appModel:this.model,container:this.$environmentDialogPanel,errorMessage:e,doLogin:function(t,n,i){o.initializeDeltaClient(t,n,function(e){"loginRequired"===e?o.showLogin():"userSessionLimit"===e?o.showForceLoginPrompt(function(){o.initializeDeltaClient(t,n,i,null,null,!0)}):i(e)})}})}});return App});