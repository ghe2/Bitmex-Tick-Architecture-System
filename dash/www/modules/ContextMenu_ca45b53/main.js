define(["jquery","d3","Handlebars","QuickBase","backbone","css!./css/app.css"],function(e,n,b,a,v){"use strict";var o,l=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),x=(i.app=b.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,o,l){return'<div class="ContextMenu">\n\n    <div class="title">\n    </div>\n\n    <div class="frame">\n    </div>\n</div>'},useData:!0}),i.button=b.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,o,l){var a,i=null!=t?t:e.nullContext||{},r=e.hooks.helperMissing,s="function",d=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div data="'+d(typeof(a=null!=(a=e(n,"text")||(null!=t?e(t,"text"):t))?a:r)==s?a.call(i,{name:"text",hash:{},data:l,loc:{start:{line:1,column:11},end:{line:1,column:19}}}):a)+'" model="'+d(typeof(a=null!=(a=e(n,"model")||(null!=t?e(t,"model"):t))?a:r)==s?a.call(i,{name:"model",hash:{},data:l,loc:{start:{line:1,column:28},end:{line:1,column:37}}}):a)+'"\n    style="background: '+d(typeof(a=null!=(a=e(n,"bgColor")||(null!=t?e(t,"bgColor"):t))?a:r)==s?a.call(i,{name:"bgColor",hash:{},data:l,loc:{start:{line:2,column:23},end:{line:2,column:34}}}):a)+";border: "+d(typeof(a=null!=(a=e(n,"border")||(null!=t?e(t,"border"):t))?a:r)==s?a.call(i,{name:"border",hash:{},data:l,loc:{start:{line:2,column:43},end:{line:2,column:53}}}):a)+"px solid "+d(typeof(a=null!=(a=e(n,"borderColor")||(null!=t?e(t,"borderColor"):t))?a:r)==s?a.call(i,{name:"borderColor",hash:{},data:l,loc:{start:{line:2,column:62},end:{line:2,column:77}}}):a)+"; border-radius: "+d(typeof(a=null!=(a=e(n,"rounding")||(null!=t?e(t,"rounding"):t))?a:r)==s?a.call(i,{name:"rounding",hash:{},data:l,loc:{start:{line:2,column:94},end:{line:2,column:106}}}):a)+"px; width: "+d(typeof(a=null!=(a=e(n,"width")||(null!=t?e(t,"width"):t))?a:r)==s?a.call(i,{name:"width",hash:{},data:l,loc:{start:{line:2,column:117},end:{line:2,column:126}}}):a)+"; height: "+d(typeof(a=null!=(a=e(n,"height")||(null!=t?e(t,"height"):t))?a:r)==s?a.call(i,{name:"height",hash:{},data:l,loc:{start:{line:2,column:136},end:{line:2,column:146}}}):a)+"; display: inline-block; padding: "+d(typeof(a=null!=(a=e(n,"padding")||(null!=t?e(t,"padding"):t))?a:r)==s?a.call(i,{name:"padding",hash:{},data:l,loc:{start:{line:2,column:180},end:{line:2,column:191}}}):a)+"px; margin: "+d(typeof(a=null!=(a=e(n,"margin")||(null!=t?e(t,"margin"):t))?a:r)==s?a.call(i,{name:"margin",hash:{},data:l,loc:{start:{line:2,column:203},end:{line:2,column:213}}}):a)+'px;">\n    <div style="height: 100%; text-align: '+d(typeof(a=null!=(a=e(n,"position")||(null!=t?e(t,"position"):t))?a:r)==s?a.call(i,{name:"position",hash:{},data:l,loc:{start:{line:3,column:42},end:{line:3,column:54}}}):a)+'">\n        <div style="height: '+d(typeof(a=null!=(a=e(n,"imgPercent")||(null!=t?e(t,"imgPercent"):t))?a:r)==s?a.call(i,{name:"imgPercent",hash:{},data:l,loc:{start:{line:4,column:28},end:{line:4,column:42}}}):a)+"%; vertical-align: "+d(typeof(a=null!=(a=e(n,"valign")||(null!=t?e(t,"valign"):t))?a:r)==s?a.call(i,{name:"valign",hash:{},data:l,loc:{start:{line:4,column:61},end:{line:4,column:71}}}):a)+'">\n            <div class="'+d(typeof(a=null!=(a=e(n,"icontype")||(null!=t?e(t,"icontype"):t))?a:r)==s?a.call(i,{name:"icontype",hash:{},data:l,loc:{start:{line:5,column:24},end:{line:5,column:36}}}):a)+" "+d(typeof(a=null!=(a=e(n,"svg")||(null!=t?e(t,"svg"):t))?a:r)==s?a.call(i,{name:"svg",hash:{},data:l,loc:{start:{line:5,column:37},end:{line:5,column:44}}}):a)+'" style="font-size: '+d(typeof(a=null!=(a=e(n,"shapeSize")||(null!=t?e(t,"shapeSize"):t))?a:r)==s?a.call(i,{name:"shapeSize",hash:{},data:l,loc:{start:{line:5,column:64},end:{line:5,column:77}}}):a)+"px; color: "+d(typeof(a=null!=(a=e(n,"shapeColor")||(null!=t?e(t,"shapeColor"):t))?a:r)==s?a.call(i,{name:"shapeColor",hash:{},data:l,loc:{start:{line:5,column:88},end:{line:5,column:102}}}):a)+"; margin: "+d(typeof(a=null!=(a=e(n,"iconMargin")||(null!=t?e(t,"iconMargin"):t))?a:r)==s?a.call(i,{name:"iconMargin",hash:{},data:l,loc:{start:{line:5,column:112},end:{line:5,column:126}}}):a)+'px;"></div>\n        </div>\n        <div style="color: '+d(typeof(a=null!=(a=e(n,"textColor")||(null!=t?e(t,"textColor"):t))?a:r)==s?a.call(i,{name:"textColor",hash:{},data:l,loc:{start:{line:7,column:27},end:{line:7,column:40}}}):a)+"; height: "+d(typeof(a=null!=(a=e(n,"textPercent")||(null!=t?e(t,"textPercent"):t))?a:r)==s?a.call(i,{name:"textPercent",hash:{},data:l,loc:{start:{line:7,column:50},end:{line:7,column:65}}}):a)+'%;">\n            <span class="span-header">&nbsp;'+d(typeof(a=null!=(a=e(n,"text")||(null!=t?e(t,"text"):t))?a:r)==s?a.call(i,{name:"text",hash:{},data:l,loc:{start:{line:8,column:44},end:{line:8,column:52}}}):a)+' </span>\n            <br />\n            <span class="span-body">&nbsp;'+d(typeof(a=null!=(a=e(n,"textContent")||(null!=t?e(t,"textContent"):t))?a:r)==s?a.call(i,{name:"textContent",hash:{},data:l,loc:{start:{line:10,column:42},end:{line:10,column:57}}}):a)+'</span>\n        </div>\n    </div>\n    <div class="tooltip" data="'+d(typeof(a=null!=(a=e(n,"info")||(null!=t?e(t,"info"):t))?a:r)==s?a.call(i,{name:"info",hash:{},data:l,loc:{start:{line:13,column:31},end:{line:13,column:39}}}):a)+'"></div>\n</div>'},useData:!0}),i.buttonEW=b.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,o,l){var a,i=null!=t?t:e.nullContext||{},r=e.hooks.helperMissing,s="function",d=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div data="'+d(typeof(a=null!=(a=e(n,"text")||(null!=t?e(t,"text"):t))?a:r)==s?a.call(i,{name:"text",hash:{},data:l,loc:{start:{line:1,column:11},end:{line:1,column:19}}}):a)+'" model="'+d(typeof(a=null!=(a=e(n,"model")||(null!=t?e(t,"model"):t))?a:r)==s?a.call(i,{name:"model",hash:{},data:l,loc:{start:{line:1,column:28},end:{line:1,column:37}}}):a)+'"\n    style="background: '+d(typeof(a=null!=(a=e(n,"bgColor")||(null!=t?e(t,"bgColor"):t))?a:r)==s?a.call(i,{name:"bgColor",hash:{},data:l,loc:{start:{line:2,column:23},end:{line:2,column:34}}}):a)+"; border: "+d(typeof(a=null!=(a=e(n,"border")||(null!=t?e(t,"border"):t))?a:r)==s?a.call(i,{name:"border",hash:{},data:l,loc:{start:{line:2,column:44},end:{line:2,column:54}}}):a)+"px solid "+d(typeof(a=null!=(a=e(n,"borderColor")||(null!=t?e(t,"borderColor"):t))?a:r)==s?a.call(i,{name:"borderColor",hash:{},data:l,loc:{start:{line:2,column:63},end:{line:2,column:78}}}):a)+"; border-radius: "+d(typeof(a=null!=(a=e(n,"rounding")||(null!=t?e(t,"rounding"):t))?a:r)==s?a.call(i,{name:"rounding",hash:{},data:l,loc:{start:{line:2,column:95},end:{line:2,column:107}}}):a)+"px; width: "+d(typeof(a=null!=(a=e(n,"width")||(null!=t?e(t,"width"):t))?a:r)==s?a.call(i,{name:"width",hash:{},data:l,loc:{start:{line:2,column:118},end:{line:2,column:127}}}):a)+"; height: "+d(typeof(a=null!=(a=e(n,"height")||(null!=t?e(t,"height"):t))?a:r)==s?a.call(i,{name:"height",hash:{},data:l,loc:{start:{line:2,column:137},end:{line:2,column:147}}}):a)+"; display: inline-block; padding: "+d(typeof(a=null!=(a=e(n,"padding")||(null!=t?e(t,"padding"):t))?a:r)==s?a.call(i,{name:"padding",hash:{},data:l,loc:{start:{line:2,column:181},end:{line:2,column:192}}}):a)+"px; margin:"+d(typeof(a=null!=(a=e(n,"margin")||(null!=t?e(t,"margin"):t))?a:r)==s?a.call(i,{name:"margin",hash:{},data:l,loc:{start:{line:2,column:203},end:{line:2,column:213}}}):a)+'px;">\n    <div style="height: 100%; text-align: '+d(typeof(a=null!=(a=e(n,"position")||(null!=t?e(t,"position"):t))?a:r)==s?a.call(i,{name:"position",hash:{},data:l,loc:{start:{line:3,column:42},end:{line:3,column:54}}}):a)+'">\n        <div style="display: inline-block; vertical-align: '+d(typeof(a=null!=(a=e(n,"valign")||(null!=t?e(t,"valign"):t))?a:r)==s?a.call(i,{name:"valign",hash:{},data:l,loc:{start:{line:4,column:59},end:{line:4,column:69}}}):a)+'">\n            <div class="'+d(typeof(a=null!=(a=e(n,"icontype")||(null!=t?e(t,"icontype"):t))?a:r)==s?a.call(i,{name:"icontype",hash:{},data:l,loc:{start:{line:5,column:24},end:{line:5,column:36}}}):a)+" "+d(typeof(a=null!=(a=e(n,"svg")||(null!=t?e(t,"svg"):t))?a:r)==s?a.call(i,{name:"svg",hash:{},data:l,loc:{start:{line:5,column:37},end:{line:5,column:44}}}):a)+'" style="font-size: '+d(typeof(a=null!=(a=e(n,"shapeSize")||(null!=t?e(t,"shapeSize"):t))?a:r)==s?a.call(i,{name:"shapeSize",hash:{},data:l,loc:{start:{line:5,column:64},end:{line:5,column:77}}}):a)+"px; color: "+d(typeof(a=null!=(a=e(n,"shapeColor")||(null!=t?e(t,"shapeColor"):t))?a:r)==s?a.call(i,{name:"shapeColor",hash:{},data:l,loc:{start:{line:5,column:88},end:{line:5,column:102}}}):a)+"; margin: "+d(typeof(a=null!=(a=e(n,"iconMargin")||(null!=t?e(t,"iconMargin"):t))?a:r)==s?a.call(i,{name:"iconMargin",hash:{},data:l,loc:{start:{line:5,column:112},end:{line:5,column:126}}}):a)+'px;"></div>\n        </div>\n        <div style="color: '+d(typeof(a=null!=(a=e(n,"textColor")||(null!=t?e(t,"textColor"):t))?a:r)==s?a.call(i,{name:"textColor",hash:{},data:l,loc:{start:{line:7,column:27},end:{line:7,column:40}}}):a)+"; display: inline-block; width: "+d(typeof(a=null!=(a=e(n,"textPercent")||(null!=t?e(t,"textPercent"):t))?a:r)==s?a.call(i,{name:"textPercent",hash:{},data:l,loc:{start:{line:7,column:72},end:{line:7,column:87}}}):a)+'%;">\n            <span class="span-header">&nbsp;'+d(typeof(a=null!=(a=e(n,"text")||(null!=t?e(t,"text"):t))?a:r)==s?a.call(i,{name:"text",hash:{},data:l,loc:{start:{line:8,column:44},end:{line:8,column:52}}}):a)+' </span>\n            <br />\n            <span class="span-body">&nbsp;'+d(typeof(a=null!=(a=e(n,"textContent")||(null!=t?e(t,"textContent"):t))?a:r)==s?a.call(i,{name:"textContent",hash:{},data:l,loc:{start:{line:10,column:42},end:{line:10,column:57}}}):a)+'</span>\n        </div>\n    </div>\n    <div class="tooltip"></div>\n</div>'},useData:!0}),i.buttonSN=b.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,o,l){var a,i=null!=t?t:e.nullContext||{},r=e.hooks.helperMissing,s="function",d=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div data="'+d(typeof(a=null!=(a=e(n,"text")||(null!=t?e(t,"text"):t))?a:r)==s?a.call(i,{name:"text",hash:{},data:l,loc:{start:{line:1,column:11},end:{line:1,column:19}}}):a)+'" model="'+d(typeof(a=null!=(a=e(n,"model")||(null!=t?e(t,"model"):t))?a:r)==s?a.call(i,{name:"model",hash:{},data:l,loc:{start:{line:1,column:28},end:{line:1,column:37}}}):a)+'"\n    style="background: '+d(typeof(a=null!=(a=e(n,"bgColor")||(null!=t?e(t,"bgColor"):t))?a:r)==s?a.call(i,{name:"bgColor",hash:{},data:l,loc:{start:{line:2,column:23},end:{line:2,column:34}}}):a)+"; border: "+d(typeof(a=null!=(a=e(n,"border")||(null!=t?e(t,"border"):t))?a:r)==s?a.call(i,{name:"border",hash:{},data:l,loc:{start:{line:2,column:44},end:{line:2,column:54}}}):a)+"px solid "+d(typeof(a=null!=(a=e(n,"borderColor")||(null!=t?e(t,"borderColor"):t))?a:r)==s?a.call(i,{name:"borderColor",hash:{},data:l,loc:{start:{line:2,column:63},end:{line:2,column:78}}}):a)+"; border-radius: "+d(typeof(a=null!=(a=e(n,"rounding")||(null!=t?e(t,"rounding"):t))?a:r)==s?a.call(i,{name:"rounding",hash:{},data:l,loc:{start:{line:2,column:95},end:{line:2,column:107}}}):a)+"px; width: "+d(typeof(a=null!=(a=e(n,"width")||(null!=t?e(t,"width"):t))?a:r)==s?a.call(i,{name:"width",hash:{},data:l,loc:{start:{line:2,column:118},end:{line:2,column:127}}}):a)+"; height: "+d(typeof(a=null!=(a=e(n,"height")||(null!=t?e(t,"height"):t))?a:r)==s?a.call(i,{name:"height",hash:{},data:l,loc:{start:{line:2,column:137},end:{line:2,column:147}}}):a)+"; display: inline-block; padding: "+d(typeof(a=null!=(a=e(n,"padding")||(null!=t?e(t,"padding"):t))?a:r)==s?a.call(i,{name:"padding",hash:{},data:l,loc:{start:{line:2,column:181},end:{line:2,column:192}}}):a)+"px; margin: "+d(typeof(a=null!=(a=e(n,"margin")||(null!=t?e(t,"margin"):t))?a:r)==s?a.call(i,{name:"margin",hash:{},data:l,loc:{start:{line:2,column:204},end:{line:2,column:214}}}):a)+'px">\n    <div style="height: 100%; text-align: '+d(typeof(a=null!=(a=e(n,"position")||(null!=t?e(t,"position"):t))?a:r)==s?a.call(i,{name:"position",hash:{},data:l,loc:{start:{line:3,column:42},end:{line:3,column:54}}}):a)+'">\n        <div style="color: '+d(typeof(a=null!=(a=e(n,"textColor")||(null!=t?e(t,"textColor"):t))?a:r)==s?a.call(i,{name:"textColor",hash:{},data:l,loc:{start:{line:4,column:27},end:{line:4,column:40}}}):a)+"; height: "+d(typeof(a=null!=(a=e(n,"textPercent")||(null!=t?e(t,"textPercent"):t))?a:r)==s?a.call(i,{name:"textPercent",hash:{},data:l,loc:{start:{line:4,column:50},end:{line:4,column:65}}}):a)+"%; vertical-align: "+d(typeof(a=null!=(a=e(n,"valign")||(null!=t?e(t,"valign"):t))?a:r)==s?a.call(i,{name:"valign",hash:{},data:l,loc:{start:{line:4,column:84},end:{line:4,column:94}}}):a)+'">\n            <span class="span-header">&nbsp;'+d(typeof(a=null!=(a=e(n,"text")||(null!=t?e(t,"text"):t))?a:r)==s?a.call(i,{name:"text",hash:{},data:l,loc:{start:{line:5,column:44},end:{line:5,column:52}}}):a)+' </span>\n            <br />\n            <span class="span-body">&nbsp;'+d(typeof(a=null!=(a=e(n,"textContent")||(null!=t?e(t,"textContent"):t))?a:r)==s?a.call(i,{name:"textContent",hash:{},data:l,loc:{start:{line:7,column:42},end:{line:7,column:57}}}):a)+'</span>\n        </div>\n        <div style="height: '+d(typeof(a=null!=(a=e(n,"imgPercent")||(null!=t?e(t,"imgPercent"):t))?a:r)==s?a.call(i,{name:"imgPercent",hash:{},data:l,loc:{start:{line:9,column:28},end:{line:9,column:42}}}):a)+'%;">\n            <div class="'+d(typeof(a=null!=(a=e(n,"icontype")||(null!=t?e(t,"icontype"):t))?a:r)==s?a.call(i,{name:"icontype",hash:{},data:l,loc:{start:{line:10,column:24},end:{line:10,column:36}}}):a)+" "+d(typeof(a=null!=(a=e(n,"svg")||(null!=t?e(t,"svg"):t))?a:r)==s?a.call(i,{name:"svg",hash:{},data:l,loc:{start:{line:10,column:37},end:{line:10,column:44}}}):a)+'" style="font-size: '+d(typeof(a=null!=(a=e(n,"shapeSize")||(null!=t?e(t,"shapeSize"):t))?a:r)==s?a.call(i,{name:"shapeSize",hash:{},data:l,loc:{start:{line:10,column:64},end:{line:10,column:77}}}):a)+"px; color: "+d(typeof(a=null!=(a=e(n,"shapeColor")||(null!=t?e(t,"shapeColor"):t))?a:r)==s?a.call(i,{name:"shapeColor",hash:{},data:l,loc:{start:{line:10,column:88},end:{line:10,column:102}}}):a)+"; margin: "+d(typeof(a=null!=(a=e(n,"iconMargin")||(null!=t?e(t,"iconMargin"):t))?a:r)==s?a.call(i,{name:"iconMargin",hash:{},data:l,loc:{start:{line:10,column:112},end:{line:10,column:126}}}):a)+'px;"></div>\n        </div>\n    </div>\n    <div class="tooltip" data="'+d(typeof(a=null!=(a=e(n,"info")||(null!=t?e(t,"info"):t))?a:r)==s?a.call(i,{name:"info",hash:{},data:l,loc:{start:{line:13,column:31},end:{line:13,column:39}}}):a)+'"></div>\n</div>'},useData:!0}),i.buttonWE=b.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,o,l){var a,i=null!=t?t:e.nullContext||{},r=e.hooks.helperMissing,s="function",d=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div data="'+d(typeof(a=null!=(a=e(n,"text")||(null!=t?e(t,"text"):t))?a:r)==s?a.call(i,{name:"text",hash:{},data:l,loc:{start:{line:1,column:11},end:{line:1,column:19}}}):a)+'" model="'+d(typeof(a=null!=(a=e(n,"model")||(null!=t?e(t,"model"):t))?a:r)==s?a.call(i,{name:"model",hash:{},data:l,loc:{start:{line:1,column:28},end:{line:1,column:37}}}):a)+'"\n    style="background: '+d(typeof(a=null!=(a=e(n,"bgColor")||(null!=t?e(t,"bgColor"):t))?a:r)==s?a.call(i,{name:"bgColor",hash:{},data:l,loc:{start:{line:2,column:23},end:{line:2,column:34}}}):a)+"; border: "+d(typeof(a=null!=(a=e(n,"border")||(null!=t?e(t,"border"):t))?a:r)==s?a.call(i,{name:"border",hash:{},data:l,loc:{start:{line:2,column:44},end:{line:2,column:54}}}):a)+"px solid "+d(typeof(a=null!=(a=e(n,"borderColor")||(null!=t?e(t,"borderColor"):t))?a:r)==s?a.call(i,{name:"borderColor",hash:{},data:l,loc:{start:{line:2,column:63},end:{line:2,column:78}}}):a)+"; border-radius: "+d(typeof(a=null!=(a=e(n,"rounding")||(null!=t?e(t,"rounding"):t))?a:r)==s?a.call(i,{name:"rounding",hash:{},data:l,loc:{start:{line:2,column:95},end:{line:2,column:107}}}):a)+"px; width: "+d(typeof(a=null!=(a=e(n,"width")||(null!=t?e(t,"width"):t))?a:r)==s?a.call(i,{name:"width",hash:{},data:l,loc:{start:{line:2,column:118},end:{line:2,column:127}}}):a)+"; height: "+d(typeof(a=null!=(a=e(n,"height")||(null!=t?e(t,"height"):t))?a:r)==s?a.call(i,{name:"height",hash:{},data:l,loc:{start:{line:2,column:137},end:{line:2,column:147}}}):a)+"; display: inline-block; padding: "+d(typeof(a=null!=(a=e(n,"padding")||(null!=t?e(t,"padding"):t))?a:r)==s?a.call(i,{name:"padding",hash:{},data:l,loc:{start:{line:2,column:181},end:{line:2,column:192}}}):a)+"px; margin: "+d(typeof(a=null!=(a=e(n,"margin")||(null!=t?e(t,"margin"):t))?a:r)==s?a.call(i,{name:"margin",hash:{},data:l,loc:{start:{line:2,column:204},end:{line:2,column:214}}}):a)+'px;">\n\n    <div style="height: 100%; text-align: '+d(typeof(a=null!=(a=e(n,"position")||(null!=t?e(t,"position"):t))?a:r)==s?a.call(i,{name:"position",hash:{},data:l,loc:{start:{line:4,column:42},end:{line:4,column:54}}}):a)+'">\n        <div style="color: '+d(typeof(a=null!=(a=e(n,"textColor")||(null!=t?e(t,"textColor"):t))?a:r)==s?a.call(i,{name:"textColor",hash:{},data:l,loc:{start:{line:5,column:27},end:{line:5,column:40}}}):a)+"; display: inline-block; vertical-align: "+d(typeof(a=null!=(a=e(n,"valign")||(null!=t?e(t,"valign"):t))?a:r)==s?a.call(i,{name:"valign",hash:{},data:l,loc:{start:{line:5,column:81},end:{line:5,column:91}}}):a)+'">\n            <span class="span-header">&nbsp;'+d(typeof(a=null!=(a=e(n,"text")||(null!=t?e(t,"text"):t))?a:r)==s?a.call(i,{name:"text",hash:{},data:l,loc:{start:{line:6,column:44},end:{line:6,column:52}}}):a)+' </span>\n            <br />\n            <span class="span-body">&nbsp;'+d(typeof(a=null!=(a=e(n,"textContent")||(null!=t?e(t,"textContent"):t))?a:r)==s?a.call(i,{name:"textContent",hash:{},data:l,loc:{start:{line:8,column:42},end:{line:8,column:57}}}):a)+'</span>\n        </div>\n        <div style="display: inline-block;">\n            <div class="'+d(typeof(a=null!=(a=e(n,"icontype")||(null!=t?e(t,"icontype"):t))?a:r)==s?a.call(i,{name:"icontype",hash:{},data:l,loc:{start:{line:11,column:24},end:{line:11,column:36}}}):a)+" "+d(typeof(a=null!=(a=e(n,"svg")||(null!=t?e(t,"svg"):t))?a:r)==s?a.call(i,{name:"svg",hash:{},data:l,loc:{start:{line:11,column:37},end:{line:11,column:44}}}):a)+'" style="font-size: '+d(typeof(a=null!=(a=e(n,"shapeSize")||(null!=t?e(t,"shapeSize"):t))?a:r)==s?a.call(i,{name:"shapeSize",hash:{},data:l,loc:{start:{line:11,column:64},end:{line:11,column:77}}}):a)+"px; color: "+d(typeof(a=null!=(a=e(n,"shapeColor")||(null!=t?e(t,"shapeColor"):t))?a:r)==s?a.call(i,{name:"shapeColor",hash:{},data:l,loc:{start:{line:11,column:88},end:{line:11,column:102}}}):a)+"; margin: "+d(typeof(a=null!=(a=e(n,"iconMargin")||(null!=t?e(t,"iconMargin"):t))?a:r)==s?a.call(i,{name:"iconMargin",hash:{},data:l,loc:{start:{line:11,column:112},end:{line:11,column:126}}}):a)+'px;"></div>\n        </div>\n    </div>\n    <div class="tooltip"></div>\n</div>'},useData:!0}),i.chart=b.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,o,l){return'<div class="crumbs">\n</div>\n<div class="graph">\n    <svg></svg>\n</div>'},useData:!0}),i.tooltip=b.template({compiler:[8,">= 4.3.0"],main:function(e,t,n,o,l){var a,i=null!=t?t:e.nullContext||{},r=e.hooks.helperMissing,s=e.escapeExpression,d="function",e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<fieldset><legend>"+s((e(n,"t")||t&&e(t,"t")||r).call(i,"preview",{name:"t",hash:{},data:l,loc:{start:{line:1,column:18},end:{line:1,column:33}}}))+'</legend>\n    <img src="'+s(typeof(a=null!=(a=e(n,"img")||(null!=t?e(t,"img"):t))?a:r)==d?a.call(i,{name:"img",hash:{},data:l,loc:{start:{line:2,column:14},end:{line:2,column:21}}}):a)+'" /></fieldset>\n'+s(typeof(a=null!=(a=e(n,"svgDiv")||(null!=t?e(t,"svgDiv"):t))?a:r)==d?a.call(i,{name:"svgDiv",hash:{},data:l,loc:{start:{line:3,column:0},end:{line:3,column:10}}}):a)},useData:!0}),i);function i(){}s.getComponentDefinition=function(e){if(0<_.keys(e.settingsModel.attributes).length)for(var t=_.find(s.upgrades,{version:e.settingsModel.get("version")}),n=_.isNil(t)?1:s.upgrades.indexOf(t)+1;n<s.upgrades.length;n+=1){var o=s.upgrades[n];o.fn(e.settingsModel),e.settingsModel.set("version",o.version)}return{id:51,componentName:"ContextMenu",componentDescription:"This element displays Context Menu.",appKey:"ContextMenu",ghostViewThumb:null,buildViewThumb:null,appArgs:{json:{version:"4.0.0d2",possibleValues:[""],Basics:{Theme:"Dark",Selected:"",Columns:3,Overflow:"hidden",Data:"",UseData:!1,DataSourceMapping:{Icon:"",HeaderText:"",ContentText:"",TooltipText:"",TargetDashboardId:"",TargetScreensId:"",ButtonColor:"",IconColor:"",BorderColor:"",TextColor:""}},Data:[],Frame:{ShowFrame:!1,FramePercent:80},ViewState:{viewstates_mapping:[]},Style:{advanced:"",advancedTooltip:'<fieldset><legend>{{t "preview"}}</legend><img src="{{img}}" /></fieldset>{{svgDiv}}'},Buttons:{ButtonLayout:"East-West",ButtonAlign:"left",ButtonBackground:"#696669",ButtonGradient:"none",ButtonMargin:10,ButtonPadding:10,IconMargin:0,ButtonBorder:0,ButtonColor:"#ffffff",TextWidth:75,TextColor:"#ffffff",ShapeColor:"#ffdffff",ShapeSize:30,ShapePosition:"center",ButtonRounding:0,ButtonBorderRounding:0,ShowTooltip:!1,FixedSize:!0,FixedWidth:180,FixedHeight:40}},schema:{type:"object",title:"Properties",properties:{possible_screens:{type:"array",items:{type:"object",properties:{title:{type:"string"},value:{type:"string"}}},options:{hidden:!0}},possible_dashboards:{type:"array",items:{type:"object",properties:{title:{type:"string"},value:{type:"string"}}},options:{hidden:!0}},possibleValues:{type:"array",items:{type:"string"},default:[""],options:{collapsed:!0,hidden:!0}},Basics:{type:"object",title:"Basics",options:{collapsed:!1},properties:{Theme:{type:"string",title:"Theme",options:{hidden:!0},enum:["Light","Dark"]},DashboardTheme:{options:{hidden:!0}},Selected:{type:"viewstate",title:"Selected Value",default:""},Rows:{type:"number"},Columns:{type:"number"},Overflow:{type:"string",title:"Overflow",enum:["hidden","auto","scroll","overlay"]},Data:{type:"data",title:"Data Source",default:""},UseData:{type:"boolean",title:"Use Data Source",default:!1,format:"checkbox"},DataSourceMapping:{type:"object",title:"Data Source Mapping",options:{collapsed:!0},properties:{Icon:{type:"string",format:"string",enumSource:"possibleValues",watch:{possibleValues:"root.possibleValues"},default:""},HeaderText:{type:"string",format:"string",enumSource:"possibleValues",watch:{possibleValues:"root.possibleValues"},default:""},ContentText:{type:"string",format:"string",enumSource:"possibleValues",watch:{possibleValues:"root.possibleValues"},default:""},TooltipText:{type:"string",format:"string",enumSource:"possibleValues",watch:{possibleValues:"root.possibleValues"},default:"",options:{hidden:!0}},TargetDashboardId:{type:"string",format:"string",enumSource:"possibleValues",watch:{possibleValues:"root.possibleValues"},default:""},TargetScreensId:{type:"string",format:"string",enumSource:"possibleValues",watch:{possibleValues:"root.possibleValues"},default:""},ButtonColor:{type:"string",format:"string",enumSource:"possibleValues",watch:{possibleValues:"root.possibleValues"},default:""},IconColor:{type:"string",format:"string",enumSource:"possibleValues",watch:{possibleValues:"root.possibleValues"},default:""},BorderColor:{type:"string",format:"string",enumSource:"possibleValues",watch:{possibleValues:"root.possibleValues"},default:""},TextColor:{type:"string",format:"string",enumSource:"possibleValues",watch:{possibleValues:"root.possibleValues"},default:""}}}}},ViewState:{type:"object",title:"Action",options:{collapsed:!1},properties:{viewstates_mapping:{type:"array",title:"ViewState Mapping",format:"table",uniqueItems:!0,items:{type:"object",title:"Mapping",options:{disable_collapse:!0},properties:{Current:{type:"viewstate"},Target:{type:"string",default:""}}}},ViewStateParam:{type:"viewstate",title:"Linked Parameter",default:""},SetParamValue:{type:"string",title:"Set Value",format:"string",default:""}}},Buttons:{type:"object",title:"Button Defaults",options:{collapsed:!1},properties:{ButtonLayout:{type:"string",title:"Layout",propertyOrder:1,enum:["North-South","South-North","East-West","West-East"]},ButtonAlign:{type:"string",title:"Alignment",propertyOrder:1,enum:["left","right","center"]},ButtonBackground:{type:"string",format:"color",title:"Background Color",propertyOrder:2,default:"#ffa500",options:{hidden:!0}},ButtonGradient:{title:"Background",type:"gradient",propertyOrder:3,options:{gradient:!0}},ButtonMargin:{type:"number",format:"number",title:"Button Margin",propertyOrder:4,default:2},IconMargin:{type:"number",format:"number",title:"Icon Margin",propertyOrder:5,default:2},ButtonPadding:{type:"number",format:"number",title:"Button Padding",propertyOrder:6,default:2},ButtonRounding:{type:"number",format:"number",title:"Button Rounding",propertyOrder:7,default:0},ButtonBorder:{type:"number",format:"number",title:"Border Width (px)",propertyOrder:8,default:1},ButtonColor:{title:"Border Colour",propertyOrder:9,default:"#ffffff",type:"gradient",options:{gradient:!1}},ButtonBorderRounding:{type:"number",format:"number",title:"Border Rounding",propertyOrder:10,default:0,options:{hidden:!0}},TextWidth:{type:"number",format:"number",title:"Text  %",propertyOrder:11,default:50},TextColor:{title:"Text Color",propertyOrder:12,default:"#ffa500",type:"gradient",options:{gradient:!1}},ShapeColor:{title:"Icon Color",propertyOrder:13,default:"#ffa500",type:"gradient",options:{gradient:!1}},ShapeSize:{type:"number",format:"number",title:"Icon Size",propertyOrder:14,default:24},ShapePosition:{type:"string",enum:["left","right","center"],title:"Align Position",propertyOrder:15,default:"left"},VerticalPosition:{default:0,minimum:0,maximum:80,type:"number",step:1,format:"range",title:"Vert. Align Position",propertyOrder:16,options:{hidden:!0}},ShowTooltip:{title:"Show Tooltip",type:"boolean",propertyOrder:17,format:"checkbox"},FixedSize:{title:"Fixed Size",type:"boolean",propertyOrder:18,format:"checkbox"},FixedWidth:{type:"number",format:"number",title:"Fixed Width",propertyOrder:19,default:100},FixedHeight:{type:"number",format:"number",title:"Fixed Height",propertyOrder:20,default:100}}},Frame:{type:"object",title:"Frame Details",options:{collapsed:!0,hidden:!0},properties:{ShowFrame:{title:"Show Frame",type:"boolean",propertyOrder:1,format:"checkbox"},FramePercent:{type:"number",title:"Frame Percent",propertyOrder:2,default:80,minimum:0,maximum:100,step:1,format:"range"}}},Data:{type:"array",format:"object",title:"Buttons",uniqueItems:!1,options:{collapsed:!0},items:{type:"object",title:"Details",properties:{TargetScreens:{title:"Open Screen on Select",type:"string",data:"possible_screens",options:{hidden:!0}},TargetDashboard:{title:"Open Dashboard on Select",type:"string",data:"possible_dashboards",options:{hidden:!0}},TargetScreensId:{title:"ID",type:"string",data:"possible_screens",options:{hidden:!0}},TargetDashboardId:{title:"ID",type:"string",data:"possible_dashboards",options:{hidden:!0}},TargetDashboardScreen:{title:"Open Dashboard on Select",type:"nav",default:"",propertyOrder:1},Shape:{type:"icon",title:"Icon",default:"",propertyOrder:3},Display:{type:"string",title:"Header Text",default:"{{Button Text}}",propertyOrder:4},Content:{type:"string",title:"Content Text",default:"",propertyOrder:5},Info:{type:"string",title:"Dashboard Info",default:"",propertyOrder:6},Customise:{title:"Customise",type:"boolean",format:"checkbox",propertyOrder:7,default:!1},ButtonColor:{title:"Button Color",propertyOrder:8,default:"#ffa500",type:"gradient",options:{gradient:!0}},IconColor:{title:"Icon Color",propertyOrder:9,default:"#ffa500",type:"gradient",options:{gradient:!1}},BorderColor:{title:"Border Color",propertyOrder:10,default:"#ffa500",type:"gradient",options:{gradient:!1}},TextColor:{title:"Text Color",propertyOrder:11,default:"#ffa500",type:"gradient",options:{gradient:!1}}}}},Style:{type:"object",title:"Style",options:{collapsed:!0},properties:{advanced:{type:"css",title:"Advanced CSS",default:""},advancedTooltip:{type:"tooltipTemplate",title:"Custom tooltip",propertyOrder:3,data:["name","thumb","creationDate","svgDiv"],default:""}}}}}}}},s.upgrades=[{version:0,fn:function(){}},{version:"4.0.0d2",fn:function(e){e.set("Style.advanced","")}}];var r=s;function s(){}p.expandNestedViewStates=function(e,t){var n=!1,o=Object.keys(e);if(n=1===o.length?(l=t.getPropertyMeta(o[0]))&&"viewstate"===l.type:n){var l=/^((?:\w+\.)*)(\d+)/.exec(o[0]);if(l)return n=l[1].slice(0,-1),o=t.getProperty(n),(l={})[n]=o,l}return e},p.replaceViewStatesWithValue=function(e,t,n){return p.replaceViewStates(e,t,function(e,t,n,o){return o.value},n)},p.replaceViewStatesWithModel=function(e,t,l){return p.replaceViewStates(e,t,function(e,t,n,o){if(n instanceof v.Model&&n.get("_viewType"))return n;e=l.getProperty(e)[t];return _.isUndefined(n)?void 0:(e.get("value")!==n&&e.set("value",n),e)},l)},p.pump=function(n){if(null!=n){if(!_.isObject(n))return n;var e=Object.getPrototypeOf(n);if(_.isObject(n)&&e!==Object.prototype&&e!==Array.prototype)return n;if(e===Array.prototype)return n.map(p.pump);var o=/^(\d+)((?:\.\w+)+)$/;if(Object.keys(n).every(function(e){return o.test(e)}))return Object.keys(n).map(function(e){var t=o.exec(e);return _.isNil(t)?{index:0,tail:"",value:0}:{index:Number(t[1]),tail:t[2].substring(1),value:n[e]}}).reduce(function(e,t){var n={};return n[t.index]={},n[t.index][t.tail]=t.value,$.extend(!0,e,p.pump(n))},[]);var l={greedy:/^(\w+)((?:\.\w+)*)$/,nonGreedy:/^(\w+)((?:\.\w+)+)$/};return Object.keys(n).some(function(e){return l.nonGreedy.test(e)})?Object.keys(n).map(function(e){var t=l.greedy.exec(e);return _.isNil(t)?{head:0,tail:null,value:0}:{head:t[1],tail:""!==t[2]?t[2].substring(1):null,value:n[e]}}).reduce(function(e,t){var n={};return null!==t.tail?(n[t.head]={},n[t.head][t.tail]=t.value):n[t.head]=t.value,$.extend(!0,e,p.pump(n))},{}):_.mapValues(n,p.pump)}},p.replaceViewStates=function(n,e,r,s){var d=function(e,t){return function n(e,t,o){o=o?o+".":"";t+="";var l=s.getPropertyMeta(o+t);{var a,i;return l&&"data"===l.type?e:l&&"viewstate"===l.type?(i=(o+t).split("."),a=i.pop(),i=i.join("."),r(i,a,e,l)):!_.isArray(e)&&!_.isObject(e)||e.has&&e.has("_dataSource")&&e.has("_dataType")?e:(o+=t,d=function(e,t){return n(e,t,o)},(u=_.isArray(e)?_.map:_.mapValues)(e,d))}}(e,t,n||"")},u=_.isArray(e)?_.map:_.mapValues;return u(e,d)};var d,u=p;function p(){}function c(e){var t=d.call(this,e)||this;return t.isPivot=!1,t.router={},t.level={},t.options=e,t.api=t.options.api,t.subscriptionKey=_.uniqueId("ContextMenus_"),t.primaryKey="_rowIndex",t.collection=new v.Collection([],{model:v.Model.extend({idAttribute:"id"})}),t.columnInfo=new v.Collection([],{model:v.Model.extend({idAttribute:"id"})}),t.columnInfo.id="id",t.collection.id=t.primaryKey,t.columnInfo.comparator="index",t.hideErrorMessage=e.api.hideErrorMessage,t.showErrorMessage=e.api.showErrorMessage,t.router={},t.level={},t.$el.html(x.app()),t.$root=t.$el.find(">.ContextMenu"),t.$frame=t.$el.find(".frame"),t.$title=t.$el.find(".title"),t.updateTheme(),t}return d=v.View,l(c,d),c.prototype.onSettingsChange=function(e){e=u.expandNestedViewStates(e,this.api),e=u.replaceViewStatesWithValue("",e,this.api),e=u.pump(e);this.onSettingsChangeProcessed.call(this,e)},c.prototype.onSettingsChangeProcessed=function(e){(_.get(e,"Basics.UseData")||_.get(e,"Basics.Data"))&&(this.onPropDataChange(this.api.getProperty("Basics").Data),_.get(e,"Basics.UseData")&&this.setButtonParams()),_.get(e,"Basics.DataSourceMapping")&&this.setButtonParams(),_.get(e,"notificationEvent")&&(this.api.setProperty("possibleColumns",[""]),this.onPropDataChange(this.api.getProperty("Basics").Data)),(_.get(e,"Data")||_.get(e,"ViewState")||_.get(e,"Style")||_.get(e,"format")||_.get(e,"Alignment")||_.get(e,"Buttons")||_.get(e,"Basics.SelectedObjectRouting"))&&this.applyContextMenu()},c.prototype.applyDataToContextMenu=function(){var e=this,t=[];_.defer(function(){e.api.getProperty("Basics.UseData")&&(t.push("none"),_.each(e.columnInfo.models,function(e){t.push(e.id)}),e.applyContextMenu())})},c.prototype.applyContextMenu=function(){var d,u,p,c,h=this,e=this.api.getProperty("Basics"),m=this.api.getProperty("Buttons"),t=this.api.getProperty("Data"),n=this.api.getProperty("Frame"),g=this.api.getProperty("Style"),o=t.length-1,f="",l=this.$el.height(),l=_.isNil(l)?0:l,y=n.ShowFrame?l*((100-n.FramePercent)/100):l,l={left:"flex-start",center:"center",right:"flex-end"}[m.ButtonAlign];e&&m&&n&&g&&(y=(m.FixedSize?"object"==typeof m.FixedHeight?parseInt(m.FixedHeight.get("value")):parseInt(m.FixedHeight):Math.floor(y/(Math.floor(o/e.Columns)+1))-2*(m.ButtonMargin+m.ButtonPadding))+"px",c=m.FixedSize?"object"==typeof m.FixedWidth?parseInt(m.FixedWidth.get("value"))+"px":parseInt(m.FixedWidth)+"px":"calc("+100/parseFloat(e.Columns)+"% - "+(2.5*m.ButtonMargin+2*m.ButtonPadding)+"px)",this.$el.html(x.app()),this.$frame=this.$el.find(".frame"),this.$frame.css({overflow:e.Overflow}),t&&(this.$frame.css({"justify-content":l}),_.each(t,function(e,t){var n="",o=20,l=e.Customise,a=""+(e.Shape||""),i=(a=0<=a.indexOf("mi-")||0<=a.indexOf("fa-")?a:"fa-"+a,!_.get(e,"TargetDashboardScreen")||_.get(e,"TargetDashboardScreen")instanceof v.Model?_.get(e,"TargetDashboardScreen")instanceof v.Model&&(n=JSON.stringify(_.extend(e.TargetDashboardScreen.toJSON(),{buttonId:t}))):(_.set(e,"TargetDashboardScreen.buttonId",t),n=JSON.stringify(e.TargetDashboardScreen)),l?"Data."+t+".ButtonColor":"Buttons.ButtonGradient"),r=l?"Data."+t+".IconColor":"Buttons.ShapeColor",s=l?"Data."+t+".TextColor":"Buttons.TextColor",l=l?"Data."+t+".BorderColor":"Buttons.ButtonColor",a={iconMargin:m.IconMargin,svg:a,icontype:a.substring(0,2),bgColor:h.browserGradient(h.api.getProperty(i)),rounding:m.ButtonRounding,shapeColor:h.api.getProperty(r),width:c,height:y,shapeSize:m.ShapeSize,shapeScale:m.ShapeSize/24,textColor:h.api.getProperty(s),text:h.api.getProperty("Data."+t+".Display"),textContent:h.api.getProperty("Data."+t+".Content"),textPercent:m.TextWidth,imgPercent:100-m.TextWidth,border:m.ButtonBorder,borderColor:h.api.getProperty(l),valign:void 0===e.VerticalPosition?0:e.VerticalPosition,borderSpacing:2.5*m.ButtonMargin+2*m.ButtonPadding,padding:m.ButtonPadding,margin:m.ButtonMargin,model:n,position:m.ShapePosition,info:e.Info};(i="South-North"===m.ButtonLayout?$(x.buttonSN(a)):"East-West"===m.ButtonLayout?$(x.buttonEW(a)):"West-East"===m.ButtonLayout?$(x.buttonWE(a)):$(x.button(a))).mouseover(function(e){if($(e.currentTarget).css({opacity:.7}),m.Showtip){if(h.dialog||(h.dialog=$(h).find(".tooltip").dialog({height:20,autoOpen:!1})),h.dialog.dialog("option","title",$(h).attr("data")),p=(void 0).get("name"),u=(void 0).get("creationDate"),h.dialog.attr("data")&&(f="<div>"+void 0+$(h).attr("data")+"</div>"),""===g.advancedTooltip)d=x.tooltip({img:"",svgDiv:f,creationDate:u,dashboard:p});else{var t=b.compile(g.advancedTooltip),n={img:"",svgDiv:f,creationDate:u,dashboard:p};_.each(h.options.viewModel.attributes,function(e,t){void 0!==t&&0!==t.indexOf(".")&&(n[t]=h.options.viewModel.get(t).get("value"))});try{d=t(n)}catch(e){d=x.tooltip({img:"",svgDiv:f,creationDate:u,dashboard:p})}}h.dialog.html(d),h.dialog.dialog("open"),o=h.dialog.children().height(),o=isNaN(o)||0===o?20:o,$(document).find(".ui-dialog.ContextMenu").css({height:o+30}),$(document).find(".ContextMenu > .tooltip.ui-dialog-content").css({height:o+30}),h.dialog.dialog("option",{dialogClass:"quick-dash ContextMenu",position:{my:"left top",at:"left bottom",collision:"flip flip",of:h}})}}).mouseout(function(e){$(e.currentTarget).css({opacity:1}),h.dialog&&h.dialog.dialog("close")}).click(function(t){h.dialog&&h.dialog.dialog("close");var t=t.currentTarget.getAttribute("model"),e={viewstate:{},dashboard:"",screen:""};if(t)try{var n=JSON.parse(t);"dict"===n._type&&n.value&&n.value.screen&&n.value.dashboard?(e.screen=n.value.screen.value,e.dashboard=n.value.dashboard.value,e.buttonId=n.buttonId,e._dashboardsType="navigation"):e=n,e.viewstate=h.mapViewStates(),_.isNil(_.get(e,"buttonId"))||(h.api.setProperty("Basics.Selected",_.get(e,"buttonId")),h.api.navigate(e))}catch(e){console.log("invalid target",t)}}),h.$frame.append(i)}),this.$iframe=$(this.$frame.find(".frame"))))},c.prototype.browserGradient=function(e){var t=e;return 0!==e.trim().indexOf("#")&&(t=(t=t.replace("-moz-","")).replace("-webkit-",""),t=0<=navigator.userAgent.indexOf("Chrome")?"-webkit-"+t:0<=navigator.userAgent.indexOf("Firefox")?"-moz-"+t:t.replace("linear-gradient(","linear-gradient(to ")),t},c.prototype.initializeErrorHandler=function(e){var t=this;this.updateErrorMessage(),this.listenTo(e,"change:error",function(){t.updateErrorMessage()})},c.prototype.mapViewStates=function(){var l=this,a={},e=this.api.getProperty("ViewState.viewstates_mapping");return _.each(e,function(e,t){var n=l.api.getPropertyMeta("ViewState.viewstates_mapping."+t+".Current"),o=l.api.getPropertyMeta("ViewState.viewstates_mapping."+t+".Target");n&&(o&&"viewstate"===o.type&&o.path?l.api.setProperty("ViewState.viewstates_mapping."+t+".Target",n.value):a[e.Target]=n.value)}),a},c.prototype.navigate=function(e,t){this.router[e]=t},c.prototype.onData=function(t,e){var n=this,o=!1,l=t.columns;t.primaryKey!==this.primaryKey&&(this.primaryKey=t.primaryKey,this.collection.reset(),this.isPivot?this.collection=new(a.Tools.createPivotCollectionFunc(this.primaryKey)):this.collection=new v.Collection([],{model:v.Model.extend({idAttribute:this.primaryKey})}),o=!0),l.reset?this.columnInfo.reset(t.columns.reset):(this.columnInfo.remove(_.map(l.remove,function(e){return e[t.primaryKey]})),this.columnInfo.add(l.add),this.columnInfo.add(l.change,{merge:!0})),(o=o||_.some(["add","remove","reset","change"],function(e){return n.metaChange="reset",void 0!==l[e]}))&&this.api.setProperty("possibleValues",this.columnInfo.pluck("id")),this.columnInfo.sort(),o&&this.applyDataToContextMenu(),e.reset?(this.applyDataToContextMenu(),this.collection.reset(e.reset)):(this.collection.remove(_.map(e.remove,function(e){return e[t.primaryKey]})),this.collection.add(e.add),this.collection.add(e.change,{merge:!0})),this.setButtonParams()},c.prototype.onPropDataChange=function(e){this.api.getProperty("Basics.UseData")&&(this.model&&(this.stopListening(this.model),this.api.unsubscribe(this.model)),this.model=e,this.model&&this.model.attributes?(this.isPivot="pivot"===this.model.get("_dataType")||void 0===this.model.get("_dataType"),this.api.subscribe(this.model,this.onData.bind(this)),this.initializeErrorHandler(this.model)):this.showErrorMessage({error:t("Invalid Data Source")+': "'+e.path+'" '+t("selected"),type:"Warning"},this.model))},c.prototype.onResizeStop=function(){this.applyContextMenu()},c.prototype.setButtonParams=function(){var i,r=this,e=this.api.getProperty("Basics"),t=[];e.UseData&&this.api.getProperty("Data")&&_.defer(function(){var l=r.api.getProperty("Buttons"),a=_.extend({},r.api.getProperty("Basics.DataSourceMapping"));t.push("none"),_.each(r.columnInfo.models,function(e){t.push(e.id)}),r.api.setProperty("possibleValues",t),_.each(r.api.getProperty("Basics.DataSourceMapping"),function(e){void 0!==e&&""!==e||t[0]}),i=[],_.each(r.collection.models,function(n,e){var o={},t=r.api.getProperty("Data")[e]||"";_.each(a,function(e,t){o[t]="none"!==e&&""!==e&&n.get(e)||""}),i.push({BorderColor:_.get(o,"BorderColor")||r.api.getProperty("Data."+e+".BorderColor")||l.ButtonColor||"#ffffff",ButtonColor:_.get(o,"ButtonColor")||r.api.getProperty("Data."+e+".ButtonColor")||l.ButtonBackground||"#ffffff",Content:_.get(o,"ContentText")||r.api.getProperty("Data."+e+".Content")||"",Customise:!0,Display:_.get(o,"HeaderText")||r.api.getProperty("Data."+e+".Display")||"",IconColor:_.get(o,"IconColor")||r.api.getProperty("Data."+e+".IconColor")||"",Info:_.get(o,"TooltipText")||r.api.getProperty("Data."+e+".Info")||"",Shape:_.get(o,"Icon")||r.api.getProperty("Data."+e+".Share")||"",TargetDashboardId:_.get(o,"TargetDashboardId")||t.TargetDashboardId||"",TargetScreensId:_.get(o,"TargetScreensId")||t.TargetScreensId||"",TargetDashboardScreen:{dashboard:_.find(r.api.getProperty("possible_dashboards"),{id:_.get(o,"TargetDashboardId")})||_.get(o,"TargetDashboardId")||t["TargetDashboardScreen.dashboard"]||{id:_.get(o,"TargetDashboardId")||t["TargetDashboardScreen.dashboard.id"],title:"<none>"},screen:_.find(r.api.getProperty("possible_screens"),{id:_.get(o,"TargetScreensId")})||_.get(o,"TargetScreensId")||t["TargetDashboardScreen.screen"]||{id:_.get(o,"TargetScreensId")||t["TargetDashboardScreen.screen.id"],title:"<none>"}},TextColor:_.get(o,"TextColor")||l.TextColor})}),r.api.setProperty("Data",i),r.applyContextMenu()})},c.prototype.setTheme=function(){this.updateTheme()},c.prototype.updateErrorMessage=function(){this.model.get("error")?this.showErrorMessage(this.model.get("error")):this.hideErrorMessage()},c.prototype.updatePadding=function(){var e=this.api.getProperty("Alignment");this.$root.css({left:e.paddingLeft+"px",right:e.paddingRight+"px",top:e.paddingTop+"px",bottom:e.paddingBottom+"px"})},c.prototype.updateTitle=function(){var e=this.api.getProperty("format"),t=e.widgetTitle;t&&0<t.length?(this.$title.text(t),this.$title.css({"font-size":e.titleFontSize,"text-align":e.titleHorizontal,"padding-left":e.titlePaddingLeft,"padding-right":e.titlePaddingRight,"padding-top":e.titlePaddingTop,"padding-bottom":e.titlePaddingBottom}),this.$frame.css("top",this.$title.outerHeight())):(this.$title.text(""),this.$frame.css("top",0))},c.prototype.updateTheme=function(){var e=this.api.getProperty("Basics.Theme").toLowerCase();this.options.dashboardViewModel.get("DashboardTheme")&&(e=this.options.dashboardViewModel.get("DashboardTheme").toLowerCase()),this.themeClass!==e&&(this.$root.removeClass(this.themeClass),this.themeClass=e,this.$root.addClass(this.themeClass))},c.getComponentDefinition=r.getComponentDefinition,c});